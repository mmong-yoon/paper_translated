"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8877"],{91093:function(e,t,i){i.d(t,{A:()=>n});let n={queue:"queue-EZRP7x",cardWrapper:"cardWrapper-qR0zV5",smallCardWrapper:"smallCardWrapper-GidLX3",archived:"archived-tVgnOK",arrow:"arrow-M1xp9f",disabled:"disabled-C1q6TH",link:"link-gPxpTf",highlight:"highlight-khGgmH",border:"border-Sobc4n",playButtonContainer:"playButtonContainer-SkXFOr",playButton:"playButton-NfBL9x",logoContainerShadow:"logoContainerShadow-MadM6a",cornerLogo:"cornerLogo-sq79Zv",vibranceTertiaryIcon:"vibranceTertiaryIcon-FMLmJq",vibranceSecondaryText:"vibranceSecondaryText-mI5k5T",vibranceTertiaryBg:"vibranceTertiaryBg-dway6D",closeButton:"closeButton-dm0qJO",closeIcon:"closeIcon-dUQ0_l",card:"card-DZvXCa",smallCard:"smallCard-QlKXKt",cardBg:"cardBg-Vnz3e5",cardTop:"cardTop-qa11Ls",bigCardTop:"bigCardTop-xISBuI",smallCardTop:"smallCardTop-YuCbBT",gifPreview:"gifPreview-jTpyu3",coverImage:"coverImage-h44eo2",audioWaveform:"audioWaveform-QTkNO2",audioLogoContainer:"audioLogoContainer-yUWOV3",cardBottom:"cardBottom-KjkXaq",smallCardRight:"smallCardRight-A8Afqo",titleContainerMinHeight:"titleContainerMinHeight-QKOvED",title:"title-EwaRJw",smallCardAuthor:"smallCardAuthor-MXnD06",iconButton:"iconButton-g5L_4l",isSaved:"isSaved-Ml5fNZ",newIconButton:"newIconButton-AH4esm",livePreview:"livePreview-t_LWyR",blur:"blur-Q0P53N",explicitIcon:"explicitIcon-otqJ1H"}},70828:function(e,t,i){i.d(t,{A:()=>n});let n={container:"container-fi9IrN",nav:"nav-ptYSWX"}},61431:function(e,t,i){i.d(t,{_:()=>h});var n=i(69277),a=i(70408),r=i(10201),o=i(84605),s=i(86500),l=i(89490),c=i(35369),d=i(60322),u=i(76977),p=i(81203),m=i(63136);function h(e){let{profile:t,onFinalizeVisibility:i,onSetVisibility:l,source:d,hideButton:p}=e,{iString:m}=(0,o.GO)();if(!t)return null;let h=t.subscriptions.every(e=>{let{visibility:t}=e;return"public"===t});return(0,r.FD)(u.VP,{children:[(0,r.Y)(u.fI,{justifyContent:"end",pullX:8,children:(0,r.Y)(c.$n,{size:"sm",priority:"quaternary",onClick:()=>{let e=h?"private":"public";l(t.subscriptions.reduce((t,i)=>{let{publication:r}=i;return(0,a._)((0,n._)({},t),{[r.id]:e})},{})),(0,s.u4)(s.qY.PROFILE_EDITED,{type:"visibility_toggled_all",for:"reads",count:t.subscriptions.length,newVisibility:e})},children:m(h?"Hide all":"Show all")})}),(0,r.Y)(u.VP,{minHeight:320,gap:4,children:t.subscriptions.map(e=>{let i;return(0,r.Y)(b,{sub:e,onSetVisibility:(i=e.publication,e=>{l(t.subscriptions.reduce((t,r)=>{let{visibility:o,publication:s}=r;return(0,a._)((0,n._)({},t),{[s.id]:s.id===i.id?e:o})},{})),(0,s.u4)(s.qY.PROFILE_EDITED,{type:"read_visibility_toggled",visibility:e})}),source:d},e.id)})}),!p&&(0,r.Y)(c.$n,{priority:"primary",onClick:i,children:m("Done")})]})}function b(e){let{sub:t,onSetVisibility:i}=e,n=t.publication;return(0,r.FD)(g,{children:[(0,r.Y)(p.Nq,{pub:n,size:32}),(0,r.Y)(m.EY.B3,{weight:"medium",flex:"grow",children:n.name}),(0,r.Y)(d.S,{checked:"public"===t.visibility,onChange:()=>i("public"===t.visibility?"private":"public")})]})}let g=(0,l.I4)({display:"flex",paddingY:8,gap:12,alignItems:"center",minWidth:0})},12165:function(e,t,i){i(10201),i(97731)},72035:function(e,t,i){i(10201),i(97731)},13918:function(e,t,i){i.d(t,{Dq:()=>j,d2:()=>J,u3:()=>V});var n=i(99851),a=i(69277),r=i(70408),o=i(10201),s=i(32485),l=i.n(s),c=i(83673),d=i.n(c),u=i(17402),p=i(34615),m=i(27437),h=i(17436),b=i(54158),g=i(89839),_=i(18325),y=i(59821),Y=i(26184),v=i(53868),f=i(97683),S=i(11333),C=i(41935),N=i(55136),k=i(84605),E=i(85478),D=i(6049),w=i(86500),A=i(12501),B=i(24078),I=i(22057),T=i(76977),P=i(63136),F=i(83629),x=i(16291),R=i(41232),L=i(98111),O=i(56458),q=i(56262),M=i(39318),U=i(70189),W=i(49807),G=i(82776),K=i(57324);class H extends u.Component{componentWillUnmount(){this.unmounted=!0}render(){let{pub:e,post:t,showAuthor:i,showPhoto:n,fromPostPage:s}=this.props;return(0,C.AS)({pub:e,post:t,showAuthor:i,showPhoto:n})||(0,C.o$)({pub:e,post:t,showAuthor:i})||(0,C.Bq)({pub:e,post:t,showAuthor:i})?this.withAuthorLine(this.props,this.state):(0,o.Y)(X,(0,r._)((0,a._)({},this.props),{className:"alternative-meta",isMobileWidth:this.state.isMobileWidth,actionBarStyle:s?"post-header-compact":"post-preview"}))}constructor(e,t){var i;if(super(e,t),(0,n._)(this,"unmounted",void 0),(0,n._)(this,"withAuthorLine",(e,t)=>{let{pub:i,post:n,showAuthor:a,showPhoto:r,getConfigFor:s,isAppMode:c}=e,d="adhoc_email"===n.type,u=(0,G.getBylineUsers)(n).length,p=1===u&&(0,G.getBylineUsers)(n)[0],m=p&&p.is_guest&&!s("dont_show_guest_byline")&&!d,h=e.showDate||e.showDatetime,b=!n.is_published&&!e.inThreadHead&&h&&!d,g=e.isFreePreview&&e.showAudience&&h&&!d,_=(0,q.isFoundingAudience)(n.audience)&&e.showAudience&&!g&&h&&!d&&!(0,O.Ed)({post:n}),y=(0,q.isPaidAudience)(n.audience)&&e.showAudience&&!_&&!g&&h&&!d&&!(0,O.Ed)({post:n}),Y=(0,C.AS)({pub:i,post:n,showAuthor:a,showPhoto:r});return(0,o.Y)(D.h2,{width:"100%",className:l()("post-meta"),children:(0,o.FD)("tr",{children:[(0,o.Y)("td",{children:(0,o.FD)(D.jJ,{children:[(0,o.Y)(D.ZB,{gap:4,children:(0,o.Y)(P.EY.Meta,{color:"primary",className:R.A.postAuthor,children:u>0?(0,G.oxfordComma)((0,G.getBylineUsers)(n).map(e=>(0,o.Y)(P.EY.Meta,{as:"a",href:c?(0,W.gTK)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,M.laT)(e,i),color:"primary",style:"text-decoration: none",children:e.name}))):(0,G.getPrintedByline)(i,n)})}),(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:(e.showDate||e.showDatetime)&&n.post_date&&(0,o.Y)("time",{dateTime:(0,x.A)(n.post_date).toISOString(),children:(0,x.A)(n.post_date).locale(this.context.language).standardDate()})}),y&&(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:"∙"}),(0,o.Y)(P.EY.Meta,{color:"paid",translated:!0,children:"Paid"})]}),_&&(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:"∙"}),(0,o.Y)(P.EY.Meta,{color:"paid",children:this.context.iString((0,O.G8)(i,n))})]}),g&&(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:"∙"}),(0,o.Y)(P.EY.Meta,{color:"paid",translated:!0,children:"Preview"})]}),m&&(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:"∙"}),(0,o.Y)(P.EY.Meta,{translated:!0,children:"Guest post"})]}),b&&(0,o.FD)(D.ZB,{gap:4,children:[(0,o.Y)(P.EY.Meta,{children:"∙"}),(0,o.Y)(P.EY.Meta,{translated:!0,children:"Draft"})]})]})]})}),Y&&(0,o.Y)("td",{align:"right",children:(0,o.Y)(D.ZB,{gap:4,children:u>0&&(0,G.getBylineUsers)(n).map((e,t)=>{var n;return t<4&&(0,o.Y)("a",{href:c?(0,W.gTK)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,M.laT)(e,i),children:(0,o.Y)(D.Kb,{src:null!=(n=e.photo_url)?n:"",size:u>1?32:40})})})})})]})})}),"undefined"!=typeof window&&(null==(i=window)?void 0:i.matchMedia)){const e=window.matchMedia("screen and (max-width: 650px)");this.state={isMobileWidth:e.matches};const t=e=>{this.unmounted||this.setState({isMobileWidth:e.matches})};e.addEventListener?e.addEventListener("change",t):e.addListener&&e.addListener(t)}}}(0,n._)(H,"contextType",k.OW);let V=(0,E.P_)(H);function J(e){var t,i;let{pub:n,post:r,user:s,reactors:l,secondaryFaces:c,mediaClipId:d}=e,[m,h]=(0,u.useState)(null),[b,g]=(0,u.useState)(!1),_=(0,A.st)({pathname:"primary"===m?"/api/v1/post/".concat(r.id,"/reactors"):"/api/v1/".concat(d?"media_clip":"post","/").concat(null!=d?d:r.id,"/restackers"),auto:!!m,deps:[r.id,m]}),y=z(l,s,!!r.reaction,n),Y=z(c,s,!!r.restacked,n),v=y.concat(Y.filter(e=>!!e.photo_url&&!y.find(t=>t.id===e.id))),f=Math.max(null!=(t=r.reactions["❤"])?t:0,(null!=y?y:[]).length),S=n.hide_post_restacks?0:null!=(i=r.restacks)?i:0,C=f>0?(0,G.pluralize)(f,"Like"):"",N="";return S>0&&(N="".concat((0,G.pluralize)(S,"Restack"))),(0,o.FD)(o.FK,{children:[(0,o.FD)(T.fI,{gap:16,alignItems:"center",color:"secondary",children:[(0,o.Y)(I.Z,{users:v,renderAvatar:e=>(0,o.Y)(B.tp,(0,a._)({},e)),direction:"rtl",renderCount:()=>(0,o.Y)(u.Fragment,{})}),(0,o.Y)(P.EY.B4,{color:"secondary",children:(0,o.FD)(T.fI,{gap:4,alignItems:"center",children:[(0,o.Y)(Z,{label:C,onClick:()=>{f&&((0,w.u4)(w.qY.POST_REACTIONS_MODAL_VIEWED,{post_id:r.id}),h("primary"),g(!0))}}),C&&N&&"∙",(0,o.Y)($,{post:r,label:N})]})})]}),_.result&&(0,o.Y)(p.K,{isOpen:b,modalLabel:C,faces:_.result,totalCount:f,onClose:()=>{g(!1),h(null)},utmSource:"post-reactions-modal"})]})}let Z=e=>{let{label:t,onClick:i}=e;return(0,o.Y)(P.Yq,{onClick:i,color:"secondary",cursor:"pointer",children:t})},$=e=>{let{label:t,post:i}=e;return(0,o.Y)(P.EY.B4,{color:"secondary",children:(0,o.Y)(P.Yq,{href:(0,U.so)(i.id,{noBase:F.Z,urlParams:{utm_source:K.VU.substack,utm_content:K.fL.facepileRestacks}}),color:"secondary",children:t})})};function j(e){var t,i;let{post:n,user:r,pub:s,mediaClipId:l}=e,c=(0,A.st)({pathname:"/api/v1/post/".concat(n.id,"/facepile"),auto:!0,deps:[n.id,l],query:{media_clip_id:l}});return(0,o.Y)(J,(0,a._)({reactors:z(null==(t=c.result)?void 0:t.reactors,r,!!n.reaction,s),secondaryFaces:z(null==(i=c.result)?void 0:i.restackers,r,!!n.restacked,s)},e))}function z(e,t,i,n){if(!e)return[];if(t){let a=e.findIndex(e=>e.id===t.id);i&&("private"!==t.subscription_visibility||46438===n.id)&&t.activity_likes_enabled&&a<0?e.splice(0,0,{id:t.id,name:t.name,photo_url:t.photo_url}):!i&&a>=0&&e.splice(a,1)}return e}function X(e){var t;let i,{additionalCommentCount:n=0,className:a,user:r,pub:s,post:c,showAudience:u=!1,showDate:p=!1,showEmailSent:g=!1,showDatetime:k=!1,showReactions:E=!0,showComments:D=!0,showShare:w=!1,showRestack:A=!1,showPublicationName:B=!1,hidePinning:I=!1,reaction_token:T,onClick:F,onChange:R,isStatic:O=!1,isFreePreview:U=!1,allowSendEmail:W=!1,allowEdit:H=!1,shareTooltipText:V,showPins:J,sharedShareDialog:Z,onClickCommentButton:$,showAuthor:j,showPhoto:z,fromPostPage:X,isMobileWidth:ee,actionBarStyle:et="post-header-compact"}=e,ei=s.id===c.publication_id?s:void 0,en="post-footer"===et,ea=en?20:"post-preview"===et?14:18,er="post-header-large"===et?20:"post-preview"===et?16:"thread-head"===et||en?14:18;i=c.comment_url_override?c.comment_url_override:O?"".concat(L.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(K.VU.substack,"&utm_medium=").concat(K.Jn.email):(0,M.wu9)(s,c,{comments:!0});let eo=n+(null!=(t=c.comment_count)?t:0),es=D&&!U&&(0,G.showCommentsOnPost)({publication:s,post:c})&&"restack"!==c.type,el=E&&!U&&!["adhoc_email","restack"].includes(c.type),ec=(p||k)&&c.post_date&&!c.is_draft,ed=g?!!c.email_sent_at:null,eu=d()([g&&ed&&{className:"email-sent",title:"This post was sent as an email",content:(0,o.Y)(h.A,{className:"post-meta-icon",height:ea,isStatic:O})},J&&c.is_section_pinned&&{className:"icon pinned",content:(0,o.Y)(Y.A,{className:"post-meta-icon",isStatic:O})},"adhoc_email"===c.type?{className:"audience-adhoc",content:(0,o.Y)(v.A,{className:"post-meta-icon",isStatic:O})}:u&&(0,q.isPaidAudience)(c.audience)&&{className:"audience-lock",content:(0,o.Y)(b.A,{color:"#666666",height:ea,isStatic:O})},(0,C.uC)({pub:s,post:c,showAuthor:j,showPhoto:z,isMobileWidth:ee})&&{className:"author",content:(0,G.getBylineUsers)(c).length>0?(0,G.oxfordComma)((0,G.getBylineUsers)(c).map(e=>(0,o.Y)(m.ProfileHoverCard,{disabled:O,subject:e,utmSource:"byline",trigger:(0,o.Y)("a",{href:(0,M.laT)(e,s),onClick:e=>e.stopPropagation(),children:e.name})}))):(0,G.getPrintedByline)(s,c)},B&&{className:"post-publication-name",content:s.name},H&&!O&&r&&r.is_contributor&&{className:"post-meta-item icon edit-icon",onClick:e=>e.stopPropagation(),content:(0,o.Y)(f.B,{pub:s,post:c,iconHeight:ea,hidePinning:I,user:r,emailSent:ed,allowSendEmail:W})},ec&&{className:"post-date",title:(0,x.A)(c.post_date).toISOString(),content:(0,o.Y)(P.EY.Meta,{children:(0,o.Y)("time",{dateTime:(0,x.A)(c.post_date).toISOString(),children:(0,C.sq)({post:c,showDatetime:k,isStatic:O,fromPostPage:X,showReactions:el})})})},(null==ei?void 0:ei.community_enabled)&&c.slug&&el&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,o.Y)(N.cy,{user:r,pub:s,post:c,token:T,onChange:e=>{null==R||R(e)},height:er,isStatic:O,buttonStyle:en,className:"post-meta-icon like-reaction-button",hideReactionCount:en&&!O})},r&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,o.Y)(Q,{post:c,isPostFooter:en,isStatic:O,lucideIconHeight:er,onChange:R})},(null==ei?void 0:ei.community_enabled)&&c.slug&&es&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,o.FD)("a",{className:en?"post-meta-button button":"",href:i,native:ei&&(0,M.dVy)(document.location.pathname),onClick:$,children:[(0,o.Y)(_.A,{className:"comment-icon post-meta-icon",isStatic:O,height:er,alt:"Comment",stroke:"#757575",fill:"transparent",strokeWidth:O?1:1.5,ampProps:{layout:"fixed"}}),!eo&&en&&(0,o.Y)("span",{className:"meta-button-label",children:"Comment"}),eo>0&&(0,o.Y)("span",{className:"comment-count",children:(0,G.numberToString)(eo)})]})},A&&!en&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,o.FD)("a",{href:L.T.RESTACK_URL,className:en?"button post-meta-button":void 0,children:[(0,o.Y)(y.A,{className:"recommend-icon post-meta-icon",isStatic:O,height:er,alt:"Recommend",stroke:"#757575",fill:"transparent",strokeWidth:O?1:1.5,ampProps:{layout:"fixed"}}),en&&(0,o.Y)("span",{className:"meta-button-label",children:"Recommend"})]})},w&&"only_free"!==c.audience&&!c.is_draft&&!U&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,o.FD)(S._,{user:r,pub:ei,post:c,reaction_token:T,height:er,onChange:R,isStatic:O,sharedShareDialog:Z,position:"post-footer"===et?"post-footer":"post-header",linkClassName:en?"button post-meta-button":void 0,children:[en&&(0,o.Y)("span",{className:"meta-button-label",children:"Share"}),V&&(0,o.Y)("div",{className:"share-tooltip-wrap",children:(0,o.Y)("div",{className:"share-tooltip",children:V})})]})}]);return O?(0,o.Y)("table",{className:l()("post-meta custom",{big:en},a),cellpadding:"0",cellspacing:"0",onClick:F,children:(0,o.Y)("tr",{children:eu.map(e=>{let{className:t,title:i,onClick:n,content:a}=e;return(0,o.Y)("td",{className:l()("post-meta-item",t),title:i,onClick:n,children:a})})})}):(0,o.Y)("div",{className:l()("post-meta post-meta-actions-web custom",{big:en},a),onClick:F,children:eu.map(e=>{let{className:t,title:i,onClick:n,content:a}=e;return(0,o.Y)("div",{className:l()("post-meta-item",t),title:i,onClick:n,children:a})})})}function Q(e){let{post:t,isPostFooter:i,isStatic:n,lucideIconHeight:s,onChange:c}=e,{onSave:d,isSaved:u}=(0,C.Jj)({post:t,isSaved:t.is_saved});return(0,o.FD)("a",{className:l()("post-meta-save-button",i?"post-meta-button button":"",{isSaved:u}),href:n&&L.T.SAVE_POST_URL||void 0,onClick:()=>{let e=d();null==c||c({post:(0,r._)((0,a._)({},t),{is_saved:e})})},children:[(0,o.Y)(g.A,{isStatic:n,height:s,stroke:"#757575",strokeWidth:n?1:1.5}),i&&(0,o.Y)("span",{className:"meta-button-label",children:"Save"})]})}},81209:function(e,t,i){i.d(t,{A:()=>A,n:()=>w});var n=i(99851),a=i(69277),r=i(70408),o=i(10201),s=i(32485),l=i.n(s),c=i(45773),d=i(17402),u=i(97432),p=i(78943),m=i(1250),h=i(84605),b=i(53989),g=i(8609),_=i(21076),y=i(89490),Y=i(35369),v=i(76977),f=i(98111),S=i(39318),C=i(41086),N=i(82776),k=i(57324);let E=["Subscribe","Subscribe now","Sign up","Sign up now"];function D(e){let{isStatic:t,pub:i,user:n,freeSignup:a,children:r,pledgesEnabled:s}=e;if(t)return(0,o.Y)(g.a.Consumer,{children:e=>{let{isFreemail:t,isFreeSubscribed:n,isPledged:a}=e;return r({isFreeSubscribed:n,isSubscribed:!t,isFullySubscribed:i.plans?!t:!s||a,isForPaidSubscription:!!i.plans&&t,isPledged:a})}});let l=a||(null==n?void 0:n.is_free_subscribed),c=null==n?void 0:n.is_subscribed,d=(null==n?void 0:n.is_subscribed)&&(null==n?void 0:n.is_founding),u=null==n?void 0:n.is_pledged;return r({isFreeSubscribed:l,isSubscribed:c,isFullySubscribed:i.plans?c:l&&(!s||u),isForPaidSubscription:!!i.plans&&l&&!c,isPledged:u,isFoundingSubscribed:d})}function w(e){let{pub:t,user:i,now:n,isStatic:a}=e,{language:r}=(0,h.GO)();return(0,o.Y)(b.l9.Consumer,{children:e=>{let{getSettingFor:s}=e,l="disabled"===t.payments_state&&!t.invite_only&&!!s("payment_pledges_enabled");return(0,o.Y)(D,{isStatic:a,user:i,pub:t,pledgesEnabled:l,children:e=>{let{isFreeSubscribed:i,isPledged:a}=e;return(0,o.Y)(o.FK,{children:(0,N.getSubscribeText)(t,{now:n,isFreeSubscribed:i,isPledged:a,pledgesEnabled:l,language:r})})}})}})}class A extends d.Component{onSignup(e,t){let{pledgesEnabled:i}=t;this.setState({loading:!0}),this.props.onSignup?this.props.onSignup(e):!this.props.forceEmailInput&&(this.props.pub.plans||this.props.pub.has_recommendations||i)?document.location.href=(0,S.eV6)(this.props.pub,(0,a._)((0,r._)((0,a._)({addBase:!0,utm_medium:k.Jn.web,utm_source:this.props.source||k.VU.subscribeWidget,utm_content:this.props.post&&this.props.post.id,just_signed_up:!0,requires_confirmation:e.body.requires_confirmation?"true":""},e.body.subscription_id&&{subscription_id:e.body.subscription_id},e.body.referral_token&&{referral_token:e.body.referral_token}),{next:this.props.next||document.location.href}),this.props.foundingUpsell&&{plan:"founding"})):(window.history.replaceState({},"",(0,S.yRP)(document.location.href,{just_subscribed:!0})),document.location.reload())}getHref(e,t){let{pub:i,subscribeButtonAttrs:n,isStatic:r,source:o,post:s,next:l,foundingUpsell:c}=this.props,d=(0,a._)({utm_medium:r?k.Jn.email:k.Jn.web,utm_source:o||k.VU.subscribeWidget,utm_content:s&&s.id,next:r?l:l||document.location.href,referring_pub_ids:r?void 0:(0,C.y)("referring_pub_ids")},c&&{plan:"founding"});return e?r?f.T.ACCOUNT_URL:(0,S.FCy)(i,{params:d,addBase:t.isSubstack}):(0,S.eV6)(i,(0,a._)({addBase:!0,root:n?n.url:r?f.T.CHECKOUT_URL:void 0},d))}getButtonLabel(e,t,i){let{isPledged:n,pledgesEnabled:a,foundingUpsell:r,isFoundingSubscribed:o}=i,{pub:s,subscribeButtonAttrs:l}=this.props,{iString:c}=I18N.i({pub:s});if(e||n)return c("Subscribed");let d=l&&l.text;return d&&!E.includes(d)?d:(0,N.getSubscribeText)(s,{now:!t,isFreeSubscribed:t,isPledged:n,pledgesEnabled:a,language:this.context.language,foundingUpsell:r,isFoundingSubscribed:o})}render(){var e;let{additionalPubIds:t,align:i="center",className:n,expectTruncation:a,forceEmailInput:r,foundingUpsell:s,freeSignup:d,freeSignupEmail:h,isStatic:g,noMargin:f,pub:S,source:C,user:E,onConfirmationRequired:w,onError:A,onPrepareData:B}=this.props,{loading:I}=null!=(e=this.state)?e:{};return(0,o.Y)(b.l9.Consumer,{children:e=>{let{getSettingFor:b}=e;return(0,o.Y)(m.oB.Consumer,{children:e=>{let m=!e.isSubstack&&"undefined"!=typeof window&&S.hostname!==window.location.hostname.replace(/[.]localhost$/,"");return(0,o.Y)(D,{pub:S,user:E,isStatic:g,freeSignup:d,pledgesEnabled:"disabled"===S.payments_state&&!S.invite_only&&!!b("payment_pledges_enabled"),children:D=>{var T;let{isFreeSubscribed:P,isSubscribed:F,isFullySubscribed:x,isPledged:R,isFoundingSubscribed:L}=D,O=this.getButtonLabel(x,P,{isPledged:R,pledgesEnabled:"disabled"===S.payments_state&&!S.invite_only&&!!b("payment_pledges_enabled"),isFoundingSubscribed:L,foundingUpsell:s}),q=P||F;return(0,o.Y)("div",{className:l()("subscribe-widget",{"is-signed-up":q,"is-fully-subscribed":x,"no-margin":f},n),"data-component-name":"SubscribeWidget",children:!r&&(q||g)?(0,o.Y)(y.az,{className:"button-wrapper",children:g?(0,o.FD)("a",{className:l()("button subscribe-btn",x?"outline":"primary"),href:this.getHref(x,e),native:!g,children:[x&&(0,o.Y)(p.A,{stroke:(null==S||null==(T=S.theme)?void 0:T.background_pop_color)||(null==S?void 0:S.theme_var_background_pop)||_.vW,fill:"transparent",isStatic:!0,className:"check-icon static",height:20}),(0,o.Y)("span",{children:O})]}):(0,o.Y)(v.Ye,{justifyContent:"left"===i?"start":"center",children:(0,o.Y)(Y.$n,{href:this.getHref(x,e),localNavigation:!1,priority:x&&(L||!s)?"secondary-accent":"primary",leading:x&&(L||!s)?(0,o.Y)(c.A,{size:20}):null,children:(0,o.Y)("span",{children:O})})})}):(0,o.Y)(v.Ye,{justifyContent:"left"===i?"start":"center",children:(0,o.Y)(u.A,{disabled:q||I,freeSignup:d,freeSignupEmail:h,expectTruncation:a,next:m?window.location.href:null,pub:S,source:C||"subscribe-widget",submitButtonText:q?"✓":(0,N.getSubscribeText)(S,{language:this.context.language}),useSubscribeLink:m,useGenericEndpoint:null==e?void 0:e.isSubstack,additionalPubIds:t,user:E,utm_campaign:(null==e?void 0:e.isSubstack)?k._9.reader2:m?k._9.crossPost:null,onConfirmationRequired:w||((null==S?void 0:S.payments_state)==="enabled"?()=>null:void 0),onError:A,onPrepareData:B,onSuccess:e=>this.onSignup(e,{pledgesEnabled:"disabled"===S.payments_state&&!S.invite_only&&!!b("payment_pledges_enabled")})})})})}})}})}})}}(0,n._)(A,"contextType",h.OW)},81295:function(e,t,i){i(99862),i(17402),i(68776),i(86500),i(94729)},30950:function(e,t,i){i.d(t,{A:()=>h});var n=i(10201),a=i(34206),r=i(9266),o=i(34835),s=i(86500),l=i(1683),c=i(35369),d=i(81203),u=i(40659),p=i(78979),m=i(39318);let h=e=>{let{pub:t,user:i,setStep:h,entry:b}=e,g=(0,u.rG)();return(0,n.Y)("div",{className:"pub-landing-step",children:(0,n.FD)(a.Ay,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{(0,s.u4)(s.qY.READER_ONBOARDING_PUB_LANDING_SIGNUP_SUCCEEDED,{entry:b}),i||(0,o.E)({user:e.body.user}),h(p.d.CATEGORIES)},children:[(0,n.FD)("div",{className:"headings",children:[(0,n.Y)(d.Nq,{pub:t,size:84}),(0,n.Y)("h3",{className:"publication-title",children:t.name}),(0,n.Y)("p",{className:"publication-description",children:t.editorial_bio||t.hero_text}),(0,n.Y)("p",{className:"publication-details",children:(0,r.Be)(t)})]}),(0,n.Y)("input",{type:"hidden",name:"email",value:null==i?void 0:i.email}),(0,n.Y)("input",{type:"hidden",name:"source",value:"".concat(b,"-reader-onboarding")}),(0,n.Y)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,n.Y)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,n.Y)("input",{type:"hidden",name:"first_url",value:l.R9}),(0,n.Y)("input",{type:"hidden",name:"first_referrer",value:l.b7}),(0,n.Y)("input",{type:"hidden",name:"first_session_url",value:l.K0}),(0,n.Y)("input",{type:"hidden",name:"first_session_referrer",value:l.OG}),(0,n.Y)("input",{type:"hidden",name:"current_url",value:l.AT}),(0,n.Y)("input",{type:"hidden",name:"current_referrer",value:l.uC}),Object.entries(g).map(e=>{let[t,i]=e;return(0,n.Y)("input",{type:"hidden",name:t,value:i},t)}),(0,n.FD)("div",{className:"modal-ctas",children:[(0,n.Y)("a",{className:"button let-me-read",href:(0,m.yRP)((0,m.$_T)(t),{no_cover:!0,utm_source:"".concat(b,"-reader-onboarding")}),onClick:()=>{(0,s.u4)(s.qY.READER_ONBOARDING_PUB_LANDING_LET_ME_READ_CLICKED,{entry:b}),(0,s.fN)(t,b)},children:"Let me read it first"}),(0,n.Y)(c.$n,{priority:"primary",onClick:e=>{(0,s.u4)(s.qY.READER_ONBOARDING_PUB_LANDING_SUBSCRIBE_CLICKED,{entry:b}),i||(e.preventDefault(),h(p.d.PUB_SIGNUP))},type:"submit",children:"Subscribe"})]})]})})}},55087:function(e,t,i){i.d(t,{A:()=>Y});var n=i(10201),a=i(45994),r=i(34206),o=i(9266),s=i(46271),l=i(34835),c=i(86500),d=i(1683),u=i(35369),p=i(76977),m=i(81203),h=i(63136),b=i(61554),g=i(40659),_=i(78979),y=i(39318);let Y=e=>{let{pub:t,user:i,profile:Y,setStep:v,entry:f}=e,{setUser:S}=(0,s.ur)(),[C,N]=(0,a.J0)(""),[k,E]=(0,a.J0)(!1),[D,w]=(0,a.J0)(!1),A=(0,g.rG)();return(0,n.FD)("div",{className:"pub-signup-step",children:[(0,n.FD)("div",{className:"headings",children:[(0,n.Y)(m.Nq,{pub:t,size:84,className:"pub-icon"}),(0,n.Y)("h3",{className:"publication-title",children:Y?"Create an account to start reading":"Subscribe to ".concat(t.name)}),(0,n.Y)("p",{className:"publication-description",children:Y?"Create a Substack account to subscribe to ".concat(Y.name):t.editorial_bio||t.hero_text}),(0,n.Y)("p",{className:"publication-details",children:Y?"Author of ".concat(t.name):(0,o.Be)(t)})]}),(0,n.FD)(r.Ay,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{i||((0,l.E)({user:e.body.user}),S(e.body.user)),e.body.requires_confirmation?((0,c.u4)(c.qY.READER_ONBOARDING_PUB_SIGNUP_FAILED,{reason:"user_exists",entry:f}),E(!0)):((0,c.u4)(c.qY.READER_ONBOARDING_PUB_SIGNUP_SUCCEEDED,{entry:f}),(0,l.E)({user:e.body.user}),v(_.d.CATEGORIES))},children:[(0,n.FD)("p",{children:[(0,n.Y)("label",{for:"email",children:"Email"}),(0,n.Y)("input",{type:"email",name:"email","aria-label":"Email",value:C,tabIndex:0,onInput:e=>{N(e.target.value)},onChange:e=>{N(e.target.value)}}),(0,n.Y)("input",{type:"hidden",name:"source",value:"".concat(f,"-reader-onboarding")}),(0,n.Y)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,n.Y)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,n.Y)("input",{type:"hidden",name:"first_url",value:d.R9}),(0,n.Y)("input",{type:"hidden",name:"first_referrer",value:d.b7}),(0,n.Y)("input",{type:"hidden",name:"first_session_url",value:d.K0}),(0,n.Y)("input",{type:"hidden",name:"first_session_referrer",value:d.OG}),(0,n.Y)("input",{type:"hidden",name:"current_url",value:d.AT}),(0,n.Y)("input",{type:"hidden",name:"current_referrer",value:d.uC}),Object.entries(A).map(e=>{let[t,i]=e;return(0,n.Y)("input",{type:"hidden",name:t,value:i},t)}),k&&(0,n.FD)("div",{className:"error",children:["Additional confirmation is required to complete your signup. Please"," ",(0,n.Y)("a",{href:(0,y.a7q)({for_pub:t.subdomain,email:C}),children:"login"})," ","or click the confirmation link in your email."]})]}),(0,n.Y)("div",{id:"error-container"}),(0,n.FD)(p.I1,{alignItems:"center",justifyContent:"space-between",paddingTop:64,gap:4,children:[(0,n.Y)(b.U,{checked:D,onCheckboxChange:e=>{w(e)}}),(0,n.Y)(u.$n,{type:"submit",priority:"primary",disabled:!D||!C,style:{marginTop:12,marginBottom:4},children:"Subscribe and continue"}),(0,n.FD)(h.EY.B5,{weight:"light",color:"secondary",children:["Already have a Substack account?"," ",(0,n.Y)(h.EY.B5,{as:"a",weight:"light",color:"secondary",href:(0,y.a7q)({for_pub:t.subdomain}),target:"_blank",style:{textDecoration:"underline"},children:"Sign in"})]})]})]})]})}},70690:function(e,t,i){function n(e,t){return e.startsWith(t.replace(/\?.*$/,""))}function a(e,t){return e.replace(/\?.*$/,"")===t.replace(/\?.*$/,"")}i.d(t,{W:()=>n,y:()=>a})},59956:function(e,t,i){i.d(t,{LJ:()=>p});var n=i(10201),a=i(32485),r=i.n(a),o=i(80697),s=i(17402),l=i(17988);i(12165),i(9266),i(37767);var c=i(84605);i(81295),i(86500),i(68349);var d=i(35369);i(81203),i(39318);let u={desktop:15,mobile:6},p=e=>{let{className:t,hasFeatured:i,categories:a,categoryId:p,categoryIds:m,loadingCategoryId:h,ranking:b,onCategoryClicked:g,defaultExpanded:_,expandedCategoryIds:y,onToggleCategory:Y}=e,[v,f]=(0,s.useState)(_||!1),[S,C]=(0,s.useState)(new Set),N=u[(0,l.useMediaQuery)({query:"only screen and (max-width: 650px)"})?"mobile":"desktop"],{iString:k}=(0,c.GO)(),E=null!=y?y:S,D=a?v?a:a.slice(0,N):[],w=e=>e.id===p||(null==m?void 0:m.includes(e.id));return(0,n.FD)("div",{className:r()("categories",t),children:[i&&(0,n.Y)(d.$n,{priority:"featured"!==p||h&&"featured"!==h?"secondary":"primary-mono",loading:"featured"===h&&"featured"!==p,onClick:()=>{g({categoryId:"featured",ranking:"all",categories:a})},children:k("Featured")}),D.map(e=>{var t;let i=E.has(e.id),r=e.subcategories&&e.subcategories.length>0,o=w(e)&&(!h||h===e.id),s=h===e.id&&p!==e.id;return(0,n.FD)(n.FK,{children:[(0,n.Y)(d.$n,{priority:o?"primary-mono":"secondary-outline",loading:s,onClick:()=>{var t;g({categoryId:e.id,ranking:b,categories:a}),r&&(t=e.id,Y?Y(t):C(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i}))},className:o?"test-active":"test-inactive",children:k(e.name||"")}),i&&r&&(null==e||null==(t=e.subcategories)?void 0:t.map(e=>{let t=w(e)&&(!h||h===e.id),i=h===e.id&&p!==e.id;return(0,n.Y)(d.$n,{priority:t?"primary-mono":"secondary",loading:i,onClick:()=>g({categoryId:e.id,ranking:b,categories:a}),children:k(e.name)},e.id)}))]})}),a&&a.length>N&&!v&&(0,n.Y)(d.K0,{priority:"secondary-outline",onClick:()=>f(!0),children:(0,n.Y)(o.A,{size:20})})]})}}}]);