"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7762"],{65259:function(){},47963:function(e,t,n){n.d(t,{El:()=>D,gF:()=>F,hj:()=>A});var i=n(69277),l=n(70408),r=n(79785),o=n(10201),a=n(17402),c=n(80682),u=n(72880),s=n(84605),d=n(46271),p=n(86500),h=n(94729),g=n(12501),m=n(22057),f=n(35369),y=n(16074),Y=n(76977),b=n(20500),w=n(16993),C=n(63136),v=n(59482),_=n(11510),k=n(39318),S=n(82776),I=n(34372);function O(){let e=(0,r._)(["Accept ","'s gift in the Substack app"]);return O=function(){return e},e}function x(){let e=(0,r._)(["We sent a link to download the Substack app to ","."]);return x=function(){return e},e}function D(){let{utm_campaign:e,utm_source:t,utm_content:n,abTestingId:i,overrideCTA:l,overrideTitle:r,subTitle:c,openUrl:u,giftCard:s,pub:d,facepileUsers:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[g,m]=(0,a.useState)(!1),f=(0,a.useCallback)(()=>{m(!0),(0,p.u4)(p.qY.APP_INSTALL_MODAL_OPENED,{utm_campaign:e,utm_source:t,utm_content:n})},[e,t,n]),y=(0,a.useCallback)(()=>{m(!1)},[]);return{open:f,modal:(0,o.Y)(T,{isOpen:g,onClose:y,utm_campaign:e,utm_source:t,utm_content:n,abTestingId:i,overrideCTA:l,overrideTitle:r,subTitle:c,openUrl:u,width:s?450:void 0,giftCard:s,pub:d,facepileUsers:h})}}function F(e){let{utm_campaign:t,utm_source:n,utm_content:i,hideEmailPrompt:l=!1,abTestingId:r,suggestedEmail:a,size:c,padding:u=32,openUrl:d,overrideCTA:p,onSend:h}=e,{iString:g}=(0,s.GO)(),m=(0,_.Iu)();return(0,o.FD)(Y.I1,{gap:20,padding:u,children:[!m&&(0,o.FD)(o.FK,{children:[(0,o.Y)(Y.pT,{className:I.A.qrCode,padding:20,alignSelf:"center",children:(0,o.Y)(A,{size:c,utm_campaign:t,utm_source:n,utm_content:i,abTestingId:r,openUrl:d})}),!m&&!l&&(0,o.Y)(y.v,{})]}),!m&&!l&&(0,o.Y)(P,{suggestedEmail:a,onSend:h}),m&&(0,o.Y)(f.$n,{href:d||(0,k.wHz)({utm_campaign:t,utm_source:n}),children:p||g("Install the app")})]})}function T(e){var t;let{isOpen:n,onClose:r,utm_campaign:u,utm_content:d,utm_source:p,abTestingId:h,overrideCTA:g,overrideTitle:f,subTitle:y,openUrl:b,width:C,facepileUsers:v,showMobileClose:I,giftCard:x,pub:D}=e,{iString:T,iTemplate:A}=(0,s.GO)(),P=(0,_.Iu)(),[E,L]=(0,a.useState)(""),N=(0,a.useCallback)(e=>{L(e)},[]),U=(0,a.useCallback)(()=>{L(""),r()},[r]),G=!!x&&!!D,q=(null==x||null==(t=x.gifter)?void 0:t.name)?"Split Zone Duo"===x.gifter.name?"SZD":(0,S.guessFirstName)(x.gifter.name):"",z=f||(G?q?A(O(),q):T("Accept this gift in the Substack app"):T("Download the Substack app"));return(0,o.FD)(w.aF,{isOpen:n,onClose:r,width:C||360,children:[(0,o.Y)(w.rQ,{title:z,description:y,onClose:r,showClose:!P||I,showDivider:!0}),E?(0,o.Y)(j,{sentEmail:E,closeModal:U}):(0,o.FD)(Y.I1,{alignItems:"stretch",paddingTop:32*!!P,children:[G?(0,o.Y)(Y.pT,{justifyContent:"center",alignItems:"center",paddingTop:{desktop:20,mobile:0},children:(0,o.Y)(c.N,(0,l._)((0,i._)({},x),{pub:D}))}):(null==v?void 0:v.length)?(0,o.Y)(Y.pT,{justifyContent:"center",alignItems:"center",padding:{mobile:8},children:(0,o.Y)(m.Z,{users:v,max:3,size:48})}):P?(0,o.Y)(Y.pT,{justifyContent:"center",alignItems:"center",children:(0,o.Y)("img",{src:(0,k.dJ9)("/img/substack-app-icon.png"),height:64,width:64})}):null,(0,o.Y)(F,{utm_campaign:u,utm_source:p,utm_content:d,abTestingId:h,openUrl:b,overrideCTA:g,size:142,onSend:N})]})]})}function A(e){let{utm_campaign:t,utm_source:i,utm_content:l,abTestingId:r,size:c=240,width:u,height:s,openUrl:d}=e,p=(0,a.useRef)(null),h=(0,k.wHz)({utm_campaign:t,utm_source:i,utm_content:l,abti:r}),m=function(e,t){let{result:i}=(0,g.qK)(()=>n.e("4592").then(n.t.bind(n,97283,23)),[],{auto:!0}),l=null==i?void 0:i.default;return(0,a.useMemo)(()=>l&&"undefined"!=typeof window?new l(e(window)):null,[l,...t])}(e=>{let t=e.devicePixelRatio,n=getComputedStyle(document.body),i="rgb(".concat(n.getPropertyValue("--color-primitive-black-rgb"),")");return{width:(null!=u?u:c)*t,height:(null!=s?s:c)*t,type:"canvas",data:d||h,dotsOptions:{color:i,type:"dots"},backgroundOptions:{color:"rgb(".concat(n.getPropertyValue("--color-primitive-white-rgb"),")")},cornersSquareOptions:{color:i,type:"extra-rounded"},cornersDotOptions:{color:i,type:"dot"},qrOptions:{errorCorrectionLevel:"L"}}},[u,s,d]);return(0,a.useEffect)(()=>{let{current:e}=p;if(!e||!m||!m._canvas)return;let t=m._canvas;return t.style.width="".concat(null!=u?u:c,"px"),t.style.height="".concat(null!=s?s:c,"px"),e.style.width="".concat(null!=u?u:c,"px"),e.style.height="".concat(null!=s?s:c,"px"),e.appendChild(t),()=>{e.removeChild(t)}},[m,u,s]),(0,o.Y)("div",{ref:p})}function P(e){let{suggestedEmail:t,onSend:n}=e,{iString:i}=(0,s.GO)(),l=(0,d.Jd)(),[r,c]=(0,a.useState)((null==l?void 0:l.email)||t||""),[u,p]=(0,a.useState)(!1),[g,m]=(0,a.useState)(null);return(0,o.Y)(o.FK,{children:(0,o.FD)(Y.I1,{gap:8,children:[(0,o.Y)(v.U,{placeholder:i("Your email"),placement:"end",priority:"primary",type:"email",value:r,onChange:e=>c(e.currentTarget.value),button:(0,o.Y)(f.$n,{loading:u,onClick:async()=>{p(!0);try{await (0,h.x6)("/api/v1/send_app_download_link",{method:"POST",json:{email:r}}),m(null),p(!1),n&&n(r)}catch(e){m("Something went wrong")}},children:i("Send link")})}),g&&(0,o.Y)(b.yn,{align:"center",children:g})]})})}let j=e=>{let{sentEmail:t,closeModal:n}=e,{iString:i,iTemplate:l}=(0,s.GO)();return(0,o.FD)(o.FK,{children:[(0,o.Y)(w.cw,{children:(0,o.FD)(Y.I1,{gap:20,justifyContent:"center",alignItems:"center",children:[(0,o.Y)(u.o,{src:"/img/cohorts/local_news/plane.png",maxWidth:64}),(0,o.FD)(Y.I1,{gap:4,justifyContent:"center",alignItems:"center",children:[(0,o.Y)(C.EY.B2,{weight:"semibold",textAlign:"center",children:i("Check your email")}),(0,o.Y)(C.EY.B3,{color:"secondary",align:"center",children:l(x(),t||"your email")})]})]})}),(0,o.Y)(w.jl,{alignButtons:"stretch",primaryButton:(0,o.Y)(f.$n,{priority:"secondary",onClick:n,children:i("Done")})})]})}},38093:function(e,t,n){n.d(t,{Q:()=>Y,Z:()=>y});var i=n(69277),l=n(10201),r=n(32485),o=n.n(r),a=n(42216),c=n(17402),u=n(84605),s=n(94729),d=n(89490),p=n(8149),h=n(76977),g=n(20500),m=n(63136),f=n(24311);function y(e){let{email:t,redirect:n,forPub:r,onIsAttemptingLoginChange:o}=e,[u,d]=(0,c.useState)(""),[h,g]=(0,c.useState)(!1),[m,f]=(0,c.useState)(!1),[y,Y]=(0,c.useState)(!1),_=async()=>{g(!0),o&&o(!0);try{let[e]=await Promise.all([(0,s.x6)("/api/v1/email-otp-login/complete",{method:"POST",json:{code:u,email:t,redirect:n,for_pub:r}}),new Promise(e=>setTimeout(e,250))]);window.location.href=e.redirect}catch(e){e instanceof s.fk&&"login_guard_challenge"===e.body.type&&Y(!0),g(!1),o&&o(!1),f(!0),d("")}};return t?(0,l.FD)(C,{children:[(0,l.Y)(a.wE,{autoFocus:!0,maxLength:6,pattern:a.UO,onChange:e=>{d(e),e.length&&f(!1)},onComplete:_,value:u,render:e=>{let{slots:t}=e;return(0,l.Y)(v,{children:t.map((e,t)=>(0,l.Y)(b,(0,i._)({disabled:h},e),t))})}}),(0,l.Y)(p.N,{open:!!m,children:(0,l.Y)(w,{suspiciousLogin:y})})]}):null}function Y(e){let{onComplete:t,error:n,isLoading:r}=e,[o,s]=(0,c.useState)(""),{iString:d}=(0,u.GO)();return(0,l.FD)(C,{children:[(0,l.Y)(a.wE,{autoFocus:!0,maxLength:6,pattern:a.UO,onChange:e=>{s(e)},onComplete:e=>{r||t(e)},value:o,disabled:r,render:e=>{let{slots:t}=e;return(0,l.Y)(v,{children:t.map((e,t)=>(0,l.Y)(b,(0,i._)({disabled:r},e),t))})}}),n&&(0,l.Y)(g.yn,{style:{textAlign:"center"},children:d("You entered an incorrect code. Please try again.")})]})}function b(e){let{char:t,isActive:n,disabled:i}=e;return(0,l.Y)(h.fI,{justifyContent:"center",alignItems:"center",width:36,height:40,className:o()(f.A.input,n&&f.A.focus,i&&f.A.disabled),children:(0,l.Y)(m.EY.B2,{textAlign:"center",children:t||""})})}function w(e){let{suspiciousLogin:t}=e,{iString:n}=(0,u.GO)(),i=n(t?"Please check your email for instructions to complete signing in.":"You entered an incorrect code. Please try again.");return(0,l.Y)(g.yn,{style:{textAlign:"center"},children:i})}let C=(0,d.I4)({display:"flex",direction:"column",alignItems:"center",gap:8}),v=(0,d.I4)({display:"flex",direction:"row",justifyContent:"center",alignItems:"center",gap:8})}}]);