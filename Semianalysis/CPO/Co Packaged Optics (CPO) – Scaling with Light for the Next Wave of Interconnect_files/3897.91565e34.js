"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["3897"],{15871:function(e,t,r){r.d(t,{AN:()=>eg,FR:()=>O,MS:()=>N,Mp:()=>eB,PM:()=>ej,Sj:()=>Y,Vy:()=>L,fF:()=>eP,fp:()=>B,sl:()=>X,uN:()=>ed,vL:()=>m,y$:()=>W,zM:()=>eY});var n,i,l,o,s,a,u,c,d,h,p,f,m,g,v,y,b,w,x,k=r(17402),S=r(74979),C=r(19251);let M=(0,k.createContext)(null),R={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},E={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function D(e){var t;let r,{announcements:n=E,container:i,hiddenTextDescribedById:l,screenReaderInstructions:o=R}=e,{announce:s,announcement:a}=(0,C.bO)(),u=(0,S.YG)("DndLiveRegion"),[c,d]=(0,k.useState)(!1);if((0,k.useEffect)(()=>{d(!0)},[]),t=(0,k.useMemo)(()=>({onDragStart(e){let{active:t}=e;s(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;n.onDragMove&&s(n.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;s(n.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;s(n.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;s(n.onDragCancel({active:t,over:r}))}}),[s,n]),r=(0,k.useContext)(M),(0,k.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!c)return null;let h=k.default.createElement(k.default.Fragment,null,k.default.createElement(C.Aw,{id:l,value:o.draggable}),k.default.createElement(C.L4,{id:u,announcement:a}));return i?(0,k.createPortal)(h,i):h}function T(){}function N(e,t){return(0,k.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}function O(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,k.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(n=h||(h={})).DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable";let I=Object.freeze({x:0,y:0});function F(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function A(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function J(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function z(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function L(e,t){if(!e||0===e.length)return null;let[r]=e;return t?r[t]:r}function K(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}let B=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=K(t,t.left,t.top),l=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=F(K(n),i);l.push({id:t,data:{droppableContainer:e,value:r}})}}return l.sort(A)},W=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=z(t),l=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=z(n),o=Number((i.reduce((e,t,n)=>e+F(r[n],t),0)/4).toFixed(4));l.push({id:t,data:{droppableContainer:e,value:o}})}}return l.sort(A)},_=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=[];for(let e of n){let{id:n}=e,l=r.get(n);if(l){let r=function(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height);if(n<i&&r<l){let o=t.width*t.height,s=e.width*e.height,a=(i-n)*(l-r);return Number((a/(o+s-a)).toFixed(4))}return 0}(l,t);r>0&&i.push({id:n,data:{droppableContainer:e,value:r}})}}return i.sort(J)};function j(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:I}let P=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})},$={ignoreTransform:!1};function Y(e,t){void 0===t&&(t=$);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:n}=(0,S.zk)(e).getComputedStyle(e);t&&(r=function(e,t,r){let n=function(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}(t);if(!n)return e;let{scaleX:i,scaleY:l,x:o,y:s}=n,a=e.left-o-(1-i)*parseFloat(r),u=e.top-s-(1-l)*parseFloat(r.slice(r.indexOf(" ")+1)),c=i?e.width/i:e.width,d=l?e.height/l:e.height;return{width:c,height:d,top:u,right:a+c,bottom:u+d,left:a}}(r,t,n))}let{top:n,left:i,width:l,height:o,bottom:s,right:a}=r;return{top:n,left:i,width:l,height:o,bottom:s,right:a}}function U(e){return Y(e,{ignoreTransform:!0})}function X(e,t){let r=[];return e?function n(i){var l,o;let s;if(null!=t&&r.length>=t||!i)return r;if((0,S.wz)(i)&&null!=i.scrollingElement&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!(0,S.sb)(i)||(0,S.xZ)(i)||r.includes(i))return r;let a=(0,S.zk)(e).getComputedStyle(i);return(i!==e&&(void 0===(l=a)&&(l=(0,S.zk)(i).getComputedStyle(i)),s=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=l[e];return"string"==typeof t&&s.test(t)}))&&r.push(i),void 0===(o=a)&&(o=(0,S.zk)(i).getComputedStyle(i)),"fixed"===o.position)?r:n(i.parentNode)}(e):r}function G(e){let[t]=X(e,1);return null!=t?t:null}function q(e){return S.Sw&&e?(0,S.l6)(e)?e:(0,S.Ll)(e)?(0,S.wz)(e)||e===(0,S.TW)(e).scrollingElement?window:(0,S.sb)(e)?e:null:null:null}function H(e){return(0,S.l6)(e)?e.scrollX:e.scrollLeft}function V(e){return(0,S.l6)(e)?e.scrollY:e.scrollTop}function Q(e){return{x:H(e),y:V(e)}}function Z(e){return!!S.Sw&&!!e&&e===document.scrollingElement}function ee(e){let t={x:0,y:0},r=Z(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,l=e.scrollLeft<=t.x;return{isTop:i,isLeft:l,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}(i=p||(p={}))[i.Forward=1]="Forward",i[i.Backward=-1]="Backward";let et={x:.2,y:.2};function er(e){return e.reduce((e,t)=>(0,S.WQ)(e,Q(t)),I)}let en=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+H(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+V(t),0)}]];class ei{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=X(t),n=er(r);for(const[t,i,l]of(this.rect={...e},this.width=e.width,this.height=e.height,en))for(const e of i)Object.defineProperty(this,e,{get:()=>{let i=l(r),o=n[t]-i;return this.rect[e]+o},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class el{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function eo(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}function es(e){e.preventDefault()}function ea(e){e.stopPropagation()}(l=f||(f={})).Click="click",l.DragStart="dragstart",l.Keydown="keydown",l.ContextMenu="contextmenu",l.Resize="resize",l.SelectionChange="selectionchange",l.VisibilityChange="visibilitychange",(o=m||(m={})).Space="Space",o.Down="ArrowDown",o.Right="ArrowRight",o.Left="ArrowLeft",o.Up="ArrowUp",o.Esc="Escape",o.Enter="Enter",o.Tab="Tab";let eu={start:[m.Space,m.Enter],cancel:[m.Esc],end:[m.Space,m.Enter,m.Tab]},ec=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case m.Right:return{...r,x:r.x+25};case m.Left:return{...r,x:r.x-25};case m.Down:return{...r,y:r.y+25};case m.Up:return{...r,y:r.y-25}}};class ed{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new el((0,S.TW)(t)),this.windowListeners=new el((0,S.zk)(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(f.Resize,this.handleCancel),this.windowListeners.add(f.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(f.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&function(e,t){if(void 0===t&&(t=Y),!e)return;let{top:r,left:n,bottom:i,right:l}=t(e);G(e)&&(i<=0||l<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(r),t(I)}handleKeyDown(e){if((0,S.kx)(e)){let{active:t,context:r,options:n}=this.props,{keyboardCodes:i=eu,coordinateGetter:l=ec,scrollBehavior:o="smooth"}=n,{code:s}=e;if(i.end.includes(s))return void this.handleEnd(e);if(i.cancel.includes(s))return void this.handleCancel(e);let{collisionRect:a}=r.current,u=a?{x:a.left,y:a.top}:I;this.referenceCoordinates||(this.referenceCoordinates=u);let c=l(e,{active:t,context:r.current,currentCoordinates:u});if(c){let t=(0,S.Re)(c,u),n={x:0,y:0},{scrollableAncestors:i}=r.current;for(let r of i){let i=e.code,{isTop:l,isRight:s,isLeft:a,isBottom:u,maxScroll:d,minScroll:h}=ee(r),p=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}(r),f={x:Math.min(i===m.Right?p.right-p.width/2:p.right,Math.max(i===m.Right?p.left:p.left+p.width/2,c.x)),y:Math.min(i===m.Down?p.bottom-p.height/2:p.bottom,Math.max(i===m.Down?p.top:p.top+p.height/2,c.y))},g=i===m.Right&&!s||i===m.Left&&!a,v=i===m.Down&&!u||i===m.Up&&!l;if(g&&f.x!==c.x){let e=r.scrollLeft+t.x,l=i===m.Right&&e<=d.x||i===m.Left&&e>=h.x;if(l&&!t.y)return void r.scrollTo({left:e,behavior:o});l?n.x=r.scrollLeft-e:n.x=i===m.Right?r.scrollLeft-d.x:r.scrollLeft-h.x,n.x&&r.scrollBy({left:-n.x,behavior:o});break}if(v&&f.y!==c.y){let e=r.scrollTop+t.y,l=i===m.Down&&e<=d.y||i===m.Up&&e>=h.y;if(l&&!t.x)return void r.scrollTo({top:e,behavior:o});l?n.y=r.scrollTop-e:n.y=i===m.Down?r.scrollTop-d.y:r.scrollTop-h.y,n.y&&r.scrollBy({top:-n.y,behavior:o});break}}this.handleMove(e,(0,S.WQ)((0,S.Re)(c,this.referenceCoordinates),n))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function eh(e){return!!(e&&"distance"in e)}function ep(e){return!!(e&&"delay"in e)}ed.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=eu,onActivation:i}=t,{active:l}=r,{code:o}=e.nativeEvent;if(n.start.includes(o)){let t=l.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==i||i({event:e.nativeEvent}),!0)}return!1}}];class ef{constructor(e,t,r){var n;void 0===r&&(r=function(e){let{EventTarget:t}=(0,S.zk)(e);return e instanceof t?e:(0,S.TW)(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:l}=i;this.props=e,this.events=t,this.document=(0,S.TW)(l),this.documentListeners=new el(this.document),this.listeners=new el(r),this.windowListeners=new el((0,S.zk)(l)),this.initialCoordinates=null!=(n=(0,S.e_)(i))?n:I,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(f.Resize,this.handleCancel),this.windowListeners.add(f.DragStart,es),this.windowListeners.add(f.VisibilityChange,this.handleCancel),this.windowListeners.add(f.ContextMenu,es),this.documentListeners.add(f.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ep(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(eh(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(f.Click,ea,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(f.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:n,props:i}=this,{onMove:l,options:{activationConstraint:o}}=i;if(!n)return;let s=null!=(t=(0,S.e_)(e))?t:I,a=(0,S.Re)(n,s);if(!r&&o){if(eh(o)){if(null!=o.tolerance&&eo(a,o.tolerance))return this.handleCancel();if(eo(a,o.distance))return this.handleStart()}return ep(o)&&eo(a,o.tolerance)?this.handleCancel():void this.handlePending(o,a)}e.cancelable&&e.preventDefault(),l(s)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===m.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let em={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class eg extends ef{constructor(e){const{event:t}=e;super(e,em,(0,S.TW)(t.target))}}eg.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!!r.isPrimary&&0===r.button&&(null==n||n({event:r}),!0)}}];(s=g||(g={}))[s.RightClick=2]="RightClick";(a=v||(v={}))[a.Pointer=0]="Pointer",a[a.DraggableRect=1]="DraggableRect",(u=y||(y={}))[u.TreeOrder=0]="TreeOrder",u[u.ReversedTreeOrder=1]="ReversedTreeOrder";let ev={x:{[p.Backward]:!1,[p.Forward]:!1},y:{[p.Backward]:!1,[p.Forward]:!1}};(c=b||(b={}))[c.Always=0]="Always",c[c.BeforeDragging=1]="BeforeDragging",c[c.WhileDragging=2]="WhileDragging",(w||(w={})).Optimized="optimized";let ey=new Map;function eb(e,t){return(0,S.KG)(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function ew(e){let{callback:t,disabled:r}=e,n=(0,S._q)(t),i=(0,k.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(n)},[r]);return(0,k.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function ex(e){return new ei(Y(e),e)}function ek(e,t,r){void 0===t&&(t=ex);let[n,i]=(0,k.useState)(null);function l(){i(n=>{if(!e)return null;if(!1===e.isConnected){var i;return null!=(i=null!=n?n:r)?i:null}let l=t(e);return JSON.stringify(n)===JSON.stringify(l)?n:l})}let o=function(e){let{callback:t,disabled:r}=e,n=(0,S._q)(t),i=(0,k.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(n)},[n,r]);return(0,k.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(t){if(e)for(let r of t){let{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){l();break}}}}),s=ew({callback:l});return(0,S.Es)(()=>{l(),e?(null==s||s.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==o||o.disconnect())},[e]),n}let eS=[];function eC(e,t){void 0===t&&(t=[]);let r=(0,k.useRef)(null);return(0,k.useEffect)(()=>{r.current=null},t),(0,k.useEffect)(()=>{let t=e!==I;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?(0,S.Re)(e,r.current):I}function eM(e){return(0,k.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let eR=[],eE=[{sensor:eg,options:{}},{sensor:ed,options:{}}],eD={current:{}},eT={draggable:{measure:U},droppable:{measure:U,strategy:b.WhileDragging,frequency:w.Optimized},dragOverlay:{measure:Y}};class eN extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let eO={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new eN,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:T},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:eT,measureDroppableContainers:T,windowRect:null,measuringScheduled:!1},eI={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:T,draggableNodes:new Map,over:null,measureDroppableContainers:T},eF=(0,k.createContext)(eI),eA=(0,k.createContext)(eO);function eJ(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new eN}}}function ez(e,t){switch(t.type){case h.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case h.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case h.DragEnd:case h.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case h.RegisterDroppable:{let{element:r}=t,{id:n}=r,i=new eN(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case h.SetDroppableDisabled:{let{id:r,key:n,disabled:i}=t,l=e.droppable.containers.get(r);if(!l||n!==l.key)return e;let o=new eN(e.droppable.containers);return o.set(r,{...l,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case h.UnregisterDroppable:{let{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;let l=new eN(e.droppable.containers);return l.delete(r),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function eL(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:i}=(0,k.useContext)(eF),l=(0,S.ZC)(n),o=(0,S.ZC)(null==r?void 0:r.id);return(0,k.useEffect)(()=>{if(!t&&!n&&l&&null!=o){if(!(0,S.kx)(l)||document.activeElement===l.target)return;let e=i.get(o);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=(0,S.ag)(e);if(t){t.focus();break}}})}},[n,t,i,o,l]),null}let eK=(0,k.createContext)({...I,scaleX:1,scaleY:1});(d=x||(x={}))[d.Uninitialized=0]="Uninitialized",d[d.Initializing=1]="Initializing",d[d.Initialized=2]="Initialized";let eB=(0,k.memo)(function(e){var t,r,n,i,l,o,s,a;let u,c,d,f,m,g,w,C,{id:R,accessibility:E,autoScroll:T=!0,children:N,sensors:O=eE,collisionDetection:F=_,measuring:A,modifiers:J,...z}=e,[K,B]=(0,k.useReducer)(ez,void 0,eJ),[W,$]=function(){let[e]=(0,k.useState)(()=>new Set),t=(0,k.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,k.useCallback)(t=>{let{type:r,event:n}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)})},[e]),t]}(),[U,H]=(0,k.useState)(x.Uninitialized),V=U===x.Initialized,{draggable:{active:en,nodes:el,translate:eo},droppable:{containers:es}}=K,ea=null!=en?el.get(en):null,eu=(0,k.useRef)({initial:null,translated:null}),ec=(0,k.useMemo)(()=>{var e;return null!=en?{id:en,data:null!=(e=null==ea?void 0:ea.data)?e:eD,rect:eu}:null},[en,ea]),ed=(0,k.useRef)(null),[eh,ep]=(0,k.useState)(null),[ef,em]=(0,k.useState)(null),eg=(0,S.YN)(z,Object.values(z)),ex=(0,S.YG)("DndDescribedBy",R),eN=(0,k.useMemo)(()=>es.getEnabled(),[es]),eO=(0,k.useMemo)(()=>({draggable:{...eT.draggable,...null==A?void 0:A.draggable},droppable:{...eT.droppable,...null==A?void 0:A.droppable},dragOverlay:{...eT.dragOverlay,...null==A?void 0:A.dragOverlay}}),[null==A?void 0:A.draggable,null==A?void 0:A.droppable,null==A?void 0:A.dragOverlay]),{droppableRects:eI,measureDroppableContainers:eB,measuringScheduled:eW}=function(e,t){let{dragging:r,dependencies:n,config:i}=t,[l,o]=(0,k.useState)(null),{frequency:s,measure:a,strategy:u}=i,c=(0,k.useRef)(e),d=function(){switch(u){case b.Always:return!1;case b.BeforeDragging:return r;default:return!r}}(),h=(0,S.YN)(d),p=(0,k.useCallback)(function(e){void 0===e&&(e=[]),h.current||o(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[h]),f=(0,k.useRef)(null),m=(0,S.KG)(t=>{if(d&&!r)return ey;if(!t||t===ey||c.current!==e||null!=l){let t=new Map;for(let r of e){if(!r)continue;if(l&&l.length>0&&!l.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,n=e?new ei(a(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t},[e,l,r,d,a]);return(0,k.useEffect)(()=>{c.current=e},[e]),(0,k.useEffect)(()=>{d||p()},[r,d]),(0,k.useEffect)(()=>{l&&l.length>0&&o(null)},[JSON.stringify(l)]),(0,k.useEffect)(()=>{d||"number"!=typeof s||null!==f.current||(f.current=setTimeout(()=>{p(),f.current=null},s))},[s,d,p,...n]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:null!=l}}(eN,{dragging:V,dependencies:[eo.x,eo.y],config:eO.droppable}),e_=(m=(f=null!=en?el.get(en):void 0)?f.node.current:null,(0,S.KG)(e=>{var t;return null==en?null:null!=(t=null!=m?m:e)?t:null},[m,en])),ej=(0,k.useMemo)(()=>ef?(0,S.e_)(ef):null,[ef]),eP=(u=(null==eh?void 0:eh.autoScrollEnabled)===!1,c="object"==typeof T?!1===T.enabled:!1===T,d=V&&!u&&!c,"object"==typeof T?{...T,enabled:d}:{enabled:d}),e$=eb(e_,eO.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e,l=(0,k.useRef)(!1),{x:o,y:s}="boolean"==typeof i?{x:i,y:i}:i;(0,S.Es)(()=>{if(!o&&!s||!t){l.current=!1;return}if(l.current||!n)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let i=j(r(e),n);if(o||(i.x=0),s||(i.y=0),l.current=!0,Math.abs(i.x)>0||Math.abs(i.y)>0){let t=G(e);t&&t.scrollBy({top:i.y,left:i.x})}},[t,o,s,n,r])}({activeNode:null!=en?el.get(en):null,config:eP.layoutShiftCompensation,initialRect:e$,measure:eO.draggable.measure});let eY=ek(e_,eO.draggable.measure,e$),eU=ek(e_?e_.parentElement:null),eX=(0,k.useRef)({activatorEvent:null,active:null,activeNode:e_,collisionRect:null,collisions:null,droppableRects:eI,draggableNodes:el,draggingNode:null,draggingNodeRect:null,droppableContainers:es,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),eG=es.getNodeFor(null==(t=eX.current.over)?void 0:t.id),eq=function(e){let{measure:t}=e,[r,n]=(0,k.useState)(null),i=ew({callback:(0,k.useCallback)(e=>{for(let{target:r}of e)if((0,S.sb)(r)){n(e=>{let n=t(r);return e?{...e,width:n.width,height:n.height}:n});break}},[t])}),l=(0,k.useCallback)(e=>{let r=function(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return(0,S.sb)(t)?t:e}(e);null==i||i.disconnect(),r&&(null==i||i.observe(r)),n(r?t(r):null)},[t,i]),[o,s]=(0,S.lk)(l);return(0,k.useMemo)(()=>({nodeRef:o,rect:r,setRef:s}),[r,o,s])}({measure:eO.dragOverlay.measure}),eH=null!=(r=eq.nodeRef.current)?r:e_,eV=V?null!=(n=eq.rect)?n:eY:null,eQ=!!(eq.nodeRef.current&&eq.rect),eZ=(g=eb(l=eQ?null:eY),j(l,g)),e0=eM(eH?(0,S.zk)(eH):null),e1=(o=V?null!=eG?eG:e_:null,w=(0,k.useRef)(o),C=(0,S.KG)(e=>o?e&&e!==eS&&o&&w.current&&o.parentNode===w.current.parentNode?e:X(o):eS,[o]),(0,k.useEffect)(()=>{w.current=o},[o]),C),e2=function(e,t){void 0===t&&(t=Y);let[r]=e,n=eM(r?(0,S.zk)(r):null),[i,l]=(0,k.useState)(eR);function o(){l(()=>e.length?e.map(e=>Z(e)?n:new ei(t(e),e)):eR)}let s=ew({callback:o});return(0,S.Es)(()=>{null==s||s.disconnect(),o(),e.forEach(e=>null==s?void 0:s.observe(e))},[e]),i}(e1),e5=function(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...n}),r):r}(J,{transform:{x:eo.x-eZ.x,y:eo.y-eZ.y,scaleX:1,scaleY:1},activatorEvent:ef,active:ec,activeNodeRect:eY,containerNodeRect:eU,draggingNodeRect:eV,over:eX.current.over,overlayNodeRect:eq.rect,scrollableAncestors:e1,scrollableAncestorRects:e2,windowRect:e0}),e3=ej?(0,S.WQ)(ej,eo):null,e7=function(e){let[t,r]=(0,k.useState)(null),n=(0,k.useRef)(e),i=(0,k.useCallback)(e=>{let t=q(e.target);t&&r(e=>e?(e.set(t,Q(t)),new Map(e)):null)},[]);return(0,k.useEffect)(()=>{let t=n.current;if(e!==t){l(t);let o=e.map(e=>{let t=q(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,Q(t)]):null}).filter(e=>null!=e);r(o.length?new Map(o):null),n.current=e}return()=>{l(e),l(t)};function l(e){e.forEach(e=>{let t=q(e);null==t||t.removeEventListener("scroll",i)})}},[i,e]),(0,k.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>(0,S.WQ)(e,t),I):er(e):I,[e,t])}(e1),e4=eC(e7),e6=eC(e7,[eY]),e9=(0,S.WQ)(e5,e4),e8=eV?P(eV,e5):null,te=ec&&e8?F({active:ec,collisionRect:e8,droppableRects:eI,droppableContainers:eN,pointerCoordinates:e3}):null,tt=L(te,"id"),[tr,tn]=(0,k.useState)(null),ti=(s=eQ?e5:(0,S.WQ)(e5,e6),a=null!=(i=null==tr?void 0:tr.rect)?i:null,{...s,scaleX:a&&eY?a.width/eY.width:1,scaleY:a&&eY?a.height/eY.height:1}),tl=(0,k.useRef)(null),to=(0,k.useCallback)((e,t)=>{let{sensor:r,options:n}=t;if(null==ed.current)return;let i=el.get(ed.current);if(!i)return;let l=e.nativeEvent,o=new r({active:ed.current,activeNode:i,event:l,options:n,context:eX,onAbort(e){if(!el.get(e))return;let{onDragAbort:t}=eg.current,r={id:e};null==t||t(r),W({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!el.get(e))return;let{onDragPending:i}=eg.current,l={id:e,constraint:t,initialCoordinates:r,offset:n};null==i||i(l),W({type:"onDragPending",event:l})},onStart(e){let t=ed.current;if(null==t)return;let r=el.get(t);if(!r)return;let{onDragStart:n}=eg.current,i={activatorEvent:l,active:{id:t,data:r.data,rect:eu}};(0,k.unstable_batchedUpdates)(()=>{null==n||n(i),H(x.Initializing),B({type:h.DragStart,initialCoordinates:e,active:t}),W({type:"onDragStart",event:i}),ep(tl.current),em(l)})},onMove(e){B({type:h.DragMove,coordinates:e})},onEnd:s(h.DragEnd),onCancel:s(h.DragCancel)});function s(e){return async function(){let{active:t,collisions:r,over:n,scrollAdjustedTranslate:i}=eX.current,o=null;if(t&&i){let{cancelDrop:s}=eg.current;o={activatorEvent:l,active:t,collisions:r,delta:i,over:n},e===h.DragEnd&&"function"==typeof s&&await Promise.resolve(s(o))&&(e=h.DragCancel)}ed.current=null,(0,k.unstable_batchedUpdates)(()=>{B({type:e}),H(x.Uninitialized),tn(null),ep(null),em(null),tl.current=null;let t=e===h.DragEnd?"onDragEnd":"onDragCancel";if(o){let e=eg.current[t];null==e||e(o),W({type:t,event:o})}})}}tl.current=o},[el]),ts=(0,k.useCallback)((e,t)=>(r,n)=>{let i=r.nativeEvent,l=el.get(n);null!==ed.current||!l||i.dndKit||i.defaultPrevented||!0===e(r,t.options,{active:l})&&(i.dndKit={capturedBy:t.sensor},ed.current=n,to(r,t))},[el,to]),ta=(0,k.useMemo)(()=>O.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:ts(e.handler,t)}))]},[]),[O,ts]);(0,k.useEffect)(()=>{if(!S.Sw)return;let e=O.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},O.map(e=>{let{sensor:t}=e;return t})),(0,S.Es)(()=>{eY&&U===x.Initializing&&H(x.Initialized)},[eY,U]),(0,k.useEffect)(()=>{let{onDragMove:e}=eg.current,{active:t,activatorEvent:r,collisions:n,over:i}=eX.current;if(!t||!r)return;let l={active:t,activatorEvent:r,collisions:n,delta:{x:e9.x,y:e9.y},over:i};(0,k.unstable_batchedUpdates)(()=>{null==e||e(l),W({type:"onDragMove",event:l})})},[e9.x,e9.y]),(0,k.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:i}=eX.current;if(!e||null==ed.current||!t||!i)return;let{onDragOver:l}=eg.current,o=n.get(tt),s=o&&o.rect.current?{id:o.id,rect:o.rect.current,data:o.data,disabled:o.disabled}:null,a={active:e,activatorEvent:t,collisions:r,delta:{x:i.x,y:i.y},over:s};(0,k.unstable_batchedUpdates)(()=>{tn(s),null==l||l(a),W({type:"onDragOver",event:a})})},[tt]),(0,S.Es)(()=>{eX.current={activatorEvent:ef,active:ec,activeNode:e_,collisionRect:e8,collisions:te,droppableRects:eI,draggableNodes:el,draggingNode:eH,draggingNodeRect:eV,droppableContainers:es,over:tr,scrollableAncestors:e1,scrollAdjustedTranslate:e9},eu.current={initial:eV,translated:e8}},[ec,e_,te,e8,el,eH,eV,eI,es,tr,e1,e9]),function(e){let{acceleration:t,activator:r=v.Pointer,canScroll:n,draggingRect:i,enabled:l,interval:o=5,order:s=y.TreeOrder,pointerCoordinates:a,scrollableAncestors:u,scrollableAncestorRects:c,delta:d,threshold:h}=e,f=function(e){let{delta:t,disabled:r}=e,n=(0,S.ZC)(t);return(0,S.KG)(e=>{if(r||!n||!e)return ev;let i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[p.Backward]:e.x[p.Backward]||-1===i.x,[p.Forward]:e.x[p.Forward]||1===i.x},y:{[p.Backward]:e.y[p.Backward]||-1===i.y,[p.Forward]:e.y[p.Forward]||1===i.y}}},[r,t,n])}({delta:d,disabled:!l}),[m,g]=(0,S.$$)(),b=(0,k.useRef)({x:0,y:0}),w=(0,k.useRef)({x:0,y:0}),x=(0,k.useMemo)(()=>{switch(r){case v.Pointer:return a?{top:a.y,bottom:a.y,left:a.x,right:a.x}:null;case v.DraggableRect:return i}},[r,i,a]),C=(0,k.useRef)(null),M=(0,k.useCallback)(()=>{let e=C.current;if(!e)return;let t=b.current.x*w.current.x,r=b.current.y*w.current.y;e.scrollBy(t,r)},[]),R=(0,k.useMemo)(()=>s===y.TreeOrder?[...u].reverse():u,[s,u]);(0,k.useEffect)(()=>{if(!l||!u.length||!x)return void g();for(let e of R){if((null==n?void 0:n(e))===!1)continue;let r=c[u.indexOf(e)];if(!r)continue;let{direction:i,speed:l}=function(e,t,r,n,i){let{top:l,left:o,right:s,bottom:a}=r;void 0===n&&(n=10),void 0===i&&(i=et);let{isTop:u,isBottom:c,isLeft:d,isRight:h}=ee(e),f={x:0,y:0},m={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!u&&l<=t.top+g.height?(f.y=p.Backward,m.y=n*Math.abs((t.top+g.height-l)/g.height)):!c&&a>=t.bottom-g.height&&(f.y=p.Forward,m.y=n*Math.abs((t.bottom-g.height-a)/g.height)),!h&&s>=t.right-g.width?(f.x=p.Forward,m.x=n*Math.abs((t.right-g.width-s)/g.width)):!d&&o<=t.left+g.width&&(f.x=p.Backward,m.x=n*Math.abs((t.left+g.width-o)/g.width)),{direction:f,speed:m}}(e,r,x,t,h);for(let e of["x","y"])f[e][i[e]]||(l[e]=0,i[e]=0);if(l.x>0||l.y>0){g(),C.current=e,m(M,o),b.current=l,w.current=i;return}}b.current={x:0,y:0},w.current={x:0,y:0},g()},[t,M,n,g,l,o,JSON.stringify(x),JSON.stringify(f),m,u,R,c,JSON.stringify(h)])}({...eP,delta:eo,draggingRect:e8,pointerCoordinates:e3,scrollableAncestors:e1,scrollableAncestorRects:e2});let tu=(0,k.useMemo)(()=>({active:ec,activeNode:e_,activeNodeRect:eY,activatorEvent:ef,collisions:te,containerNodeRect:eU,dragOverlay:eq,draggableNodes:el,droppableContainers:es,droppableRects:eI,over:tr,measureDroppableContainers:eB,scrollableAncestors:e1,scrollableAncestorRects:e2,measuringConfiguration:eO,measuringScheduled:eW,windowRect:e0}),[ec,e_,eY,ef,te,eU,eq,el,es,eI,tr,eB,e1,e2,eO,eW,e0]),tc=(0,k.useMemo)(()=>({activatorEvent:ef,activators:ta,active:ec,activeNodeRect:eY,ariaDescribedById:{draggable:ex},dispatch:B,draggableNodes:el,over:tr,measureDroppableContainers:eB}),[ef,ta,ec,eY,B,ex,el,tr,eB]);return k.default.createElement(M.Provider,{value:$},k.default.createElement(eF.Provider,{value:tc},k.default.createElement(eA.Provider,{value:tu},k.default.createElement(eK.Provider,{value:ti},N)),k.default.createElement(eL,{disabled:(null==E?void 0:E.restoreFocus)===!1})),k.default.createElement(D,{...E,hiddenTextDescribedById:ex}))}),eW=(0,k.createContext)(null),e_="button";function ej(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e,l=(0,S.YG)("Draggable"),{activators:o,activatorEvent:s,active:a,activeNodeRect:u,ariaDescribedById:c,draggableNodes:d,over:h}=(0,k.useContext)(eF),{role:p=e_,roleDescription:f="draggable",tabIndex:m=0}=null!=i?i:{},g=(null==a?void 0:a.id)===t,v=(0,k.useContext)(g?eK:eW),[y,b]=(0,S.lk)(),[w,x]=(0,S.lk)(),C=(0,k.useMemo)(()=>o.reduce((e,r)=>{let{eventName:n,handler:i}=r;return e[n]=e=>{i(e,t)},e},{}),[o,t]),M=(0,S.YN)(r);return(0,S.Es)(()=>(d.set(t,{id:t,key:l,node:y,activatorNode:w,data:M}),()=>{let e=d.get(t);e&&e.key===l&&d.delete(t)}),[d,t]),{active:a,activatorEvent:s,activeNodeRect:u,attributes:(0,k.useMemo)(()=>({role:p,tabIndex:m,"aria-disabled":n,"aria-pressed":!!g&&p===e_||void 0,"aria-roledescription":f,"aria-describedby":c.draggable}),[n,p,m,g,f,c.draggable]),isDragging:g,listeners:n?void 0:C,node:y,over:h,setNodeRef:b,setActivatorNodeRef:x,transform:v}}function eP(){return(0,k.useContext)(eA)}let e$={timeout:25};function eY(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e,l=(0,S.YG)("Droppable"),{active:o,dispatch:s,over:a,measureDroppableContainers:u}=(0,k.useContext)(eF),c=(0,k.useRef)({disabled:r}),d=(0,k.useRef)(!1),p=(0,k.useRef)(null),f=(0,k.useRef)(null),{disabled:m,updateMeasurementsFor:g,timeout:v}={...e$,...i},y=(0,S.YN)(null!=g?g:n),b=ew({callback:(0,k.useCallback)(()=>{if(!d.current){d.current=!0;return}null!=f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),f.current=null},v)},[v]),disabled:m||!o}),w=(0,k.useCallback)((e,t)=>{b&&(t&&(b.unobserve(t),d.current=!1),e&&b.observe(e))},[b]),[x,C]=(0,S.lk)(w),M=(0,S.YN)(t);return(0,k.useEffect)(()=>{b&&x.current&&(b.disconnect(),d.current=!1,b.observe(x.current))},[x,b]),(0,k.useEffect)(()=>(s({type:h.RegisterDroppable,element:{id:n,key:l,disabled:r,node:x,rect:p,data:M}}),()=>s({type:h.UnregisterDroppable,key:l,id:n})),[n]),(0,k.useEffect)(()=>{r!==c.current.disabled&&(s({type:h.SetDroppableDisabled,id:n,key:l,disabled:r}),c.current.disabled=r)},[n,l,r,s]),{active:o,rect:p,isOver:(null==a?void 0:a.id)===n,node:x,over:a,setNodeRef:C}}},43627:function(e,t,r){r.d(t,{JR:()=>x,be:()=>o,gB:()=>d,gl:()=>y,kL:()=>a});var n=r(17402),i=r(15871),l=r(74979);function o(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function s(e){return null!==e&&e>=0}let a=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e,l=o(t,n,r),s=t[i],a=l[i];return a&&s?{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}:null},u="Sortable",c=n.default.createContext({activeIndex:-1,containerId:u,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:a,disabled:{draggable:!1,droppable:!1}});function d(e){let{children:t,id:r,items:o,strategy:s=a,disabled:d=!1}=e,{active:h,dragOverlay:p,droppableRects:f,over:m,measureDroppableContainers:g}=(0,i.fF)(),v=(0,l.YG)(u,r),y=null!==p.rect,b=(0,n.useMemo)(()=>o.map(e=>"object"==typeof e&&"id"in e?e.id:e),[o]),w=null!=h,x=h?b.indexOf(h.id):-1,k=m?b.indexOf(m.id):-1,S=(0,n.useRef)(b),C=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(b,S.current),M=-1!==k&&-1===x||C,R="boolean"==typeof d?{draggable:d,droppable:d}:d;(0,l.Es)(()=>{C&&w&&g(b)},[C,b,w,g]),(0,n.useEffect)(()=>{S.current=b},[b]);let E=(0,n.useMemo)(()=>({activeIndex:x,containerId:v,disabled:R,disableTransforms:M,items:b,overIndex:k,useDragOverlay:y,sortedRects:b.reduce((e,t,r)=>{let n=f.get(t);return n&&(e[r]=n),e},Array(b.length)),strategy:s}),[x,v,R.draggable,R.droppable,M,b,k,f,y,s]);return n.default.createElement(c.Provider,{value:E},t)}let h=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return o(r,n,i).indexOf(t)},p=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:l,newIndex:o,previousItems:s,previousContainerId:a,transition:u}=e;return!!u&&!!n&&(s===l||i!==o)&&(!!r||o!==i&&t===a)},f={duration:200,easing:"ease"},m="transform",g=l.Ks.Transition.toString({property:m,duration:0,easing:"linear"}),v={roleDescription:"sortable"};function y(e){var t,r,o,a;let{animateLayoutChanges:u=p,attributes:d,disabled:y,data:b,getNewIndex:w=h,id:x,strategy:k,resizeObserverConfig:S,transition:C=f}=e,{items:M,containerId:R,activeIndex:E,disabled:D,disableTransforms:T,sortedRects:N,overIndex:O,useDragOverlay:I,strategy:F}=(0,n.useContext)(c),A=(t=y,r=D,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(o=null==t?void 0:t.draggable)?o:r.draggable,droppable:null!=(a=null==t?void 0:t.droppable)?a:r.droppable}),J=M.indexOf(x),z=(0,n.useMemo)(()=>({sortable:{containerId:R,index:J,items:M},...b}),[R,b,J,M]),L=(0,n.useMemo)(()=>M.slice(M.indexOf(x)),[M,x]),{rect:K,node:B,isOver:W,setNodeRef:_}=(0,i.zM)({id:x,data:z,disabled:A.droppable,resizeObserverConfig:{updateMeasurementsFor:L,...S}}),{active:j,activatorEvent:P,activeNodeRect:$,attributes:Y,setNodeRef:U,listeners:X,isDragging:G,over:q,setActivatorNodeRef:H,transform:V}=(0,i.PM)({id:x,data:z,attributes:{...v,...d},disabled:A.draggable}),Q=(0,l.jn)(_,U),Z=!!j,ee=Z&&!T&&s(E)&&s(O),et=!I&&G,er=et&&ee?V:null,en=ee?null!=er?er:(null!=k?k:F)({rects:N,activeNodeRect:$,activeIndex:E,overIndex:O,index:J}):null,ei=s(E)&&s(O)?w({id:x,items:M,activeIndex:E,overIndex:O}):J,el=null==j?void 0:j.id,eo=(0,n.useRef)({activeId:el,items:M,newIndex:ei,containerId:R}),es=M!==eo.current.items,ea=u({active:j,containerId:R,isDragging:G,isSorting:Z,id:x,index:J,items:M,newIndex:eo.current.newIndex,previousItems:eo.current.items,previousContainerId:eo.current.containerId,transition:C,wasDragging:null!=eo.current.activeId}),eu=function(e){let{disabled:t,index:r,node:o,rect:s}=e,[a,u]=(0,n.useState)(null),c=(0,n.useRef)(r);return(0,l.Es)(()=>{if(!t&&r!==c.current&&o.current){let e=s.current;if(e){let t=(0,i.Sj)(o.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&u(r)}}r!==c.current&&(c.current=r)},[t,r,o,s]),(0,n.useEffect)(()=>{a&&u(null)},[a]),a}({disabled:!ea,index:J,node:B,rect:K});return(0,n.useEffect)(()=>{Z&&eo.current.newIndex!==ei&&(eo.current.newIndex=ei),R!==eo.current.containerId&&(eo.current.containerId=R),M!==eo.current.items&&(eo.current.items=M)},[Z,ei,R,M]),(0,n.useEffect)(()=>{if(el===eo.current.activeId)return;if(el&&!eo.current.activeId){eo.current.activeId=el;return}let e=setTimeout(()=>{eo.current.activeId=el},50);return()=>clearTimeout(e)},[el]),{active:j,activeIndex:E,attributes:Y,data:z,rect:K,index:J,newIndex:ei,items:M,isOver:W,isSorting:Z,isDragging:G,listeners:X,node:B,overIndex:O,over:q,setNodeRef:Q,setActivatorNodeRef:H,setDroppableNodeRef:_,setDraggableNodeRef:U,transform:null!=eu?eu:en,transition:eu||es&&eo.current.newIndex===J?g:(!et||(0,l.kx)(P))&&C&&(Z||ea)?l.Ks.Transition.toString({...C,property:m}):void 0}}function b(e){if(!e)return!1;let t=e.data.current;return!!t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable}let w=[i.vL.Down,i.vL.Right,i.vL.Up,i.vL.Left],x=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:o,droppableContainers:s,over:a,scrollableAncestors:u}}=t;if(w.includes(e.code)){if(e.preventDefault(),!r||!n)return;let t=[];s.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;let l=o.get(r.id);if(l)switch(e.code){case i.vL.Down:n.top<l.top&&t.push(r);break;case i.vL.Up:n.top>l.top&&t.push(r);break;case i.vL.Left:n.left>l.left&&t.push(r);break;case i.vL.Right:n.left<l.left&&t.push(r)}});let h=(0,i.y$)({active:r,collisionRect:n,droppableRects:o,droppableContainers:t,pointerCoordinates:null}),p=(0,i.Vy)(h,"id");if(p===(null==a?void 0:a.id)&&h.length>1&&(p=h[1].id),null!=p){let e=s.get(r.id),t=s.get(p),a=t?o.get(t.id):null,h=null==t?void 0:t.node.current;if(h&&a&&e&&t){var c,d;let r=(0,i.sl)(h).some((e,t)=>u[t]!==e),o=k(e,t),s=(c=e,d=t,!!b(c)&&!!b(d)&&!!k(c,d)&&c.data.current.sortable.index<d.data.current.sortable.index),p=r||!o?{x:0,y:0}:{x:s?n.width-a.width:0,y:s?n.height-a.height:0},f={x:a.left,y:a.top};return p.x&&p.y?f:(0,l.Re)(f,p)}}}};function k(e,t){return!!b(e)&&!!b(t)&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}},74979:function(e,t,r){r.d(t,{$$:()=>m,Es:()=>p,KG:()=>v,Ks:()=>E,Ll:()=>s,Re:()=>C,Sw:()=>l,TW:()=>h,WQ:()=>S,YG:()=>x,YN:()=>g,ZC:()=>b,_q:()=>f,ag:()=>T,e_:()=>R,jn:()=>i,kx:()=>M,l6:()=>o,lk:()=>y,sb:()=>c,wz:()=>u,xZ:()=>d,zk:()=>a});var n=r(17402);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}let l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function o(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function s(e){return"nodeType"in e}function a(e){var t,r;return e?o(e)?e:s(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function u(e){let{Document:t}=a(e);return e instanceof t}function c(e){return!o(e)&&e instanceof a(e).HTMLElement}function d(e){return e instanceof a(e).SVGElement}function h(e){return e?o(e)?e.document:s(e)?u(e)?e:c(e)||d(e)?e.ownerDocument:document:document:document}let p=l?n.useLayoutEffect:n.useEffect;function f(e){let t=(0,n.useRef)(e);return p(()=>{t.current=e}),(0,n.useCallback)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)},[])}function m(){let e=(0,n.useRef)(null);return[(0,n.useCallback)((t,r)=>{e.current=setInterval(t,r)},[]),(0,n.useCallback)(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}function g(e,t){void 0===t&&(t=[e]);let r=(0,n.useRef)(e);return p(()=>{r.current!==e&&(r.current=e)},t),r}function v(e,t){let r=(0,n.useRef)();return(0,n.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function y(e){let t=f(e),r=(0,n.useRef)(null),i=(0,n.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,i]}function b(e){let t=(0,n.useRef)();return(0,n.useEffect)(()=>{t.current=e},[e]),t.current}let w={};function x(e,t){return(0,n.useMemo)(()=>{if(t)return t;let r=null==w[e]?0:w[e]+1;return w[e]=r,e+"-"+r},[e,t])}function k(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((t,r)=>{for(let[n,i]of Object.entries(r)){let r=t[n];null!=r&&(t[n]=r+e*i)}return t},{...t})}}let S=k(1),C=k(-1);function M(e){if(!e)return!1;let{KeyboardEvent:t}=a(e.target);return t&&e instanceof t}function R(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=a(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let E=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[E.Translate.toString(e),E.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),D="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function T(e){return e.matches(D)?e:e.querySelector(D)}},97070:function(e,t,r){r.d(t,{$L:()=>T,Ln:()=>m,N0:()=>E,Um:()=>D,Wg:()=>g,X9:()=>o,dL:()=>W,jP:()=>b,n9:()=>M,oM:()=>w,zy:()=>C});var n=r(579);class i{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class l{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&l.empty)return l.empty}recover(e){let t=0,r=65535&e;if(!this.inverted)for(let e=0;e<r;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*r]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let n=0,l=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;let u=this.ranges[s+l],c=this.ranges[s+o],d=a+u;if(e<=d){let l=u?e==a?-1:e==d?1:t:t,o=a+n+(l<0?0:c);if(r)return o;let h=e==(t<0?a:d)?null:s/3+(e-a)*65536,p=e==a?2:e==d?1:4;return(t<0?e!=a:e!=d)&&(p|=8),new i(o,p,h)}n+=c-u}return r?e+n:new i(e+n,0,null)}touches(e,t){let r=0,n=65535&t,i=this.inverted?2:1,l=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let o=this.ranges[t]-(this.inverted?r:0);if(o>e)break;let s=this.ranges[t+i];if(e<=o+s&&t==3*n)return!0;r+=this.ranges[t+l]-s}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,i=0;n<this.ranges.length;n+=3){let l=this.ranges[n],o=l-(this.inverted?i:0),s=l+(this.inverted?0:i),a=this.ranges[n+t],u=this.ranges[n+r];e(o,o+a,s,s+u),i+=u-a}}invert(){return new l(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?l.empty:new l(e<0?[0,-e,0]:[0,0,e])}}l.empty=new l([]);class o{constructor(e,t,r=0,n=e?e.length:0){this.mirror=t,this.from=r,this.to=n,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new o(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let n=e.getMirror(t);this.appendMap(e._maps[t],null!=n&&n<t?r+n:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let n=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=n&&n>t?r-n-1:void 0)}}invert(){let e=new o;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let n=0;for(let r=this.from;r<this.to;r++){let i=this._maps[r].mapResult(e,t);if(null!=i.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this._maps[t].recover(i.recover);continue}}n|=i.delInfo,e=i.pos}return r?e:new i(e,n,null)}}let s=Object.create(null);class a{getMap(){return l.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let r=s[t.stepType];if(!r)throw RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in s)throw RangeError("Duplicate use of step JSON ID "+e);return s[e]=t,t.prototype.jsonID=e,t}}class u{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new u(e,null)}static fail(e){return new u(null,e)}static fromReplace(e,t,r,i){try{return u.ok(e.replace(t,r,i))}catch(e){if(e instanceof n.vI)return u.fail(e.message);throw e}}}function c(e,t,r){let i=[];for(let n=0;n<e.childCount;n++){let l=e.child(n);l.content.size&&(l=l.copy(c(l.content,t,l))),l.isInline&&(l=t(l,r,n)),i.push(l)}return n.FK.fromArray(i)}class d extends a{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),l=new n.Ji(c(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,i),t.openStart,t.openEnd);return u.fromReplace(e,this.from,this.to,l)}invert(){return new h(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new d(t.pos,r.pos,this.mark)}merge(e){return e instanceof d&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new d(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new d(t.from,t.to,e.markFromJSON(t.mark))}}a.jsonID("addMark",d);class h extends a{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new n.Ji(c(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return u.fromReplace(e,this.from,this.to,r)}invert(){return new d(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new h(t.pos,r.pos,this.mark)}merge(e){return e instanceof h&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new h(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new h(t.from,t.to,e.markFromJSON(t.mark))}}a.jsonID("removeMark",h);class p extends a{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return u.fromReplace(e,this.pos,this.pos+1,new n.Ji(n.FK.from(r),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(e))return new p(this.pos,t.marks[r]);return new p(this.pos,this.mark)}}return new f(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new p(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new p(t.pos,e.markFromJSON(t.mark))}}a.jsonID("addNodeMark",p);class f extends a{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return u.fromReplace(e,this.pos,this.pos+1,new n.Ji(n.FK.from(r),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new p(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new f(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new f(t.pos,e.markFromJSON(t.mark))}}a.jsonID("removeNodeMark",f);class m extends a{constructor(e,t,r,n=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=n}apply(e){return this.structure&&v(e,this.from,this.to)?u.fail("Structure replace would overwrite content"):u.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new l([this.from,this.to-this.from,this.slice.size])}invert(e){return new m(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new m(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof m)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart)if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;else{let t=this.slice.size+e.slice.size==0?n.Ji.empty:new n.Ji(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new m(e.from,this.to,t,this.structure)}{let t=this.slice.size+e.slice.size==0?n.Ji.empty:new n.Ji(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new m(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new m(t.from,t.to,n.Ji.fromJSON(e,t.slice),!!t.structure)}}a.jsonID("replace",m);class g extends a{constructor(e,t,r,n,i,l,o=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=n,this.slice=i,this.insert=l,this.structure=o}apply(e){if(this.structure&&(v(e,this.from,this.gapFrom)||v(e,this.gapTo,this.to)))return u.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return u.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?u.fromReplace(e,this.from,this.to,r):u.fail("Content does not fit in gap")}getMap(){return new l([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new g(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),n=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||n<t.pos||i>r.pos?null:new g(t.pos,r.pos,n,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new g(t.from,t.to,t.gapFrom,t.gapTo,n.Ji.fromJSON(e,t.slice),t.insert,!!t.structure)}}function v(e,t,r){let n=e.resolve(t),i=r-t,l=n.depth;for(;i>0&&l>0&&n.indexAfter(l)==n.node(l).childCount;)l--,i--;if(i>0){let e=n.node(l).maybeChild(n.indexAfter(l));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function y(e,t,r,i=r.contentMatch,l=!0){let o=e.doc.nodeAt(t),s=[],a=t+1;for(let t=0;t<o.childCount;t++){let u=o.child(t),c=a+u.nodeSize,d=i.matchType(u.type);if(d){i=d;for(let t=0;t<u.marks.length;t++)r.allowsMarkType(u.marks[t].type)||e.step(new h(a,c,u.marks[t]));if(l&&u.isText&&"pre"!=r.whitespace){let e,t=/\r?\n|\r/g,i;for(;e=t.exec(u.text);)i||(i=new n.Ji(n.FK.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),s.push(new m(a+e.index,a+e.index+e[0].length,i))}}else s.push(new m(a,c,n.Ji.empty));a=c}if(!i.validEnd){let t=i.fillBefore(n.FK.empty,!0);e.replace(a,a,new n.Ji(t,0,0))}for(let t=s.length-1;t>=0;t--)e.step(s[t])}function b(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let r=e.depth;;--r){let n=e.$from.node(r),i=e.$from.index(r),l=e.$to.indexAfter(r);if(r<e.depth&&n.canReplace(i,l,t))return r;if(0==r||n.type.spec.isolating||!((0==i||n.canReplace(i,n.childCount))&&(l==n.childCount||n.canReplace(0,l))))break}return null}function w(e,t,r=null,n=e){let i=function(e,t){let{parent:r,startIndex:n,endIndex:i}=e,l=r.contentMatchAt(n).findWrapping(t);if(!l)return null;let o=l.length?l[0]:t;return r.canReplaceWith(n,i,o)?l:null}(e,t),l=i&&function(e,t){let{parent:r,startIndex:n,endIndex:i}=e,l=r.child(n),o=t.contentMatch.findWrapping(l.type);if(!o)return null;let s=(o.length?o[o.length-1]:t).contentMatch;for(let e=n;s&&e<i;e++)s=s.matchType(r.child(e).type);return s&&s.validEnd?o:null}(n,t);return l?i.map(x).concat({type:t,attrs:r}).concat(l.map(x)):null}function x(e){return{type:e,attrs:null}}function k(e,t,r,n){t.forEach((i,l)=>{if(i.isText){let o,s=/\r?\n|\r/g;for(;o=s.exec(i.text);){let i=e.mapping.slice(n).map(r+1+l+o.index);e.replaceWith(i,i+1,t.type.schema.linebreakReplacement.create())}}})}function S(e,t,r,n){t.forEach((i,l)=>{if(i.type==i.type.schema.linebreakReplacement){let i=e.mapping.slice(n).map(r+1+l);e.replaceWith(i,i+1,t.type.schema.text("\n"))}})}function C(e,t,r=1,n){let i=e.resolve(t),l=i.depth-r,o=n&&n[n.length-1]||i.parent;if(l<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let e=i.depth-1,t=r-2;e>l;e--,t--){let r=i.node(e),l=i.index(e);if(r.type.spec.isolating)return!1;let o=r.content.cutByIndex(l,r.childCount),s=n&&n[t+1];s&&(o=o.replaceChild(0,s.type.create(s.attrs)));let a=n&&n[t]||r;if(!r.canReplace(l+1,r.childCount)||!a.type.validContent(o))return!1}let s=i.indexAfter(l),a=n&&n[0];return i.node(l).canReplaceWith(s,s,a?a.type:i.node(l+1).type)}function M(e,t){let r=e.resolve(t),n=r.index();return R(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function R(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let i=0;i<t.childCount;i++){let l=t.child(i),o=l.type==n?e.type.schema.nodes.text:l.type;if(!(r=r.matchType(o))||!e.type.allowsMarks(l.marks))return!1}return r.validEnd}(e,t))}function E(e,t,r=-1){let n=e.resolve(t);for(let e=n.depth;;e--){let i,l,o=n.index(e);if(e==n.depth?(i=n.nodeBefore,l=n.nodeAfter):r>0?(i=n.node(e+1),o++,l=n.node(e).maybeChild(o)):(i=n.node(e).maybeChild(o-1),l=n.node(e+1)),i&&!i.isTextblock&&R(i,l)&&n.node(e).canReplace(o,o+1))return t;if(0==e)break;t=r<0?n.before(e):n.after(e)}}function D(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let i=r.content;for(let e=0;e<r.openStart;e++)i=i.firstChild.content;for(let e=1;e<=(0==r.openStart&&r.size?2:1);e++)for(let t=n.depth;t>=0;t--){let r=t==n.depth?0:n.pos<=(n.start(t+1)+n.end(t+1))/2?-1:1,l=n.index(t)+ +(r>0),o=n.node(t),s=!1;if(1==e)s=o.canReplace(l,l,i);else{let e=o.contentMatchAt(l).findWrapping(i.firstChild.type);s=e&&o.canReplaceWith(l,l,e[0])}if(s)return 0==r?n.pos:r<0?n.before(t+1):n.after(t+1)}return null}function T(e,t,r=t,i=n.Ji.empty){if(t==r&&!i.size)return null;let l=e.resolve(t),o=e.resolve(r);return N(l,o,i)?new m(t,r,i):new O(l,o,i).fit()}function N(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}a.jsonID("replaceAround",g);class O{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=n.FK.empty;for(let t=0;t<=e.depth;t++){let r=e.node(t);this.frontier.push({type:r.type,match:r.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=n.FK.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let l=this.placed,o=r.depth,s=i.depth;for(;o&&s&&1==l.childCount;)l=l.firstChild.content,o--,s--;let a=new n.Ji(l,o,s);return e>-1?new g(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new m(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,n=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(n=0),i.type.spec.isolating&&n<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=1==t?e:this.unplaced.openStart;r>=0;r--){let e=null,i=(r?(e=A(this.unplaced.content,r-1).firstChild).content:this.unplaced.content).firstChild;for(let l=this.depth;l>=0;l--){let{type:o,match:s}=this.frontier[l],a,u=null;if(1==t&&(i?s.matchType(i.type)||(u=s.fillBefore(n.FK.from(i),!1)):e&&o.compatibleContent(e.type)))return{sliceDepth:r,frontierDepth:l,parent:e,inject:u};if(2==t&&i&&(a=s.findWrapping(i.type)))return{sliceDepth:r,frontierDepth:l,parent:e,wrap:a};if(e&&s.matchType(e.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=A(e,t);return!!i.childCount&&!i.firstChild.isLeaf&&(this.unplaced=new n.Ji(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=A(e,t);if(i.childCount<=1&&t>0){let l=e.size-t<=t+i.size;this.unplaced=new n.Ji(I(e,t-1,1),t-1,l?t-1:r)}else this.unplaced=new n.Ji(I(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:l}){for(;this.depth>t;)this.closeFrontierNode();if(l)for(let e=0;e<l.length;e++)this.openFrontierNode(l[e]);let o=this.unplaced,s=r?r.content:o.content,a=o.openStart-e,u=0,c=[],{match:d,type:h}=this.frontier[t];if(i){for(let e=0;e<i.childCount;e++)c.push(i.child(e));d=d.matchFragment(i)}let p=s.size+e-(o.content.size-o.openEnd);for(;u<s.childCount;){let e=s.child(u),t=d.matchType(e.type);if(!t)break;(++u>1||0==a||e.content.size)&&(d=t,c.push(function e(t,r,i){if(r<=0)return t;let l=t.content;return r>1&&(l=l.replaceChild(0,e(l.firstChild,r-1,1==l.childCount?i-1:0))),r>0&&(l=t.type.contentMatch.fillBefore(l).append(l),i<=0&&(l=l.append(t.type.contentMatch.matchFragment(l).fillBefore(n.FK.empty,!0)))),t.copy(l)}(e.mark(h.allowedMarks(e.marks)),1==u?a:0,u==s.childCount?p:-1)))}let f=u==s.childCount;f||(p=-1),this.placed=F(this.placed,t,n.FK.from(c)),this.frontier[t].match=d,f&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=s;e<p;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=f?0==e?n.Ji.empty:new n.Ji(I(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new n.Ji(I(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!J(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:r}=this.$to,n=this.$to.after(r);for(;r>1&&n==this.$to.end(--r);)++n;return n}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:n}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),l=J(e,t,n,r,i);if(l){for(let r=t-1;r>=0;r--){let{match:t,type:n}=this.frontier[r],i=J(e,r,n,t,!0);if(!i||i.childCount)continue e}return{depth:t,fit:l,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=F(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let t=e.node(r),n=t.type.contentMatch.fillBefore(t.content,!0,e.index(r));this.openFrontierNode(t.type,t.attrs,n)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=F(this.placed,this.depth,n.FK.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(n.FK.empty,!0);e.childCount&&(this.placed=F(this.placed,this.frontier.length,e))}}function I(e,t,r){return 0==t?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(I(e.firstChild.content,t-1,r)))}function F(e,t,r){return 0==t?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(F(e.lastChild.content,t-1,r)))}function A(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function J(e,t,r,n,i){let l=e.node(t),o=i?e.indexAfter(t):e.index(t);if(o==l.childCount&&!r.compatibleContent(l.type))return null;let s=n.fillBefore(l.content,!0,o);return s&&!function(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}(r,l.content,o)?s:null}function z(e,t){let r=[],n=Math.min(e.depth,t.depth);for(let i=n;i>=0;i--){let n=e.start(i);if(n<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(n==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==n-1)&&r.push(i)}return r}class L extends a{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at attribute step's position");let r=Object.create(null);for(let e in t.attrs)r[e]=t.attrs[e];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return u.fromReplace(e,this.pos,this.pos+1,new n.Ji(n.FK.from(i),0,+!t.isLeaf))}getMap(){return l.empty}invert(e){return new L(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new L(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new L(t.pos,t.attr,t.value)}}a.jsonID("attr",L);class K extends a{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return u.ok(r)}getMap(){return l.empty}invert(e){return new K(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new K(t.attr,t.value)}}a.jsonID("docAttr",K);let B=class extends Error{};(B=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r}).prototype=Object.create(Error.prototype),B.prototype.constructor=B,B.prototype.name="TransformError";class W{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new o}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new B(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=n.Ji.empty){let i=T(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new n.Ji(n.FK.from(r),0,0))}delete(e,t){return this.replace(e,t,n.Ji.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return!function(e,t,r,i){if(!i.size)return e.deleteRange(t,r);let l=e.doc.resolve(t),o=e.doc.resolve(r);if(N(l,o,i))return e.step(new m(t,r,i));let s=z(l,e.doc.resolve(r));0==s[s.length-1]&&s.pop();let a=-(l.depth+1);s.unshift(a);for(let e=l.depth,t=l.pos-1;e>0;e--,t--){let r=l.node(e).type.spec;if(r.defining||r.definingAsContext||r.isolating)break;s.indexOf(e)>-1?a=e:l.before(e)==t&&s.splice(1,0,-e)}let u=s.indexOf(a),c=[],d=i.openStart;for(let e=i.content,t=0;;t++){let r=e.firstChild;if(c.push(r),t==i.openStart)break;e=r.content}for(let e=d-1;e>=0;e--){var h;let t=c[e],r=(h=t.type).spec.defining||h.spec.definingForContent;if(r&&!t.sameMarkup(l.node(Math.abs(a)-1)))d=e;else if(r||!t.type.isTextblock)break}for(let t=i.openStart;t>=0;t--){let a=(t+d+1)%(i.openStart+1),h=c[a];if(h)for(let t=0;t<s.length;t++){let c=s[(t+u)%s.length],d=!0;c<0&&(d=!1,c=-c);let p=l.node(c-1),f=l.index(c-1);if(p.canReplaceWith(f,f,h.type,h.marks))return e.replace(l.before(c),d?o.after(c):r,new n.Ji(function e(t,r,i,l,o){if(r<i){let n=t.firstChild;t=t.replaceChild(0,n.copy(e(n.content,r+1,i,l,n)))}if(r>l){let e=o.contentMatchAt(0),r=e.fillBefore(t).append(t);t=r.append(e.matchFragment(r).fillBefore(n.FK.empty,!0))}return t}(i.content,0,i.openStart,a),a,i.openEnd))}}let p=e.steps.length;for(let n=s.length-1;n>=0&&(e.replace(t,r,i),!(e.steps.length>p));n--){let e=s[n];e<0||(t=l.before(e),r=o.after(e))}}(this,e,t,r),this}replaceRangeWith(e,t,r){var i=e,l=t;if(!r.isInline&&i==l&&this.doc.resolve(i).parent.content.size){let e=function(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(0==n.parentOffset)for(let e=n.depth-1;e>=0;e--){let t=n.index(e);if(n.node(e).canReplaceWith(t,t,r))return n.before(e+1);if(t>0)return null}if(n.parentOffset==n.parent.content.size)for(let e=n.depth-1;e>=0;e--){let t=n.indexAfter(e);if(n.node(e).canReplaceWith(t,t,r))return n.after(e+1);if(t<n.node(e).childCount)break}return null}(this.doc,i,r.type);null!=e&&(i=l=e)}return this.replaceRange(i,l,new n.Ji(n.FK.from(r),0,0)),this}deleteRange(e,t){return!function(e,t,r){let n=e.doc.resolve(t),i=e.doc.resolve(r),l=z(n,i);for(let t=0;t<l.length;t++){let r=l[t],o=t==l.length-1;if(o&&0==r||n.node(r).type.contentMatch.validEnd)return e.delete(n.start(r),i.end(r));if(r>0&&(o||n.node(r-1).canReplace(n.index(r-1),i.indexAfter(r-1))))return e.delete(n.before(r),i.after(r))}for(let l=1;l<=n.depth&&l<=i.depth;l++)if(t-n.start(l)==n.depth-l&&r>n.end(l)&&i.end(l)-r!=i.depth-l&&n.start(l-1)==i.start(l-1)&&n.node(l-1).canReplace(n.index(l-1),i.index(l-1)))return e.delete(n.before(l),r);e.delete(t,r)}(this,e,t),this}lift(e,t){return!function(e,t,r){let{$from:i,$to:l,depth:o}=t,s=i.before(o+1),a=l.after(o+1),u=s,c=a,d=n.FK.empty,h=0;for(let e=o,t=!1;e>r;e--)t||i.index(e)>0?(t=!0,d=n.FK.from(i.node(e).copy(d)),h++):u--;let p=n.FK.empty,f=0;for(let e=o,t=!1;e>r;e--)t||l.after(e+1)<l.end(e)?(t=!0,p=n.FK.from(l.node(e).copy(p)),f++):c++;e.step(new g(u,c,s,a,new n.Ji(d.append(p),h,f),d.size-h,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,r){let i=null,{linebreakReplacement:l}=e.doc.type.schema,o=e.doc.resolve(t-r),s=o.node().type;if(l&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(l);e&&!t?i=!1:!e&&t&&(i=!0)}let a=e.steps.length;if(!1===i){let n=e.doc.resolve(t+r);S(e,n.node(),n.before(),a)}s.inlineContent&&y(e,t+r-1,s,o.node().contentMatchAt(o.index()),null==i);let u=e.mapping.slice(a),c=u.map(t-r);if(e.step(new m(c,u.map(t+r,-1),n.Ji.empty,!0)),!0===i){let t=e.doc.resolve(c);k(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,r){let i=n.FK.empty;for(let e=r.length-1;e>=0;e--){if(i.size){let t=r[e].type.contentMatch.matchFragment(i);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=n.FK.from(r[e].type.create(r[e].attrs,i))}let l=t.start,o=t.end;e.step(new g(l,o,l,o,new n.Ji(i,0,0),r.length,!0))}(this,e,t),this}setBlockType(e,t=e,r,i=null){var l=this;if(!r.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let o=l.steps.length;return l.doc.nodesBetween(e,t,(e,t)=>{var s,a,u;let c,d,h="function"==typeof i?i(e):i;if(e.isTextblock&&!e.hasMarkup(r,h)&&(s=l.doc,a=l.mapping.slice(o).map(t),u=r,d=(c=s.resolve(a)).index(),c.parent.canReplaceWith(d,d+1,u))){let i=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?i=!1:!e&&t&&(i=!0)}!1===i&&S(l,e,t,o),y(l,l.mapping.slice(o).map(t,1),r,void 0,null===i);let s=l.mapping.slice(o),a=s.map(t,1),u=s.map(t+e.nodeSize,1);return l.step(new g(a,u,a+1,u-1,new n.Ji(n.FK.from(r.create(h,null,e.marks)),0,0),1,!0)),!0===i&&k(l,e,t,o),!1}}),this}setNodeMarkup(e,t,r=null,i){return!function(e,t,r,i,l){let o=e.doc.nodeAt(t);if(!o)throw RangeError("No node at given position");r||(r=o.type);let s=r.create(i,null,l||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,s);if(!r.validContent(o.content))throw RangeError("Invalid content for node type "+r.name);e.step(new g(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new n.Ji(n.FK.from(s),0,0),1,!0))}(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new L(e,t,r)),this}setDocAttribute(e,t){return this.step(new K(e,t)),this}addNodeMark(e,t){return this.step(new p(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw RangeError("No node at position "+e);if(t instanceof n.CU)t.isInSet(r.marks)&&this.step(new f(e,t));else{let n=r.marks,i,l=[];for(;i=t.isInSet(n);)l.push(new f(e,i)),n=i.removeFromSet(n);for(let e=l.length-1;e>=0;e--)this.step(l[e])}return this}split(e,t=1,r){return!function(e,t,r=1,i){let l=e.doc.resolve(t),o=n.FK.empty,s=n.FK.empty;for(let e=l.depth,t=l.depth-r,a=r-1;e>t;e--,a--){o=n.FK.from(l.node(e).copy(o));let t=i&&i[a];s=n.FK.from(t?t.type.create(t.attrs,s):l.node(e).copy(s))}e.step(new m(t,t,new n.Ji(o.append(s),r,r),!0))}(this,e,t,r),this}addMark(e,t,r){var n;let i,l,o,s;return n=this,o=[],s=[],n.doc.nodesBetween(e,t,(n,a,u)=>{if(!n.isInline)return;let c=n.marks;if(!r.isInSet(c)&&u.type.allowsMarkType(r.type)){let u=Math.max(a,e),p=Math.min(a+n.nodeSize,t),f=r.addToSet(c);for(let e=0;e<c.length;e++)c[e].isInSet(f)||(i&&i.to==u&&i.mark.eq(c[e])?i.to=p:o.push(i=new h(u,p,c[e])));l&&l.to==u?l.to=p:s.push(l=new d(u,p,r))}}),o.forEach(e=>n.step(e)),s.forEach(e=>n.step(e)),this}removeMark(e,t,r){var i;let l,o;return i=this,l=[],o=0,i.doc.nodesBetween(e,t,(i,s)=>{if(!i.isInline)return;o++;let a=null;if(r instanceof n.sX){let e=i.marks,t;for(;t=r.isInSet(e);)(a||(a=[])).push(t),e=t.removeFromSet(e)}else r?r.isInSet(i.marks)&&(a=[r]):a=i.marks;if(a&&a.length){let r=Math.min(s+i.nodeSize,t);for(let t=0;t<a.length;t++){let n=a[t],i;for(let e=0;e<l.length;e++){let t=l[e];t.step==o-1&&n.eq(l[e].style)&&(i=t)}i?(i.to=r,i.step=o):l.push({style:n,from:Math.max(s,e),to:r,step:o})}}}),l.forEach(e=>i.step(new h(e.from,e.to,e.style))),this}clearIncompatible(e,t,r){return y(this,e,t,r),this}}}}]);