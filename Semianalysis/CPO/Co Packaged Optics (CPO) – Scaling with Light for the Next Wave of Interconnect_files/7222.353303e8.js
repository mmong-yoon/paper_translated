"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7222"],{5109:function(e,t,i){i.d(t,{QL:()=>q,dx:()=>j});var n=i(99851);if(/^(1889|2101|3133|6578|8156)$/.test(i.j))var a=i(69277);if(/^(1889|2101|3133|6578|8156)$/.test(i.j))var l=i(70408);if(/^(1889|2101|3133|6578|8156)$/.test(i.j))var o=i(32641);var r=i(79785),s=i(10201),u=i(32485),c=i.n(u),d=i(69843),p=i.n(d),h=i(17402),m=i(45516),b=i(34206),Y=i(52820),f=i(84605),v=i(86500),y=i(94729),g=i(89490),w=i(35369),S=i(74715),F=i(60322),_=i(76977),k=i(20500),C=i(76171),D=i(16993),E=i(81203),I=i(94996),x=i(63136),N=i(11587),T=i(65842),A=i(61554),P=i(96400),U=i(39318),B=i(46058),L=i(16722);function H(){let e=(0,r._)([""," on Substack"]);return H=function(){return e},e}class R extends h.Component{componentDidMount(){if(this.props.autoSubmit){var e,t,i;this.isComplete()?null==(e=this.formRef.current)||e.handleSubmit():null==(t=(i=this.props).onAutoSubmitFailed)||t.call(i)}}isComplete(){let{user:e,needsPhoto:t}=this.props;return e&&!e.is_magic&&e.name&&(!t||e.photo_url)}onError(e){var t,i,n;this.props.autoSubmit&&!this.state.autoSubmitFailed&&(this.setState({autoSubmitFailed:!0}),null==(i=(n=this.props).onAutoSubmitFailed)||i.call(n)),this.setState({sentLoginEmail:!1}),(null==(t=e.response)?void 0:t.status)===401&&this.sendLoginEmail()}async createDefaultPublication(e,t){let{iTemplate:i}=this.props;try{let n=await (0,y.x6)("/api/v1/publication/suggestion"),a=t||i(H(),e);await (0,y.x6)("/api/v1/publication",{method:"post",json:{name:e,subdomain:n.subdomain,hero_text:a,tos:!0}})}catch(e){(0,v.u4)(v.qY.DEFAULT_PUBLICATION_CREATION_FAILED),console.warn("couldn't set up a default publication",e)}}async sendLoginEmail(){let e=this.state.newEmail||this.props.freeSignupEmail;if(!this.state.loading&&e){this.setState({loading:!0});try{await (0,y.x6)("/api/v1/email-login",{method:"post",json:{email:e,redirect:document.location.href}}),this.setState({sentLoginEmail:!0})}catch(e){console.error("Failed send login email:",e)}this.setState({loading:!1})}}render(){var e;let{className:t,user:i,numVisibleSubscriptions:n,numSubscriptions:a,freeSignup:l,freeSignupEmail:o,needsPhoto:r,optionalPhoto:u,showHandle:d=!0,token:h,text:Y,onSuccess:f,prepareData:v,pageTitle:y,primaryEligiblePublications:D,isPostInvite:U,complete:H,profileExists:R,onSkip:j,onEditReadVisibility:q,barebones:O,onEditRecommendations:$,numRecommendationsToMake:W,noSubscribeCta:z,style:J,iString:Q,iPlural:V,showSocialHandle:G,pub:K}=this.props,{newPhotoUrl:M,newName:Z,newHandle:X,newEmail:ee,loading:et,sentLoginEmail:ei,sentAccountConfirmationEmail:en,newBio:ea,createPublication:el,selectedSocial:eo,selectedSocialHandle:er,tosAccepted:es,subscribeToNewsletter:eu}=null!=(e=this.state)?e:{},ec=M||(0,B.w3)(i,{}),ed="string"==typeof y||null===y?y:Q(this.isComplete()?"Update your profile":"Create your profile"),ep=Z||i&&i.name||"",eh=X||(null==i?void 0:i.handle)||"",em="string"==typeof ea?ea:i&&i.bio||"",eb=(!i||i.is_magic)&&!o&&!U,eY=!R&&!!$&&!p()(W)&&W>0,ef=U&&D&&(null==i?void 0:i.has_publication)&&D.length>1,ev="number"==typeof n&&!p()(a)&&a>0&&q,ey=!z&&!(i&&(i.is_subscribed||i.is_free_subscribed)||l),eg=U&&!(null==i?void 0:i.has_publication),ew=async(e,t)=>{e.body.emailConfirmationRequired?this.setState({sentAccountConfirmationEmail:!0}):(el&&await this.createDefaultPublication(ep,em),f(e,t))};return(0,s.FD)("div",{className:c()("profile-updater",t),style:J,children:[ed&&(0,s.Y)(x.EY.H4,{align:"left",paddingBottom:20,children:ed}),(ec||r||u)&&(0,s.Y)(_.fI,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,s.Y)(m.U,{user:{photo_url:M||(null==i?void 0:i.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return this.setState({newPhotoUrl:t})}})}),(0,s.FD)(b.Ay,{ref:this.formRef,method:"put",action:"/api/v1/user/profile",prepareData:v,onSuccess:ew,onError:e=>this.onError(e),noInlineErrors:!0,loading:et,autoLock:!0,children:[(0,s.FD)(_.VP,{gap:20,children:[(0,s.FD)(T.A0,{children:[(0,s.Y)(C.sb,{htmlFor:"name",children:Q("Name")}),K?(0,s.Y)("input",{type:"hidden",name:"pub_id",value:K.id}):null,(0,s.Y)(T.ks,{autoFocus:!0,type:"text",className:"profile-name",placeholder:Q("Type your name..."),name:"name",id:"name",value:ep,onInput:e=>{this.setState({newName:e.currentTarget.value})}})]}),eb&&(0,s.FD)(T.A0,{children:[(0,s.Y)(C.sb,{htmlFor:"email",children:Q("Email")}),(0,s.Y)(T.ks,{type:"email",placeholder:Q("Enter your email address..."),name:"email",value:null!=ee?ee:void 0,onInput:e=>{this.setState({newEmail:e.currentTarget.value})}})]}),d&&(0,s.FD)(T.A0,{children:[(0,s.Y)(C.JU,{htmlFor:"handle",children:Q("Handle")}),(0,s.Y)(T.ks,{type:"text",className:"profile-name",placeholder:Q("Type your handle..."),name:"handle",id:"handle",value:eh,onInput:e=>{this.setState({newHandle:e.currentTarget.value})}})]}),!O&&(0,s.FD)(T.A0,{children:[(0,s.Y)(C.JU,{htmlFor:"bio",children:Q("Bio")}),(0,s.Y)(N.T,{placeholder:Q("Say something about yourself..."),name:"bio",id:"bio",value:em,onInput:e=>{this.setState({newBio:e.currentTarget.value})}}),U&&(0,s.Y)(k.EE,{align:"left",children:Q("Tip: this will be shown at the bottom of your guest post")})]}),U&&(0,s.Y)("input",{type:"hidden",name:"needs_bio",value:"true"}),G&&(0,s.FD)(T.A0,{children:[(0,s.Y)(C.Sy,{htmlFor:"social",hint:Q("Optional"),children:Q("Where else can you be found?")}),(0,s.FD)(_.fI,{gap:8,wrap:"wrap",children:[(0,s.Y)(_.fI,{flex:"grow",minWidth:200,children:(0,s.FD)(I.I,{flex:"grow",name:"social",value:eo,onChange:e=>{this.setState({selectedSocial:e.currentTarget.value})},children:[(0,s.Y)(I.K,{children:Q("Select a social network")}),(0,s.Y)("option",{value:"twitter",children:Q("Twitter")}),(0,s.Y)("option",{value:"instagram",children:Q("Instagram")}),(0,s.Y)("option",{value:"tiktok",children:Q("Tiktok")}),(0,s.Y)("option",{value:"linkedin",children:Q("LinkedIn")}),(0,s.Y)("option",{value:"youtube",children:Q("Youtube")})]})}),(0,s.Y)(_.fI,{flex:"grow",minWidth:200,children:(0,s.Y)(T.ks,{flex:"grow",type:"text",placeholder:Q("@yourhandle"),name:"socialHandle",value:er,onInput:e=>{this.setState({selectedSocialHandle:e.currentTarget.value})}})})]})]}),ef&&(0,s.FD)(T.A0,{children:[(0,s.Y)(C.JU,{children:Q("Publication to display")}),(0,s.Y)(S.Z,{padding:12,gap:12,children:D.map((e,t)=>{var i,n;return(0,s.Y)(C.JU,{htmlFor:"primary-radio-".concat(e.id),children:(0,s.FD)(_.fI,{gap:12,alignItems:"center",children:[(0,s.Y)("input",{id:"primary-radio-".concat(e.id),type:"radio",name:"primary_publication_user_id",value:e.id,checked:0===t}),(0,s.Y)(E.Nq,{pub:e.publication,size:24}),(0,s.Y)(x.EY.B3,{as:"span",children:null!=(n=null==(i=e.publication)?void 0:i.name)?n:""})]})})})})]}),ey&&(0,s.FD)(_.Ye,{as:"label",className:L.A.checkbox,gap:8,children:[(0,s.Y)(F.S,{size:"sm",name:"free_signup",defaultChecked:!0,checked:eu,onChange:e=>this.setState({subscribeToNewsletter:e})}),(0,s.Y)(x.EY.B3,{as:"span",children:Q("Subscribe to the newsletter")})]}),eg&&(0,s.FD)(_.Ye,{as:"label",className:L.A.checkbox,gap:8,children:[(0,s.Y)(F.S,{name:"create_publication",id:"create-publication-checkbox",checked:el,onChange:e=>{this.setState({createPublication:e})}}),(0,s.Y)(x.EY.B3,{as:"span",children:Q("Create a Substack publication for me")})]}),(0,s.Y)("input",{type:"hidden",name:"confirmation_redirect_pathname",value:document.location.pathname}),(0,s.Y)("input",{type:"hidden",name:"photo_url",value:null!=ec?ec:void 0}),(0,s.Y)("input",{type:"hidden",name:"user_id",value:(null==i?void 0:i.id)||""}),(0,s.Y)("input",{type:"hidden",name:"needs_photo",value:!!r}),(0,s.Y)("input",{type:"hidden",name:"token",value:h}),H&&(0,s.Y)("input",{type:"hidden",name:"complete",value:!0}),(0,s.FD)("div",{id:"error-container",children:[ei&&(0,s.FD)(x.EY,{as:"div",translated:!0,className:"error other-error",children:["If you have an account with us, we've sent an email to ",(0,s.Y)("b",{children:P.TH.p(null!=ee?ee:"")})," with a link that you can use to sign in."]}),en&&(0,s.Y)("div",{className:"error other-error",children:Q("We have sent you a confirmation email. Please check your inbox before continuing.")})]}),ev&&(0,s.FD)(x.EY.B3,{as:"span",children:[(0,s.Y)(x.Yq,{cursor:"pointer",decoration:"underline",onClick:q,children:V("1 subscription","%1 subscriptions",n)})," ",Q("will be displayed on your profile.")]}),eY&&(0,s.FD)(x.EY.B3,{as:"span",children:[(0,s.Y)(x.Yq,{cursor:"pointer",decoration:"underline",onClick:$,children:V("1 recommendation","%1 recommendations",W)})," ",Q("will be made on your publication.")]})]}),(0,s.FD)(_.VP,{gap:8,children:[!i&&(0,s.Y)(g.az,{className:L.A.tosCheckboxContainer,paddingTop:20,paddingBottom:12,children:(0,s.Y)(A.U,{checked:es,onCheckboxChange:e=>this.setState({tosAccepted:e}),style:{display:"flex"}})}),(0,s.Y)(w.$n,{priority:"primary",disabled:!i&&!es,type:"submit",size:"lg",children:Y||Q("Save")}),j&&(0,s.Y)(w.$n,{priority:"secondary",onClick:j||(()=>{}),children:Q("Skip")})]})]})]})}constructor(e,t){var i;super(e,t),(0,n._)(this,"formRef",void 0),this.formRef=(0,h.createRef)();const a=!!e.isPostInvite||!!e.profileExists;this.state={newName:null,newHandle:null,newBio:null,newEmail:e.user&&e.user.is_magic?e.user.email:null,selectedSocial:"instagram",createPublication:!!e.isPostInvite&&!(null==(i=e.user)?void 0:i.has_publication),tosAccepted:a,subscribeToNewsletter:!0}}}let j=(0,Y.WR)((0,f.wr)(R));function q(e){var{isOpen:t,onClose:i,contributor:n}=e,r=(0,o._)(e,["isOpen","onClose","contributor"]);return(0,s.FD)(D.aF,{isOpen:t,onClose:()=>i(),width:490,children:[(0,s.Y)(D.rQ,{showClose:!0,onClose:()=>i()}),(0,s.Y)(D.cw,{children:n?(0,s.Y)(O,(0,l._)((0,a._)({},r),{user:r.user,pub:r.pub,profile:r.profile,onSuccess:()=>i()})):(0,s.Y)(j,(0,l._)((0,a._)({},r),{onSuccess:()=>i()}))})]})}let O=e=>{let{profile:t,user:i,pub:n,onSuccess:a,isOwnProfile:l}=e,{iString:o}=(0,f.GO)(),[r,u]=(0,h.useState)(null),c=r||t&&t.photo_url,[d,p]=(0,h.useState)(t.name),[Y,v]=(0,h.useState)(t.bio);return(0,s.FD)("div",{className:"profile-updater",children:[(0,s.Y)("h2",{className:"page-title profile-updater-title",children:"Edit contributor profile"}),(0,s.Y)("div",{className:"profile-photo-wrap",children:(0,s.Y)(m.U,{user:{photo_url:r||(null==t?void 0:t.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return u(t)}})}),(0,s.FD)(b.Ay,{method:"patch",action:"/api/v1/publication/users/".concat(t.id),onSuccess:a,autoLock:!0,children:[(0,s.Y)("input",{type:"text",className:"profile-name",placeholder:"Contributor's name…",name:"name",value:d,onInput:e=>{p(e.target.value)}}),(0,s.Y)("textarea",{className:"profile-bio",placeholder:"Contributor's bio…",name:"bio",value:Y,onInput:e=>{v(e.target.value)}}),(0,s.Y)("input",{type:"hidden",name:"photo_url",value:c}),(0,s.FD)("span",{className:"notice",children:[(0,s.FD)(x.EY,{translated:!0,as:"p",children:[(0,s.Y)("b",{children:"Note:"})," This is a contributor profile, viewable by ",P.TH.p(n.name),"'s readers."]}),l&&(0,s.FD)(x.EY,{translated:!0,as:"p",children:["You may also edit your"," ",(0,s.Y)("a",{native:!0,href:"".concat((0,U.gYq)(i)),children:"personal profile"}),"."]})]}),(0,s.Y)(w.$n,{priority:"primary",type:"submit",children:o("Update profile")})]})]})}}}]);