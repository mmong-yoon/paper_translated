"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["484"],{36906:function(e,t,i){i.d(t,{A:()=>n});let n={placeholder:"placeholder-lQYQJg",placeholderMessage:"placeholderMessage-GZJPyX"}},6045:function(e,t,i){i.d(t,{A:()=>n});let n={pubTheme:"pubTheme-yiXxQA",headerTheme:"headerTheme-cI2mYP",footerTheme:"footerTheme-BgBgJ9",footerSecondaryTheme:"footerSecondaryTheme-_7Juj4"}},52050:function(e,t,i){i.d(t,{A:()=>n});let n={selectedSpeaker:"selectedSpeaker-icrBiI",datetimeInput:"datetimeInput-OqKjSC",ticketButton:"ticketButton-_hOigI",ticketButtonContainer:"ticketButtonContainer-A4voWr",formLabel:"formLabel-LFkbuh",columnLabel:"columnLabel-bQ1kce",tabs:"tabs-d40s8L",carouselSection:"carouselSection-gPB50n",viewAll:"viewAll-yqgIin",activeIndicator:"activeIndicator-I76W2t",body:"body-MEXoZj",gridContainer:"gridContainer-cUzqtv",gridElement:"gridElement-yo5ihO",gridContentWide:"gridContentWide-rxBiud",minusPadding:"minusPadding-PaL7bd",header:"header-mDRyAe",upcomingEventsHeader:"upcomingEventsHeader-woqqJt",section:"section-K5XK4J",overviewContent:"overviewContent-XLjjqs",storyFilters:"storyFilters-Lww1a5",eventFilterSidebar:"eventFilterSidebar-HGZH1F",eventFiltersContainer:"eventFiltersContainer-PfCZ51",eventFilters:"eventFilters-Gdxaic",filterDrawer:"filterDrawer-fhVjQs",halfWidth:"halfWidth-O2RF3T",fullWidth:"fullWidth-PjDnZi",gridDrawer:"gridDrawer-HhS2nB",filterLabel:"filterLabel-vseYc7",isOpen:"isOpen-d3Hazm",filterInput:"filterInput-uDsFci",link:"link-yscYw4",caret:"caret-hr8414",collapsed:"collapsed-IIhTt4",presentingSponsorItem:"presentingSponsorItem-IK1Qmj",logoImage:"logoImage-kRUrob",sponsorsSection:"sponsorsSection-BrYna3",presentingSponsors:"presentingSponsors-UxJZOf",associateSponsorItem:"associateSponsorItem-zHyb7w",associateSponsors:"associateSponsors-a_8Uy9",eventSponsors:"eventSponsors-I3hh3z",accentText:"accentText-Jdzypb",clearAll:"clearAll-e_qauL",grid2:"grid2-omt62a",radioButton:"radioButton-YqfUDb",contentBlock:"contentBlock-vCbxlb",thickDivider:"thickDivider-GSdz5t",speakerContainer:"speakerContainer-Cy_jJg",subscribeButton:"subscribeButton-EGn0ZU",authorCard:"authorCard-jki8YU",eventsPreview:"eventsPreview-jo606i",seriesItem:"seriesItem-mdFy9Y",eventsContainer:"eventsContainer-oKPVOv",manifesto:"manifesto-dsJabs",keepReading:"keepReading-ZcGvRV",filterButton:"filterButton-P9_uB2"}},62227:function(e,t,i){i.d(t,{A:()=>n});let n={button:"button-NT7dt3",avatarWithPubLogo:"avatarWithPubLogo-FS3Qv7",avatar:"avatar-mn4drz",pubLogo:"pubLogo-cMWGpU",displayedBadge:"displayedBadge-gAo5ie",pubAvatar:"pubAvatar-QXvrAG",offer:"offer-BpTfs_",unavailable:"unavailable-hONyuw",description:"description-Ca932u",check:"check-lUurJO",disabledCheck:"disabledCheck-I9na7Z",originalPrice:"originalPrice-GLByyh",closeButton:"closeButton-l2SNve"}},23382:function(e,t,i){i.d(t,{A:()=>n});let n={content:"content-G_L5eC",expand:"expand-AIPHFb",collapse:"collapse-KRyDqG"}},18993:function(e,t,i){i.d(t,{Dx:()=>e6,I8:()=>eD,dw:()=>eT,eT:()=>eP,gL:()=>eg,lS:()=>em,mj:()=>tt});var n=i(69277),r=i(70408),a=i(32641),l=i(79785),o=i(10201),s=i(50172),c=i(45994),d=i(32485),u=i.n(d),p=i(95201),h=i.n(p),m=i(99609),g=i(6896),f=i(40972),v=i(54718),b=i(35404),y=i(82853),Y=i(48587),_=i(54687),w=i(98188),C=i(37946),k=i(48686),S=i(16079),I=i(32708),F=i(65892),D=i(87677),T=i(67078),A=i(26683),E=i(73040),N=i(91461),P=i(86404),x=i(66443);i(72880);var L=i(15688),R=i(82936),M=i(84605),B=i(46275),O=i(46271),U=i(88325),j=i(25714),z=i(86500),H=i(27069),W=i(94729),V=i(72569),K=i(68349),q=i(24078),G=i(15040),J=i(35369),$=i(17028),Z=i(88774),Q=i(75303),X=i(81929),ee=i(36372),et=i(3046),ei=i(46647),en=i(69089),er=i(70486),ea=i(42831);i(53457);var el=i(32848),eo=i(20437),es=i(49807),ec=i(11993),ed=i(45464),eu=i(3898),ep=i(36083);function eh(){let e=(0,l._)(["You are not allowed to post or react to this chat. ",""]);return eh=function(){return e},e}function em(e){var t,i,n;let{communityPost:r,author:a,pubRole:l,userStatus:s,extras:d,withAttribution:u,flex:p,hideReply:h,isReadOnly:g,onReply:f,onDelete:v,pub:b,truncate:y=!0,surface:Y,useClientSideRouting:_,utmSource:w,isPaid:C,isFounding:k}=e,{iString:S}=(0,M.GO)(),I=(0,c.li)(null),F=_?(0,es.e$6)({pubId:r.publication_id,postId:r.id,noBase:!0}):(0,es.sWz)({postId:r.id,utm_source:w}),D=(0,ea.d)({entityType:"communityPost",publication:b}),T=(0,R._N)(r.user_id);return(0,o.FD)(eR,{pubThemeAccentColor:null!=(n=null==b||null==(t=b.theme)?void 0:t.background_pop_color)?n:null==b?void 0:b.theme_var_background_pop,pubThemePrintOnPopColor:null==b||null==(i=b.theme)?void 0:i.print_on_pop,user:a,pubRole:l,userStatus:s,flex:p,containerRef:I,extras:d,children:[u&&(0,o.Y)(tt,{text:"From ".concat(a.name,"’s subscriber chat")}),!T&&(0,o.Y)(et.Nf,{user:a}),(0,o.Y)(ev,{actionMenuProps:{communityEntity:r,publicationId:r.publication_id,replyAction:f&&!h&&(0,o.Y)(Z.Dr,{leading:(0,o.Y)(m.A,{}),disabled:r.is_locked,onClick:f,children:S("Reply")}),onReply:g||h||r.is_locked?void 0:f,onDelete:v,onReport:D,isReadOnly:g,isFlagged:r.reported_by_user},flex:p,children:(0,o.Y)(eg,{communityPost:r,hideReply:h,userBlockStatus:T,isFounding:k,isPaid:C,isReadOnly:g,useClientSideRouting:_,utmSource:w,pub:b,truncate:y,surface:Y,author:a})}),!h&&(0,o.Y)(Q.AE,{href:F,children:(0,o.Y)(e6,{onClick:f,direction:"incoming",commenters:r.recent_commenters,count:r.comment_count,hasUnread:!!(r.most_recent_comment_created_at&&r.user_last_viewed_timestamp&&r.user_last_viewed_timestamp<r.most_recent_comment_created_at)})}),!h||r.body||r.link_metadata?(0,o.Y)(et.Xx,{direction:"incoming"}):null]})}function eg(e){let{communityPost:t,hideReply:i,userBlockStatus:a,isReadOnly:l,isFounding:s,isPaid:c,pub:d,surface:p,communityPostEmbedPostId:h,useClientSideRouting:m,utmSource:g,truncate:f,onReply:v,reactionsContext:b,handleReactionClick:y,reaction:Y,reactions:_,backAction:w,outline:C}=e,{images:k,video:S}=ef(t.mediaAttachments),I=!(k.length>0||S),F=null!=b?b:{type:"posts",id:t.id},{audience:D}=t,{canReply:T,shouldShowToken:A}=e5({audience:D,isFounding:s,isPaid:c,chatPaywallStatus:null==d?void 0:d.paywall_chat}),E=(0,er.wA)(),N=m?(0,es.e$6)({pubId:t.publication_id,postId:t.id,noBase:!0,params:{backAction:w}}):(0,es.sWz)({postId:t.id,utm_source:g}),P=function(e,t){if(!e||!(null==t?void 0:t.url))return e;let i=t.url,n=e.trim();return n.startsWith(i)?n.slice(i.length).trim():n.endsWith(i)?n.slice(0,-i.length).trim():e}(t.body,t.link_metadata),L=e=>{"feed-recommended"!==F.type&&(y?y({id:t.id,reaction:e}):eb(t.id,"posts",E,t.reaction)(e))},R=null!=Y?Y:t.reaction,M=null!=_?_:t.reactions,B=p&&(p.startsWith("chat_inbox")?"chat_inbox":(0,U.u)(p));return(0,o.FD)(eZ,{hasFooter:!i,children:[!a&&"media"===t.type&&(k.length>0||S)&&(0,o.FD)(en.e,{context:F,reactions:M,currentReaction:R,onReactionClick:L,isReadOnly:l,children:[S&&(0,o.Y)(eo.R8,{mediaUpload:S.mediaUpload,composing:!1,maxWidth:400,videoPlayerProps:{surface:B,entityType:"community_post",entityKey:t.id,contentType:"communityPost",primaryEntityKey:h,primaryEntityType:h?"post":void 0}},S.mediaUpload.id),k&&(0,o.FD)($.az,{children:[(0,o.Y)(x.K,{assets:k.filter(e=>e.url).map(e=>({src:e.url,explicit:e.explicit,width:e.width,height:e.height})),className:u()(ed.A.imageGroup,i&&!t.body&&ed.A.isLast),maxWidth:400,maxHeight:420,readOnly:l,isContained:!0,outline:C}),A&&!t.body&&(0,o.Y)(e0,{className:ed.A.right,canReply:!!T,audience:t.audience,style:"media"})]})]}),!a&&t.link_metadata&&(0,o.Y)(en.e,{context:F,reactions:M,currentReaction:null!=Y?Y:t.reaction,onReactionClick:L,setReactions:!!(I&&t.link_metadata),isReadOnly:l,alignSelf:"stretch",children:(0,o.Y)(et.ZT,{metadata:t.link_metadata,isFirst:I,direction:"incoming"})}),(t.body||I&&!t.link_metadata)&&(0,o.Y)(en.e,{context:F,reactions:M,currentReaction:null!=Y?Y:t.reaction,onReactionClick:L,setReactions:I&&!t.link_metadata,isReadOnly:l,alignSelf:"stretch",children:P&&(0,o.Y)(Q.AE,{href:N,style:{display:"flex"},children:(0,o.Y)(eX,{publication:d,communityEntity:(0,r._)((0,n._)({},t),{body:P}),onClick:e=>{!e.defaultPrevented&&v&&v(e)},truncate:f,isPaid:c,isFounding:s,outline:C})})})]})}let ef=e=>{let t=[],i=null;for(let n of e)"image"===n.type?t.push(n):i||(i=n);return{images:t,video:i}};function ev(e){let{children:t,actionMenuProps:i,flex:r="grow"}=e;return(0,o.FD)($.Ye,{alignItems:"start",gap:12,flex:r,children:[(0,o.Y)(et.dU,{children:t}),(0,o.Y)(eO,(0,n._)({},i))]})}let eb=(e,t,i,n)=>async r=>{n===r?i(eY(r,e,t)):i(ey(r,e,t,n))},ey=(e,t,i,n)=>async(r,a)=>{let{iString:l,iTemplate:o}=I18N.i("en");r({type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:e}});let s=await (0,A.YD)(e,t,i);if(s instanceof W.fk){var c,d;(null==(c=s.body)?void 0:c.status)==="PUBLICATION_BAN"?alert(o(eh(),null==(d=s.body)?void 0:d.error)):alert(l("We failed post your reaction. Please try again later."))}else(0,H.v)(s,{message:"Failed to add reaction"});s instanceof Error&&r(n?{type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:n}}:{type:"".concat(i,"-remove_reaction"),payload:{id:t,reaction:e}})},eY=(e,t,i)=>async(n,r)=>{n({type:"".concat(i,"-remove_reaction"),payload:{id:t,reaction:e}}),await (0,A.jx)(e,t,i) instanceof Error&&n({type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:e}})};async function e_(e,t){try{return await fetch("/api/v1/community/posts/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function ew(e,t){try{return await fetch("/api/v1/community/comments/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function eC(e,t){try{return await fetch("/api/v1/community/comments/".concat(e,"/publication_bans?ban=").concat(t.toString()),{method:"POST"})}catch(e){return e}}async function ek(e){try{return await (0,W.x6)("/api/v1/community/comments/".concat(e),{method:"DELETE",json:{commentId:e}})}catch(e){return e}}async function eS(e){try{return await (0,W.x6)("/api/v1/community/comments/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eI(e){try{return await (0,W.x6)("/api/v1/community/posts/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eF(e){try{return await (0,W.x6)("/api/v1/community/posts/".concat(e),{method:"DELETE",json:{postId:e}})}catch(e){return e}}function eD(e){let{author:t,extras:i,showReply:a=!0,analyticsParams:l,commenters:s,count:d,audience:u,paywallInfo:p,onClick:h}=e;return(0,c.vJ)(()=>{var e;l&&(0,z.u4)(z.qY.THREAD_PAYWALL_SCREEN_VIEWED,(0,r._)((0,n._)({},l),{audience:u&&("only_founding"===(e=u)?"founding":"only_paid"===e?"paid":"free")}))},[]),(0,o.FD)(eR,{user:t,extras:i,children:[t&&(0,o.Y)(et.Nf,{user:t}),(0,o.FD)(eZ,{children:[p?(0,o.Y)(e9,{audience:u,paywallInfo:p,onClick:h}):(0,o.Y)(e7,{audience:u,onClick:h}),a&&(0,o.Y)(e6,{isLocked:!0,direction:"incoming",commenters:s,count:d,onClick:h})]})]})}function eT(e){let{author:t,extras:i,showReply:n=!0,commenters:r,count:a}=e;return(0,o.Y)(eR,{user:t,extras:i,children:(0,o.FD)(eZ,{children:[(0,o.Y)(e8,{}),n&&(0,o.Y)(e6,{isLocked:!0,direction:"incoming",commenters:r,count:a})]})})}function eA(e){return"string"==typeof e.message}function eE(e){let{text:t,rawText:i,specialText:n,mentionMap:r,direction:a="incoming",limit:l=600,linkify:s=!0}=e,{iString:d}=(0,M.GO)(),[p,h]=(0,c.J0)(!1);if(n)return(0,o.Y)("em",{children:n});if(!t)return(0,o.Y)(o.FK,{});let m=[{characters:t.length,message:t}];i&&r&&(m=function(e,t,i){let n=/\$\{(\d+)\}/g,r=n.exec(e),a=[],l=0;for(;r;){var s,c,d;let u=t[Number(r[1])],p=u.text.slice(1);u?(r.index>l&&a.push({characters:r.index-l,message:e.slice(l,r.index)}),a.push({characters:u.text.length,message:(s=u.user_id,c=p,d=i,(0,o.Y)(j.P,{id:s,label:c,type:"user",unstyled:"outgoing"===d}))})):a.push({characters:n.lastIndex-l,message:e.slice(l,n.lastIndex)}),l=n.lastIndex,r=n.exec(e)}return l<e.length&&a.push({characters:e.length-l,message:e.slice(l)}),a}(i,r,a));let{alwaysShow:g,afterExpansion:f}=function(e,t){let i=0,n=[],r=[];for(let a of e){let e=a;if(i<t){if(i+e.characters>t&&eA(e)){let n=t-i,a={characters:n,message:e.message.slice(0,n)},l={characters:e.characters-n,message:e.message.slice(n)};e=a,r.push(l)}i+=e.characters,n.push(e)}else r.push(e)}return{alwaysShow:n,afterExpansion:r}}(m,l),v=f.length>0;return(0,o.FD)(o.FK,{children:[g.map(e=>s&&eA(e)?(0,o.Y)(eN,{children:e.message}):e.message),v&&!p&&(0,o.FD)(o.FK,{children:[(0,o.Y)("span",{children:" "}),(0,o.Y)(J.Nm,{resetCss:!0,className:u()(ed.A.readMore,ed.A[a]),onClick:e=>{e.preventDefault(),h(!0)},children:d("See more")})]}),v&&p&&(0,o.Y)(o.FK,{children:f.map(e=>s&&eA(e)?(0,o.Y)(eN,{children:e.message}):e.message)})]})}function eN(e){let{children:t}=e;return(0,o.Y)(h(),{options:{attributes:{rel:"nofollow ugc",onClick:e=>e.stopPropagation()},className:ed.A.textLink,format:(e,t)=>"url"===t?(0,ec.H)(e,64):e},children:t})}function eP(e){var{communityComment:t,quoteReply:i,isTargeted:r,isBanned:l,pubRole:s,isNew:c,error:d}=e,u=(0,a._)(e,["communityComment","quoteReply","isTargeted","isBanned","pubRole","isNew","error"]);return(0,o.Y)(ex,(0,n._)({isTargeted:r,isNew:c,comments:[{communityComment:t,quoteReply:i,isBanned:l,pubRole:s,isNew:c,error:d}]},u))}function ex(e){let{comments:t,author:i,isNew:n,chatPublicationId:r,hideReply:a,onReply:l,onNewQuote:c,onQuoteReplyClick:d,onDelete:u,commentRef:p,isTargeted:h,isReadOnly:m,chatAuthorNameAttribution:f,extras:v,flex:b,pub:y}=e,Y=(0,er.wA)(),_=t[t.length-1].communityComment,{reply_count:w=0,recent_commenters:C=[]}=null!=_?_:{},k=(0,ea.d)({entityType:"communityComment",publication:y}),S=!a&&w>0,I=t[0],{communityComment:F}=I;return(0,o.FD)(eR,{user:i,pubRole:t[0].pubRole,containerRef:p,id:"comment-".concat(null==_?void 0:_.id),flex:b,extras:v,children:[f&&(0,o.Y)(tt,{text:"Comment from ".concat(f,"’s subscriber chat")}),(0,o.Y)(ev,{actionMenuProps:{communityEntity:F,isBanned:I.isBanned,isFlagged:F.reported_by_user,replyAction:l&&(0,o.Y)(Z.Dr,{disabled:!!F.is_locked,onClick:l,leading:(0,o.Y)(g.A,{}),children:"Reply in ".concat(0===w?"a new":"","thread")}),onDelete:u,onNewQuote:c,onReport:k,isReadOnly:m,publicationId:r,isNew:n},flex:b,children:(0,o.Y)(eZ,{hasFooter:S,children:t.map((e,i)=>{var n,r;let{communityComment:{id:a,body:c,quote_id:u,media_uploads:p,reactions:g,reaction:f,reported_by_user:v},quoteReply:b,isNew:y,error:_}=e;return(0,o.FD)(s.Fragment,{children:[!y&&!v&&p&&p.length>0&&null===u&&(0,o.FD)(en.e,{context:{type:"comments",id:a},reactions:g,currentReaction:f,onReactionClick:eb(a,"comments",Y,f),isReadOnly:m||y,children:[(0,o.Y)(L.f,{mediaAssets:(null!=p?p:[]).filter(e=>e.media_upload_id).map(e=>({media_upload_id:e.media_upload_id})),surface:"chat_inbox",entityType:"community_comment",entityKey:a,contentType:"communityComment"}),(0,o.Y)(x.K,{assets:p.filter(e=>e.url).map(e=>({src:e.url,explicit:!!e.is_explicit,width:e.image_width,height:e.image_height})),className:ed.A.ImageGrid,maxWidth:400,maxHeight:420,readOnly:m,isContained:!0})]}),c&&(0,o.Y)(en.e,{context:{type:"comments",id:a},reactions:g,currentReaction:f,onReactionClick:eb(a,"comments",Y,f),setReactions:!p||0===p.length,isReadOnly:m||y,children:(0,o.FD)(eQ,{isTargeted:h,onClick:l,children:[b&&(0,o.Y)(e4,{body:b.comment.body,author:null!=(r=null==(n=b.user)?void 0:n.name)?r:"",onClick:d,direction:"outgoing"}),(0,o.Y)(e3,{communityEntity:t[i].communityComment})]})}),_&&(0,o.Y)($.EY.B5,{color:"error",children:"\uDBC0\uDC5F Not delivered."})]},a)})})}),S&&(0,o.Y)(Q.AE,{href:(0,es.e$6)({pubId:F.post_id,postId:F.post_id,commentId:F.id,noBase:!0}),children:(0,o.Y)(e6,{direction:"incoming",commenters:C,count:w,onClick:l})})]})}function eL(e){return void 0===e.post_id}function eR(e){var t;let{user:i,children:n,extras:r,flex:a="grow",containerRef:l,id:s,pubRole:c,userStatus:d,pubThemeAccentColor:p,pubThemePrintOnPopColor:h}=e,m=(0,R._N)(null!=(t=null==i?void 0:i.id)?t:0);return(0,o.FD)($.I1,{id:s,flex:a,gap:2,ref:l,className:u()(eu.A.reactionsHoverZone,ed.A.avatarContainer),children:[(0,o.FD)($.pT,{alignItems:"end",gap:12,children:[(0,o.Y)($.pT,{paddingTop:4,children:m?(0,o.Y)(eM,{user:i}):i?(0,o.Y)(ti,{pubThemeAccentColor:p,pubThemePrintOnPopColor:h,user:i,pubRole:c,userStatus:d,size:32}):(0,o.Y)(eB,{})}),(0,o.Y)($.I1,{flex:"grow",gap:2,position:"relative",alignItems:"start",children:n})]}),r&&(0,o.FD)($.pT,{gap:12,children:[(0,o.Y)($.az,{width:32}),(0,o.Y)($.I1,{flex:"grow",gap:4,children:r})]})]})}function eM(e){let{user:t}=e,i=(0,B.BR)().isOnDestination;return(0,o.Y)(Q.AE,{href:t?(0,es.gYq)(t,{noBase:i}):void 0,children:(0,o.Y)(eB,{children:(0,o.Y)(f.A,{size:20,stroke:"var(--color-fg-tertiary)"})})})}let eB=(0,Q.I4)({radius:"full",width:32,height:32,bg:"secondary"},Q.ov);function eO(e){var{isNew:t}=e,i=(0,a._)(e,["isNew"]);if(t)return null;let{onNewQuote:r,onReply:l,communityEntity:s}=i;return(0,o.FD)($.pT,{alignItems:"center",gap:4,className:ed.A.actions,children:[r&&s&&(0,o.Y)(ej,{onNewQuote:r,communityComment:s}),l&&s&&(0,o.Y)(ez,{onReply:l}),(0,o.Y)(Z.W1,{trigger:(0,o.Y)(J.K0,{"aria-label":"Options",size:"sm",priority:"tertiary",children:(0,o.Y)(v.A,{size:20})}),children:(0,o.Y)(eU,(0,n._)({},i))})]})}function eU(e){let{communityEntity:t,replyAction:i,onDelete:n,onReport:r,isReadOnly:a,publicationId:l,isBanned:s,isFlagged:c,onNewQuote:d}=e,u=(0,O.Jd)(),{isAuthor:p,publicationUser:h}=(0,el.NL)(null!=l?l:0),m=(null==h?void 0:h.role)==="community_moderator",g=l&&p,f=t&&u&&t.user_id===u.id,v=t&&!eL(t),b=v&&"parent_id"in t&&null!==t.parent_id,y=f||g||m,Y=f||g||m,_=!f&&!c,w=(g||m)&&v&&!f,C=!v&&u&&(null==t?void 0:t.user_id)===u.id;return t?(0,o.FD)(o.FK,{children:[(0,o.Y)(eV,{communityEntity:t}),t.body&&(0,o.Y)(eW,{communityEntity:t}),!a&&d&&v&&(0,o.Y)(eH,{onNewQuote:d,communityComment:t}),!a&&i,C&&(0,o.Y)(eq,{communityEntity:t}),(0,o.FD)(Z.H9,{children:[!a&&!b&&Y&&(0,o.Y)(eK,{communityEntity:t}),!a&&y&&(0,o.Y)(e$,{communityEntity:t,onDelete:n}),!a&&void 0!==s&&w&&(0,o.Y)(eJ,{communityEntity:t,isBanned:s}),!a&&_&&(0,o.Y)(eG,{onReport:r,communityEntity:t})]}),(0,o.Y)(Z.NW,{children:(0,o.Y)($.pT,{paddingY:4,children:(0,o.Y)(ei.D,{conjunction:!0,timestamp:t.created_at})})})]}):null}function ej(e){let{onNewQuote:t,communityComment:i}=e;return(0,o.Y)(J.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:()=>{t(i)},children:(0,o.Y)(m.A,{size:20})})}function ez(e){let{onReply:t}=e;return(0,o.Y)(J.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:t,children:(0,o.Y)(m.A,{size:20})})}function eH(e){let{onNewQuote:t,communityComment:i}=e,{iString:n}=(0,M.GO)();return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(m.A,{}),onClick:()=>{t(i)},children:n("Reply")})}function eW(e){let{communityEntity:t}=e,{iString:i}=(0,M.GO)(),n=(0,ee.d)();return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(b.A,{}),onClick:()=>{if(t){let{body:e}=t;(0,K.lW)(e),n.popToast(()=>(0,o.Y)(ee.y,{text:i("Text copied to clipboard"),Icon:b.A}))}},children:i("Copy text")})}function eV(e){let{communityEntity:t}=e,{iString:i}=(0,M.GO)(),n=(0,V.c)(),{id:r}=t,a=eL(t);return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(y.A,{}),onClick:()=>{let e;if(a)e=(0,es.sWz)({postId:r});else if(t.parent_id){var i;e=(0,es.j5y)({commentId:null!=(i=t.parent_id)?i:r,targetReplyId:t.parent_id?r:void 0,showTarget:!0})}else e=(0,es.sWz)({postId:t.post_id,targetReplyId:t.id,showTarget:!0});n(e)},children:i("Copy link")})}function eK(e){let{communityEntity:t}=e,{iString:i}=(0,M.GO)(),n=(0,er.wA)(),r=(0,ee.d)(),{id:a,is_locked:l}=t,s=eL(t),c=async()=>{if(s){let e;n((e=!l,async(t,i)=>{t({type:"posts-lock_replies",payload:{id:a,isLocked:e}});let n=await e_(a,e);n instanceof Error&&(console.warn("error locking post",n),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this post. Please try again later.")),t({type:"posts-lock_replies",payload:{id:a,isLocked:!e}}))}))}else{let e;n((e=!l,async(t,i)=>{t({type:"comments-lock_replies",payload:{id:a,isLocked:e}});let n=await ew(a,e);n instanceof Error&&(console.warn("error locking comment",n),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this comment. Please try again later.")),t({type:"comments-lock_replies",payload:{id:a,isLocked:!e}}))}))}l?r.popToast(()=>(0,o.Y)(ee.y,{text:i("Enabled replies"),Icon:_.A})):r.popToast(()=>(0,o.Y)(ee.y,{text:i("Disabled replies"),Icon:Y.A}))};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(Y.A,{}),onClick:c,priority:"destructive",children:l?i("Re-enable replies"):i("Disable replies")})}function eq(e){let{communityEntity:t}=e,i=(0,er.wA)(),n=eL(t),r=async()=>{n&&i({type:"posts-edit_post",payload:{post:t}})};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(w.A,{}),onClick:r,priority:"primary",children:"Edit"})}function eG(e){let{onReport:t,communityEntity:i}=e,{iString:n}=(0,M.GO)();return(0,o.Y)(o.FK,{children:(0,o.Y)(Z.Dr,{leading:(0,o.Y)(C.A,{}),onClick:()=>{t(i.id,"admin"!==i.user_pub_role)},priority:"destructive",children:n("Report")})})}function eJ(e){let{communityEntity:t,isBanned:i}=e,{iString:n}=(0,M.GO)(),r=(0,er.wA)(),a=async()=>{if(confirm("Are you sure you want to ban this user?")){let e,{id:n}=t;r((e=!i,async(t,i)=>{t({type:"comments-ban_author",payload:{id:n,ban:e}});let r=await eC(n,e);r instanceof Error&&(console.warn("error toggling ban for comment author",r),alert("There was an error ".concat(e?"banning":"unbanning"," this user. Please try again later.")),t({type:"comments-ban_author",payload:{id:n,ban:!e}}))}))}};return(0,o.Y)(Z.Dr,{leading:i?(0,o.Y)(k.A,{}):(0,o.Y)(S.A,{}),onClick:a,priority:"destructive",children:n(i?"Unban":"Ban")})}function e$(e){let{communityEntity:t,onDelete:i}=e,{iString:n}=(0,M.GO)(),r=(0,er.wA)(),a=eL(t),l=async()=>{if(confirm("Are you sure you want to delete this ".concat(a?"thread":"comment","?"))){let{id:e}=t;if(a){let{publication_id:i}=t;r(async(t,n)=>{t({type:"posts-delete_post",payload:{id:e,publication_id:i}});let r=await eF(e);r instanceof Error&&console.warn("error deleting thread",r)})}else{let{post_id:i,parent_id:n}=t;r(async(t,r)=>{t({type:"comments-delete_comment",payload:{id:e,postId:i}});let a=await ek(e);if(a instanceof Error&&console.warn("error deleting comment",a),n){let e=await eS(n);e instanceof Error||t({type:"comments-update_comment",payload:{id:n,comment:e.comment}})}let l=await eI(i);l instanceof Error||t({type:"posts-update_post",payload:{id:i,post:l.communityPost}})})}i&&setTimeout(i,500)}};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(I.A,{}),onClick:l,priority:"destructive",children:n("Delete")})}function eZ(e){var{hasFooter:t}=e,i=(0,a._)(e,["hasFooter"]);return(0,o.Y)($.I1,(0,n._)({className:u()(ed.A.bubbleStack,t&&ed.A.hasFooter),gap:2,alignItems:"start"},i))}function eQ(e){var{isTargeted:t,className:i}=e,r=(0,a._)(e,["isTargeted","className"]);return(0,o.Y)($.I1,(0,n._)({className:u()(ed.A.bubble,t&&ed.A.highlight,i),sizing:"border-box",paddingY:8,paddingX:12,bg:"secondary",minWidth:0,gap:8},r))}function eX(e){let{communityEntity:t,publication:i,isTargeted:n,onClick:r,truncate:a=!0,isPaid:l,isFounding:s,outline:c}=e,{audience:d}=t,{canReply:u,shouldShowToken:p}=e5({audience:d,isFounding:s,isPaid:l,chatPaywallStatus:null==i?void 0:i.paywall_chat}),h=p||t.is_edited,m=t.reactions?Object.keys(t.reactions).length:0;return(0,o.FD)(eQ,{isTargeted:n,onClick:r,className:ep.A[m>0?"reactions-".concat(m):""],outline:c,children:[(0,o.Y)(e3,{communityEntity:t,truncate:a}),h&&(0,o.FD)($.Ye,{justifyContent:"end",gap:2,children:[p&&(0,o.Y)(e0,{canReply:!!u,audience:d}),t.is_edited&&(0,o.Y)(e2,{})]})]})}function e0(e){let{canReply:t,audience:i,style:n="default",showLabel:r=!0,className:a}=e,l=r?"media"===n?"var(--vibrance-primary)":"var(--color-chat-incoming-fg-primary)":"var(--color-fg-primary)";return(0,o.FD)(X.vw,{className:u()(ed.A.paywallReplyTag,"media"===n&&ed.A.media,!r&&ed.A.iconOnly,a),priority:"secondary",children:[t?(0,o.Y)(P.A,{size:12,color:l}):(0,o.Y)(N.A,{size:12,color:l}),r&&(0,o.Y)($.EY.B5,{weight:"medium",children:e1.get(i)})]})}let e1=new Map([["only_paid","Paid subscribers only"],["only_paid_replies","Paid subscriber replies"],["only_founding","Founding members only"],["only_founding_replies","Founding member replies"]]);function e2(){return(0,o.FD)(X.vw,{className:ed.A.paywallReplyTag,priority:"secondary",children:[(0,o.Y)(F.A,{size:12}),(0,o.Y)($.EY.B5,{weight:"medium",children:"Edited"})]})}function e4(e){let{author:t,body:i,direction:n,onClick:r,children:a,isFirst:l=!0,pubThemeBackgroundColor:s,isAuthorContributor:c}=e,d="incoming"===n&&c,p=d&&s;return(0,o.Y)($.pT,{pullX:4,children:(0,o.FD)($.pT,{gap:12,className:u()(ed.A.quote,ed.A[n],!l&&ed.A.notFirst,d&&ed.A.author),onClick:r,radius:"md",overflow:"hidden",padding:8,flex:"grow",style:{"--color-chat-author-bg-overlay":p?"".concat(s,"33"):"oklch(from var(--color-bg-accent-themed) l c h / 0.2)"},children:[(0,o.FD)($.I1,{children:[(0,o.Y)($.EY.B4,{weight:"bold",children:null!=t?t:""}),(0,o.Y)($.EY.B3,{clamp:2,isParagraph:!0,children:i})]}),a]})})}function e3(e){var t,i,n,r,a;let{communityEntity:l,truncate:s=!0}=e,c=null,d=eL(l)?"thread":"reply";l.reported_by_user&&(c="You reported this ".concat(d)),"deleted"!==l.status&&l.body||(c="This ".concat(d," is not available"));let u=(0,R._N)(l.user_id);c||"blocking"!==u?c||"blocked"!==u||(c="This person is blocked"):c="This person blocked you";let p=null!=(t=l.raw_body)?t:l.body;return p?eL(l)&&l.link_url&&!l.link_metadata&&(p="".concat(p,"\n\n").concat(l.link_url).trim()):eL(l)?(null==(n=l.media_assets)?void 0:n.length)?c="".concat(l.media_assets.length," ").concat(l.media_assets.length>1?"photos":"photo","."):l.link_url&&(l.link_metadata?c='Link: "'.concat(l.link_metadata.title,'"'):(p=l.link_url,c=null)):(null==(i=l.media_uploads)?void 0:i.length)&&(c="".concat(l.media_uploads.length," ").concat(l.media_uploads.length>1?"photos":"photo",".")),(0,o.Y)($.EY.B3,{className:ed.A.body,isParagraph:!0,children:(p||c)&&(0,o.Y)(eE,{text:p,rawText:null!=(r=l.raw_body)?r:"",mentionMap:Array.isArray(l.mentions)?void 0:null!=(a=l.mentions)?a:void 0,specialText:c,limit:s?void 0:9999999})})}function e6(e){let{isLocked:t,count:i=0,commenters:n,hasUnread:r,onClick:a,direction:l,outline:s}=e,{iString:c,iPlural:d}=(0,M.GO)();return(0,o.Y)(et.Zh,{isLast:!0,messageDirection:l,onClick:a,cursor:a?"pointer":void 0,height:36,paddingY:4,paddingRight:12,paddingLeft:12,outline:s,children:(0,o.FD)($.pT,{justifyContent:"space-between",alignItems:"center",gap:32,children:[(0,o.FD)($.pT,{alignItems:"center",gap:8,children:[n&&i>0&&(0,o.Y)($.pT,{className:ed.A.facepile,alignItems:"center",children:n.map(e=>(0,o.Y)(q.eu,{className:u()(ed.A.facepileAvatar,"outgoing"===l&&ed.A.outgoing),user:e,size:22}))}),(0,o.Y)($.pT,{gap:8,alignItems:"center",children:(0,o.Y)($.EY.B3,{as:"span",className:r?ed.A.hasUnread:ed.A.noUnread,children:0===i?c("Leave a reply"):d("%1 reply","%1 replies",i)})})]}),t?(0,o.Y)(N.A,{size:14,color:"var(--color-chat-fg-secondary)"}):(0,o.Y)(D.A,{size:20,stroke:r?"var(--color-chat-reply-active)":"var(--color-chat-fg-secondary)"})]})})}function e7(e){let{audience:t,href:i,onClick:n}=e;return(0,o.Y)($.I1,{className:ed.A.paywallBubble,as:i?"a":"div",onClick:n,cursor:n?"pointer":void 0,alignSelf:"stretch",alignItems:"center",justifyContent:"center",bg:"secondary",href:i,target:i?"_blank":void 0,children:(0,o.FD)($.pT,{alignItems:"center",gap:4,children:[(0,o.Y)(T.A,{size:12,stroke:"var(--color-fg-secondary)"}),(0,o.Y)($.EY.Meta,{weight:"semibold",children:"only_founding"===t?"FOUNDING MEMBERS ONLY":"only_paid"===t?"PAID SUBSCRIBERS ONLY":"SUBSCRIBERS ONLY"})]})})}function e8(){return(0,o.Y)($.I1,{className:ed.A.paywallBubble,alignSelf:"stretch",alignItems:"center",justifyContent:"center",bg:"secondary",children:(0,o.FD)($.pT,{alignItems:"center",gap:4,children:[(0,o.Y)(T.A,{size:12,stroke:"var(--color-fg-secondary)"}),(0,o.Y)($.EY.Meta,{weight:"semibold",children:"SUBSCRIBERS ONLY"})]})})}function e5(e){let{audience:t,isFounding:i,isPaid:n,chatPaywallStatus:r}=e,a=["only_founding","only_founding_replies"].includes(t);return{canReply:i||"all_subscribers"===t||n&&["only_paid","only_paid_replies"].includes(t),shouldShowToken:r&&("free"===r&&"all_subscribers"!==t||"paid"===r&&a)}}function e9(e){let{paywallInfo:t,audience:i,onClick:n}=e,{mediaAttachments:r}=t,{body:a}=t,l=r[0];return a||l||(a=[,,,,].fill("Blah blah blah blahhhhh blah.").join(" ")),(0,o.FD)(o.FK,{children:[l&&(0,o.Y)($.I1,{position:"relative",children:(0,o.Y)(x.K,{className:ed.A.ImageGrid,assets:[{src:l.thumb_url,width:l.width,height:l.height,explicit:!1}],maxWidth:400,maxHeight:420,readOnly:!0,isContained:!0,children:(0,o.Y)(te,{className:ed.A.paywallFade,children:(0,o.Y)(e0,{canReply:!1,audience:null!=i?i:"only_paid",style:"media",showLabel:!a,className:a?ed.A.right:ed.A.center})})})}),a&&(0,o.FD)(eQ,{className:ed.A.bubble,onClick:n,children:[(0,o.Y)($.EY.B3,{className:ed.A.paywallText,isParagraph:!0,children:a}),(0,o.Y)(te,{className:u()(ed.A.paywallFade,ed.A.paywallBlur),children:(0,o.Y)($.az,{className:ed.A.paywallReplyTagAbsolute,children:(0,o.Y)(e0,{canReply:!1,audience:null!=i?i:"only_paid",style:"media"})})})]})]})}let te=(0,Q.I4)({position:"absolute",inset:0,alignItems:"center",justifyContent:"center"},Q.VP);function tt(e){let{text:t,isStatic:i}=e;return(0,o.Y)($.pT,{paddingX:8,paddingY:4,children:(0,o.FD)($.EY.B5,{color:"secondary",weight:"semibold",children:[(0,o.Y)(E.A,{strokeWidth:2,height:12,stroke:"#808080",fill:"transparent",isStatic:i})," ",t]})})}function ti(e){let t,{user:i,size:n,pubRole:r,userStatus:a,className:l,disabled:s,pubThemeAccentColor:c,pubThemePrintOnPopColor:d}=e,u=(0,B.BR)().isOnDestination;(null==r?void 0:r.role)==="admin"||(null==r?void 0:r.role)==="contributor"?t="author":(null==r?void 0:r.is_founding)?t="founding":(null==r?void 0:r.membership_state)==="subscribed"&&(t="paid");let p=(0,o.Y)(q.tp,{user:i,size:n,className:l,disabled:s,linkProps:{target:"_blank"},noBase:u});return"author"!==t?(null==a?void 0:a.badge)?(0,o.Y)(G.Pk,{badge:a.badge,children:p}):p:(0,o.Y)(G.w4,{tier:t,fgOverride:d,bgOverride:c,children:p})}},26683:function(e,t,i){i.d(t,{LI:()=>T,Sd:()=>D,YD:()=>M,jx:()=>B});var n=i(69277),r=i(70408),a=i(10201),l=i(50172),o=i(17402),s=i(45994),c=i(32485),d=i.n(c),u=i(78649),p=i(29528),h=i(44518),m=i(46271),g=i(94729),f=i(12501),v=i(35369),b=i(17028),y=i(97515),Y=i(37598),_=i(57820),w=i(40837),C=i(75303),k=i(63136),S=i(66511),I=i(3898);let F=(0,l.createContext)({isLoading:!1,emojis:{suggestedReactionTypes:[],categories:[],reactionTypes:{}}});function D(e){let{children:t}=e,{user:i}=(0,m.ur)(),{result:n,isLoading:r}=(0,f.st)({pathname:"/api/v1/threads/reactions",method:"GET",cacheTtl:6e5,auto:!!i});return(0,a.Y)(F.Provider,{value:{emojis:n,isLoading:r},children:t})}function T(e){let{context:t,reactions:i,currentReaction:n,onReactionClick:r,isReadOnly:l,showCounts:o=!0,maxReactions:c,direction:p}=e,h=i&&Object.keys(i).some(e=>i[e]>0),m=(0,s.li)(null),[g,f]=(0,s.J0)(!1),{emojis:v,isLoading:y}=(0,s.NT)(F),_=(0,s.Kr)(()=>i&&(null==v?void 0:v.reactionTypes)?Object.entries(i).sort((e,t)=>{let[i,n]=e,[r,a]=t;return n===a?i.localeCompare(r):a-n}).filter(e=>{let[t,i]=e;return i>0&&v.reactionTypes[t]}).slice(0,3):[],[i,v]);return(null==v?void 0:v.reactionTypes)?(0,a.Y)(u.Q,{children:(0,a.FD)(b.Ye,{onClick:R,className:d()(I.A.reactionsContainer,{[I.A.show]:h||g,[I.A.outgoing]:"outgoing"===p}),children:[_.map(e=>{let[i,l]=e,s=v.reactionTypes[i],c=i===n||s===n,u=(0,a.FD)(b.Ye,{className:d()(I.A.reaction,{[I.A.selected]:o&&c}),shadow:"sm",bg:"primary",gap:4,alignItems:"center",justifyContent:"center",paddingX:6,onClick:()=>s&&r&&r(i,s),children:[(0,a.Y)(k.EY.B4,{font:"emoji",children:s}),o&&(0,a.Y)(k.EY.Meta,{fontWeight:"bold",color:c?"white":"primary",children:l})]},i);return["feed-recommended","direct-message"].includes(t.type)?u:(0,a.Y)(S.m_,{text:(0,a.Y)(N,{context:t,reaction:i}),side:"bottom",children:u},i)}),!l&&(!c||!n)&&(0,a.Y)(Y.A,{trigger:(0,a.Y)(A,{}),onOpen:()=>f(!0),onClose:()=>f(!1),children:e=>{let{close:t}=e;return(0,a.Y)(E,{emojis:v,isLoading:y,currentReaction:n,onPick:(e,i)=>{r&&r(e,i),t()},inputRef:m})}})]})}):null}let A=(0,o.forwardRef)((e,t)=>(0,a.Y)(v.Nm,(0,r._)((0,n._)({ref:t,resetCss:!0,className:I.A.addReactButton,shadow:"sm",bg:"primary",paddingX:4,alignItems:"center"},e),{children:(0,a.Y)(p.A,{className:I.A.addReactIcon})})));function E(e){var t;let{emojis:n,isLoading:r,currentReaction:l,onPick:o,inputRef:c}=e,d=(0,s.Kr)(()=>(null==n?void 0:n.reactionTypes)&&!r?Object.keys(n.reactionTypes):[],[null==n?void 0:n.reactionTypes,r]),{result:p,isLoading:m}=(0,f.qK)(()=>i.e("4022").then(i.t.bind(i,70405,19)),[],{auto:!0}),g=(0,s.hb)(e=>[e,...(null==p?void 0:p[e])||[]],[p]),{filteredItems:v,setQuery:Y,hasFiltered:C,query:k}=(0,h.S)({items:d,getKeys:g,deps:[d,g]});return(0,a.Y)(u.Q,{children:(0,a.FD)(b.I1,{sizing:"border-box",gap:12,padding:12,minWidth:320,height:400,onClick:R,overflowY:"auto",children:[(0,a.Y)(w.D,{ref:c,onChange:Y}),r||m?(0,a.Y)(b.I1,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,a.Y)(_.y$,{})}):(0,a.FD)(a.FK,{children:[C&&(v&&v.length>0?(0,a.Y)(P,{reactions:v,currentReaction:l,onPick:o,emojiMap:n.reactionTypes,title:null}):(0,a.Y)(y.p,{title:"No results for ".concat(k),description:"Try another search"})),!C&&(0,a.FD)(a.FK,{children:[(0,a.Y)(P,{reactions:n.suggestedReactionTypes,currentReaction:l,onPick:o,emojiMap:n.reactionTypes,title:"Suggested"}),null==(t=n.categories)?void 0:t.map(e=>(0,a.Y)(P,{reactions:e.reactionTypes,currentReaction:l,onPick:o,emojiMap:n.reactionTypes,title:e.title},e.title))]})]})]})})}function N(e){var t;let{reaction:i,context:n}=e,r=["posts","feed-subscribed"].includes(n.type)?"/api/v1/community/posts/".concat(n.id,"/reactions"):"/api/v1/community/comments/".concat(n.id,"/reactions"),{result:a,isLoading:l}=(0,f.st)({pathname:r,method:"GET",auto:!0});if(l)return"Loading...";let o=(null!=(t=null==a?void 0:a.reactions.filter(e=>e.reaction===i))?t:[]).map(e=>e.user.name),s=o.slice(0,6),c=Math.max(0,o.length-6),d=s.join(", ");return c>0?"".concat(d," + ").concat(c," ").concat(1===c?"other":"others"):d}function P(e){let{reactions:t,currentReaction:i,onPick:n,emojiMap:r,title:l}=e;return(0,a.FD)(b.I1,{gap:4,children:[l&&(0,a.Y)(k.EY.B4,{color:"secondary",children:l}),(0,a.Y)(b.az,{className:I.A.emojiGrid,gap:2,alignItems:"center",justifyContent:"center",children:null==t?void 0:t.map(e=>(0,a.Y)(x,{onClick:()=>n(e,r[e]),className:d()(I.A.emojiBox,{[I.A.selected]:e===i}),children:(0,a.Y)(L,{children:r[e]})},e))})]})}let x=(0,C.I4)({bg:"primary",alignItems:"center",justifyContent:"center",radius:"sm",width:32,height:32,cursor:"pointer"},C.fI),L=(0,C.I4)({fontSize:20,lineHeight:20,color:"primary",fontWeight:"medium",font:"emoji"}),R=e=>{e.stopPropagation(),e.preventDefault()};async function M(e,t,i){try{return await (0,g.x6)("/api/v1/community/".concat(i,"/").concat(t,"/reaction"),{method:"POST",json:{reaction:e}})}catch(e){return e}}async function B(e,t,i){try{return await (0,g.x6)("/api/v1/community/".concat(i,"/").concat(t,"/reaction"),{method:"DELETE",query:{reaction:e}})}catch(e){return e}}},36066:function(e,t,i){i.d(t,{A:()=>o});var n=i(10201),r=i(67078),a=i(46137),l=i(3364);let o=e=>{let{audience:t,className:i,size:o=16,isStatic:s,thin:c}=e;return"only_paid"===t?c?(0,n.Y)(l.A,{className:i,height:o,isStatic:s}):(0,n.Y)(r.A,{className:i,size:o}):"founding"===t?(0,n.Y)(a.A,{className:i,height:o,isStatic:s,strokeWidth:1}):null}},28308:function(e,t,i){i.d(t,{DZ:()=>p});var n=i(10201),r=i(32485),a=i.n(r);i(17402);var l=i(15734),o=i.n(l),s=i(3680),c=i(84605),d=i(58418);let u=function(){let{children:e,dismissKey:t,dismissDurationInSeconds:i,beforeDismiss:r,className:l,level:o="info"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[c,u]=(0,d.A)(t,i,r);return c?null:(0,n.FD)("div",{className:a()("banner",o,l),children:[e,(0,n.Y)(s.A,{width:12,height:12,className:"banner-close",onClick:e=>{e.preventDefault(),e.stopPropagation(),u()}})]})},p=e=>{let{}=e,{iString:t}=(0,c.GO)();return(0,n.FD)(u,{level:"coming-soon",dismissKey:"coming-soon-banner.dismissed",beforeDismiss:()=>{o().put("/api/v1/publication_settings").send({seen_coming_soon_explainer:!0})},children:[(0,n.Y)("div",{className:"coming-soon-banner-header",children:t("Welcome to Substack!")}),(0,n.Y)("br",{}),(0,n.Y)("p",{children:t('We\'ve created this "Coming Soon" post for you. To edit it, click the three-dot icon.')}),(0,n.Y)("br",{}),(0,n.Y)("p",{children:t("It's just a placeholder and won't be sent out to your subscribers. To email them, click the \"New Post\" button.")})]})}},89333:function(e,t,i){i.d(t,{Ay:()=>R,Dw:()=>x,NJ:()=>M});var n=i(69277),r=i(70408),a=i(10201),l=i(50180),o=i(56808),s=i(16858),c=i(17402),d=i(15734),u=i.n(d),p=i(78423),h=i(69715),m=i(9486),g=i(41935),f=i(9979),v=i(41873),b=i(86500),y=i(58418),Y=i(66714),_=i(74049),w=i(68349),C=i(89490),k=i(35369),S=i(16074),I=i(76977),F=i(16993),D=i(57820),T=i(63136),A=i(39318),E=i(92967),N=i(57324),P=i(36906);let x=e=>{let[t,i]=(0,c.useState)(null),[n,r]=(0,c.useState)(null),[a]=(0,c.useState)(!0),[l,o]=(0,c.useState)(null),[s,d]=(0,c.useState)(null),p=async()=>{let t=await u().get("/api/v1/video/upload/".concat(e));i(t.body);let{id:a,state:l}=t.body;if(["uploaded","transcoded"].includes(l)&&!n){let{body:{src:e}}=await u().get("/api/v1/video/upload/".concat(a,"/src.json?type=original"));r(e)}},h=async()=>{let{mux_asset:t,mux_preview_asset:i}=(await u().get("/api/v1/video/upload/".concat(e,"/assets"))).body;o(t),d(i)};return(0,c.useEffect)(()=>{p(),h()},[e]),(0,c.useEffect)(()=>{let a=setInterval(()=>{let l=async()=>{let t=await u().get("/api/v1/video/upload/".concat(e)),{id:l,mux_rendition_quality:o,state:s}=t.body;if(i(t.body),o&&clearInterval(a),["uploaded","transcoded"].includes(s)&&!n){let{body:{src:e}}=await u().get("/api/v1/video/upload/".concat(l,"/src.json?type=original"));r(e)}else h()};(null==t?void 0:t.state)==="error"?(console.warn("error creating clip"),clearInterval(a)):(null==t?void 0:t.mux_rendition_quality)?clearInterval(a):l()},5e3);return()=>{clearInterval(a)}},[t]),{mediaUpload:t,loading:a,downloadUrl:n,muxAsset:l,muxPreviewAsset:s}};function L(e){var t;let{pub:i,post:r,mediaUploadId:s,isOpen:d,onClose:u,surface:p}=e,h=(0,c.createRef)(),{mediaUpload:g,downloadUrl:y,muxPreviewAsset:Y}=x(s);(0,c.useEffect)(()=>{s&&(0,b.u4)(b.qY.VIDEO_CLIP_SEEN,{post_id:r.id,clip_id:s,surface:p})},[s]);let L=async()=>{g&&await (0,_.P)(g)},R=()=>{(0,b.u4)(b.qY.VIDEO_CLIP_WATCH_FULL_EPISODE_BUTTON_CLICKED,{name:"watch full episosde",post_id:r?r.id:null,utm_campaign:N._9.substackClips,utm_medium:N.Jn.web,surface:p}),window.history.pushState({},"",(0,A.oRR)(window.location.href,{clipId:void 0,share:void 0})),u()};if(!g)return null;let M=null!==new URL(window.location.href).searchParams.get("share"),B=["uploaded","transcoded"].includes(g.state),O=(0,w.rr)(),U="creating";"error"===g.state?U="error":"transcoded"===g.state?U="transcoded":"uploaded"===g.state?U="uploaded":null!==g.mux_preview_playback_id&&(null==Y?void 0:Y.status)==="ready"&&(U="preview");let j={entityType:"post",entityKey:String(r.id),surface:"editor",contentType:"clip"};return(0,a.FD)(F.aF,{width:640,fullscreenMobile:!0,isOpen:d,onClose:u,children:[(0,a.Y)(F.rQ,{showClose:!0,title:M?"Share Clip":"Clip",onClose:u,description:"✂️ ".concat((0,E.lL)(null!=(t=g.duration)?t:0)," | ").concat(r.title)}),(0,a.FD)(F.cw,{children:["transcoded"===U&&(0,a.Y)(v.A,(0,n._)({ref:h,mediaUpload:g,pub:null!=i?i:null,autoPlay:!1,isClip:!0,videoType:"clip"},j)),"preview"===U&&(0,a.Y)(v.A,(0,n._)({ref:h,mediaUpload:g,pub:null!=i?i:null,autoPlay:!1,isClip:!0,usePreview:!0,videoType:"clip"},j)),"uploaded"===U&&y&&(0,a.Y)("div",{class:"video-player-wrapper",children:(0,a.Y)("div",{class:"video-player",children:(0,a.Y)("video",{src:y,type:"video/mp4",controls:!0})})}),"creating"===U&&(0,a.Y)(I.Ye,{children:(0,a.Y)(I.I1,{className:P.A.placeholder,justifyContent:"center",alignItems:"center",children:(0,a.FD)(I.I1,{justifyContent:"center",alignItems:"center",className:P.A.placeholderMessage,gap:8,children:[(0,a.Y)(D.y$,{}),(0,a.Y)(T.EY.B3,{weight:"bold",children:"Your clip is being processed"}),(0,a.FD)(T.EY.B4,{weight:"medium",color:"secondary",align:"center",children:["Clips may take up to a minute to process. Meanwhile, ",(0,a.Y)("b",{children:"share your clip link below"})]})]})})}),"error"===U&&(0,a.Y)(I.Ye,{children:(0,a.FD)(I.I1,{className:P.A.placeholder,children:[(0,a.Y)(l.A,{stroke:"gray"}),(0,a.Y)(T.EY.B4,{weight:"medium",color:"secondary",children:"Oops! There was an error creating the clip"})]})}),"error"!==U&&(0,a.FD)(I.I1,{paddingTop:16,children:[(0,a.Y)(S.c,{}),(0,a.Y)(C.az,{children:(0,a.FD)(I.Ye,{justifyContent:"space-between",flex:"grow",paddingTop:16,children:[!M&&(0,a.Y)(I.Ye,{children:O?(0,a.Y)(k.K0,{priority:"primary",onClick:R,children:(0,a.Y)(o.A,{})}):(0,a.Y)(k.$n,{priority:"primary",onClick:R,children:"Watch full episode"})}),(0,a.Y)(m.e,{shareUrl:(e,t,n)=>(0,f.x5)(e,{clip:g,post:r,pub:i,medium:n,utm_campaign:t}),pub:i,clip:g,post:r,selectionId:void 0,disabled:!1,disabledInstagram:!B,disabledDownload:!B,onDownloadClick:L,isSharing:M,surface:p})]})})]})]})]})}function R(e){let{post:t,mediaUploadId:i,surface:l}=e,[o,s]=(0,c.useState)(!0),[d,u]=(0,c.useState)(i);(0,c.useEffect)(()=>{let e=()=>{u(new URLSearchParams(window.location.search).get("clipId")),s(!0)};return window.addEventListener("urlchange",e),window.addEventListener("popstate",e),e(),()=>{window.removeEventListener("urlchange",e),window.removeEventListener("popstate",e)}},[]);let{mediaUpload:p,loading:h}=(0,Y.X)({mediaUploadId:d});return!h&&p&&d?(0,a.Y)(L,(0,r._)((0,n._)({},e),{mediaUploadId:d,isOpen:o,onClose:()=>{s(!1),(0,b.u4)(b.qY.VIDEO_CLIP_MODAL_CLOSED,{post_id:null==t?void 0:t.id,clip_id:d,surface:l})}})):null}let M=e=>{var t;let{post:i,mediaUpload:n,disabled:r,style:l,surface:o}=e,[,c]=(0,y.A)(p.h7),{onStartClipping:d}=(0,h.MC)(),u=(null!=(t=null==n?void 0:n.duration)?t:0)>5;return(0,a.Y)(g.fp,{title:u?r?"upgrade in order to watch this video and be able to clip it":"":"can't clip videos shorter than 5 seconds",isDisabled:!u||r,style:l,onClick:()=>{c(),u&&(d({source:"post-ufi",title:null}),(0,b.u4)(b.qY.MEDIA_CLIP_BUTTON_CLICKED,{button:"create",source:"player ufi",surface:o}),(0,b.u4)(b.qY.VIDEO_CLIP_BUTTON_CLICKED,{post_id:i.id,surface:o}))},icon:(0,a.Y)(s.A,{className:"icon",height:(0,g.t2)(l),strokeWidth:g.mV})})}},9486:function(e,t,i){i.d(t,{e:()=>E});var n=i(10201),r=i(32485),a=i.n(r),l=i(82853),o=i(48309),s=i(17402),c=i(68924),d=i(4067),u=i(69277),p=i(70408),h=i(97731);let m=e=>(0,n.Y)(h.A,(0,p._)((0,u._)({},e),{name:"ShareInstagramIcon",svgParams:{height:1e3,width:1e3},children:(0,n.FD)("svg",{width:"1000.0001",height:"1000.0001",viewBox:"0 0 264.58332 264.58332",version:"1.1",id:"svg15",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.FD)("defs",{id:"defs11",children:[(0,n.Y)("radialGradient",{id:"f",cx:"158.429",cy:"578.08801",r:"52.351501",href:"#a",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(0,-4.03418,4.28018,0,-2332.2273,942.2356)",fx:"158.429",fy:"578.08801"}),(0,n.Y)("radialGradient",{href:"#b",id:"g",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(0.67441,-1.16203,1.51283,0.87801,-814.3657,-47.8354)",cx:"172.6149",cy:"600.69238",fx:"172.6149",fy:"600.69238",r:"65"}),(0,n.Y)("radialGradient",{href:"#c",id:"h",cx:"144.01199",cy:"51.3367",fx:"144.01199",fy:"51.3367",r:"67.081001",gradientTransform:"matrix(-2.3989,0.67549,-0.23008,-0.81732,464.9957,-26.4035)",gradientUnits:"userSpaceOnUse"}),(0,n.Y)("radialGradient",{href:"#d",id:"e",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(-3.10797,0.87652,-0.6315,-2.23914,1345.6503,1374.1983)",cx:"199.78841",cy:"628.43793",fx:"199.78841",fy:"628.43793",r:"52.351501"}),(0,n.FD)("linearGradient",{id:"d",children:[(0,n.Y)("stop",{offset:"0","stop-color":"#ff005f",id:"stop1"}),(0,n.Y)("stop",{offset:"1","stop-color":"#fc01d8",id:"stop2"})]}),(0,n.FD)("linearGradient",{id:"c",children:[(0,n.Y)("stop",{offset:"0","stop-color":"#780cff",id:"stop3"}),(0,n.Y)("stop",{"stop-color":"#820bff",offset:"1","stop-opacity":"0",id:"stop4"})]}),(0,n.FD)("linearGradient",{id:"b",children:[(0,n.Y)("stop",{offset:"0","stop-color":"#fc0",id:"stop5"}),(0,n.Y)("stop",{offset:"1","stop-color":"#fc0","stop-opacity":"0",id:"stop6"})]}),(0,n.FD)("linearGradient",{id:"a",children:[(0,n.Y)("stop",{offset:"0","stop-color":"#fc0",id:"stop7"}),(0,n.Y)("stop",{offset:".1242","stop-color":"#fc0",id:"stop8"}),(0,n.Y)("stop",{offset:".5672","stop-color":"#fe4a05",id:"stop9"}),(0,n.Y)("stop",{offset:".6942","stop-color":"#ff0f3f",id:"stop10"}),(0,n.Y)("stop",{offset:"1","stop-color":"#fe0657","stop-opacity":"0",id:"stop11"})]}),(0,n.Y)("clipPath",{id:"clipCircle",children:(0,n.Y)("circle",{cx:"132",cy:"132",r:"132",fill:"#ffffff",stroke:"#000000",id:"circle11"})})]}),(0,n.FD)("g",{"clip-path":"url(#clipCircle)",id:"g15",children:[(0,n.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#e)",transform:"translate(-71.8155,-18.1429)",id:"path11",style:"fill:url(#e)"}),(0,n.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#f)",transform:"translate(-71.8155,-18.1429)",id:"path12",style:"fill:url(#f)"}),(0,n.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#g)",transform:"translate(-71.8155,-18.1429)",id:"path13",style:"fill:url(#g)"}),(0,n.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#h)",transform:"translate(-71.8155,-18.1429)",id:"path14",style:"fill:url(#h)"}),(0,n.Y)("path",{d:"m 132.3452,33.973 c -26.7167,0 -30.0696,0.1167 -40.5629,0.5939 -10.4727,0.4792 -17.6212,2.136 -23.8762,4.567 -6.4701,2.5107 -11.9586,5.8693 -17.4265,11.3352 -5.472,5.464 -8.8332,10.9483 -11.354,17.4116 -2.4389,6.2524 -4.099,13.3976 -4.5703,23.8585 -0.4693,10.4854 -0.5923,13.8379 -0.5923,40.5348 0,26.697 0.1189,30.0371 0.5943,40.5225 0.4817,10.465 2.1397,17.6082 4.5703,23.8585 2.5147,6.4654 5.8758,11.9497 11.3458,17.4136 5.466,5.468 10.9544,8.8349 17.4204,11.3456 6.259,2.4309 13.4097,4.0877 23.8803,4.567 10.4933,0.477 13.8441,0.5938 40.5588,0.5938 26.7188,0 30.0615,-0.1167 40.5547,-0.5939 10.4728,-0.4792 17.6295,-2.136 23.8885,-4.567 6.4681,-2.5106 11.9484,-5.8775 17.4143,-11.3455 5.472,-5.4639 8.8332,-10.9482 11.354,-17.4115 2.4183,-6.2524 4.0784,-13.3976 4.5703,-23.8585 0.4713,-10.4854 0.5943,-13.8277 0.5943,-40.5246 0,-26.697 -0.123,-30.0473 -0.5943,-40.5328 -0.4919,-10.465 -2.152,-17.6081 -4.5703,-23.8584 -2.5208,-6.4654 -5.882,-11.9498 -11.354,-17.4137 C 208.7183,45.0011 203.2462,41.6425 196.77,39.1338 190.4986,36.7029 183.346,35.0461 172.8733,34.5669 162.38,34.0897 159.0394,33.973 132.3145,33.973 Z m -8.825,17.7147 c 2.6193,-0.0041 5.5418,0 8.825,0 26.2659,0 29.379,0.0942 39.7513,0.5652 9.5915,0.4383 14.7971,2.0397 18.2648,3.3852 4.5908,1.7817 7.8638,3.9116 11.3048,7.3521 3.4431,3.4406 5.5745,6.7173 7.3617,11.3046 1.3465,3.461 2.9512,8.6628 3.3877,18.2472 0.4714,10.3625 0.5739,13.4754 0.5739,39.7095 0,26.234 -0.1025,29.347 -0.5739,39.7095 -0.4386,9.5843 -2.0412,14.7861 -3.3877,18.2471 -1.783,4.5874 -3.9186,7.8539 -7.3617,11.2923 -3.443,3.4406 -6.712,5.5704 -11.3048,7.3521 -3.4636,1.3517 -8.6733,2.949 -18.2648,3.3873 -10.3702,0.471 -13.4854,0.5734 -39.7513,0.5734 -26.2679,0 -29.381,-0.1024 -39.7513,-0.5734 -9.5914,-0.4423 -14.797,-2.0438 -18.2668,-3.3893 -4.5908,-1.7817 -7.87,-3.9116 -11.313,-7.3521 -3.4431,-3.4405 -5.5745,-6.709 -7.3617,-11.2985 -1.3465,-3.461 -2.9512,-8.6628 -3.3877,-18.2471 -0.4714,-10.3626 -0.5657,-13.4754 -0.5657,-39.7259 0,-26.2504 0.0943,-29.347 0.5657,-39.7095 0.4386,-9.5844 2.0412,-14.7861 3.3877,-18.2512 1.783,-4.5874 3.9186,-7.8641 7.3617,-11.3046 3.443,-3.4406 6.7222,-5.5704 11.313,-7.3562 3.4677,-1.3517 8.6754,-2.949 18.2668,-3.3894 9.075,-0.4096 12.5919,-0.5324 30.9264,-0.553 z m 61.3363,16.322 c -6.5173,0 -11.805,5.2776 -11.805,11.792 0,6.5125 5.2877,11.7962 11.805,11.7962 6.5172,0 11.8049,-5.2837 11.8049,-11.7962 0,-6.5124 -5.2877,-11.796 -11.805,-11.796 z m -52.5113,13.7826 c -27.8993,0 -50.5191,22.6031 -50.5191,50.4817 0,27.8786 22.6198,50.4714 50.5191,50.4714 27.8993,0 50.511,-22.5928 50.511,-50.4714 0,-27.8786 -22.6137,-50.4817 -50.513,-50.4817 z m 0,17.7147 c 18.109,0 32.7914,14.6694 32.7914,32.767 0,18.0956 -14.6824,32.767 -32.7914,32.767 -18.111,0 -32.7913,-14.6714 -32.7913,-32.767 0,-18.0976 14.6803,-32.767 32.7913,-32.767 z",fill:"#ffffff",id:"path15"})]})]})}));var g=i(49331),f=i(79146),v=i(86500),b=i(35369),y=i(76977),Y=i(16993),_=i(63136);let w="step-Rk40vT",C=e=>{let{isOpen:t,onClose:i,onCopyLinkClick:r,mediaCarousel:a}=e;return(0,s.useEffect)(()=>{t&&(0,v.u4)(v.qY.VIDEO_CLIP_INSTAGRAM_SHARE_MODAL_SEEN,{source:"clip-share-modal"})},[t]),(0,n.FD)(Y.aF,{isOpen:t,onClose:i,fullscreenMobile:!0,children:[(0,n.Y)(Y.rQ,{showClose:!0,onClose:i,title:"Share to Instagram"}),(0,n.Y)(Y.cw,{children:(0,n.FD)(y.I1,{gap:32,children:[(0,n.FD)(y.Ye,{children:[(0,n.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,n.Y)(_.EY.H4,{children:"1"})}),(0,n.Y)(y.Ye,{children:(0,n.FD)(y.I1,{gap:16,children:[(0,n.Y)(_.EY.H4,{children:"Download clip"}),(0,n.Y)(y.I1,{bg:"secondary",radius:"md",border:"detail",children:a})]})})]}),(0,n.FD)(y.Ye,{children:[(0,n.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,n.Y)(_.EY.H4,{children:"2"})}),(0,n.Y)(y.Ye,{children:(0,n.FD)(y.I1,{gap:16,children:[(0,n.FD)(y.I1,{gap:4,children:[(0,n.Y)(_.EY.H4,{children:"Copy a link to the post"}),(0,n.Y)(_.EY.B4,{children:"Add a link to your Instagram story or bio."})]}),(0,n.Y)(y.Ye,{children:(0,n.Y)(b.$n,{priority:"secondary",onClick:()=>r("instagram","substack-clips","social"),trailing:(0,n.Y)(l.A,{}),children:"Copy link"})})]})})]}),(0,n.FD)(y.Ye,{children:[(0,n.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,n.Y)(_.EY.H4,{children:"3"})}),(0,n.Y)(y.Ye,{children:(0,n.Y)(y.I1,{gap:16,children:(0,n.FD)(y.I1,{gap:4,children:[(0,n.Y)(_.EY.H4,{children:"Post from Instagram"}),(0,n.Y)(_.EY.B4,{children:"Visit the Instagram app and share the image with a link to the post. Or share from Instagram on desktop"})]})})})]}),(0,n.Y)(y.Ye,{justifyContent:"end",paddingTop:32,paddingX:16,children:(0,n.Y)(b.$n,{priority:"primary",onClick:i,children:"Done"})})]})})]})};var k=i(9979),S=i(68349),I=i(57820),F=i(36372),D=i(66511),T=i(39318),A=i(49807);function E(e){let{shareUrl:t,pub:i,post:r,clip:u,selectionId:p,disabled:h,disabledInstagram:Y,disabledDownload:_,onDownloadClick:w,isSharing:E,surface:N}=e,P=(0,F.d)(),[x,L]=(0,s.useState)(!1),R=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"substack-clip",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"web";M(e,t,i,e=>((0,S.lW)(e),P.popToast(()=>(0,n.Y)(F.y,{text:"Copied link to clipboard"})),!1))},M=(e,n,a,l)=>{(0,k.Q_)(e,l,{shareUrl:t(e,n,a),post:r,pub:i,selectionId:p,utm_campaign:n,utm_medium:a,event:v.qY.VIDEO_CLIP_SHARE_BUTTON_CLICKED,trackParams:{surface:N}})},B=async()=>{M("facebook","substack-clips","social",e=>(0,A.yRP)("https://www.facebook.com/sharer/sharer.php",{u:e}))},O=async()=>{r&&M("twitter","substack-clips","social",e=>(0,T.gKg)({url:e,text:r.title}))},U=async()=>{M("linkedin","substack-clips","social",e=>(0,A.yRP)("https://www.linkedin.com/sharing/share-offsite/",{url:e}))};return(0,n.FD)(y.Ye,{justifyContent:"space-between",flex:"fill",children:[E?(0,n.Y)(y.Ye,{children:(0,n.Y)(b.$n,{priority:"primary",rounded:!1,onClick:()=>R(),leading:(0,n.Y)(l.A,{size:20}),children:"Copy link"})}):(0,n.Y)("div",{}),(0,n.FD)(y.Ye,{gap:8,children:[(0,n.Y)(D.m_,{text:_?"Your clip will be ready to download shortly":"Download",children:(0,n.Y)(b.K0,{className:a()({"disabledButton-hUWISL":_}),priority:"secondary-outline",onClick:w,disabled:_,children:_?(0,n.Y)(I.y$,{}):(0,n.Y)(o.A,{size:20})})}),!E&&(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:()=>R(),disabled:h,children:(0,n.Y)(l.A,{size:20})}),(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:()=>{(0,k.HT)({shareUrl:t("notes","substack-clips","web"),pub:i,post:r,utm_campaign:"substack-clips"})},disabled:h,children:(0,n.Y)(g.A,{height:24})}),(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:()=>{(0,v.u4)(v.qY.VIDEO_CLIP_SHARE_BUTTON_CLICKED,{name:"instagram",post_id:r?r.id:null,utm_campaign:"substack-clips",utm_medium:"social",surface:N}),L(!0)},disabled:h||Y,children:(0,n.Y)(m,{height:20,width:20})}),(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:O,disabled:h,children:(0,n.Y)(f.A,{height:20,width:20})}),(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:B,disabled:h,children:(0,n.Y)(c.A,{height:20,width:20})}),(0,n.Y)(b.K0,{priority:"secondary-outline",onClick:U,disabled:h,children:(0,n.Y)(d.A,{height:20,width:20})}),(0,n.Y)(C,{isOpen:x,onClose:()=>{L(!1)},onCopyLinkClick:R,mediaCarousel:(0,n.FD)(y.Ye,{gap:16,alignItems:"center",justifyContent:"center",padding:16,position:"relative",children:[(0,n.Y)("img",{src:(0,T.Pzx)(u),width:"300px"}),(0,n.Y)("div",{className:"download-QWI_A5",children:(0,n.Y)(y.Ye,{padding:32,children:(0,n.Y)(b.mZ,{onClick:()=>w&&w(),children:(0,n.Y)(o.A,{size:"16"})})})})]})})]})]})}},96250:function(e,t,i){i.d(t,{D:()=>m});var n=i(10201),r=i(17402),a=i(58471),l=i(23044),o=i(13950),s=i(56778),c=i(86500),d=i(68410),u=i(76977),p=i(63136),h=i(39318);let m=(0,r.memo)(e=>{var t;let{pub:i,user:r,path:l,showIntrinioAttrib:m}=e,{isMobile:f,isTablet:v}=(0,d.sM)(),b="/"===l,y=null==(t=i.theme)?void 0:t.custom_footer,Y=b&&(null==y?void 0:y.backgroundColor),_=(null==y?void 0:y.showPublicationName)&&(null==y?void 0:y.publicationNamePosition)==="bottom",w=(0,n.Y)(g,{pub:i,showIntrinioAttrib:null!=m&&m}),C=(0,n.FD)("div",{className:"footer-wrap compact-footer",children:[(0,n.Y)(s.A,{onVisible:()=>{var e;(0,c.u4)(c.qY.PUBLICATION_FOOTER_SEEN,{publication_id:null==i?void 0:i.id,user_id:null==r?void 0:r.id,source:(e=l)?"/"===e?"pub-homepage":e.startsWith("/p")?"pub-post":e:"unknown"})}}),(0,n.Y)("div",{className:"footer custom-themed-background",children:f||v?(0,n.FD)(u.VP,{alignItems:"center",gap:12,children:[w,(0,n.Y)(a.k,{user:r,size:"sm"}),(0,n.FD)(p.EY,{translated:!0,as:"div",className:"footer-slogan-blurb",children:[(0,n.Y)("a",{href:"".concat((0,h.Ewe)()),native:!0,children:"Substack"})," ","is the home for great culture"]})]}):(0,n.FD)(u.fI,{alignItems:"center",flex:"grow",gap:12,children:[(0,n.Y)(u.fI,{flex:"grow",minWidth:0,nowrap:!0,children:w}),(0,n.Y)(u.fI,{children:(0,n.Y)(a.k,{user:r,size:"sm"})}),(0,n.Y)(u.fI,{flex:"grow",minWidth:0,justifyContent:"end",children:(0,n.FD)(p.EY,{translated:!0,as:"div",className:"footer-slogan-blurb",children:[(0,n.Y)("a",{href:"".concat((0,h.Ewe)()),native:!0,children:"Substack"})," ","is the home for great culture"]})})]})})]});return(0,n.Y)(o.DH,{prefix:Y?_?"footer_secondary":"footer":void 0,children:C})}),g=e=>{let{pub:t,showIntrinioAttrib:i}=e,{isMobile:r,isTablet:a}=(0,d.sM)();return(0,l.PG)(t)?(0,n.FD)(u.pT,{alignItems:r||a?"center":"start",direction:"column",gap:4,children:[(0,n.FD)(u.pT,{alignItems:"center",gap:4,children:[(0,n.Y)(l.d_,{pub:t}),(0,n.Y)(l.TB,{}),(0,n.Y)(l.P0,{pub:t})]}),(0,n.FD)(u.pT,{alignItems:"center",gap:4,children:[(0,n.Y)("span",{children:"Substack"}),i&&(0,n.FD)(n.FK,{children:[(0,n.Y)(l.TB,{}),(0,n.Y)(l.kz,{})]}),(0,n.Y)(l.TB,{}),(0,n.Y)(l.vA,{pub:t})]})]}):(0,n.FD)("span",{children:[(0,n.Y)(l.d_,{pub:t}),i&&(0,n.FD)(n.FK,{children:[(0,n.Y)(l.TB,{}),(0,n.Y)(l.kz,{})]}),(0,n.Y)(l.TB,{}),(0,n.Y)(l.vA,{pub:t})]})}},8853:function(e,t,i){i.d(t,{c:()=>u});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17028),d=i(39891);function u(e){var{src:t,width:i,height:o,sourceFormats:u=["webp"],radius:h,className:m,options:g}=e,f=(0,a._)(e,["src","width","height","sourceFormats","radius","className","options"]);let v=[i,2*i,3*i],b=i/o,y=(0,r._)((0,n._)({crop:"fill"},g),{height:o}),Y="".concat(i,"px"),_=v.map(e=>({width:e,height:Math.floor(e/b)}));return(0,l.FD)("picture",{className:p,children:[u.map(e=>(0,l.Y)("source",{type:"image/".concat(e),srcSet:_.map(i=>{let{width:a,height:l}=i;return"".concat((0,d.dJ)(t,a,(0,r._)((0,n._)({},y),{height:l,format:e}))," ").concat(a,"w")}).join(", ")},e)),(0,l.Y)("img",(0,r._)((0,n._)({src:(0,d.dJ)(t,i,y),srcSet:_.map(e=>{let{width:i,height:a}=e;return"".concat((0,d.dJ)(t,i,(0,r._)((0,n._)({},y),{height:a}))," ").concat(i,"w")}).join(", "),sizes:Y,width:i,height:o},f),{className:s()(m,(0,c.iF)({radius:h}))}))]})}let p=(0,c.iF)({display:"contents"})},23044:function(e,t,i){i.d(t,{P0:()=>s,PG:()=>d,TB:()=>u,d_:()=>l,kz:()=>c,vA:()=>o});var n=i(10201),r=i(85048),a=i(63136);let l=e=>{let{pub:t}=e;return(0,n.FD)("span",{children:["\xa9 ",new Date().getFullYear()," ",(null==t?void 0:t.copyright)||"Substack Inc"]})},o=e=>{let{pub:t}=e;return(0,n.Y)(r.Nf,{publication:t})},s=e=>{let{pub:t}=e;return(0,n.Y)(r.Gf,{pub:t})},c=()=>(0,n.FD)(a.EY,{translated:!0,as:"span",children:["Market data by ",(0,n.Y)("a",{href:"https://intrinio.com/",children:"Intrinio"})]}),d=e=>!!(e.has_custom_tos||e.has_custom_privacy),u=()=>(0,n.Y)("span",{children:" \xb7 "})},52742:function(e,t,i){i.d(t,{V:()=>F});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(48635),d=i(90232),u=i(48697),p=i(48309),h=i(17402),m=i(12791),g=i(84605),f=i(85478),v=i(68349),b=i(89490),y=i(35369),Y=i(76977),_=i(19008),w=i(82439),C=i(57820),k=i(36372),S=i(39318),I=i(37749);function F(e){var{isOpen:t,onClose:i}=e,o=(0,a._)(e,["isOpen","onClose"]);let{iString:s}=(0,g.GO)();return(0,l.FD)(_.h,{isOpen:t,onClose:i,children:[(0,l.Y)(w.l,{title:s("Fullscreen image")}),(0,l.Y)(D,(0,r._)((0,n._)({},o),{isOpen:t,onClose:i}))]})}function D(e){let{modalContent:t=[],onClose:i,step:n,post:r,publication:a,feedItem:o,onLike:c}=e,d=(0,v.rr)(),u=(0,f.mJ)().getConfigFor("enable_image_viewer_ufi"),[p,g]=(0,h.useState)(n),[y,_]=(0,h.useState)(!0),[w,k]=(0,h.useState)(!1),F=(0,h.useCallback)(()=>{0!==p&&g(p-1)},[p]),D=(0,h.useCallback)(()=>{p!==t.length-1&&g(p+1)},[p,t]);(0,h.useEffect)(()=>{t.forEach(e=>{e.attrs.src&&(new Image().src=(0,S.dJ9)(e.attrs.src,void 0,{quality:"auto:good"}))})},[t]),(0,h.useEffect)(()=>{if(!d){let e,t=t=>{(null==t?void 0:t.type)==="keydown"&&(e=>{let{key:t}=e;["ArrowRight","ArrowDown"].includes(t)?(D(),e.stopPropagation()):["ArrowLeft","ArrowUp"].includes(t)&&(F(),e.stopPropagation())})(t),clearTimeout(e),k(!1),e=setTimeout(()=>{k(!0)},2e3)};return window.addEventListener("pointermove",t,{capture:!0,passive:!0}),window.addEventListener("pointerdown",t,{capture:!0,passive:!0}),window.addEventListener("keydown",t,{capture:!0,passive:!0}),t(),()=>{clearTimeout(e),window.removeEventListener("pointermove",t,{capture:!0}),window.removeEventListener("pointerdown",t,{capture:!0}),window.removeEventListener("keydown",t,{capture:!0})}}},[d,p,t,D,F]);let P=t[p];if(!P)return null;let{src:x,alt:L="",title:R=""}=P.attrs;return(0,l.FD)(l.FK,{children:[(0,l.FD)(b.az,{className:s()(I.A.chrome,w&&I.A.hidden),children:[(0,l.Y)(E,{onClick:i}),p<t.length-1&&(0,l.Y)(T,{onClick:D}),p>0&&(0,l.Y)(A,{onClick:F}),(0,l.Y)(N,{title:R,src:x}),u&&(0,l.Y)(m.W,{post:r,publication:a,feedItem:o,onLike:c})]}),(0,l.FD)(Y.ov,{position:"absolute",inset:0,pointerEvents:"none",children:[(0,l.Y)(b.az,{as:"img",className:s()(I.A.img,y&&I.A.loading),onLoad:()=>{_(!1)},onClick:i,alt:null!=L?L:void 0,title:null!=R?R:void 0,src:(0,S.dJ9)(x,void 0,{quality:"auto:good"}),animate:!0}),y&&(0,l.Y)(C.y$,{className:I.A.spinner,theme:"media"})]})]})}function T(e){let{onClick:t}=e,{iString:i}=(0,g.GO)();return(0,l.Y)(P,{className:s()(I.A.right,I.A.middle),onClick:t,"aria-label":i("Next image"),children:(0,l.Y)(c.A,{size:20})})}function A(e){let{onClick:t}=e,{iString:i}=(0,g.GO)();return(0,l.Y)(P,{className:s()(I.A.left,I.A.middle),onClick:t,"aria-label":i("Previous image"),children:(0,l.Y)(d.A,{size:20})})}function E(e){let{onClick:t}=e,{iString:i}=(0,g.GO)();return(0,l.Y)(P,{className:s()(I.A.top,I.A.right),onClick:t,"aria-label":i("Close image viewer"),children:(0,l.Y)(u.A,{size:20})})}function N(e){let{title:t,src:i}=e,{iString:n}=(0,g.GO)(),r=(0,k.d)(),a=async()=>{r.popToast(()=>(0,l.Y)(k.y,{text:n("Downloading image..."),Icon:p.A}));try{await fetch(i).then(async e=>{var t,i,n;let r=null==(n=e.headers.get("Content-Disposition"))||null==(i=n.split("filename="))||null==(t=i[1])?void 0:t.replace(/"/g,"");return{blob:await e.blob(),filename:r}}).then(e=>{let{blob:i,filename:n}=e,r=n?decodeURIComponent(n):null;!r&&(t?(r=t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").trim().slice(0,100)).includes(".")||(r="".concat(r,".jpg")):r="image.jpg");let a=window.URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=r,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(a)})}catch(e){console.error(e)}};return(0,l.Y)(P,{className:s()(I.A.top,I.A.left),onClick:a,"aria-label":n("Download image"),children:(0,l.Y)(p.A,{size:20})})}function P(e){var{children:t,className:i}=e,o=(0,a._)(e,["children","className"]);return(0,l.Y)(y.mZ,(0,r._)((0,n._)({rounded:!0,className:s()(I.A.button,i)},o),{children:t}))}},38959:function(e,t,i){i.d(t,{C:()=>l});var n=i(10201),r=i(13950),a=i(76977);let l=()=>(0,n.Y)(r.DH,{children:(0,n.Y)(a.Ye,{height:56,borderBottom:"detail-themed"})})},58398:function(e,t,i){i.d(t,{Z:()=>Y});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(69715),s=i(9979),c=i(49949),d=i(84605),u=i(10398),p=i(42509),h=i(2675),m=i(8103),g=i(64839),f=i(86500),v=i(76977),b=i(16993),y=i(75303);let Y=e=>{var{isOpen:t,onClose:i,shareUrl:d,post:u,pub:p,profile:h,comments:m,commentId:y,medium:Y="web",utm_campaign:C,referral_token:k,position:S,clippingAllowed:I}=e,F=(0,a._)(e,["isOpen","onClose","shareUrl","post","pub","profile","comments","commentId","medium","utm_campaign","referral_token","position","clippingAllowed"]);let{handleClose:D,internalUtmCampaign:T}=(0,g.W)((0,n._)({isOpen:t,onClose:i,shareUrl:d,post:u,pub:p,profile:h,comments:m,commentId:y,medium:Y,utm_campaign:C,referral_token:k},F)),{onStartClipping:A}=(0,o.MC)(),E="post_share_dropdown",N=m&&y&&m.find(e=>e.id===y),P=N?"comment":p&&!u?"publication":u?"post":h?"profile":void 0;return(0,l.FD)(b.aF,{isOpen:t,onClose:D,children:[(0,l.Y)(_,{type:P,onClose:D}),(0,l.Y)(b.cw,{children:(0,l.FD)(v.VP,{gap:20,children:[(0,l.Y)(w,{type:P,pub:p,post:u,profile:h,comment:N,shareUrl:d}),(0,l.Y)(c.k,(0,r._)((0,n._)({utm_campaign:null!=T?T:C,medium:Y,post:u,pub:p},F),{shareName:(0,s.ZE)({post:u,pub:p,profile:h}),handleOnClipClick:()=>{(0,f.u4)(f.qY.MEDIA_CLIP_BUTTON_CLICKED,{button:"create",source:"post share dropdown",surface:E}),(0,f.u4)(f.qY.VIDEO_CLIP_BUTTON_CLICKED,{post_id:null==u?void 0:u.id,source:S,type:null==u?void 0:u.type,surface:E}),A({source:"post-share-dropdown",title:null}),i()},showClipping:!!I,disableClipping:!I,shareUrl:null!=d?d:(0,s.x5)(null,{medium:Y,post:u,pub:p,profile:h,comments:m,commentId:y,utm_campaign:C,referral_token:k})}))]})})]})};function _(e){let{type:t,onClose:i}=e,{iString:n}=(0,d.GO)();return(0,l.Y)(b.rQ,{title:n(t?"Share this ".concat(t):"Share"),onClose:i,showClose:!0})}let w=e=>{let{type:t,pub:i,post:n,profile:r,comment:a,shareUrl:o}=e;return(0,l.FD)(C,{shareUrl:o,children:["comment"==t&&a&&(0,l.Y)(u.Hr,{comment:a,readOnly:!0}),"post"==t&&n&&i&&(0,l.Y)(h.Sp,{post:n,publication:i,readOnly:!0}),"publication"==t&&i&&(0,l.Y)(m.S,{publication:i,readOnly:!0}),"profile"==t&&r&&(0,l.Y)(p.i,{url:o,readOnly:!0,title:r.name,host:"substack.com",image:r.photo_url}),void 0==t&&(0,l.Y)(p.i,{url:o,readOnly:!0})]})},C=e=>{let{shareUrl:t,children:i}=e,{handleCopyLink:n}=(0,s._m)();return(0,l.Y)(y.AE,{onClick:()=>n({shareUrl:null!=t?t:"#"}),href:null!=t?t:"#",children:i})}},15688:function(e,t,i){i.d(t,{f:()=>u});var n=i(69277),r=i(32641),a=i(10201),l=i(17402),o=i(94729),s=i(76977),c=i(20437);let d=e=>{var{mediaAsset:t}=e,i=(0,r._)(e,["mediaAsset"]);let[n,s]=(0,l.useState)(null);return((0,l.useEffect)(()=>{let e=async e=>{s(await (0,o.x6)("/api/v1/video/upload/".concat(e)))};t.media_upload_id&&e(t.media_upload_id)},[t.media_upload_id]),n)?(0,a.Y)(c.R8,{mediaUpload:n,composing:!1,videoPlayerProps:i}):null},u=e=>{var{mediaAssets:t=[]}=e,i=(0,r._)(e,["mediaAssets"]);return(0,a.Y)(s.VP,{children:t.map(e=>(0,a.Y)(d,(0,n._)({mediaAsset:e},i),e.media_upload_id))})}},4169:function(e,t,i){i.d(t,{b:()=>l});var n=i(10201),r=i(17028),a=i(37316);function l(e){let{containerRef:t,currentTime:i,remainingTime:l,progress:u,onMouseDown:p}=e;return(0,n.FD)(d,{"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":100*u,children:[(0,n.Y)(s,{time:i,textAlign:"left"}),(0,n.FD)(r.fI,{flex:"grow",position:"relative",alignItems:"center",cursor:"pointer",height:12,className:a.A.container,style:{"--progress":"".concat(u)},ref:t,onMouseDown:p,children:[(0,n.Y)(o,{}),(0,n.Y)(c,{})]}),(0,n.Y)(s,{time:l,textAlign:"right"})]})}function o(){return(0,n.Y)(r.fI,{flex:"grow",radius:"full",overflow:"hidden",position:"relative",bg:"tertiary",height:4,children:(0,n.Y)(r.az,{position:"absolute",opacity:90,className:a.A.fill})})}function s(e){let{time:t,textAlign:i}=e;return(0,n.Y)(r.EY.B4,{color:"secondary",minWidth:40,textAlign:i,children:t})}let c=(0,r.I4)({width:12,height:12,radius:"full",shadow:"xs",position:"absolute",className:a.A.playhead}),d=(0,r.I4)({display:"flex",flex:"grow",alignItems:"center",gap:8})},8273:function(e,t,i){i.d(t,{A:()=>c});var n=i(10201),r=i(17402);let a={lenny:[{slug:"lenny-bot",iframe_url:"https://www.delphi.ai/embeddable/config/bd9a8c49-766e-4bb4-8a41-11ecbd8cfb0d",title:"Lenny Bot",description:"Chat with Lenny Bot"}],yourlocalepidemiologist:[{slug:"ask-yle",iframe_url:"https://app.askdewey.co/c/2c22acae-54d4-42eb-bd38-7cdf6c0422c1/chat/new",title:"Ask Your Local Epidemiologist",description:"Chat with Your Local Epidemiologist"}]};var l=i(79909),o=i(13950),s=i(57820);function c(e){var t;let i,{pub:c,slug:d,config:u}=e,[p,h]=(0,r.useState)(!0),m=null!=u?u:(t=c.subdomain,(i=a[t])&&i.find(e=>e.slug===d)||null);return m?(0,n.FD)(o.DH,{children:[(0,n.Y)(l.Metadata,{title:m.title,description:m.description}),(0,n.FD)("div",{className:"pageWrapper-JRNFOD",children:[p&&(0,n.Y)("div",{className:"loadingContainer-RJ6q8J",children:(0,n.Y)(s.y$,{})}),m.iframe_url&&(0,n.Y)("iframe",{src:m.iframe_url,className:"iframe-UZJJEZ",style:{display:p?"none":"block"},onLoad:()=>{h(!1)},title:m.title,referrerPolicy:"no-referrer"})]})]}):null}},41880:function(e,t,i){i.d(t,{$E:()=>p,Ne:()=>Y,Oy:()=>v,Rm:()=>_,U2:()=>h,WZ:()=>b,eo:()=>f,n1:()=>g,u0:()=>m,vC:()=>y});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(15894),s=i(25006),c=i(63136),d=i(4016),u=i(80051);function p(e){var{children:t,paddingBottom:i=8}=e,u=(0,a._)(e,["children","paddingBottom"]);let p=(0,s.df)();return(0,d.lu)({pub:p})?(0,l.Y)(o.T,(0,r._)((0,n._)({},u),{preset:"h4-sans-condensed",style:{paddingBottom:i},children:t})):(0,l.Y)(c.EY.H1,(0,r._)((0,n._)({},u),{style:{paddingBottom:8},children:t}))}function h(e){var{children:t,paddingBottom:i=8}=e,u=(0,a._)(e,["children","paddingBottom"]);let p=(0,s.df)();return(0,d.lu)({pub:p})?(0,l.Y)(o.T,(0,r._)((0,n._)({},u),{preset:"h6-sans",style:{paddingBottom:i},children:t})):(0,l.Y)(c.EY.H2,(0,r._)((0,n._)({style:{paddingBottom:i}},u),{children:t}))}function m(e){var{children:t}=e,i=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,n._)({},i),{preset:"d1-sans-regular",children:t})):(0,l.Y)(c.EY.B1,(0,r._)((0,n._)({},i),{children:t}))}function g(e){var{children:t}=e,i=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,n._)({},i),{color:"tertiary",preset:"detail-small",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,n._)({},i),{color:"secondary",children:t}))}function f(e){var{children:t}=e,i=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,n._)({},i),{preset:"list-item-menu",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,n._)({},i),{children:t}))}function v(e){var{href:t,onClick:i,children:u}=e,p=(0,a._)(e,["href","onClick","children"]);let h=(0,s.df)();return(0,d.lu)({pub:h})?(0,l.Y)(o.T,(0,r._)((0,n._)({},p),{as:"a",href:t,preset:"list-item-menu",onClick:i,style:{textDecoration:"underline",fontWeight:"bold"},color:"blue",native:!0,children:u})):(0,l.Y)(c.EY.B4,(0,r._)((0,n._)({},p),{as:"a",href:t,onClick:i,children:u}))}function b(e){var{children:t}=e,i=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,n._)({},i),{color:"tertiary",preset:"detail-small",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,n._)({},i),{color:"secondary",children:t}))}function y(e){var{children:t}=e,i=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,n._)({},i),{preset:"lg-preview-byline",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,n._)({},i),{color:"secondary",children:t}))}function Y(){return(0,l.Y)("hr",{className:u.A.hrSmall})}function _(){return(0,l.Y)("hr",{className:u.A.hrLarge})}},31793:function(e,t,i){i.d(t,{E:()=>D});var n=i(69277),r=i(70408),a=i(10201),l=i(83673),o=i.n(l),s=i(38970),c=i.n(s),d=i(17402),u=i(15734),p=i.n(u),h=i(89160),m=i(79796),g=i(27428),f=i(95691),v=i(84605),b=i(25006),y=i(46271),Y=i(12501),_=i(68349),w=i(36372),C=i(56458),k=i(4016),S=i(96301),I=i(77124),F=i(39318);let D=()=>{let e=(0,y.Jd)(),t=(0,b.df)(),i=(0,w.d)(),{iString:l}=(0,v.GO)(),[s,u]=(0,d.useState)((null==e?void 0:e.name)||""),[D,T]=(0,d.useState)((null==e?void 0:e.email)||""),[A,E]=(0,d.useState)(!1),[N,P]=(0,d.useState)(!1),[x,L]=(0,d.useState)(null),[R,M]=(0,d.useState)(null),[B,O]=(0,d.useState)(!1),[U,j]=(0,d.useState)(!1),[z]=(0,d.useState)(0),[H,W]=(0,d.useState)(new Set),{ids:V}=(0,m.i)({pub:t}),{ids:K}=(0,m.i)({pub:t,pubSetting:"fp_primary_column_section_ids"}),{ids:q}=(0,I.q)({pub:null!=t?t:void 0}),{ids:G}=(0,f.P)({pub:null!=t?t:void 0}),{ids:J}=(0,g.M)({pub:null!=t?t:void 0}),{ids:$}=(0,h.G)({pub:null!=t?t:void 0}),{result:Z,isLoading:Q,refetch:X}=(0,Y.st)({pathname:"/api/v1/subscription",auto:!0}),{refetch:ee,isLoading:et}=(0,Y.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH"}),{refetch:ei}=(0,Y.st)({pathname:"/api/v1/subscription/email",auto:!1,method:"POST"});(0,d.useEffect)(()=>{!Q&&(null==Z?void 0:Z.email_settings)&&W(new Set(Object.keys(Z.email_settings).filter(e=>{var t;return"individual"===(null==(t=Z.email_settings)?void 0:t[e])}).map(e=>Number(e))))},[Q,Z]);let en=(0,d.useCallback)(async e=>{if(e&&e!==s){E(!0),L(null);try{await p().put("/api/v1/user/profile").send({name:e}),u(e)}catch(e){L((0,_.uX)(e)),console.error("Name update failed:",e)}finally{E(!1)}}},[s]),er=(0,d.useCallback)(async()=>{if(!(null==e?void 0:e.email))return{success:!1};O(!0);try{return await p().post("/api/v1/forgot").send({email:e.email,for_pub:null==t?void 0:t.subdomain,redirect:window.location.pathname}),i.popToast(()=>(0,a.Y)(w.y,{text:"Password reset email sent. Please check your inbox."})),{success:!0}}catch(e){return console.error("Password reset failed:",e),i.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)})),{success:!1}}finally{O(!1)}},[null==e?void 0:e.email,i]),ea=(0,d.useCallback)(async(e,i)=>{if(e&&e!==D){if(e!==i)return void M("Email addresses do not match");P(!0),M(null);try{await p().put("/api/v1/user/email").send({email:e,email_doublecheck:i}),T(e),(0,_.V2)((0,F.bgT)({redirect:"/subscribe?isSignInAttempt=true",for_pub:null==t?void 0:t.subdomain}))}catch(e){var n;(null==(n=e.response)?void 0:n.status)===403?M("This email is already associated with another account"):M((0,_.uX)(e)),console.error("Email update failed:",e)}finally{P(!1)}}},[D]),el=(0,d.useMemo)(()=>t?(0,C.Jh)({pub:t,includeMainPub:!(0,k.lu)({pub:t})}):[],[t]),eo=(0,d.useMemo)(()=>el.filter(e=>{var t,i,n,r;return!q.includes(null!=(t=e.sectionId)?t:-1)&&!G.includes(null!=(i=e.sectionId)?i:-1)&&!J.includes(null!=(n=e.sectionId)?n:-1)&&!$.includes(null!=(r=e.sectionId)?r:-1)}),[el,q,G,J,$]),es=(0,d.useMemo)(()=>{let e=c()(el,"sectionId"),t=[...q,...G].filter(e=>!$.includes(e));return o()(t.map(t=>e[t]))},[el,q,G,$]),ec=(0,d.useCallback)(async(e,i)=>{if(!e||!t)return;let n=new Set(H);i?n.add(e):n.delete(e);try{await ee({json:eo.reduce((t,n)=>(n.sectionId===e&&(t[n.sectionId]={setting:i?"individual":"disabled"}),t),{})}),i&&(null==Z?void 0:Z.email_disabled)&&(await ei({json:{publication_id:t.id,email_disabled:!1,receive_podcast_emails:!0,source:"account_settings"}}),await X()),W(n)}catch(e){console.error("Failed to update newsletter subscription:",e)}},[t,H,eo,ee,ei,Z,X]),ed=(0,d.useCallback)(async(e,i)=>{if(!t)return;let n=[];"fromTheFreePress"===e?n=K:"featured"===e?n=V.filter(e=>!K.includes(e)):"topic"===e?n=eo.filter(e=>!K.includes(e.sectionId||0)&&!V.includes(e.sectionId||0)).map(e=>e.sectionId||0):"video"===e&&(n=es.map(e=>e.sectionId).filter(e=>null!=e));let r=new Set(H);n.forEach(e=>{i?r.add(e):r.delete(e)});try{let e=n.reduce((e,t)=>(e[t]={setting:i?"individual":"disabled"},e),{});await ee({json:e}),i&&(null==Z?void 0:Z.email_disabled)&&(await ei({json:{publication_id:t.id,email_disabled:!1,receive_podcast_emails:!0,source:"account_settings"}}),await X()),W(r)}catch(e){console.error("Failed to update newsletter group:",e)}},[t,K,V,H,ee,ei,Z,X]),eu=(0,d.useCallback)(async()=>{if(t&&e)try{let e=eo.filter(e=>e.sectionId).map(e=>e.sectionId);if(e.length>0){let t=e.reduce((e,t)=>(e[t]={setting:"disabled"},e),{});await ee({json:t})}await ei({json:{publication_id:t.id,email_disabled:!0,receive_podcast_emails:!1,source:"account_settings"}}),await X(),W(new Set),i.popToast(()=>(0,a.Y)(w.y,{text:"Successfully unsubscribed from all emails."}))}catch(e){console.error("Failed to unsubscribe from all emails:",e),i.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}},[t,e,eo,ee,ei,X,i]),ep=(0,d.useCallback)(async()=>{if(confirm(l("Are you sure? Time paid will not be refunded")))try{await p().del("/api/v1/subscription").send({force_now:!0}),i.popToast(()=>(0,a.Y)(w.y,{text:"Subscription cancelled successfully."})),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.error("Failed to delete subscription:",e),i.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}},[l,i]),eh=(0,d.useCallback)(async()=>{j(!0);try{await p().post("/api/v1/subscription/reactivate").send({}),i.popToast(()=>(0,a.Y)(w.y,{text:"Your subscription is set to renew."})),await X()}catch(e){console.error("Failed to set to renew:",e),i.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}finally{j(!1)}},[i,X]),em=c()(eo,"sectionId"),eg=t&&K?{name:"From The Free Press",newsletters:o()(K.map(e=>em[e])).map(e=>(0,r._)((0,n._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)}))}:{name:"From The Free Press",newsletters:[]},ef=t&&K?{name:"All",newsletters:o()(eo.filter(e=>e.sectionId).map(e=>(0,r._)((0,n._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"All",newsletters:[]},ev=t&&V?{name:"Featured",newsletters:o()(V.filter(e=>!K.includes(e)).map(e=>em[e])).map(e=>(0,r._)((0,n._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)}))}:{name:"Featured",newsletters:[]},eb=t&&eo?{name:"Topic Alerts",newsletters:o()(eo.filter(e=>!!e.sectionId&&!K.includes(e.sectionId)&&!V.includes(e.sectionId)).map(e=>(0,r._)((0,n._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"Topic Alerts",newsletters:[]},ey=t&&eo?{name:"Podcast and Video Alerts",newsletters:o()(es.map(e=>(0,r._)((0,n._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"Podcast and Video Alerts",newsletters:[]},eY=(null==Z?void 0:Z.status)==="trialing",e_=null;return eY&&(Z.current_period_end?e_=new Date(1e3*Z.current_period_end):Z.expiry&&(e_=new Date(Z.expiry))),{name:s,email:D,updateName:en,updateEmail:ea,isUpdatingName:A,isUpdatingEmail:N,nameError:x,emailError:R,isSendingReset:B,handlePasswordChange:er,newsletters:{isLoading:Q||et,fromTheFreePress:eg,all:ef,featured:ev,topic:eb,video:ey,updateNewsletter:ec,updateNewsletterGroup:ed,unsubscribeFromAllEmails:eu,pubEmailsDisabled:!!(null==Z?void 0:Z.email_disabled)},plan:null==Z?void 0:Z.plan,totalAmount:null==Z?void 0:Z.totalAmount,currency:null==Z?void 0:Z.currency,isLifetime:(null==Z?void 0:Z.type)==="lifetime"||(null==Z?void 0:Z.never_ends)||!1,isComped:(null==Z?void 0:Z.is_comped)||!1,isTrial:eY,giftCount:z,trialEnd:e_,canChangeSubscription:!!Z&&(0,S.GU)(Z),subscription:null!=Z?Z:void 0,renewing:U,onSetToRenew:eh,onUnsubscribeNow:ep}}},68188:function(e,t,i){i.d(t,{A:()=>c});var n=i(69277),r=i(10201),a=i(32485),l=i.n(a),o=i(17402),s=i(79909);class c extends o.Component{render(){let{html:e,children:t,metadata:i}=this.props;return(0,r.FD)("div",{className:l()("pageContainer-PCEs9w","container-border"),children:[(0,r.Y)(s.Metadata,(0,n._)({},i)),(0,r.Y)("div",{className:"container",children:(0,r.FD)("div",{className:"page typography",children:[t,(0,r.Y)("div",{className:"body markup",dangerouslySetInnerHTML:{__html:e}})]})})]})}}},68924:function(e,t,i){i.d(t,{A:()=>o});var n=i(69277),r=i(70408),a=i(10201),l=i(97731);let o=e=>(0,a.FD)(l.A,(0,r._)((0,n._)({},e),{name:"FacebookIconCircle",svgParams:{height:24,width:24},children:[(0,a.Y)("circle",{cx:"12",cy:"12",r:"11.75",fill:"white",stroke:"none"}),(0,a.Y)("path",{d:"M12 0C5.37098 0 0 5.37089 0 11.9975C0 17.9844 4.38331 22.9414 10.1117 23.8491L10.1164 15.473H7.04998V12.0021H10.1164C10.1164 12.0021 10.1023 10.0269 10.1164 9.14743C10.1305 8.26797 10.3045 7.42142 10.7607 6.65008C11.4615 5.4555 12.5526 4.87237 13.893 4.70775C14.9935 4.57135 16.08 4.72183 17.1664 4.87237C17.2416 4.88176 17.2792 4.89115 17.3545 4.90529C17.3545 4.90529 17.3592 5.03225 17.3545 5.11222C17.3498 5.94933 17.3545 7.86819 17.3545 7.86819C16.8324 7.8588 15.9671 7.80706 15.3933 7.89641C14.4433 8.04221 13.8977 8.64891 13.8789 9.6036C13.8601 10.3467 13.8695 12.0021 13.8695 12.0021H17.2134L16.6726 15.473H13.8742V23.8491C19.612 22.9508 24 17.9844 24 11.9975C23.9953 5.37089 18.6243 0 11.9977 0Z",fill:"#1877f2",stroke:"none"})]}))},4067:function(e,t,i){i.d(t,{A:()=>o});var n=i(69277),r=i(70408),a=i(10201),l=i(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,n._)({},e),{name:"LinkedInShareIcon",svgParams:{height:24,width:24,stroke:"none",viewBox:"0 0 72 72"},children:(0,a.FD)("g",{fill:"none",fillRule:"evenodd",stroke:"none",children:[(0,a.Y)("path",{d:"M36,72 L36,72 C55.882251,72 72,55.882251 72,36 L72,36 C72,16.117749 55.882251,-3.65231026e-15 36,0 L36,0 C16.117749,3.65231026e-15 -2.4348735e-15,16.117749 0,36 L0,36 C2.4348735e-15,55.882251 16.117749,72 36,72 Z",fill:"#007EBB"}),(0,a.Y)("path",{d:"M59,57 L49.959375,57 L49.959375,41.6017895 C49.959375,37.3800228 48.3552083,35.0207581 45.0136719,35.0207581 C41.3785156,35.0207581 39.4792969,37.4759395 39.4792969,41.6017895 L39.4792969,57 L30.7666667,57 L30.7666667,27.6666667 L39.4792969,27.6666667 L39.4792969,31.6178624 C39.4792969,31.6178624 42.0989583,26.7704897 48.3236979,26.7704897 C54.5455729,26.7704897 59,30.5699366 59,38.4279486 L59,57 Z M20.372526,23.8257036 C17.4048177,23.8257036 15,21.4020172 15,18.4128518 C15,15.4236864 17.4048177,13 20.372526,13 C23.3402344,13 25.7436198,15.4236864 25.7436198,18.4128518 C25.7436198,21.4020172 23.3402344,23.8257036 20.372526,23.8257036 Z M15.8736979,57 L24.958724,57 L24.958724,27.6666667 L15.8736979,27.6666667 L15.8736979,57 Z",fill:"#FFF",stroke:"none"})]})}))},36534:function(e,t,i){i.d(t,{A:()=>o});var n=i(69277),r=i(70408),a=i(10201),l=i(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,n._)({},e),{name:"PlayIcon",svgParams:{height:43,width:35},children:(0,a.Y)("path",{d:"M34.428 20.819C34.8483 21.0821 34.8483 21.7121 34.428 21.9752L1.74924 42.4349C1.3132 42.7079 0.755859 42.3835 0.755859 41.8568V0.937387C0.755859 0.410635 1.3132 0.0862969 1.74925 0.359298L34.428 20.819Z"})}))},49331:function(e,t,i){i.d(t,{A:()=>o});var n=i(69277),r=i(70408),a=i(10201),l=i(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,n._)({},e),{name:"ShareSubstackIcon",svgParams:{height:24,width:24,viewBox:"0 0 24 24",stroke:"none"},children:(0,a.Y)("path",{d:"M21.6608 8.55517H2.33838V5.9555H21.6617V8.55517H21.6608ZM2.33838 10.911V23L12 17.6008L21.6617 23V10.911H2.33838ZM21.6617 1H2.33838V3.59967H21.6617V1Z",fill:"var(--color-semantic-substack-bg-primary)",stroke:"none"})}))},79146:function(e,t,i){i.d(t,{A:()=>o});var n=i(69277),r=i(70408),a=i(10201),l=i(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,n._)({},e),{name:"ShareTwitterIcon",svgParams:{height:24,width:24,stroke:"none"},children:(0,a.Y)("path",{d:"M17.7508 2.96069H20.8175L14.1175 10.619L22 21.0382H15.8283L10.995 14.7182L5.46333 21.0382H2.395L9.56167 12.8465L2 2.96153H8.32833L12.6975 8.73819L17.7508 2.96069ZM16.675 19.2032H18.3742L7.405 4.69986H5.58167L16.675 19.2032Z",fill:"var(--color-fg-primary)",stroke:"none"})}))},60745:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"BlueskyIcon",svgParams:{viewBox:"0 0 600 600"},width:t,height:t,fill:i,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"})}))}},49031:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"FacebookIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:i,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"})}))}},34581:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"LinkedInIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:i,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"M18.5195 0H1.47656C0.660156 0 0 0.644531 0 1.44141V18.5547C0 19.3516 0.660156 20 1.47656 20H18.5195C19.3359 20 20 19.3516 20 18.5586V1.44141C20 0.644531 19.3359 0 18.5195 0ZM5.93359 17.043H2.96484V7.49609H5.93359V17.043ZM4.44922 6.19531C3.49609 6.19531 2.72656 5.42578 2.72656 4.47656C2.72656 3.52734 3.49609 2.75781 4.44922 2.75781C5.39844 2.75781 6.16797 3.52734 6.16797 4.47656C6.16797 5.42188 5.39844 6.19531 4.44922 6.19531ZM17.043 17.043H14.0781V12.4023C14.0781 11.2969 14.0586 9.87109 12.5352 9.87109C10.9922 9.87109 10.7578 11.0781 10.7578 12.3242V17.043H7.79688V7.49609H10.6406V8.80078H10.6797C11.0742 8.05078 12.043 7.25781 13.4844 7.25781C16.4883 7.25781 17.043 9.23438 17.043 11.8047V17.043Z"})}))}},38685:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"XIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:i,children:(0,l.Y)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M13.2879 19.1666L8.66337 12.575L2.87405 19.1666H0.424805L7.57674 11.0258L0.424805 0.833252H6.71309L11.0717 7.04577L16.5327 0.833252H18.982L12.1619 8.59699L19.5762 19.1666H13.2879ZM16.0154 17.3083H14.3665L3.93176 2.69159H5.58092L9.7601 8.54422L10.4828 9.55981L16.0154 17.3083Z"})}))}},14701:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 26 26"},width:t,height:t,stroke:"none",fill:i,children:(0,l.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.82184 6.14159C7.56025 6.78804 7.4162 7.49464 7.4162 8.23489C7.4162 9.09949 7.61271 9.91819 7.9635 10.6488C8.60389 10.4676 9.27965 10.3706 9.97806 10.3706C10.1536 10.3706 10.3278 10.3767 10.5003 10.3888C10.6996 9.28561 11.1441 8.26769 11.7752 7.39342C10.8114 6.60183 9.57792 6.12665 8.23342 6.12665C8.09499 6.12665 7.95774 6.13168 7.82184 6.14159ZM5.77711 6.69453C5.67168 7.19136 5.6162 7.70664 5.6162 8.23489C5.6162 9.34746 5.86227 10.4026 6.30295 11.3487C5.04556 12.0717 4.02116 13.1542 3.37011 14.456C2.91142 13.6453 2.64961 12.7084 2.64961 11.7105C2.64961 9.50798 3.92478 7.60333 5.77711 6.69453ZM6.62812 4.50164C3.32204 5.23459 0.849609 8.18379 0.849609 11.7105C0.849609 13.5781 1.54303 15.2838 2.68647 16.5842C2.62578 16.9653 2.59425 17.3562 2.59425 17.7544C2.59425 21.8324 5.9001 25.1382 9.97806 25.1382C11.0364 25.1382 12.0427 24.9156 12.9527 24.5146C13.8703 24.9237 14.8868 25.1511 15.9565 25.1511C20.0344 25.1511 23.3403 21.8453 23.3403 17.7673C23.3403 17.3869 23.3115 17.0133 23.256 16.6484C24.4334 15.3402 25.15 13.609 25.15 11.7105C25.15 8.18398 22.6778 5.23491 19.372 4.50176C18.0895 2.31749 15.716 0.851074 13 0.851074C10.2841 0.851074 7.91059 2.31743 6.62812 4.50164ZM8.97613 4.36354C10.502 4.51594 11.8911 5.13289 12.9998 6.07089C14.1086 5.1328 15.4978 4.51583 17.0239 4.36349C16.008 3.30789 14.5807 2.65107 13 2.65107C11.4193 2.65107 9.99198 3.30791 8.97613 4.36354ZM18.1782 6.14162C18.0422 6.1317 17.9047 6.12665 17.7661 6.12665C16.4217 6.12665 15.1881 6.60183 14.2244 7.39342C14.8571 8.26995 15.3022 9.29088 15.5008 10.3974C15.6515 10.3882 15.8034 10.3835 15.9565 10.3835C16.6738 10.3835 17.3673 10.4858 18.0231 10.6766C18.3823 9.93902 18.5838 9.11049 18.5838 8.23489C18.5838 7.49466 18.4398 6.78807 18.1782 6.14162ZM16.872 12.2582C16.5741 12.2091 16.2683 12.1835 15.9565 12.1835C15.8373 12.1835 15.7189 12.1873 15.6016 12.1946C15.5866 12.4264 15.5609 12.6552 15.525 12.8807C15.5917 12.9565 15.6569 13.0338 15.7205 13.1123C16.1408 12.8774 16.5276 12.5897 16.872 12.2582ZM16.6751 14.6406C17.456 14.1916 18.147 13.6039 18.7146 12.9112C19.918 13.5961 20.8419 14.7155 21.2731 16.0559C20.3145 16.8304 19.0945 17.2943 17.7661 17.2943C17.6251 17.2943 17.4852 17.289 17.3468 17.2788C17.2872 16.341 17.0525 15.4508 16.6751 14.6406ZM14.6053 15.4437C14.7432 15.4131 14.8797 15.3787 15.0146 15.3405C15.2344 15.7983 15.3936 16.2906 15.4819 16.8072C15.0272 16.6031 14.6048 16.3399 14.2244 16.0275C14.3602 15.8394 14.4874 15.6446 14.6053 15.4437ZM13.5397 13.4538C13.5008 13.5722 13.4581 13.689 13.4116 13.8038C13.2757 13.8137 13.1384 13.8187 13 13.8187C12.8614 13.8187 12.724 13.8136 12.588 13.8037C12.5373 13.6787 12.4911 13.5513 12.4495 13.4219C12.6177 13.286 12.794 13.1597 12.9774 13.0437C13.1735 13.1688 13.3613 13.3059 13.5397 13.4538ZM12.9818 11.0072C13.2248 10.9001 13.4747 10.8057 13.7305 10.725C13.6069 10.0305 13.3548 9.3804 12.9998 8.80019C12.6435 9.3825 12.3909 10.0352 12.2677 10.7325C12.5116 10.8119 12.7499 10.9038 12.9818 11.0072ZM10.3974 12.1861C10.259 12.1758 10.1191 12.1706 9.97806 12.1706C9.68186 12.1706 9.39103 12.1937 9.1073 12.2381C9.44659 12.5681 9.82768 12.8553 10.2419 13.0911C10.3148 13.0021 10.3897 12.9149 10.4666 12.8294C10.4344 12.6178 10.4112 12.4032 10.3974 12.1861ZM9.27818 14.6135C8.50368 14.1606 7.81907 13.5707 7.25761 12.877C6.04543 13.5545 5.11183 14.6709 4.67178 16.0111C5.63842 16.8125 6.87966 17.2943 8.23342 17.2943C8.35261 17.2943 8.47093 17.2905 8.58827 17.2832C8.64976 16.3331 8.89095 15.432 9.27818 14.6135ZM10.4498 16.8371C10.5392 16.3038 10.7042 15.7962 10.9334 15.3256C11.085 15.3697 11.2387 15.4091 11.3942 15.4436C11.5121 15.6445 11.6393 15.8393 11.7752 16.0275C11.3759 16.3554 10.9304 16.6291 10.4498 16.8371ZM8.68906 19.0804C8.53836 19.0896 8.38643 19.0943 8.23342 19.0943C6.82992 19.0943 5.51788 18.7027 4.40059 18.0228C4.54064 20.982 6.98419 23.3382 9.97806 23.3382C10.3286 23.3382 10.6715 23.3059 11.0041 23.2442C9.81887 22.1718 8.98334 20.72 8.68906 19.0804ZM12.9571 22.478C11.6671 21.6549 10.7378 20.3165 10.4593 18.7528C11.4019 18.4552 12.2628 17.9735 12.9998 17.35C13.7201 17.9595 14.5588 18.4334 15.4765 18.7324C15.1983 20.3075 14.2597 21.6548 12.9571 22.478ZM14.9067 23.2526C15.2467 23.3173 15.5976 23.3511 15.9565 23.3511C18.9412 23.3511 21.379 21.0093 21.5326 18.0627C20.4299 18.718 19.1419 19.0943 17.7661 19.0943C17.5906 19.0943 17.4164 19.0881 17.2439 19.0761C16.9463 20.7231 16.1024 22.18 14.9067 23.2526ZM22.5911 14.5228C21.9495 13.2133 20.9316 12.1216 19.6783 11.3888C20.1308 10.4323 20.3838 9.36317 20.3838 8.23489C20.3838 7.70673 20.3284 7.19153 20.223 6.69479C22.075 7.60369 23.35 9.50818 23.35 11.7105C23.35 12.736 23.0735 13.6969 22.5911 14.5228Z"})}))}},14647:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,stroke:"none",fill:i,children:(0,l.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0436 3.51174C14.4213 1.66968 17.8438 1.81108 20.0161 3.98341C22.1882 6.15552 22.3297 9.5776 20.4883 11.9552C22.308 14.3248 22.1043 17.7443 19.9244 19.9242C17.7446 22.104 14.3255 22.3079 11.956 20.4885C9.57839 22.3299 6.1564 22.1883 3.98435 20.0162C1.8125 17.8443 1.67073 14.4227 3.51158 12.0451C1.69209 9.67557 1.89593 6.25627 4.07573 4.07643C6.25532 1.8968 9.67415 1.69278 12.0436 3.51174ZM10.7862 4.82251C9.14237 3.68439 6.84468 3.85303 5.34853 5.34921C3.8523 6.84546 3.68371 9.14337 4.822 10.7873C6.30674 9.7329 8.15567 9.41636 9.84859 9.84842C9.41641 8.15584 9.73255 6.30722 10.7862 4.82251ZM6.19444 12.0422C7.5081 11.2786 9.12685 11.2691 10.425 12.0048C9.11132 12.7684 7.49256 12.7779 6.19444 12.0422ZM4.82075 13.3014C3.6397 14.9746 3.79215 17.2784 5.25715 18.7435C6.72233 20.2087 9.02649 20.361 10.6997 19.1794C9.66398 17.7076 9.37248 15.8727 9.81462 14.1861C8.12786 14.6285 6.29279 14.3372 4.82075 13.3014ZM11.9587 17.8054C11.2232 16.5075 11.2326 14.8891 11.9957 13.5756C12.7312 14.8735 12.7218 16.4919 11.9587 17.8054ZM13.2136 19.178C14.8575 20.3162 17.1553 20.1477 18.6516 18.6514C20.1479 17.155 20.3164 14.8568 19.1778 13.2128C17.6931 14.2668 15.8445 14.5832 14.1519 14.1512C14.5841 15.8441 14.2678 17.6931 13.2136 19.178ZM17.805 11.958C16.4917 12.7209 14.8738 12.7303 13.5761 11.9952C14.8894 11.2324 16.5073 11.2229 17.805 11.958ZM19.1791 10.6991C20.3608 9.02581 20.2085 6.72146 18.7433 5.25619C17.2779 3.79079 14.9733 3.63863 13.3 4.82071C14.3361 6.29264 14.6277 8.1277 14.1855 9.81454C15.8722 9.37211 17.7071 9.66343 19.1791 10.6991ZM12.0413 6.19502C12.7767 7.49269 12.7676 9.1108 12.0048 10.4243C11.2694 9.12658 11.2786 7.50848 12.0413 6.19502Z"})}))}},20713:function(e,t,i){i.d(t,{A:()=>s});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(97731);let s=e=>{var{size:t=24,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,n._)({},s),{name:"CommentBadgeStarIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:i,children:(0,l.Y)("path",{stroke:"none",d:"M5.29389 16.7794C5.1238 16.6496 5.02086 16.4773 4.98505 16.2625C4.94924 16.0521 4.97834 15.8081 5.07233 15.5306L6.43525 11.4822L2.95746 8.99133C2.71576 8.81677 2.54568 8.6355 2.44721 8.44751C2.35322 8.25505 2.34203 8.05587 2.41364 7.84998C2.48078 7.64856 2.60834 7.49862 2.79633 7.40015C2.98432 7.30168 3.22602 7.25468 3.52143 7.25916L7.79145 7.28601L9.08722 3.21069C9.17674 2.92871 9.29759 2.71387 9.44977 2.56616C9.60195 2.41398 9.78323 2.33789 9.9936 2.33789C10.2084 2.33789 10.392 2.41398 10.5441 2.56616C10.6963 2.71387 10.8172 2.92871 10.9067 3.21069L12.2025 7.28601L16.4658 7.25916C16.7656 7.25468 17.0096 7.30168 17.1976 7.40015C17.3856 7.49862 17.5131 7.64856 17.5803 7.84998C17.6519 8.05587 17.6385 8.25505 17.54 8.44751C17.446 8.6355 17.2781 8.81677 17.0364 8.99133L13.5587 11.4822L14.9216 15.5306C15.0156 15.8081 15.0447 16.0521 15.0089 16.2625C14.973 16.4773 14.8701 16.6496 14.7 16.7794C14.5255 16.9092 14.3308 16.9562 14.1159 16.9204C13.9055 16.8846 13.6817 16.7794 13.4445 16.6049L9.9936 14.0737L6.54938 16.6049C6.31216 16.7794 6.08613 16.8846 5.87128 16.9204C5.66091 16.9562 5.46845 16.9092 5.29389 16.7794Z"})}))}},69990:function(e,t,i){i.d(t,{M:()=>en});var n=i(69277),r=i(70408),a=i(10201),l=i(32485),o=i.n(l),s=i(17402),c=i(45773),d=i(80697),u=i(74919),p=i(72880),h=i(15894),m=i(79796),g=i(25006),f=i(17306),v=i(68410),b=i(76977),y=i(63136),Y=i(4016),_=i(39318),w=i(98949);let C={containerFP:"containerFP-Ndac1V",containerFp:"containerFP-Ndac1V",name:"name-mkZ7O7",imgFP:"imgFP-nsipp_",imgFp:"imgFP-nsipp_",toggleBox:"toggleBox-FyAfgO",selected:"selected-bOtT9y",previewLink:"previewLink-nVh1jb",img:"img-tyGf_Q",container:"container-Yff188",selectableContainer:"selectableContainer-nkPfNo",selectedContainer:"selectedContainer-jizK_g",clickableContainer:"clickableContainer-BH19PC",containerMobile:"containerMobile-MaSyfh",imgMobile:"imgMobile-afxbEf",selector:"selector-x5tcGg",unselected:"unselected-B90yNk",seeLatest:"seeLatest-OQwW6G"},k=e=>{var t,i,n,r,l;let{newsletter:s,hideLink:c=!1,onToggle:d,onClick:p,isTopicAlert:h=!1}=e,f=(0,g.df)(),{metadata:v}=(0,m.i)({pub:f}),{metadata:k}=(0,m.i)({pub:f,pubSetting:"fp_primary_column_section_ids"});p&&d&&console.error("you cannot pass both onToggle and onClick");let F=!!d;if((0,Y.lu)({pub:f}))return(0,a.Y)(S,{newsletter:s,onClick:p,onToggle:d,isTopicAlert:h});if((0,w.Fr)())return(0,a.Y)(I,{newsletter:s,hideLink:c,onClick:p,onToggle:d});let D=null!=(l=null==(t=v[null!=(n=s.sectionId)?n:-1])?void 0:t.frequency)?l:null==(i=k[null!=(r=s.sectionId)?r:-1])?void 0:i.frequency;return(0,a.FD)(b.I1,{className:o()(C.container,{[C.selectedContainer]:F&&s.selected,[C.selectableContainer]:F,[C.clickableContainer]:!!p}),justifyContent:"space-between",radius:"md",padding:16,onClick:F?e=>{e.stopPropagation(),null==d||d({sectionId:s.sectionId,isSelected:!s.selected})}:null!=p?p:void 0,children:[F&&s.selected?(0,a.Y)(u.A,{className:o()(C.selector)}):F?(0,a.Y)("div",{className:o()(C.unselected,C.selector)}):null,(0,a.FD)(b.I1,{gap:24,children:[s.logoUrl&&(0,a.Y)("div",{className:C.img,children:s.logoUrl&&(0,a.Y)("img",{className:C.img,src:(0,_.dJ9)(s.logoUrl,64)})}),(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(y.EY.H3,{paddingRight:32*!s.logoUrl,weight:"semibold",color:"pub-primary-text",clamp:2,children:[s.name,D&&(0,a.FD)(a.FK,{children:[(0,a.Y)("br",{}),(0,a.Y)(y.EY.B4,{color:"secondary",weight:"semibold",children:D})]})]}),(0,a.Y)(y.EY.B4,{color:"pub-secondary-text",clamp:4,children:s.description})]})]}),!c&&(0,a.Y)(y.EY,{size:14,weight:"semibold",font:"text",color:"pub-secondary-text",children:(0,a.Y)("a",{onClick:e=>e.stopPropagation(),className:C.seeLatest,href:s.linkUrl,native:!0,children:"See the latest"})})]})},S=e=>{var t,i,l,s,u,y,Y,_,w,k,S;let{newsletter:I,onToggle:F,isTopicAlert:D}=e,{isMobile:T}=(0,v.sM)(),A=(0,g.df)(),{metadata:E,ids:N}=(0,m.i)({pub:A}),{metadata:P,ids:x}=(0,m.i)({pub:A,pubSetting:"fp_primary_column_section_ids"}),L=N.concat(x),{markdownProps:R}=(0,f.$)(I.description);if(!F)return null;let M=L.includes(null!=(u=I.sectionId)?u:-1),B=null!=(_=null==(t=E[null!=(y=I.sectionId)?y:-1])?void 0:t.frequency)?_:null==(i=P[null!=(Y=I.sectionId)?Y:-1])?void 0:i.frequency,O=null!=(S=null==(l=E[null!=(w=I.sectionId)?w:-1])?void 0:l.tagline)?S:null==(s=P[null!=(k=I.sectionId)?k:-1])?void 0:s.tagline;return(0,a.FD)(b.pT,{direction:T?"row":"column",gap:8,className:o()(C.containerFP,{[C.selectedContainerFP]:I.selected}),justifyContent:"space-between",padding:16,paddingRight:T?48:void 0,children:[(0,a.Y)(b.I1,{className:o()(C.toggleBox,{[C.selected]:I.selected}),onClick:()=>{F({sectionId:I.sectionId,isSelected:!I.selected})},children:I.selected?(0,a.Y)(c.A,{stroke:"#FFFFFF",size:20}):(0,a.Y)(d.A,{stroke:"var(--color-fg-primary-themed)",size:20})}),I.logoUrl&&!D&&(0,a.Y)("div",{children:(0,a.Y)(p.o,{src:I.logoUrl,className:C.imgFP,maxWidth:80,imageIsFixedWidth:!0,useRetinaSizing:!0})}),(0,a.FD)(b.I1,{justifyContent:"space-between",style:{height:"100%"},children:[(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{preset:"h7-sans",className:C.name,children:[I.name,O&&": ".concat(O)]}),(0,a.Y)(h.T,(0,r._)((0,n._)({},R),{preset:"d4-serif",clamp:4}))]}),M&&(0,a.FD)(b.Ye,{gap:8,paddingTop:16,children:[(0,a.Y)(h.T,{className:C.previewLink,as:"a",preset:"caption",color:"accent",onClick:e=>e.stopPropagation(),href:I.linkUrl,native:!0,children:"Preview"}),B&&(0,a.Y)(h.T,{as:"a",preset:"caption",color:"tertiary",onClick:e=>e.stopPropagation(),href:I.linkUrl,native:!0,children:B})]})]})]})},I=e=>{var t,i;let{newsletter:n,hideLink:r,onClick:l,onToggle:s}=e,c=(0,g.df)(),{metadata:d}=(0,m.i)({pub:c}),p=!!s,h=e=>{e.stopPropagation(),null==s||s({sectionId:n.sectionId,isSelected:!n.selected})},f=null==(t=d[null!=(i=n.sectionId)?i:-1])?void 0:t.frequency;return(0,a.FD)(b.I1,{className:o()(C.containerMobile,{[C.selectedContainer]:p&&n.selected,[C.selectableContainer]:p,[C.clickableContainer]:!!h}),justifyContent:"space-between",radius:"md",padding:16,onClick:p?h:null!=l?l:void 0,children:[p&&n.selected?(0,a.Y)(u.A,{className:o()(C.selector)}):p?(0,a.Y)("div",{className:o()(C.unselected,C.selector)}):null,(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(b.Ye,{gap:8,children:[n.logoUrl&&(0,a.Y)("img",{className:C.imgMobile,src:(0,_.dJ9)(n.logoUrl,64)}),(0,a.Y)(y.EY.B3,{paddingRight:32,weight:"semibold",color:"primary",font:"text",clamp:2,children:n.name})]}),(0,a.Y)(y.EY.B4,{color:"secondary",clamp:2,font:"text",children:n.description}),f&&(0,a.FD)(y.EY.B4,{color:"secondary",weight:"semibold",children:["Frequency: ",f]})]}),!r&&(0,a.Y)(y.EY,{translated:!0,size:14,weight:"semibold",font:"text",color:"pub-secondary-text",children:(0,a.Y)("a",{href:n.linkUrl,native:!0,children:"See the latest"})})]})};var F=i(84605),D=i(68349);let T=e=>{let{newsletters:t,hideLinks:i,onNewsletterClick:n,justifyItems:r,isTopicAlert:l=!1}=e,{iString:o}=(0,F.GO)(),{isMobile:s}=(0,v.sM)(),c=(0,g.df)();return(0,a.FD)(b.pT,{direction:(0,Y.lu)({pub:c})&&s?"column":"row",className:"container-AE41Ma",wrap:"wrap",justifyContent:r,gap:(0,Y.lu)({pub:c})&&s?16:(0,Y.lu)({pub:c})?40:24,children:[0===t.length&&(0,a.Y)("div",{children:o("No additional newsletters")}),t.map((e,t)=>(0,a.Y)(k,{newsletter:e,hideLink:i,isTopicAlert:l,onToggle:n?e=>{let{sectionId:t,isSelected:i}=e;n({sectionId:t,isSelected:i})}:void 0,onClick:i||(0,Y.lu)({pub:c})?void 0:()=>{(0,D.V2)(e.linkUrl,{local_navigation:!1})}},t))]})};var A=i(13950),E=i(83673),N=i.n(E),P=i(38221),x=i.n(P),L=i(38970),R=i.n(L),M=i(72102),B=i(75107),O=i(41640),U=i(73869);let j={containerFP:"containerFP-07t9zF",containerFp:"containerFP-07t9zF",name:"name-a0Fz9O",sectionName:"sectionName-rkaqT2",imgFP:"imgFP-inDFlQ",imgFp:"imgFP-inDFlQ",toggleBox:"toggleBox-imiF_d",selected:"selected-BzhSfY",previewLink:"previewLink-E_1a9P",img:"img-WX3nAp",container:"container-o46UIK",newsletter:"newsletter-D2dW12",selectableContainer:"selectableContainer-YL_iyh",selectedContainer:"selectedContainer-n52rn6",clickableContainer:"clickableContainer-kN6aXS",containerMobile:"containerMobile-FCXV4L",imgMobile:"imgMobile-yxcTR0",selector:"selector-m97riq",unselected:"unselected-o9ICqY",seeLatest:"seeLatest-RyDQ23"},z=e=>{var t,i,l,s,u,v,y,Y,_,w,C;let{newsletter:k,onToggle:S,isTopicAlert:I}=e,F=(0,g.df)(),{metadata:D,ids:T}=(0,m.i)({pub:F}),{metadata:A,ids:E}=(0,m.i)({pub:F,pubSetting:"fp_primary_column_section_ids"}),N=T.concat(E),{markdownProps:P}=(0,f.$)(k.description);if(!S)return null;let x=N.includes(null!=(u=k.sectionId)?u:-1),L=null!=(Y=null==(t=D[null!=(v=k.sectionId)?v:-1])?void 0:t.frequency)?Y:null==(i=A[null!=(y=k.sectionId)?y:-1])?void 0:i.frequency,R=null!=(C=null==(l=D[null!=(_=k.sectionId)?_:-1])?void 0:l.tagline)?C:null==(s=A[null!=(w=k.sectionId)?w:-1])?void 0:s.tagline;return(0,a.FD)(b.pT,{className:o()(j.containerFP,j.newsletter,{[j.selectedContainerFP]:k.selected}),direction:"row",gap:16,justifyContent:"space-between",padding:16,children:[(0,a.Y)(b.I1,{className:o()(j.toggleBox,{[j.selected]:k.selected}),onClick:()=>{S({sectionId:k.sectionId,isSelected:!k.selected})},children:k.selected?(0,a.Y)(c.A,{size:20,stroke:"#FFFFFF"}):(0,a.Y)(d.A,{size:20,stroke:"var(--color-fg-primary-themed)"})}),(0,a.FD)(b.I1,{justifyContent:"space-between",minWidth:0,style:{height:"100%"},children:[(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{className:j.name,preset:"h7-sans",children:[k.name,R&&": ".concat(R)]}),(0,a.Y)(h.T,(0,r._)((0,n._)({},P),{clamp:4,preset:"d4-serif"}))]}),x&&(0,a.FD)(b.Ye,{gap:8,paddingTop:16,children:[(0,a.Y)(h.T,{as:"a",className:j.previewLink,color:"accent",href:k.linkUrl,native:!0,preset:"caption",onClick:e=>e.stopPropagation(),children:"Preview"}),L&&(0,a.Y)(h.T,{as:"a",color:"tertiary",href:k.linkUrl,native:!0,preset:"caption",onClick:e=>e.stopPropagation(),children:L})]})]}),k.logoUrl&&!I&&(0,a.Y)("div",{children:(0,a.Y)(p.o,{className:j.imgFP,imageIsFixedWidth:!0,maxWidth:80,src:k.logoUrl,useRetinaSizing:!0})})]})},H=e=>{let{isMobile:t,selected:i,id:n,name:r,tagline:l,description:s,onToggle:u}=e;return(0,a.FD)(b.pT,{className:o()(j.containerFP,j.section,{[j.selectedContainerFP]:i}),direction:"row",gap:16,padding:16,paddingBottom:24,paddingLeft:16*!!t,children:[(0,a.Y)(b.I1,{className:o()(j.toggleBox,{[j.selected]:i}),onClick:u,children:i?(0,a.Y)(c.A,{size:20,stroke:"#FFFFFF"}):(0,a.Y)(d.A,{size:20,stroke:"var(--color-fg-primary-themed)"})}),(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{className:j.sectionName,id:n,preset:"h5-sans",children:[r,l&&": ".concat(l)]}),(0,a.Y)(h.T,{clamp:4,preset:"d4-serif",children:s})]})]})};var W=i(89160),V=i(27428),K=i(77124),q=i(95691),G=i(12501),J=i(36372);let $={container:"container-TdpX8j",menuContainer:"menuContainer-eVgk2K",menu:"menu-QeR7Zf",menuOpen:"menuOpen-Y2LbVM",menuFixed:"menuFixed-aZOMlg",activeDropdown:"activeDropdown-TfhPGt",dropdownItem:"dropdownItem-CUrbuV",activeButton:"activeButton-mA_kLf",sectionItem:"sectionItem-qgeeAr",fullWidth:"fullWidth-MFfT4k",dividerFP:"dividerFP-xuOYlu",dividerFp:"dividerFP-xuOYlu",dividerLight:"dividerLight-El30xh",selectAll:"selectAll-mqDRzw",selectAllWrapper:"selectAllWrapper-NrGWzW",contentColumn:"contentColumn-dSrdJe",sectionContainer:"sectionContainer-TeyA0k"},Z=e=>{var t,i;let{pub:l,user:d,newsletters:u,freeSignupEmail:p,newsletter_management_token:g}=e,{ids:f}=(0,q.P)({pub:l}),{ids:y}=(0,V.M)({pub:l}),{ids:Y}=(0,K.q)({pub:l}),{ids:w}=(0,m.i)({pub:l}),{ids:C}=(0,m.i)({pub:l,pubSetting:"fp_primary_column_section_ids"}),{ids:k}=(0,W.G)({pub:l}),{isMobile:S,isTablet:I,isDesktop:F}=(0,v.sM)(),{popToast:T}=(0,J.d)(),E=R()(l.authorPagesInfo,"primary_section_id"),P=u.filter(e=>{var t,i,n,r;return!f.includes(null!=(t=e.sectionId)?t:-1)&&!Y.includes(null!=(i=e.sectionId)?i:-1)&&!y.includes(null!=(n=e.sectionId)?n:-1)&&!k.includes(null!=(r=e.sectionId)?r:-1)}).map(e=>{var t;let i=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,n._)({},e),{linkUrl:i&&null!=(t=(0,_.cxh)({userId:i.user_id,pub:l}))?t:e.linkUrl})}),L=P.filter(e=>{var t;return!C.includes(e.sectionId||-1)&&!w.includes(e.sectionId||-1)&&!k.includes(null!=(t=e.sectionId)?t:-1)}),j=u.filter(e=>{var t,i;return f.includes(null!=(t=e.sectionId)?t:-1)&&!k.includes(null!=(i=e.sectionId)?i:-1)}).map(e=>{var t;let i=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,n._)({},e),{linkUrl:i&&null!=(t=(0,_.cxh)({userId:i.user_id,pub:l}))?t:e.linkUrl})}),Z=u.filter(e=>{var t,i;return Y.includes(null!=(t=e.sectionId)?t:-1)&&!k.includes(null!=(i=e.sectionId)?i:-1)}).map(e=>{var t;let i=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,n._)({},e),{linkUrl:i&&null!=(t=(0,_.cxh)({userId:i.user_id,pub:l}))?t:e.linkUrl})}),Q=!!d||!!p,[X,ee]=(0,s.useState)(new Set),[et,ei]=(0,s.useState)("from-the-free-press"),en=(0,s.useRef)(null),[er,ea]=(0,s.useState)(!1),[el,eo]=(0,s.useState)(!1),[es,ec]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if("undefined"!=typeof window&&Q){var e;let t=new URL(window.location.href),i=Number(null!=(e=t.searchParams.get("unsubscribed_from"))?e:t.searchParams.get("subscribed_to")),n=[...P,...j,...Z].find(e=>e.sectionId===i);n&&T(()=>(0,a.Y)(J.y,{Icon:c.A,text:t.searchParams.get("unsubscribed_from")?"You will no longer receive emails for ".concat(n.name,"."):"You will start receiving emails for ".concat(n.name,".")}))}},[]);let{result:ed,isLoading:eu}=(0,G.st)({pathname:"/api/v1/subscription",auto:Q,query:{token:g}});(0,s.useEffect)(()=>{!eu&&(null==ed?void 0:ed.email_settings)&&ee(new Set(Object.keys(ed.email_settings).filter(e=>"individual"===ed.email_settings[e]).map(e=>Number(e))))},[eu]);let{refetch:ep}=(0,G.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH",query:{token:g},deps:[X]}),eh=e=>{Q&&ep({json:[...P,...j,...Z].reduce((t,i)=>(i.sectionId&&(t[i.sectionId]={setting:e.has(i.sectionId)?"individual":"disabled"}),t),{})}).then(()=>{T(()=>(0,a.Y)(J.y,{Icon:c.A,text:"Subscription updated!"}))})},em=R()(P,"sectionId"),eg=N()(w.map(e=>em[e])),ef=N()(C.map(e=>em[e])),ev=eg.some(e=>X.has(e.sectionId||0)),eb=ef.some(e=>X.has(e.sectionId||0)),ey=L.some(e=>X.has(e.sectionId||0)),eY=Z.some(e=>X.has(e.sectionId||0)),e_=j.some(e=>X.has(e.sectionId||0)),ew=e=>{var t;return null==(t=document.getElementById(e))?void 0:t.scrollIntoView({behavior:"smooth"})},eC=(0,s.useMemo)(()=>[{id:"from-the-free-press",name:"From The Free Press",description:"As a subscriber, every week you'll receive:",newsletters:ef,selected:eb,groupKey:"from-thefp"},{id:"featured",name:"Featured",description:"",newsletters:eg,selected:ev,groupKey:"columns"},{id:"topic-alerts",name:"Topic Alerts",description:"Click to select which Free Press stories you'd like delivered directly to your inbox, the moment we publish them:",newsletters:L,selected:ey,groupKey:"topics",isTopicAlert:!0,shouldSort:!0},{id:"podcast-alerts",name:"Podcast Alerts",description:"Get notified when we publish new podcast episodes:",newsletters:Z,selected:eY,groupKey:"podcasts",isTopicAlert:!1,shouldSort:!0},{id:"video-alerts",name:"Video Alerts",description:"Get notified when we publish new videos:",newsletters:j,selected:e_,groupKey:"videos",isTopicAlert:!1,shouldSort:!0}],[ef,eb,eg,ev,L,ey,Z,eY,j,e_]);(0,s.useEffect)(()=>{let e=[];return eC.forEach(t=>{let i=document.getElementById(t.id);if(i){let n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&ei(t.id)})},{rootMargin:"-10% 0px -50% 0px"});n.observe(i),e.push(n)}}),()=>e.forEach(e=>e.disconnect())},[eC]);let ek=(0,s.useCallback)(()=>{if(en.current){var e,t,i;let n=en.current.getBoundingClientRect(),r=null==(e=en.current.parentElement)?void 0:e.getBoundingClientRect(),a=null==(i=en.current.parentElement)||null==(t=i.parentElement)?void 0:t.getBoundingClientRect();if(n&&r&&a){let e=r.top;!S&&a.bottom<n.height+64?(ea(!1),eo(!0)):e<=64*!S?(eo(!1),ea(!0)):(eo(!1),ea(!1))}}},[S,eo]),eS=(0,s.useMemo)(()=>x()(ek,25,{trailing:!0,leading:!0,maxWait:60}),[ek]);return((0,s.useEffect)(()=>(window.addEventListener("scroll",eS,{passive:!0}),()=>{window.removeEventListener("scroll",eS)}),[eS]),eu&&Q)?(0,a.Y)("div",{style:{minHeight:"var(--full-height)"}}):(0,a.FD)(A.DH,{children:[(0,a.Y)("div",{className:o()("page","typography",$.container,$.large,"the-free-press-theme"),children:(0,a.FD)(b.I1,{children:[(0,a.FD)(b.I1,{gap:8,position:"relative",children:[(0,a.FD)(b.I1,{padding:16,children:[(0,a.Y)(h.T,{preset:"h1-sans",children:"Newsletters"}),(0,a.Y)(h.T,{preset:"d1-sans-regular",children:"We’ll email you when there’s something new from the voices and topics you care about."}),(null==d?void 0:d.is_admin)&&(0,a.Y)(b.Ye,{position:"absolute",style:{top:0,right:0},children:(0,a.Y)(U.m,{pub:l,sectionType:"columns",user:d})})]}),(0,a.Y)("div",{className:$.dividerFP})]}),(0,a.FD)(b.pT,{alignItems:"start",direction:S&&!I?"column":"row",gap:64,justifyContent:"space-between",paddingTop:36*!S,position:"relative",children:[(0,a.Y)("div",{className:o()($.menuContainer),children:(0,a.Y)("div",{ref:en,className:o()($.menu,er&&$.menuFixed,es&&$.menuOpen),style:el?{top:"auto",bottom:0}:{},children:S&&!I?(0,a.FD)(b.I1,{gap:8,zIndex:1,children:[(0,a.FD)(b.Ye,{className:o()($.activeDropdown,$.dropdownItem),justifyContent:"space-between",onClick:()=>ec(!es),children:[(0,a.Y)(h.T,{preset:"detail-large",children:(null==(t=eC.find(e=>e.id===et))?void 0:t.name)||(null==(i=eC[0])?void 0:i.name)}),es?(0,a.Y)(M.A,{size:24,stroke:"var(--color-accent-themed)"}):(0,a.Y)(B.A,{size:24,stroke:"var(--color-accent-themed)"})]}),es&&(0,a.Y)(b.I1,{paddingBottom:8,children:eC.filter(e=>e.id!==et).map(e=>(0,a.Y)(h.T,{className:$.dropdownItem,preset:"detail-large",onClick:()=>{ew(e.id),ec(!1)},children:e.name},e.id))})]}):(0,a.Y)(b.I1,{alignItems:"start",gap:16,children:eC.map(e=>(0,a.Y)(h.T,{className:o()(et===e.id&&$.activeButton,$.sectionItem),preset:"detail-large",whiteSpace:"nowrap",onClick:()=>ew(e.id),children:e.name},e.id))})})}),(0,a.Y)(b.I1,{className:$.contentColumn,gap:40,padding:16,children:eC.map(e=>{if(!e.newsletters.length)return null;let t=e.newsletters.map(e=>(0,r._)((0,n._)({},e),{selected:X.has(e.sectionId||0)})),i=e.shouldSort?t.sort((e,t)=>e.name<t.name?-1:+(e.name>t.name)):t;return(0,a.FD)(b.I1,{children:[(0,a.Y)(b.I1,{gap:8,children:(0,a.Y)(H,{description:e.description,id:e.id,isMobile:S,name:e.name,selected:e.selected,onToggle:()=>{var t,i;let n,r,a;t=e.groupKey,i=!e.selected,r=("from-thefp"===t?ef:"columns"===t?eg:"topics"===t?L:"podcasts"===t?Z:j).map(e=>e.sectionId||0),a=Array.from(X),eh(n=new Set(i?a.concat(r):a.filter(e=>!r.includes(e)))),ee(n)}})}),!F&&(0,a.Y)("div",{className:$.dividerLight}),(0,a.Y)(b.pT,{className:$.sectionContainer,direction:F?"row":"column",gap:0,wrap:"wrap",children:i.map((t,n)=>(0,a.FD)(s.Fragment,{children:[(0,a.Y)(z,{isTopicAlert:e.isTopicAlert,newsletter:t,onClick:()=>{(0,D.V2)(t.linkUrl,{local_navigation:!1})},onToggle:e=>{let{sectionId:t,isSelected:i}=e;(e=>{let{sectionId:t,isSelected:i}=e;if(!t)return;let n=new Set(X);i?n.add(t):n.delete(t),eh(n),ee(n)})({sectionId:t,isSelected:i})}}),!F&&n<i.length-1&&(0,a.Y)("div",{className:$.dividerLight})]},t.sectionId))})]},e.id)})})]})]})}),!Q&&(0,a.Y)(O.C,{isOpen:X.size>0,pub:l,selectedNewsletters:X,user:d,onSuccess:e=>{(0,D.V2)((0,_.my9)(l,{just_signed_up:!0,autoSubmit:!!e.body.prompt_to_login||void 0,email:e.body.email,skip_sections:!0,next:"/newsletters"}),{replace:!0,local_navigation:!1})}})]})};var Q=i(35369),X=i(16074),ee=i(56458),et=i(92636),ei=i(57324);let en=e=>{let{pub:t,user:i,freeSignupEmail:l,newsletter_management_token:c}=e,d=(0,s.useMemo)(()=>(0,ee.Jh)({pub:t,includeMainPub:!(0,Y.lu)({pub:t}),excludePodcasts:(0,Y.s7)({pub:t})}).map(e=>(0,r._)((0,n._)({},e),{linkUrl:(0,_.oRR)(e.linkUrl,{utm_source:ei.VU.newsletterPage}),selected:e.defaultOn})),[t]);return 0===d.length?("undefined"!=typeof window&&(window.location.href=(0,et.$_)(t)),(0,a.Y)("div",{children:"loading..."})):(0,Y.lu)({pub:t})?(0,a.Y)(Z,{newsletter_management_token:c,newsletters:d,pub:t,user:i,freeSignupEmail:l}):(0,a.Y)("div",{className:o()("page","typography","container-moTuSH"),children:(0,a.Y)(A.DH,{children:(0,a.FD)(b.I1,{children:[(0,a.FD)(b.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.FD)(b.I1,{gap:8,paddingBottom:40,paddingTop:48,children:[(0,a.Y)(y.EY.H2,{color:"pub-primary-text",children:"Newsletters"}),(0,a.FD)(y.EY.B3,{color:"pub-secondary-text",children:["Get the best of ",t.name," in your inbox.",(null==i?void 0:i.is_subscribed)?(0,a.FD)(a.FK,{children:[" ","You can manage your subscription in your"," ",(0,a.Y)("a",{className:"accountLink-UwyLNq",href:(0,_.FCy)(t),native:!0,children:"account settings"}),"."]}):""]})]}),(!i||!i.is_subscribed)&&(0,a.Y)(Q.$n,{priority:"primary",href:(0,_.eV6)(t,{addBase:!0,utm_source:ei.VU.newsletterPage}),localNavigation:!1,children:"Subscribe"})]}),(0,a.Y)(X.c,{}),(0,a.Y)("div",{className:"newsletterList-TOG54r",children:(0,a.Y)(T,{newsletters:d,hideLinks:!1,justifyItems:"start"})})]})})})}},41935:function(e,t,i){i.d(t,{AS:()=>e4,Bq:()=>e0,Cg:()=>eB,E0:()=>eW,I2:()=>eE,Jj:()=>ez,N9:()=>eP,Ph:()=>eN,Z4:()=>ej,bW:()=>e5,fp:()=>eX,fz:()=>e9,hy:()=>e8,ib:()=>eV,if:()=>eJ,ln:()=>eH,mV:()=>eF,o$:()=>e2,sk:()=>eR,sq:()=>e3,t2:()=>eI,uC:()=>e1,wR:()=>e7,xx:()=>eT});var n=i(69277),r=i(70408),a=i(79785),l=i(10201),o=i(32485),s=i.n(o),c=i(36119),d=i.n(c),u=i(7350),p=i.n(u),h=i(54718),m=i(96758),g=i(18771),f=i(14520),v=i(80827),b=i(18931),y=i(57157),Y=i(47796),_=i(72170),w=i(43954),C=i(69308),k=i(17402),S=i(15734),I=i.n(S),F=i(36066),D=i(89333),T=i(27437),A=i(4013),E=i(20297),N=i(89839),P=i(18325),x=i(43427),L=i(14394),R=i(78330),M=i(15074),B=i(58299),O=i(26184),U=i(97683),j=i(33460),z=i(30653),H=i(55136),W=i(50883),V=i(58398),K=i(94794),q=i(84605),G=i(53989),J=i(85478),$=i(98747),Z=i(46271),Q=i(6049),X=i(86500),ee=i(94729),et=i(12501),ei=i(31669),en=i(68349),er=i(98920),ea=i(35369),el=i(76977),eo=i(88774),es=i(16993),ec=i(57820),ed=i(63136),eu=i(36372),ep=i(25758);i(5180);var eh=i(83629),em=i(28916),eg=i(11510),ef=i(16291),ev=i(98111),eb=i(56262),ey=i(19601),eY=i(39318),e_=i(49807),ew=i(82776),eC=i(30077),ek=i(57324);function eS(){let e=(0,a._)(["Published on ",""]);return eS=function(){return e},e}function eI(e,t){if("button"===e&&"verbose"===t)return 16;if("button"===e)return 20;if("tabs"===e)return 24;if("compressed"===e)return 14;if("large-on-dark"===e)return 20;return 0}let eF=2,eD=e=>{let{isFullWidth:t,children:i}=e;return t?(0,l.Y)(el.Ye,{className:"post-ufi-button-wrapper",gap:8,children:i}):i};function eT(e){let{post:t,pub:i,user:n,style:r,justified:a,isStatic:o,hideReactions:c,hideComments:u,hideShare:p,hideSavePost:m,useShareLabel:g,allowEdit:f,editButtonIsLast:v,onChange:b,hidePinning:y,showEmailSent:Y,allowSendEmail:_,footerHidden:w,onCommentsClick:C,labelStyle:S,showPreamble:I,preambleConfig:F={},position:T,hideByDisabling:A,showRestackButton:E,showRestackModal:N,showClipping:P,hideFeedRestackButton:x,onToggleMenu:L,postReactionToken:R,initialShareTimestamp:M}=e,B=(0,$.oY)(),{showPins:O,showAudience:U,showDate:H,showDatetime:W,showAuthor:V,showPublicationName:G,showCrossPostedPublicationName:Z}=F;c=c||!i.community_enabled||!t.slug||t.is_draft;let Q=d()(Object.values((null==t?void 0:t.reactions)||{})),X=Y?!!t.email_sent_at:null,ee=(0,K.aZ)(),{iString:et}=(0,q.GO)(),ei=f&&(null==n?void 0:n.is_contributor)&&!ee,en=eA({post:t,pub:i,user:n,defaultOpen:E&&N&&"post-footer"!==T&&"post-footer-full-width"!==T}),{getConfigFor:er}=(0,J.mJ)(),el=(0,eg.Iu)(),[es,ec]=(0,k.useState)({isOpen:!1,action:null}),ed=(0,k.useMemo)(()=>{var e;let n=null==(e=t.publishedBylines)?void 0:e[0];return(null==n?void 0:n.name)&&(n.photo_url||i.logo_url)?{author:{id:n.id,name:n.name,photo_url:n.photo_url||null},pub:{subdomain:i.subdomain,name:i.name,logo_url:i.logo_url}}:null},[t.publishedBylines,i.subdomain,i.name,i.logo_url]),eu=!n&&el&&!o&&!!ed,ep=n&&(0,l.Y)(eQ,{style:r,pub:i,post:t,user:n,hidePinning:y,emailSent:null!=X?X:void 0,allowSendEmail:_,footerHidden:w,canBeCrossPosted:E,onToggleMenu:L}),eh=!x&&i.community_enabled&&t.slug&&!t.is_draft,em=E&&!I&&(A||c&&u&&p&&!ei),ef="counts-or-none"===S&&t.comment_count?"count":"labels"===S?"cta":"none",ev=n&&t.videoUpload&&(0,eC.Z)(n,t,t.videoUpload),eb="post-footer-full-width"===T;return(0,l.FD)("div",{className:s()("post-ufi","style-".concat(r),{justified:a,themed:B,"single-full-width-button":em,"vertically-stacked":"shows-episode-player"===T}),children:[(0,l.FD)(eD,{isFullWidth:eb,children:[I&&F&&(0,l.Y)(e6,{pub:i,post:t,showPins:O,showAudience:U,showDate:H,showDatetime:W,showEmailSent:Y,showAuthor:V,showPublicationName:G,showCrossPostedPublicationName:Z}),ei&&!v&&ep,P&&t.videoUpload&&!er("disable_clipping_for_readers")&&(0,l.Y)(D.NJ,{post:t,mediaUpload:t.videoUpload,disabled:!ev,style:r,surface:"post"}),(A||!c)&&(0,l.Y)(ex,{post:t,pub:i,user:n,labelStyle:A&&c?"none":"counts-or-none"===S&&Q?"count":"labels"===S?"cta":"none",style:r,onChange:b,isStatic:!!o,isDisabled:A&&c||"shows-episode-player"===T&&!n,postReactionToken:R,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"like"}):void 0}),(A||!u)&&(0,l.Y)(eG,{post:t,pub:i,isStatic:o,labelStyle:A&&u?"none":ef,style:r,count:t.comment_count,onClick:C,isDisabled:A&&u,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"comment"}):void 0}),eh&&(0,l.Y)(eR,{pub:i,post:t,onChange:b,style:r,onToggleMenu:L,isStatic:o,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"restack"}):void 0}),!p&&(0,l.Y)(j.$8,{post:t,pub:i,user:n,trigger:{style:r,labelStyle:g?"cta":"none",isStatic:o},position:T,initialShareTimestamp:M,showClipping:P&&!!t.videoUpload,disableClipping:!ev})]}),(0,l.FD)(eD,{isFullWidth:eb,children:[!m&&!E&&n&&(0,l.Y)(eK,{post:t,labelStyle:ef,position:T,style:r,onChange:b}),ei&&v&&ep,E&&!ei&&"post-header"===T&&(0,l.Y)(l.FK,{children:(0,l.FD)(eo.W1,{trigger:(0,l.Y)(ea.K0,{"aria-label":et("View repost options"),priority:"secondary-outline",children:(0,l.Y)(h.A,{size:20})}),children:[n&&(0,l.Y)(eZ,{onClick:en.open,post:t,pub:i,user:n}),(0,l.Y)(eq,{post:t,onChange:b})]})}),E&&!ei&&eb&&(0,l.FD)(l.FK,{children:[!m&&(0,l.Y)(eK,{post:t,labelStyle:"verbose",position:T,style:"button",onChange:b}),n&&(0,l.Y)(e$,{onClick:en.open,post:t,pub:i,user:n,style:"button"})]})]}),en.modal,(0,l.Y)(z.M,{isOpen:es.isOpen,setOpen:e=>ec({isOpen:e,action:es.action}),author:null==ed?void 0:ed.author,pub:null==ed?void 0:ed.pub,action:es.action||"like",postId:t.id,postSlug:t.slug})]})}function eA(e){let{pub:t,user:i,post:n,defaultOpen:r=!1}=e,[a,o]=(0,k.useState)(r);return(0,k.useEffect)(()=>{r&&i&&(0,X.u4)(X.qY.RESTACK_POST_CLICKED,{restacked_publication_id:t.id,restacked_post_id:n.id,restacking_user_id:i.id,is_from_email:!0})},[r,t,n,i]),{open:()=>o(!0),modal:(0,l.Y)(W.T,{pub:t,user:i,post:n,open:a,setOpen:o}),isOpen:a}}function eE(e){let{post:t,pub:i,user:n,isStatic:r,onChange:a,allowEdit:o,hidePinning:c,showEmailSent:d,allowSendEmail:u,hideComments:h,onCommentsClick:m,showRestackButton:g,showRestackModal:f,setFooterShown:v,postReactionToken:b}=e,y=function(){let e="undefined"==typeof window,[t,i]=(0,k.useState)(e?0:window.pageYOffset),[n,r]=(0,k.useState)(!0),a=(0,k.useMemo)(()=>Date.now()+1e3,[]),l=(0,k.useRef)(0);return(0,k.useEffect)(()=>{let e=p()(()=>{let e=Date.now(),n=(e-l.current)/1e3,o=(t-window.pageYOffset)/n;l.current=e,window.pageYOffset<0||(e<a||-o>100?r(!0):o>100&&r(!1),i(window.pageYOffset))},250);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[t,i,r,a,l,!0]),n}(),Y=(0,eu.d)(),_=(0,ei.V)();return((0,k.useEffect)(()=>{Y.addOffset(64*(y?1:-1)),v&&v(!y)},[y,v]),_)?null:(0,l.Y)(el.pT,{alignItems:"center",padding:8,className:s()("mobile-footer-ufi",{hidden:y}),children:(0,l.Y)(eT,{post:t,pub:i,user:n,isStatic:r,justified:!0,style:"tabs",onChange:a,allowEdit:o,editButtonIsLast:!0,hidePinning:c,showEmailSent:d,allowSendEmail:u,footerHidden:y,labelStyle:"counts-or-none",hideComments:h,onCommentsClick:m,position:"mobile-toolbar",hideByDisabling:!0,showRestackModal:f,showRestackButton:g,postReactionToken:b})})}function eN(e){let{post:t,user:i,surface:n,onChange:r,postReactionToken:a}=e,l=!!(null==t?void 0:t.reaction),o=(0,K.aZ)(),s=(0,et.st)({pathname:(0,e_.yRP)(o?"/api/v1/cross-post/".concat(null==t?void 0:t.id,"/reaction"):"/api/v1/post/".concat(null==t?void 0:t.id,"/reaction"),{token:a}),method:"POST",deps:[null==t?void 0:t.id]});return{isLiked:l,toggle:async()=>{var e;if(s.isLoading)return"error";if(!i)return"unauthorized";let{reaction:a,reactions:l,reactor_names:o}=(0,H.Qw)(i,t);t.reaction=null!=a&&a,t.reactions=l,t.reactor_names=null!=o?o:[],null==r||r({post:t});let c=await s.refetch(a?{method:"POST",json:{reaction:"❤",surface:n}}:{method:"DELETE"}),d=null==c||null==(e=c.response)?void 0:e.status;if(d){let{reaction:e,reactions:n,reactor_names:a}=(0,H.Qw)(i,t);t.reaction=null!=e&&e,t.reactions=n,t.reactor_names=null!=a?a:[],null==r||r({post:t})}return 401===d?"unauthorized":d?"error":a?"liked":"unliked"}}}function eP(){return async function(e,t){let{tabId:i,restacking_user_id:n,media_clip_id:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await (0,ee.x6)("/api/v1/post/".concat(e,"/reaction"),t?{method:"POST",json:{reaction:"❤",surface:"reader",tabId:i,restacking_user_id:n,media_clip_id:r}}:{method:"DELETE",json:{tabId:i,media_clip_id:r}})}}function ex(e){let{post:t,pub:i,user:n,style:r,labelStyle:a,onChange:o,isStatic:s,isDisabled:c,postReactionToken:u,onOpenUpsellModal:p}=e,{iString:h}=(0,q.GO)(),m=d()(Object.values((null==t?void 0:t.reactions)||{})),g="count"===a?(0,ew.numberToString)(m||0):"cta"===a?"Like":null;return(0,l.Y)(ej,{post:t,pub:i,user:n,onChange:o,isStatic:s,style:r,postReactionToken:u,onOpenUpsellModal:p,children:e=>{let{isLiked:t,handleLike:i}=e;return(0,l.Y)(eX,{style:r,state:t?"liked":void 0,icon:(0,l.Y)(x.A,{className:"icon",height:eI(r),strokeWidth:eF}),onClick:c?()=>{}:i,noLabel:"none"===a,isDisabled:c,ariaLabel:h("Like")+("count"===a?" (".concat((0,ew.numberToString)(m||0),")"):""),ariaPressed:t,children:g})}})}function eL(e){let{style:t,onClick:i}=e;return(0,l.Y)(eX,{style:t,state:void 0,icon:(0,l.Y)(m.A,{className:"icon",height:eI(t),strokeWidth:eF}),"aria-label":"menu",onClick:i})}function eR(e){let{renderTrigger:t,pub:i,post:a,style:o,onToggleMenu:s,onChange:c,isStatic:d,onOpenUpsellModal:u}=e,[p,h]=(0,k.useState)(!1),{iString:m}=(0,q.GO)(),{canRestack:g,isRestacked:f,restacks:v,menuItems:b,nuxModal:y,loggedOutRestackAttempt:Y}=(0,em.I)({pub:i,post:a,onRestack:e=>{null==c||c({post:(0,r._)((0,n._)({},a),{restacked:e,restacks:v+(e?1:-1)})})},renderWithoutUser:!0});if((0,k.useEffect)(()=>{Y&&h(!0)},[Y]),!g)return null;let _=!i.community_enabled,w=void 0!==u,C=e=>{if((0,X.u4)(X.qY.POST_UFI_BUTTON_CLICKED,{type:"restack",post_id:a.id}),w){e.preventDefault(),e.stopPropagation(),u();return}},S=t?t({restacks:v,isRestacked:f,isDisabled:_,onClick:C}):(0,l.Y)(eX,{style:o,state:f?"restacked":void 0,icon:(0,l.Y)(B.A,{className:"icon",height:eI(o),strokeWidth:eF}),noLabel:0===v,"aria-label":"menu",isDisabled:_,onClick:C,children:v.toLocaleString(void 0,{maximumSignificantDigits:4})});return(0,l.FD)(l.FK,{children:[y,_||w?S:(0,l.Y)(eo.W1,{trigger:S,onOpen:()=>{s&&s({active:!0})},onClose:()=>{s&&s({active:!1})},"aria-label":m("View repost options"),children:b}),(0,l.Y)(er.Z,{displaySignInModal:p,onCloseSignInModal:()=>h(!1),isStatic:!!d,entry:"post-preview-like"})]})}function eM(e){let{postId:t,isOpen:i,onClose:n}=e,r=(0,J.mJ)(),{iString:a}=(0,q.GO)(),[o,s]=(0,k.useState)(),c=!0==r.getConfigFor("enable_post_summarization"),d=(0,k.useRef)(!1),u=(0,k.useCallback)(()=>{d.current=!0,I().post("/api/v1/posts/".concat(t,"/summary")).then(e=>{var t;(null==(t=e.body)?void 0:t.summary)&&s(e.body.summary)}).finally(()=>{d.current=!1})},[t]);return((0,k.useEffect)(()=>{i&&c&&!o&&!d.current&&u()},[i,u,c,o]),c)?(0,l.FD)(es.aF,{isOpen:i,onClose:n,width:750,children:[(0,l.Y)(es.rQ,{showClose:!0,title:a("Reader guide"),onClose:n}),(0,l.Y)(el.I1,{padding:16,paddingBottom:32,children:o?(0,l.Y)("div",{dangerouslySetInnerHTML:{__html:o}}):(0,l.Y)(el.I1,{alignItems:"center",justifyContent:"center",style:{flex:1,minHeight:300},children:(0,l.Y)("div",{className:"embed-loader"})})})]}):null}let eB=e=>{let{isOpen:t,setIsOpen:i}=e;return(0,k.useEffect)(()=>{let e=setTimeout(()=>{t&&i(!1)},1e4);return()=>clearTimeout(e)},[t]),(0,l.Y)(es.aF,{isOpen:t,onClose:()=>i(!1),width:300,children:(0,l.FD)(el.I1,{padding:16,gap:16,children:[(0,l.Y)(ed.EY.H4,{translated:!0,children:"Generating PDF..."}),(0,l.Y)(el.I1,{alignItems:"center",children:(0,l.Y)(ec.y$,{})})]})})};function eO(e){let{post:t,pub:i,user:n,onChange:r,showRestackModal:a,canBeCrossPosted:o,onSummaryOpen:s,onToggleRestackModal:c}=e,{iString:d}=(0,q.GO)(),u="button",p=(0,J.mJ)(),m=!0==p.getConfigFor("enable_post_summarization"),[y,Y]=(0,k.useState)(!1),_=eA({pub:i,user:n,post:t,defaultOpen:a&&o});return(0,k.useEffect)(()=>{null==c||c(_.isOpen)},[c,_.isOpen]),(0,l.FD)(l.FK,{children:[(0,l.Y)(eB,{isOpen:y,setIsOpen:Y}),(0,l.FD)(eo.W1,{trigger:(0,l.Y)(eX,{style:u,icon:(0,l.Y)(h.A,{className:"icon edit-icon",size:eI(u),strokeWidth:2}),noLabel:!0,"aria-label":d("More")}),children:[n&&(0,l.Y)(eq,{post:t,onChange:r,showIcon:!0}),m&&(0,l.Y)(eo.Dr,{leading:(0,l.Y)(g.A,{}),onClick:s,children:d("Reader guide")}),o&&(0,l.Y)(eo.Dr,{leading:(0,l.Y)(f.A,{}),onClick:()=>{_.open(),(0,X.u4)(X.qY.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:t.id,restacking_user_id:n.id,is_from_email:!1})},children:d("Cross post")}),p.getConfigFor("show_open_post_as_pdf_button")&&(0,l.Y)(eo.Dr,{leading:(0,l.Y)(v.A,{}),onClick:()=>{Y(!0),(0,en.V2)((0,e_.MGs)(i,t.id),{local_navigation:!1})},children:d("Open as PDF")}),n&&(0,l.Y)(eo.Dr,{leading:(0,l.Y)(b.A,{}),href:(0,e_.Vtr)(t.id),children:d("Substack Reader")})]}),_.modal]})}function eU(e){var t;let i=d()(Object.values((null==(t=e.post)?void 0:t.reactions)||{}));return(0,l.Y)(ex,(0,r._)((0,n._)({},e),{labelStyle:i>0?"count":"none"}))}function ej(e){let{post:t,pub:i,user:n,onChange:r,isStatic:a,children:o,style:c,postReactionToken:d,onOpenUpsellModal:u}=e,[p,h]=(0,k.useState)(!1),{isLiked:m,toggle:g}=eN({post:t,user:n,onChange:r,postReactionToken:d}),[f,v]=(0,k.useState)(!1),b=(0,k.useCallback)(async e=>{var i;if(null==e||null==(i=e.stopPropagation)||i.call(e),(0,X.u4)(X.qY.POST_UFI_BUTTON_CLICKED,{type:"like",post_id:t.id}),void 0!==u){u(),null==e||e.preventDefault();return}"unauthorized"===await g()&&v(!0)},[g,u,t.id]);return(0,l.FD)("div",{className:s()("like-button-container","post-ufi-button","style-".concat(c),m&&"state-liked"),children:[o({isLiked:m,handleLike:b}),(0,l.Y)(er.Z,{isStatic:a,displaySignInModal:f,onCloseSignInModal:()=>v(!1),entry:"post-preview-restack"}),!a&&(0,l.Y)(V.Z,{isOpen:p,medium:"web",pub:i,user:n,post:t,onClose:()=>h(!1)})]})}function ez(e){var t;let{post:i,defaultSaved:n,isSaved:r,trackSurface:a}=e;return eH({postId:i.id,defaultSaved:null!=(t=null!=n?n:i.is_saved)&&t,isSaved:r,trackSurface:a})}function eH(e){let{postId:t,defaultSaved:i,isSaved:n,trackSurface:r}=e,[a,l]=(0,k.useState)(i),o=null!=n?n:a,{refetch:s}=(0,et.st)({pathname:"/api/v1/posts/saved",method:"POST",json:{post_id:t,surface:r},deps:[t]}),c=eV();return{isSaved:o,onSave:()=>(s({method:o?"DELETE":"POST"}),l(!o),c(!o),!o)}}async function eW(e,t,i){let{surface:n}=i;await (0,ee.x6)("/api/v1/posts/saved",{method:t?"POST":"DELETE",json:{post_id:e}}),(0,X.u4)(X.qY.POST_SAVED,{post_id:e,surface:n,is_saved:t})}function eV(){let e=(0,eu.d)(),{iString:t}=(0,q.GO)();return i=>{i?e.popToast(()=>(0,l.Y)(eu.y,{text:t("Post saved"),Icon:y.A,cta:t("View now"),href:(0,eY.c8C)()})):e.popToast(()=>(0,l.Y)(eu.y,{text:t("Post unsaved"),Icon:Y.A}))}}function eK(e){let{style:t,post:i,isSaved:a,labelStyle:o,position:s,onChange:c}=e,{isSaved:d,onSave:u}=ez({defaultSaved:a,post:i,isSaved:i.is_saved,trackSurface:s}),{iString:p}=(0,q.GO)();return(0,l.Y)(eX,{state:d?"saved":void 0,style:t,icon:(0,l.Y)(N.A,{className:"icon",height:eI(t,"verbose"===o?"verbose":null),strokeWidth:eF}),noLabel:"none"===o,verboseLabel:"verbose"===o,onClick:()=>{let e=u();null==c||c({post:(0,r._)((0,n._)({},i),{is_saved:e})})},ariaPressed:d,ariaLabel:p("Save"),children:"cta"===o||"verbose"===o?p("Save"):null})}function eq(e){let{post:t,isSaved:i,onChange:a,showIcon:o}=e,{onSave:s}=ez({defaultSaved:i,post:t,isSaved:t.is_saved}),{iString:c}=(0,q.GO)(),d=t.is_saved?"var(--color-accent-fg-orange)":void 0;return(0,l.Y)(eo.Dr,{leading:o?(0,l.Y)(y.A,{style:{stroke:d,fill:d}}):void 0,onClick:()=>{let e=s();null==a||a({post:(0,r._)((0,n._)({},t),{is_saved:e})})},children:c(t.is_saved?"Unsave":"Save")})}function eG(e){let t,{style:i,count:r,labelStyle:a,post:o,pub:s,isStatic:c,onClick:d,isDisabled:u,onOpenUpsellModal:p}=e,{iString:h}=(0,q.GO)(),m=(0,eg.Iu)(),g=(0,Z.Jd)(),f=(null!=r?r:0)>0,v=void 0!==p&&!g&&m;return t=(null==o?void 0:o.comment_url_override)?o.comment_url_override:c?"".concat(ev.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ek.VU.substack,"&utm_medium=").concat(ek.Jn.email):!m||(null==g?void 0:g.is_contributor)?(0,eY.wu9)(s,o,{comments:!0}):(0,eY.XV8)(s.subdomain,o.slug,{params:(0,n._)({comments:!0,utm_source:ek.VU.post,utm_medium:ek.Jn.web},v&&f&&{show_app_upsell:"comment"})}),(0,l.FD)(eX,{style:i,icon:(0,l.Y)(P.A,{className:"icon",height:eI(i),strokeWidth:eF}),href:u?void 0:t,onClick:u?()=>{}:e=>{if((0,X.u4)(X.qY.POST_UFI_BUTTON_CLICKED,{type:"comment",post_id:o.id}),v&&!f){p(),e.preventDefault();return}d?d(e):(null==e||e.preventDefault(),window.location.href=t)},noLabel:"none"===a,className:"post-ufi-comment-button",isDisabled:u,ariaLabel:h("cta"===a?"Comment":"View comments"+" (".concat((0,ew.numberToString)(r||0),")")),children:["cta"===a&&h("Comment"),"count"===a&&(0,ew.numberToString)(r||0)]})}function eJ(e){let t,{post:i,user:n,pub:r,style:a,labelStyle:o,isStatic:c,onChange:d,position:u}=e,[p,h]=(0,k.useState)(!1),m=(0,k.useCallback)(()=>{(0,X.u4)(X.qY.POST_SHARE_BUTTON_CLICKED,{position:u,post_id:i.id}),h(!0)},[]),{iString:g}=(0,q.GO)();t=i.share_url_override?i.share_url_override:c?i?ev.T.SHARE_URL:ev.T.SHARE_PUB_URL:"javascript:void(0)";let f="none"===o;return(0,l.FD)(l.FK,{children:[(0,l.Y)(eX,{style:a,icon:f?(0,l.Y)(_.A,{className:"icon",height:eI(a),strokeWidth:eF}):null,onClick:m,href:t,noLabel:"none"===o,className:s()(!f&&"no-icon"),children:"cta"===o&&g("Share")}),!c&&(0,l.Y)(V.Z,{isOpen:p,medium:"web",pub:r,user:n,post:i,onChange:d,onClose:()=>h(!1)})]})}function e$(e){let{post:t,user:i,pub:n,onClick:r,style:a}=e,{iString:o}=(0,q.GO)();return(0,l.Y)(l.FK,{children:(0,l.Y)(eX,{style:a,icon:(0,l.Y)(L.A,{className:"icon",height:eI(a,"verbose"),strokeWidth:eF}),onClick:()=>{(0,X.u4)(X.qY.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:t.id,restacking_user_id:i.id,is_from_email:!1}),r()},noLabel:!1,verboseLabel:!0,title:o("Cross-Post"),children:o("Cross-post")})})}function eZ(e){let{post:t,user:i,pub:n,onClick:r}=e,{iString:a}=(0,q.GO)();return(0,l.Y)(l.FK,{children:(0,l.Y)(eo.Dr,{onClick:()=>{(0,X.u4)(X.qY.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:t.id,restacking_user_id:i.id,is_from_email:!1}),r()},children:a("Cross-post")})})}function eQ(e){let{style:t,pub:i,post:n,user:r,hidePinning:a,emailSent:o,allowSendEmail:c,footerHidden:d,showRestackModal:u,canBeCrossPosted:p,onSummaryOpen:m,onToggleMenu:g,onToggleRestackModal:f}=e,v=eA({post:n,pub:i,user:r,defaultOpen:u&&p});(0,k.useEffect)(()=>{null==f||f(v.isOpen)},[f,v.isOpen]);let b=(0,l.Y)(eX,{style:t,icon:(0,l.Y)(h.A,{className:"icon edit-icon",size:eI(t),strokeWidth:2}),noLabel:!0});return(0,l.FD)("div",{className:s()("edit-button-container","post-ufi-button","style-".concat(t)),children:[(0,l.Y)(U.D,{trigger:b,pub:i,post:n,user:r,hidePinning:a,emailSent:o,allowSendEmail:c,handleCrossPost:p?()=>{v.open(),(0,X.u4)(X.qY.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:n.id,restacking_user_id:r.id,is_from_email:!1})}:void 0,onSummaryOpen:m,onToggleMenu:g,disabled:d}),v.modal]})}let eX=(0,k.forwardRef)((e,t)=>{let{icon:i,children:n,state:r,style:a,onClick:o,href:c,noLabel:d,verboseLabel:u,noBorder:p,className:h,isDisabled:m,iconPosition:g="left",title:f,ariaLabel:v,ariaPressed:b}=e;return(0,l.FD)(ea.Nm,{className:s()("post-ufi-button","style-".concat(a),h,r?"state-".concat(r):void 0,m?"state-disabled":void 0,n&&!d?"has-label":"no-label",p?"no-border":"with-border",u?"verbose-label":""),title:f,href:c,onClick:e=>{o&&(e.stopPropagation(),o(e))},ref:t,"aria-label":null!=v?v:f,"aria-pressed":b,children:["left"===g&&i,!d&&n&&(0,l.Y)("div",{className:"label",children:n}),"right"===g&&i]})}),e0=e=>{let{pub:t,post:i,showAuthor:n}=e;return!!(n&&t.bylines_enabled&&(0,ew.getPrintedByline)(t,i))},e1=e=>{let{pub:t,post:i,showAuthor:n,showPhoto:r,isMobileWidth:a}=e;return e0({pub:t,post:i,showAuthor:n})&&!e2({pub:t,post:i,showAuthor:n})&&!e4({pub:t,post:i,showAuthor:n,showPhoto:r})&&!a},e2=e=>{let{pub:t,post:i,showAuthor:n}=e;return e0({pub:t,post:i,showAuthor:n})&&(0,ew.getBylineUsers)(i).length>1},e4=e=>{var t;let{pub:i,post:n,showAuthor:r,showPhoto:a}=e;return!!(e0({pub:i,post:n,showAuthor:r})&&a&&(null==(t=(0,ew.getBylineUsers)(n)[0])?void 0:t.photo_url)&&i.byline_images_enabled)};function e3(e){let{post:t,showDatetime:i,isStatic:n,fromPostPage:r,showReactions:a,language:l="en"}=e,o=t.reactions?Object.values(t.reactions).reduce((e,t)=>e+t,0):0,s=r&&!n&&a&&o>=70&&o<100;return i&&s?(0,ef.A)(t.post_date).locale(l).standardDatetimeWithYear():i&&!s?(0,ef.A)(t.post_date).locale(l).standardDatetime():n?(0,ef.A)(t.post_date).locale(l).standardDate():s?(0,ef.A)(t.post_date).locale(l).standardDate({full:s}):(0,ef.A)(t.post_date).locale(l).standardDateOrTime()}function e6(e){let{pub:t,post:i,showPins:n,showAudience:r,showDate:a,showDatetime:o,showEmailSent:c,showAuthor:d,showPublicationName:u,showCrossPostedPublicationName:p}=e,h=(0,$.oY)(),m=!!(d&&t.bylines_enabled&&(0,ew.getPrintedByline)(t,i)),g=a&&i.post_date&&!i.is_draft,f=c?!!i.email_sent_at:null,{iString:v,iTemplate:b,language:y}=(0,q.GO)();return(0,l.FD)("div",{className:s()("ufi-preamble",{themed:h}),children:[p&&i.restacked_pub_name?(0,l.Y)("div",{className:"ufi-preamble-label cross-posted-pub-name",children:b(eS(),i.restacked_pub_name)}):null,c&&f&&(0,l.Y)("div",{className:"email-sent",title:v("This post was sent as an email"),children:(0,l.Y)(w.A,{className:"post-ufi-preamble-icon",size:16})}),n&&i.is_section_pinned&&(0,l.Y)("div",{className:"pinned",children:(0,l.Y)(O.A,{className:"post-ufi-preamble-icon"})}),"adhoc_email"===i.type?(0,l.Y)("div",{className:"audience-adhoc",children:(0,l.Y)(A.A,{className:"post-ufi-preamble-icon"})}):r&&(0,eb.isPaidAudience)(i.audience)&&(0,l.Y)("div",{className:"audience-lock",children:(0,l.Y)(F.A,{audience:i.audience,className:"lock-icon post-ufi-preamble-icon",size:16})}),e1({pub:t,post:i,showAuthor:m,isMobileWidth:!1})&&(0,l.Y)("div",{className:"ufi-preamble-label author",children:(0,ew.getBylineUsers)(i).length>0?(0,ew.oxfordComma)((0,ew.getBylineUsers)(i).map(e=>(0,l.Y)(l.FK,{children:(0,l.Y)(T.ProfileHoverCard,{subject:e,utmSource:"byline",trigger:(0,l.Y)("a",{href:(0,e_.gYq)(e,{noBase:eh.Z}),onClick:e=>e.stopPropagation(),children:e.name})})}))):(0,ew.getPrintedByline)(t,i)}),u&&(0,l.Y)("div",{className:"post-publication-name",children:t.name}),g&&(0,l.Y)("div",{className:"ufi-preamble-label post-date",title:(0,ef.A)(i.post_date).toISOString(),children:(0,l.Y)("time",{dateTime:(0,ef.A)(i.post_date).toISOString(),children:e3({post:i,showDatetime:o,language:y})})})]})}let e7=e=>{let{pub:t,post:i,user:n,onChange:r,postReactionToken:a,onOpenUpsellModal:o}=e;return(0,J.mJ)().getConfigFor("like_posts_enabled")&&t.community_enabled?(0,l.Y)(eU,{style:"button",post:i,pub:t,user:n,onChange:r,postReactionToken:a,onOpenUpsellModal:o}):null},e8=e=>{let{pub:t,post:i,onClick:n,onOpenUpsellModal:r}=e,a=(0,ew.showCommentsOnPost)({publication:t,post:i}),{comment_count:o}=i;return a?(0,l.Y)(eG,{post:i,pub:t,labelStyle:o>0?"count":"none",style:"button",count:o,onClick:n,onOpenUpsellModal:r}):null};function e5(e){let{hideBottomBorder:t,post:i,pub:n,user:r,onChange:a,onCommentsClick:o,showRestackModal:s=!1,showTranscriptionButton:c,onTranscriptionClick:d,postReactionToken:u,onToggleRestackModal:p,onTranscriptClick:h,position:m}=e,{iString:g}=(0,q.GO)(),f=(0,K.aZ)(),v=(0,J.mJ)(),b=(0,eg.Iu)(),[y,Y]=(0,k.useState)({isOpen:!1,action:null}),_=(0,k.useMemo)(()=>{var e;let t=null==(e=i.publishedBylines)?void 0:e[0];return(null==t?void 0:t.name)&&(t.photo_url||n.logo_url)?{author:{id:t.id,name:t.name,photo_url:t.photo_url||null},pub:{subdomain:n.subdomain,name:n.name,logo_url:n.logo_url}}:null},[i.publishedBylines,n.subdomain,n.name,n.logo_url]),w=!r&&b&&!!_,S=(null==r?void 0:r.is_contributor)&&!f,{getSettingFor:I}=(0,G.Pu)(),F=!i.is_draft&&(0,ey.A)(r,{enable_restacking:!!I("enable_restacking")},i,n,!1),[D,T]=(0,k.useState)(!1),[A,E]=(0,k.useState)(!1),N=v.getConfigFor("enable_press_kit_preview_modal"),P=r&&i.videoUpload&&(0,eC.Z)(r,i,i.videoUpload),[x,L]=(0,k.useState)(!1);return(0,l.FD)(el.pT,{className:"post-ufi",alignItems:"center",borderTop:"detail-themed",borderBottom:t?void 0:"detail-themed",justifyContent:"space-between",gap:16,flex:"grow",paddingY:16,children:[(0,l.FD)(el.pT,{gap:8,children:[(0,l.Y)(e7,{post:i,pub:n,user:r,onChange:a,postReactionToken:u,onOpenUpsellModal:w?()=>Y({isOpen:!0,action:"like"}):void 0}),(0,l.Y)(e8,{pub:n,post:i,onClick:o,onOpenUpsellModal:w?()=>Y({isOpen:!0,action:"comment"}):void 0}),(0,l.Y)(eR,{pub:n,post:i,onChange:a,style:"button",onOpenUpsellModal:w?()=>Y({isOpen:!0,action:"restack"}):void 0}),c&&(0,l.Y)(eL,{style:"button",onClick:d})]}),(0,l.FD)(el.pT,{gap:8,children:[N&&(0,l.Y)(ea.$n,{priority:"secondary-outline",onClick:()=>E(!0),children:g("Assets")}),(0,l.FD)(l.FK,{children:[(0,l.Y)(eX,{style:"button",onClick:()=>{L(!0)},children:g("Share")}),(0,l.Y)(V.Z,{isOpen:x,onClose:()=>L(!1),utm_campaign:"post-expanded-share",user:r,post:i,pub:n,position:m,clippingAllowed:!!P})]}),h&&(0,l.Y)(eX,{onClick:h,style:"button",icon:(0,l.Y)(C.A,{stroke:"var(--color-fg-secondary-themed)",size:16}),children:g("Transcript")}),S?(0,l.Y)(eQ,{style:"button",pub:n,post:i,user:r,showRestackModal:s,canBeCrossPosted:F,onSummaryOpen:()=>T(!0),onToggleRestackModal:p}):(r||F)&&(0,l.Y)(eO,{post:i,pub:n,user:r,onChange:a,showRestackModal:s,canBeCrossPosted:F,onSummaryOpen:()=>T(!0),onToggleRestackModal:p})]}),(0,l.Y)(eM,{postId:i.id,isOpen:D,onClose:()=>T(!1)}),N&&(0,l.Y)(ep.r,{isOpen:A,onClose:()=>E(!1),post:i}),(0,l.Y)(z.M,{isOpen:y.isOpen,setOpen:e=>Y({isOpen:e,action:y.action}),author:null==_?void 0:_.author,pub:null==_?void 0:_.pub,action:y.action||"like",postId:i.id,postSlug:i.slug})]})}function e9(e){let{isFooter:t,readInAppText:i,customization:{showAppUpsell:a,showShare:o,showComments:c,showReactions:d,showListen:u,showSave:p,showRestack:h,showCommentRestack:m}}=e,g=!t&&(h||u||p),{iString:f}=(0,q.GO)(),v=null!=i?i:f("READ IN APP");return t||o||c||d||u||p||!h?(0,l.FD)(Q.h2,{className:t?"email-ufi-2-bottom":"email-ufi-2-top",width:"100%",children:[h&&t&&(0,l.FD)(l.FK,{children:[(0,l.Y)(te,{}),(0,l.Y)("tr",{children:(0,l.Y)("td",{children:(0,l.FD)(Q.h2,{width:"100%",className:"email-ufi-2-row",children:[(0,l.Y)("tr",{children:(0,l.Y)("td",{width:"95%",children:o&&(0,l.FD)(Q.tR,{tableClassName:"email-button-outline-wrapper-full-width",aClassName:"email-button-outline full-width",href:ev.T.SHARE_URL,children:[(0,l.Y)(R.A,(0,n._)({},tt)),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]})})}),(0,l.Y)(te,{})]})})})]}),(0,l.Y)(te,{}),(0,l.Y)("tr",{children:(0,l.Y)("td",{children:(0,l.Y)(Q.h2,{width:"100%",children:(0,l.FD)("tr",{children:[(0,l.Y)("td",{children:(0,l.FD)(Q.ZB,{gap:8,style:g?void 0:{margin:"0 auto"},children:[d?t?(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:ev.T.REACTION_URL,children:[(0,l.Y)(x.A,(0,n._)({},tt)),(0,l.Y)("span",{className:"email-button-text",children:f("Like")})]}):(0,l.Y)(ti,{href:ev.T.REACTION_URL,children:(0,l.Y)(x.A,(0,n._)({},tt))}):null,c?t?(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:"".concat(ev.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ek.VU.substack,"&utm_medium=").concat(ek.Jn.email),children:[(0,l.Y)(P.A,(0,n._)({},tt)),(0,l.Y)("span",{className:"email-button-text",children:f("Comment")})]}):(0,l.Y)(ti,{href:"".concat(ev.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ek.VU.substack,"&utm_medium=").concat(ek.Jn.email),children:(0,l.Y)(P.A,(0,n._)({},tt))}):null,o&&a&&(t?(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:ev.T.SHARE_URL,children:[(0,l.Y)(M.A,(0,n._)({},tt)),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]}):(0,l.Y)(ti,{href:ev.T.SHARE_URL,children:(0,l.Y)(M.A,(0,n._)({},tt))})),m&&(t?(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:"".concat(ev.T.RESTACK_COMMENT_URL,"&utm_source=").concat(ek.VU.substack,"&utm_medium=").concat(ek.Jn.email),children:[(0,l.Y)(B.A,(0,n._)({},tt)),(0,l.Y)("span",{className:"email-button-text",children:f("Restack")})]}):(0,l.Y)(ti,{href:"".concat(ev.T.RESTACK_COMMENT_URL,"&utm_source=").concat(ek.VU.substack,"&utm_medium=").concat(ek.Jn.email),children:(0,l.Y)(B.A,(0,n._)({},tt))}))]})}),(0,l.Y)("td",{align:"right",children:(0,l.FD)(Q.ZB,{gap:8,children:[o&&!a&&!t&&(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:ev.T.SHARE_URL,children:[(0,l.Y)("div",{className:"email-button-spacer"}),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]}),a&&!t&&(0,l.FD)(Q.tR,{aClassName:"email-button-outline",href:"".concat(ev.T.POST_APP_LINK_URL,"&utm_campaign=email-read-in-app"),children:[(0,l.Y)("div",{className:"email-button-spacer"}),(0,l.Y)("span",{className:"email-button-text",style:{marginRight:4},children:v}),(0,l.Y)(E.A,(0,r._)((0,n._)({},tt),{className:s()("icon","text-icon")}))]})]})})]})})})}),(0,l.Y)(te,{})]}):(0,l.Y)(Q.h2,{className:"email-ufi-2-empty",width:"100%",children:(0,l.Y)("tr",{height:1,children:(0,l.Y)("td",{height:1,style:{fontSize:0,lineHeight:0},children:"\xa0"})})})}function te(){return(0,l.Y)("tr",{height:16,children:(0,l.Y)("td",{height:16,style:{fontSize:0,lineHeight:0},children:"\xa0"})})}let tt={className:"icon",height:18,strokeWidth:1,isStatic:!0,stroke:"#808080",fill:"none"};function ti(e){let{size:t=38,href:i,children:n}=e;return(0,l.Y)(Q.h2,{width:t,children:(0,l.Y)("tr",{children:(0,l.Y)("td",{align:"center",children:(0,l.Y)("a",{className:"email-icon-button",href:i,style:{width:t},children:n})})})})}},55136:function(e,t,i){i.d(t,{LZ:()=>P,Qw:()=>F,cy:()=>N,wx:()=>I,xu:()=>A});var n=i(99851),r=i(69277),a=i(10201),l=i(32485),o=i.n(l),s=i(36119),c=i.n(s),d=i(17402),u=i(15734),p=i.n(u),h=i(97432),m=i(43427),g=i(86271),f=i(84605),v=i(70145),b=i(34835),y=i(86500),Y=i(68349),_=i(76977),w=i(63136),C=i(98111),k=i(39318),S=i(82776);let I=(e,t,i)=>{let{reaction:n,reactions:r,reactor_names:a}=D(e,t,i);T(t,n,r,a)},F=(e,t)=>D(e,t,!t.reaction),D=(e,t,i)=>{let n="reaction"in t?t.reaction:void 0,{reactions:a={"❤":0},reactor_names:l=[]}=t;if(a=(0,r._)({},a),l=[...l],i&&!n){let t=a[n="❤"];a[n]=t?t+1:1,e&&e.is_public_admin&&l.push(e.name||"author")}else!i&&n&&(a["❤"]=a["❤"]?a["❤"]-1:0,e&&e.is_public_admin&&(l=l.filter(t=>t!==(e.name||"author"))),n=null);return{reaction:n,reactions:a,reactor_names:l}},T=(e,t,i,n)=>{e.reaction=t,e.reactions=i,e.reactor_names=n};function A(e,t,i,n){let r=(0,k.yRP)("/api/v1/".concat(t?"comment":"post","/").concat(e.id,"/reaction"),{token:n});return i?p().post(r).send({reaction:"❤"}):p().delete(r)}class E extends d.Component{notifyParent(e){let{reaction:t,reactions:i,reactor_names:n}=e,a=(0,r._)({},this.props.post),l=this.props.comment&&(0,r._)({},this.props.comment);T(l||a,t,i,n),this.props.onChange&&this.props.onChange({post:a,comment:l})}async reactionRejected(e){(0,y.u4)(y.qY.REACTION_REJECTED,{comment_id:this.props.comment&&this.props.comment.id,post_id:this.props.post&&this.props.post.id,reason:"Not logged in",unreact:!e}),await new Promise(e=>{this.state.includeModal?this.modalRef.current.open(e):this.setState({includeModal:!0},()=>this.modalRef.current.open(e))})}render(){let e,{className:t,user:i,pub:n,comment:r,height:l,isStatic:s,post:d,buttonStyle:u,hideReactionCount:p,countInParenthesesStyle:h,iString:g}=this.props,f=r||d,v=null==f?void 0:f.reaction,b=(null==f?void 0:f.reactions)||{},y=c()(Object.values(b));return e=d&&d.reaction_url_override?d.reaction_url_override:s?C.T.REACTION_URL:"javascript:void(0)",(0,a.FD)(w.EY,{as:"span",decoration:"hover-underline",color:v?"error":"pub-secondary-text",className:t,children:[this.props.render?this.props.render({liked:v,numReactions:y>0?(0,S.numberToString)(y):null,onClick:e=>{this.react(e)}}):(0,a.Y)("a",{href:e,className:o()("like-button",{button:u,"post-meta-button":u,liked:v}),onClick:e=>this.react(e),children:(0,a.FD)(_.pT,{gap:6,alignItems:"center",className:t,children:[s?(0,a.Y)(m.A,{ampProps:{layout:"fixed"},isStatic:!0,height:l,stroke:"var(--color-fg-secondary-themed)",fill:"transparent"}):(0,a.FD)(_.pT,{className:"reaction-container",children:[(0,a.Y)(m.A,{className:"animation"}),!v&&(0,a.Y)(m.A,{strokeWidth:2,height:l,fill:"transparent",stroke:"var(--color-fg-secondary-themed)"}),v&&(0,a.Y)(m.A,{height:l,strokeWidth:2})]}),h?(0,a.FD)(w.EY.Meta,{color:v?"error":"pub-secondary-text",className:"like-count",children:[g(v?"Liked":"Like"),!p&&y>0?" (".concat((0,S.numberToString)(y),")"):""]}):!p&&y>0?(0,a.Y)("span",{className:"like-count",children:(0,S.numberToString)(y)}):u?(0,a.Y)("span",{className:"like-count",children:g("Like")}):null]})}),!s&&this.state.includeModal&&(0,a.Y)(P,{modalRef:this.modalRef,user:i,pub:n,comment:r,react:this.react})]})}constructor(...e){super(...e),(0,n._)(this,"state",{includeModal:!1}),(0,n._)(this,"modalRef",(0,d.createRef)()),(0,n._)(this,"react",async e=>{if(this.props.commentActionsOverride){null==e||e.preventDefault(),null==e||e.stopPropagation(),this.props.commentActionsOverride();return}if(this.props.isStatic)return;e&&(e.preventDefault(),e.stopPropagation());let t=this.props.comment||this.props.post;if(!t)return void console.warn("LikeButton: no subject");let i=!t.reaction;if(this.props.onReactedChange&&this.props.onReactedChange(i),this.props.noSelfUpdate)return;let n=await (0,Y.vL)(this,"locked",async(e,t)=>{let n,r=t.comment||t.post;if(!r)return void console.warn("LikeButton: no subject");let a=A(r,!!t.comment,i,t.token);t.oauthAccessToken&&a.set("Authorization","Bearer ".concat(t.oauthAccessToken));let{reaction:l,reactions:o,reactor_names:s}=F(t.user,r);this.notifyParent({reactions:o,reaction:l,reactor_names:s});try{await a}catch(e){n=e,this.notifyParent(r)}return{error:n,reaction:l}});return n&&n.error&&(n.error.response&&401===n.error.response.statusCode?await this.reactionRejected(n.reaction):alert((0,Y.uX)(n.error))),!!n&&!n.error})}}let N=(0,f.wr)((0,v.ct)(E));function P(e){let{comment:t,pub:i,user:n,modalRef:r,onClose:l,react:o}=e,{iString:s}=(0,f.GO)();return(0,a.Y)(g.A,{ref:r,onClose:l,children:(0,a.FD)(_.I1,{alignItems:"center",paddingTop:80,gap:24,children:[(0,a.Y)(w.EY.H2,{children:s(t?"Subscribe to like this comment":"Subscribe to like this post")}),(0,a.Y)(h.A,{user:n,pub:i,showLogin:!0,showTerms:!0,source:"like_button",onSuccess:async e=>{let t=e&&e.body&&e.body.email;e&&e.body&&e.body.prompt_to_login||!await o()?window.location.href=(0,k.a7q)({for_pub:i.subdomain,email:t}):(null==r?void 0:r.current)&&((0,b.E)({freeSignup:!0,freeSignupEmail:t}),await r.current.close())}})]})})}},15667:function(e,t,i){i.d(t,{H:()=>C,w:()=>w});var n=i(79785),r=i(10201),a=i(37946),l=i(44471),o=i(17402),s=i(84605),c=i(68349),d=i(35369),u=i(76977),p=i(16993),h=i(19832),m=i(84843),g=i(94996),f=i(63136),v=i(11587),b=i(36372),y=i(74588);function Y(){let e=(0,n._)(["Your report and profile will be shared with the admins of ","."]);return Y=function(){return e},e}let _=["hate","private_information","plagiarism","impersonation","illegal_activity","spam","pornography","other"],w=["impersonation","spam","pornography","other"];function C(e){var t,i;let{isOpen:n,pub:w,onClose:C,onSubmit:S=()=>Promise.resolve(),canReportToAdmins:I=!1,reasons:F=_}=e,[D,T]=(0,o.useState)(null),{iString:A,iTemplate:E,language:N}=(0,s.GO)(),[P,x]=(0,o.useState)(null),[L,R]=(0,o.useState)(!1),[M,B]=(0,o.useState)(!1),[O,U]=(0,o.useState)(!I),{popToast:j}=(0,b.d)();if((0,o.useEffect)(()=>{n&&U(!I)},[n,I,F]),(0,o.useEffect)(()=>{O?B(!!D):B(!!P)},[O,D,P,F]),I&&!w)return console.error("Must supply pub if reporting to pub admins is possible"),null;let z=O?"Report to Substack":"Report to the ".concat(I18N.p(null!=(t=null==w?void 0:w.name)?t:"")," admins");return(0,r.FD)(r.FK,{children:[(0,r.FD)(p.aF,{isOpen:n,onClose:C,disableCloseOnBackdropClick:L||O,children:[(0,r.Y)(p.rQ,{title:z,icon:(0,r.Y)(m.qx,{bg:"accent-red",icon:(0,r.Y)(a.A,{stroke:"var(--color-semantic-error-fg-primary)"})}),description:(0,r.Y)(k,{reportingToSubstack:O,pub:null!=w?w:null,onReportToSubstackClicked:()=>{U(!0)}}),showClose:!0,onClose:C}),(0,r.Y)(p.cw,{children:(0,r.FD)(u.I1,{gap:20,children:[O&&(0,r.Y)(r.FK,{children:(0,r.FD)(u.I1,{gap:8,children:[(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Reason"}),(0,r.FD)(g.I,{value:null!=D?D:void 0,onChange:e=>{T(e.target.value)},children:[(0,r.Y)(g.K,{children:A("Select a reason")}),F.map(e=>(0,r.Y)("option",{value:e,children:(e=>{let{category:t,language:i="en"}=e;return(0,y.j)({category:t,language:i})})({category:e,language:N})},e))]})]})}),(0,r.FD)(u.I1,{gap:8,children:[(0,r.FD)(u.Ye,{justifyContent:"space-between",children:[O?(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Additional details"}):(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Reason"}),O&&(0,r.Y)(f.EY.B4,{color:"secondary",translated:!0,children:"Optional"})]}),(0,r.Y)(v.T,{onChange:e=>{x(e.currentTarget.value||null)},placeholder:A("Describe why you're reporting this...")})]})]})}),(0,r.Y)(p.jl,{alignButtons:"stretch",primaryButton:(0,r.Y)(d.$n,{disabled:!M,priority:"destructive",onClick:()=>{R(!0)},children:A("Submit")})})]}),(0,r.Y)(h.m,{isOpen:L,onClose:()=>{R(!1)},title:A("Submit report?"),description:O?A("Reported content will be reviewed and removed if it violates our Content Guidelines."):E(Y(),null!=(i=null==w?void 0:w.name)?i:"this publication"),primaryButton:(0,r.Y)(d.$n,{priority:"destructive",onClick:async()=>{R(!1);try{await S({reportCategory:O?D:null,details:P,reportedToSubstack:O})}catch(i){console.error("could not submit report",i);let e=(0,c.uX)(i),t=e&&e.startsWith("Something went wrong")?e:"Something went wrong: ".concat(e);j(()=>(0,r.Y)(b.y,{text:t}));return}j(()=>(0,r.Y)(b.y,{text:"Your report was submitted",Icon:l.A}))},children:A("Submit report")}),secondaryButton:(0,r.Y)(d.$n,{priority:"secondary",onClick:()=>{R(!1)},children:A("Cancel")})})]})}function k(e){var t;let{reportingToSubstack:i,pub:n,onReportToSubstackClicked:a}=e;return i?(0,r.FD)(f.EY,{translated:!0,children:["Report content that violates Substack's"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://substack.com/content",target:"_blank",rel:"noreferrer",children:"Content Guidelines"})," ","below. Your report is only viewed by our staff. Find additional reporting options and information in our"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://support.substack.com/hc/en-us/articles/23248646000532",target:"_blank",rel:"noreferrer",children:"Standards and Enforcement Help Center"}),"."]}):(0,r.FD)(f.EY,{translated:!0,children:[(0,r.FD)(f.EY.B3,{color:"secondary",translated:!0,children:["Your report and profile will be shared with the admins of ",(0,r.Y)("strong",{children:I18N.p(null!=(t=null==n?void 0:n.name)?t:"")}),", since at Substack we believe publication owners are best able to moderate their communities."]}),(0,r.FD)(f.EY.B3,{translated:!0,color:"secondary",children:["If you believe something violates Substack's"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://substack.com/content",target:"_blank",rel:"noreferrer",children:"Content Guidelines"}),", you can"," ",(0,r.Y)(f.Yq,{color:"highlight",onClick:()=>{a()},children:"report it to Substack"})," ","instead."]})]})}},82011:function(e,t,i){i.d(t,{L:()=>u});var n=i(79785),r=i(10201),a=i(73062),l=i(32600),o=i(84605),s=i(36372);function c(){let e=(0,n._)(["You'll no longer be notified when this author publishes."]);return c=function(){return e},e}function d(){let e=(0,n._)(["You'll be notified by email whenever this author publishes."]);return d=function(){return e},e}let u=e=>{let{authorId:t,minimize:i,className:n}=e,{popToast:u}=(0,s.d)(),{iTemplate:p}=(0,o.GO)(),{isSubscribedToAuthor:h,toggleSubscription:m}=(0,l.C)(t);return(0,r.Y)(a.i,{className:n,isSubscribed:h,minimize:i,onClick:async e=>{e.preventDefault(),e.stopPropagation(),await m(),u(()=>(0,r.Y)(s.y,{text:h?p(c()):p(d())}))}})}},20410:function(e,t,i){i.d(t,{$:()=>_});var n=i(10201),r=i(43954),a=i(45773),l=i(49436),o=i(17402),s=i(38685),c=i(72880),d=i(82528),u=i(63446),p=i(15894),h=i(32600),m=i(84605),g=i(16447),f=i(60355),v=i(97778),b=i(16074),y=i(76977),Y=i(82776);let _=e=>{var t,i,_,w,C,k,S;let{author_id_or_slug:I,authorInfo:F,posts:D,pub:T,user:A,utm:E}=e,{authorInfo:N,posts:P}=(0,v.Y)({author_id_or_slug:I,authorInfoPreload:F,postsPreload:D,pub:T}),{isSubscribedToAuthor:x,toggleSubscription:L,hasSection:R}=(0,h.C)(null!=(t=null==N?void 0:N.user_id)?t:0),{iString:M}=(0,m.GO)(),B=null!=(i=null==N?void 0:N.name)?i:"",O=null!=(_=null==N?void 0:N.bio)?_:"",U=null!=(w=null==N?void 0:N.photo_url)?w:null,j=null!=(C=null==N?void 0:N.twitter_screen_name)?C:"",z=null!=(S=null!=(k=null==N?void 0:N.email_for_display)?k:null==N?void 0:N.email)?S:"",H=(0,Y.isDefaultMarblePhoto)(U)?void 0:U;return(0,n.Y)(d.y,{belowDescription:(0,n.FD)(y.I1,{gap:16,children:[z&&(0,n.FD)(y.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(r.A,{size:16}),(0,n.Y)(p.T,{preset:"body-link",children:(0,n.Y)("a",{href:"mailto:".concat(z),children:z})})]}),j&&(0,n.FD)(y.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(s.A,{size:16}),(0,n.Y)(p.T,{preset:"body-link",children:(0,n.Y)("a",{href:"https://x.com/".concat(j),children:j})})]}),R&&(0,n.FD)(o.Fragment,{children:[(0,n.Y)(b.c,{paddingY:8}),(0,n.FD)(y.I1,{alignItems:"start",gap:16,children:[(0,n.Y)(u.v,{size:"sm",variant:"outline",onClick:L,children:x?(0,n.FD)(y.Ye,{alignItems:"center",gap:8,children:[M("Notified")," ",(0,n.Y)(a.A,{size:16})]}):(0,n.FD)(y.Ye,{alignItems:"center",gap:8,children:[M("Get Notified")," ",(0,n.Y)(l.A,{size:16})]})}),(0,n.Y)(p.T,{preset:"detail-small",children:M(x?"You'll be notified by email whenever this author publishes.":"Get notified by email whenever this author publishes.")})]})]})]}),bodyWrapperVariant:"two-middle-columns",description:null!=O?O:void 0,image:H?(0,n.Y)(c.o,{maxWidth:400,src:H,style:{maxWidth:"100%"}}):void 0,isLoading:!N,title:B,children:N&&P&&(0,n.Y)(g.M,{authorId:N.user_id,hideCommunity:!0,isPodcast:!1,newPosts:P,pub:T,renderLoading:()=>null,user:A,utm:E,children:e=>{let{posts:t}=e;return(0,n.Y)(y.I1,{gap:24,children:t.map((e,t)=>(0,n.FD)(n.FK,{children:[0!==t&&(0,n.Y)(b.c,{}),(0,n.Y)(f.R,{post:e,variant:"archive"})]}))})}})})}},19449:function(e,t,i){i.d(t,{r:()=>y,e:()=>b});var n=i(10201),r=i(84934),a=i(52117),l=i(15113),o=i(72880),s=i(82528),c=i(1842),d=i(90847),u=i(84605),p=i(68410),h=i(35369),m=i(92636),g=i(39891),f=i(18947);let v="image-sYkLIi",b={careers:{slug:"careers",title:(0,n.FD)("span",{children:["Join ",(0,n.Y)("em",{children:"The Free Press"})]}),description:(0,n.FD)("span",{children:[(0,n.Y)("em",{children:"The Free Press"})," is seeking exceptional people who share our values."]})},about:{slug:"about",title:(0,n.FD)("span",{children:["About",(0,n.Y)("br",{}),(0,n.Y)("em",{children:"The Free Press"})]}),description:"A new media company built on the ideals that were once the bedrock of American journalism."},"the-free-press-book-club":{slug:"the-free-press-book-club",title:"The Free Press Book Club",description:"Each month, one Free Press writer sits down with the author of a new, vital book. We’ve read and discussed novels, essay collections, political criticism, and more. Book club attendees get a copy of the book, an opportunity to ask questions, and to meet other Free Pressers.",image:(0,n.Y)(o.o,{alt:"The Free Press Book Club",className:v,maxWidth:540,src:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/fp-book-club-cover.jpg"))})},america250:{slug:"america250",title:"The Free Press Presents: America at 250",description:"\nTwo and a half centuries later, we still hold these truths to be self-evident.\n\nJoin us for a yearlong celebration of America’s 250th birthday: where we’ve come from, where we are, and where we’re going. Expect big events, small gatherings, performances, podcasts, videos, and essays from your favorite _Free Press_ contributors, and many others. Find out about all of it here, first.",image:(0,n.Y)(o.o,{alt:"America at 250",className:v,maxWidth:540,src:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/america250Final.png"))}),socialImage:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/america250SocialFinal.png"))},"community-guidelines":{slug:"community-guidelines",title:"Community Guidelines",description:""},"privacy-notice":{slug:"privacy-notice",title:"Privacy Notice",description:""},"upcoming-events":{slug:"upcoming-events",title:"Upcoming Events",description:""},faq:{slug:"faq",title:"Frequently Asked Questions",description:""}},y=e=>{var t,i,o;let{pub:m,post:g,user:v,type:y,html:Y,isAboutPage:_}=e,w=b[y],{isMobile:C}=(0,p.sM)(),{iString:k}=(0,u.GO)(),S=!!((null==v?void 0:v.is_contributor)&&(null==g?void 0:g.id)&&(null==g?void 0:g.type)==="page"),I=(0,a.Rv)(Y,"h1, h2, h3"),F="string"==typeof(null==w?void 0:w.title)?w.title:(null==g?void 0:g.title)||"";return(0,n.Y)(s.y,{aboveTitle:S&&(null==g?void 0:g.id)?(0,n.Y)(h.$n,{href:(0,f.I_)(m,g.id,{params:{back:document.location.href}}),leading:(0,n.Y)(r.A,{size:20}),localNavigation:!1,priority:"secondary",children:k("Edit")}):null,description:(null==w?void 0:w.description)||"",image:null==w?void 0:w.image,metadata:{image:null!=(t=null==w?void 0:w.socialImage)?t:void 0,twitterImage:null!=(i=null==w?void 0:w.socialImage)?i:void 0},title:(null==w?void 0:w.title)||(null==g?void 0:g.title)||"",children:(0,n.FD)("div",{className:"typography post",children:[I&&(0,n.Y)(c._,{postId:null==g?void 0:g.id,showComments:!1,title:F,toc:I,wordCount:null!=(o=null==g?void 0:g.wordcount)?o:0}),(0,n.Y)("div",{className:C?"":"container",children:(0,n.Y)(d.Z,{isCustomPage:!0,children:(0,n.Y)(l.A,{html:Y,isAboutPage:_,post:g,pub:m,user:v})})})]})})}},20905:function(e,t,i){i.d(t,{X:()=>T});var n=i(10201),r=i(17402),a=i(79909),l=i(13950),o=i(38486),s=i(44815),c=i(32485),d=i.n(c),u=i(76977);let p=e=>{let{imageUrl:t,children:i,textAlign:r="left",useFixedAspectRatio:a=!1}=e;return(0,n.Y)("div",{className:"background-XIOFVG",children:(0,n.FD)("div",{className:"container-MxDuwa",children:[(0,n.Y)("img",{alt:"Events",className:d()("headerImage-mfhwbd",a?"headerImageAspect-T8HgTk":null),src:t}),(0,n.Y)(u.I1,{alignItems:"center"===r?"center":"start",className:"content-bcrzex",justifyContent:"center",position:"relative",textAlign:r,children:i})]})})};var h=i(22884),m=i(57898),g=i(53696),f=i(19449),v=i(15894),b=i(27428),y=i(25006),Y=i(44333),_=i(68410),w=i(28528),C=i(16291),k=i(39862),S=i(41086),I=i(49807),F=i(52050);let D=e=>{let{event:t,pub:i,user:r,post:a}=e,l=t?(0,o.dN)(t.location):null;return t?(0,n.FD)(n.FK,{children:[(0,n.Y)(v.T,{color:"white",preset:"h2-serif",children:t.title}),(0,n.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:t.dateTime&&"".concat((0,C.A)(t.dateTime).format("MMMM D, YYYY")," ").concat((0,C.A)(t.dateTime).format("h:mma"))}),(0,n.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:[l," at ",t.place]}),(0,n.Y)(m.z,{event:t,isHeader:!0,post:a,pub:i,surface:"fp-events",user:r})]}):null},T=e=>{var t;let{pub:i,user:c,fpEventsData:d}=e,{initialSections:m}=(0,b.M)({pub:i}),[C]=(0,Y.rd)(),{isMobile:T}=(0,_.sM)(),A=!!(null==c?void 0:c.is_admin)&&!C.url.includes("hideAdmin"),[E,N]=(0,r.useState)((0,S.y)("event_id")||void 0),[P,x]=(0,r.useState)((0,S.y)("series")||void 0),{result:L,refetch:R}=(0,o.ZJ)(),M=(null==L?void 0:L.configs)||[],{result:B}=(0,o.uL)(E),O=null==B||null==(t=B.config)?void 0:t.value,U=e=>{x(void 0),N(e);let t=e?"?event_id=".concat(e):"";window.history.pushState(null,"","/events".concat(t))},{title:j,description:z}=f.e["the-free-press-book-club"],H={id:"the-free-press-book-club",title:j.toString(),imageUrl:"".concat((0,I.Ewe)(),"/img/thefp/fp-book-club-cover.jpg"),description:z.toString(),url:"/p/the-free-press-book-club"},{title:W,description:V}=f.e.america250,K=[{id:"the-free-press-presents-america-at-250",title:W.toString(),imageUrl:"".concat((0,I.Ewe)(),"/img/thefp/america250Final.png"),description:V.toString(),url:"/america250"},...m.map(e=>({id:e.slug,title:e.name,imageUrl:e.logo_url||"",description:e.description,url:(0,I.Dor)(i,{section:e})})),H],q=P?K.find(e=>e.title===k.n[P]):void 0;return(0,n.Y)(y.Eo,{pub:i,children:(0,n.Y)(w.XL,{pub:i,children:(0,n.FD)(l.DH,{children:[(null==d?void 0:d.socialPreviewImage)&&(0,n.Y)(a.Metadata,{image:(0,I.dJ9)(null==d?void 0:d.socialPreviewImage,800,{crop:"crop",height:800}),pub:i}),E&&O?(0,n.FD)("div",{children:[(0,n.Y)(p,{imageUrl:null==O?void 0:O.image,textAlign:"center",children:(0,n.Y)(D,{event:O,post:null,pub:i,user:null!=c?c:null})}),(0,n.Y)(g.r,{children:(0,n.Y)(u.I1,{paddingBottom:32,paddingTop:40,children:(0,n.Y)(s.s,{eventId:E,goToEvent:U,post:null,pub:i,surface:"fp-events",user:null!=c?c:null})})})]}):P?(0,n.FD)("div",{children:[(0,n.FD)(p,{imageUrl:(null==q?void 0:q.imageUrl)||(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/events.jpg")),textAlign:"center",children:[(0,n.Y)(v.T,{color:"white",preset:"h2-serif",children:k.n[P]}),(0,n.Y)(u.Ye,{paddingBottom:40,children:(0,n.Y)(v.T,{color:"white",preset:"body",children:null==q?void 0:q.description})})]}),(0,n.Y)(g.r,{children:(0,n.Y)(u.I1,{alignSelf:"center",className:F.A.eventsContainer,maxWidth:T?480:void 0,paddingBottom:32,paddingTop:40,children:(0,n.Y)(h.y,{allEvents:M.filter(e=>e.value.series===P),goToEvent:U,isAdmin:A,post:null,pub:i,refetchEvents:R,showBackToEvents:!0,showSeries:!1,user:null!=c?c:null})})})]}):(0,n.FD)("div",{children:[(0,n.FD)(p,{imageUrl:(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/events.jpg")),useFixedAspectRatio:!0,children:[(0,n.Y)(u.Ye,{alignItems:"center",width:"100%",children:(0,n.Y)(v.T,{align:T?"center":"left",color:"white",preset:"h2-serif",children:T?"The Free Press Events":"Events"})}),(0,n.FD)(u.I1,{gap:24,paddingBottom:40,children:[(0,n.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:"We believe ideas are meant to be tested—debated, challenged, and sometimes turned on their head. Open dialogue isn’t a luxury; it’s essential to a healthy democracy. And the best way to have it is live and in person."}),(0,n.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:["We bring together the most fascinating thinkers, writers, and provocateurs—and the readers who make it all possible. Whether it’s a high-stakes debate, a live taping of ",(0,n.Y)("em",{children:"Honestly"}),", or an election-night gathering, every ",(0,n.Y)("em",{children:"Free Press"})," event has one thing in common: the people. Curious, independent-minded, and fiercely civil, ",(0,n.Y)("em",{children:"Free Pressers"})," come ready to think hard—and have a good time doing it."]})]})]}),(0,n.Y)(g.r,{children:(0,n.Y)(u.I1,{alignSelf:"center",className:F.A.eventsContainer,maxWidth:T?480:void 0,paddingBottom:32,paddingTop:40,children:(0,n.Y)(h.y,{allEvents:M,goToEvent:U,goToSeries:e=>{N(void 0),x(e);let t=e?"?series=".concat(e):"";window.history.pushState(null,"","/events".concat(t))},isAdmin:A,post:null,pub:i,refetchEvents:R,seriesConfig:K,showSeries:!0,user:null!=c?c:null})})})]})]})})})}},77238:function(e,t,i){i.d(t,{B:()=>o});var n=i(10201),r=i(82528),a=i(73090),l=i(16447);let o=e=>{let{pub:t,user:i,newPostsForArchive:o,metadata:s,utm:c}=e;return(0,n.Y)(r.y,{bodyWrapperVariant:"two-middle-columns",metadata:s,title:"Latest",children:(0,n.Y)(l.M,{hideCommunity:!0,hideTop:!0,newPosts:null==o?void 0:o.pub,pub:t,renderLoading:()=>null,source:"archive",user:i,utm:c,children:e=>{let{posts:t}=e;return(0,n.Y)(a.R,{posts:t})}})})}},17450:function(e,t,i){i.d(t,{y:()=>ek});var n=i(69277),r=i(70408),a=i(79785),l=i(10201),o=i(97213),s=i(17402),c=i(15734),d=i.n(c),u=i(23623),p=i(79909),h=i(13950),m=i(48697),g=i(77849),f=i(63446),v=i(72102),b=i(13482),y=i(15894),Y=i(85042),_=i(68410),w=i(76977);let C=e=>{let{isMinimized:t,liveStream:i,onMaximizeChat:n}=e,{isMobile:r,isMobileLandscape:a}=(0,_.sM)(),o=(0,s.useRef)(null),{message:c,setMessage:d,loading:u,sendMessage:p}=(0,Y.M)({inputRef:o,liveStream:i}),h=async()=>{await p(),t&&n()},m=async e=>{"Enter"===e.key&&await h()},g=i.liveStreamInformation.chatAuthInfo.canSendChat;return(0,l.FD)(w.I1,{flex:"grow",children:[t&&(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",borderTop:r?"detail":void 0,cursor:"pointer",justifyContent:"space-between",paddingX:24,paddingY:16,onClick:n,children:[(0,l.Y)(y.T,{preset:"d1-sans-medium",children:"Live Chat"}),(0,l.Y)(v.A,{})]}),(0,l.Y)(w.I1,{flex:r||a?void 0:"grow",paddingX:24,paddingY:r||a?24:t?16:24,children:(0,l.Y)(b.w,{ref:o,disabled:!g||u,flex:"grow",liveStream:i,placeholder:g?"Write message...":i.liveStreamInformation.chatAuthInfo.errorMessage,rows:r||a||t?1:3,style:{flexGrow:1},value:c,onChange:e=>{d(e.currentTarget.value)},onKeyDown:m,onSend:h})})]})};var k=i(75107),S=i(83804);let I=e=>{let{headerHeight:t,liveStream:i,onMinimizeChat:n}=e;return(0,l.FD)(w.I1,{flex:"grow",children:[(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",cursor:"pointer",justifyContent:"space-between",paddingX:24,paddingY:t?void 0:16,style:t?{height:t}:void 0,onClick:n,children:[(0,l.Y)(y.T,{preset:"d1-sans-medium",children:"Live Chat"}),(0,l.Y)(k.A,{})]}),(0,l.Y)(w.I1,{flex:"grow",position:"relative",children:(0,l.Y)(S.lC,{liveStream:i})})]})};var F=i(3160),D=i(13589),T=i(80703),A=i(16008),E=i(66511),N=i(49807),P=i(57324);let x=e=>{let{liveStream:t,pub:i,viewerCount:a,concurrentViewerCount:o}=e,[c,d]=(0,D.Mk)(),[u,p]=(0,s.useState)(!1),{isMobile:h}=(0,_.sM)(),m=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(y.T,{clamp:1,preset:"h5-serif",children:t.liveStream.title}),t.liveStream.description&&(0,l.Y)(y.T,{clamp:2,preset:"d3-serif",children:t.liveStream.description})]}),g="Total: ".concat(a,"\nCurrent: ").concat(o),f=(0,l.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,l.Y)("div",{className:"liveTag-MsSGA4",children:(0,l.Y)(y.T,{preset:"detail-large",children:"Live"})}),(0,l.Y)(E.m_,{delayEnter:100,disabled:h,text:g,children:(0,l.FD)(w.Ye,{alignItems:"center",className:"viewerCount-R1kN0i",cursor:"pointer",gap:8,onClick:()=>{h&&p(!u)},children:[(0,l.Y)(F.A,{}),(0,l.Y)(y.T,{preset:"detail-small",children:a})]})})]}),v=(0,l.Y)(A.X,{shareName:t.liveStream.title,shareUrl:(0,N.QMq)({pub:i,utm_source:P.VU.liveStreamShareButton}),trackParams:{live_stream_id:t.liveStream.id},trigger:(0,l.Y)(w.Ye,(0,r._)((0,n._)({},d),{alignItems:"center",cursor:"pointer",children:(0,l.Y)(T.A,{height:24,isHovered:c,width:24})})),utmCampaign:P._9.liveStreamPermalink});return h?(0,l.FD)(w.I1,{gap:24,paddingX:28,paddingY:16,children:[(0,l.FD)(w.Ye,{alignItems:"center",gap:8,justifyContent:"space-between",children:[f,v]}),m]}):(0,l.FD)(w.Ye,{alignItems:"start",gap:24,justifyContent:"space-between",paddingX:24,paddingY:24,children:[m,(0,l.FD)(w.Ye,{alignItems:"center",gap:24,children:[f,v]})]})},L=e=>{let{user:t,subscribeUrl:i}=e;return(0,l.FD)(w.I1,{gap:40,children:[(0,l.FD)(w.I1,{alignItems:"center",gap:8,children:[(0,l.Y)(y.T,{align:"center",preset:"h4-sans-condensed",children:"Stream Ended"}),(0,l.Y)(y.T,{align:"center",preset:"d1-sans-regular",children:(null==t?void 0:t.is_subscribed)?"Thanks for watching!":"".concat((null==t?void 0:t.is_free_subscribed)?"Upgrade":"Subscribe"," to watch the next live stream")})]}),(0,l.FD)(w.I1,{alignItems:"stretch",alignSelf:"stretch",gap:8,children:[(null==t?void 0:t.is_subscribed)?(0,l.Y)(f.v,{href:"/videos",variant:"outline",children:"Watch More"}):(0,l.Y)(f.v,{href:i,native:!0,variant:"primary-accent",children:(null==t?void 0:t.is_free_subscribed)?"Upgrade":"Subscribe"}),(0,l.Y)(f.v,{href:"/",variant:"tertiary",children:"Back to Homepage"})]})]})};var R=i(75999),M=i(35369);let B=e=>{let{closeHref:t,height:i,user:n,subscribeUrl:r}=e,{isMobile:a,isMobileLandscape:o}=(0,_.sM)();return(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",className:"container-j8poGw",justifyContent:"space-between",paddingLeft:24,paddingRight:16,paddingY:i?void 0:a?12:16,style:i?{height:i}:void 0,children:[(0,l.Y)(R.u,{forceMobile:a||o,height:56}),(0,l.FD)(w.Ye,{alignItems:"center",gap:16,children:[!(null==n?void 0:n.is_subscribed)&&(0,l.Y)(f.v,{href:r,native:!0,size:o?"sm":a?"md":"lg",trailingIcon:"plus",variant:"primary-accent",children:(null==n?void 0:n.is_free_subscribed)?"Upgrade":"Subscribe"}),(0,l.Y)(M.K0,{href:t,priority:"quaternary",children:(0,l.Y)(m.A,{})})]})]})};var O=i(45773),U=i(84605),j=i(68349),z=i(24078),H=i(17028),W=i(16993),V=i(36372),K=i(16884),q=i(39318);function G(){let e=(0,a._)(["Subscribed to ",""]);return G=function(){return e},e}let J=e=>{let{liveStream:t,guests:i,subscriptions:n,setSubscriptions:r,isHostsModalOpen:a,setIsHostsModalOpen:o,user:s}=e,{iString:c}=(0,U.GO)();return(0,l.FD)(W.aF,{isOpen:a,onClose:()=>o(!1),children:[(0,l.Y)(W.rQ,{showClose:!0,showDivider:!0,title:c(i.length?"Hosts":"Host"),onClose:()=>o(!1)}),(0,l.Y)(W.cw,{children:(0,l.Y)(H.I1,{gap:20,children:[t,...i.map(e=>e)].map(e=>{var t,i;let{user:a,pub:o}=e,c=["free_signup","subscribed"].includes(null!=(i=null==(t=n.filter(e=>e.publication_id===(null==o?void 0:o.id)).map(e=>e.membership_state))?void 0:t[0])?i:"unsubscribed");return(0,l.Y)($,{isSubscribed:c,pub:o,setSubscriptions:r,streamingUser:a,subscriptions:n,user:s})})})})]})},$=e=>{var t,i;let{streamingUser:a,pub:o,isSubscribed:c,subscriptions:d,setSubscriptions:u,user:p}=e,{iString:h,iTemplate:m}=(0,U.GO)(),{popToast:g}=(0,V.d)(),[v,b]=(0,s.useState)([]);return(0,l.FD)(H.Ye,{alignItems:"center",gap:12,children:[(0,l.Y)(z.dm,{linkProps:{target:"_blank"},size:40,user:a,utmSource:P.VU.liveStreamHostModal}),(0,l.FD)(H.I1,{flex:"grow",children:[(0,l.Y)(Z,{streamingUser:a}),(0,l.Y)(Q,{pub:o})]}),o?(0,l.Y)(f.v,{disabled:c||v.includes(o.id)||["free_signup","subscribed"].includes(null!=(i=null==(t=d.find(e=>e.publication_id===o.id))?void 0:t.membership_state)?i:"unsubscribed"),size:"sm",variant:"primary-accent",onClick:async()=>{if(!p){window.location.href=(0,q.my9)(o,{utm_source:P.VU.liveStreamHostModal,next:document.location.href,utm_medium:P.Jn.web});return}b(e=>[...e,o.id]);try{let e=await (0,K.yc)(o.id,P.VU.liveStreamHostModal,{publication:o,user:p,openPubInNewTabAfterSubscription:!1});if(!e.didAction){e.errorMessage&&g(()=>(0,l.Y)(V.y,{text:e.errorMessage||""})),b(e=>e.filter(e=>e!==o.id));return}d.some(e=>e.publication_id===o.id)?u(e=>e.map(e=>e.publication_id===o.id?(0,r._)((0,n._)({},e),{membership_state:"free_signup"}):e)):u(e=>[...e,{id:o.id,publication_id:o.id,membership_state:"free_signup",is_founding:!1}]),g(()=>(0,l.Y)(V.y,{Icon:O.A,text:m(G(),o.name)}))}catch(e){alert((0,j.uX)(e))}b(e=>e.filter(e=>e!==o.id))},children:h(c?"Subscribed":"Subscribe")}):null]},a.id)},Z=e=>{let{streamingUser:t}=e;return(0,l.Y)(y.T,{preset:"detail-large",children:(0,l.Y)(H.Yq,{href:(0,q.gYq)(t,{utm_source:P.VU.liveStreamHostModal}),target:"_blank",children:t.name})})},Q=e=>{let{pub:t}=e;return t?(0,l.Y)(y.T,{color:"tertiary",preset:"detail-small",children:(0,l.Y)(H.Yq,{href:(0,N.$_T)(t,{forceSubdomain:!0}),target:"_blank",children:t.name})}):null};var X=i(49869),ee=i(22057),et=i(55696),ei=i(92636);let en=e=>{var t,i;let{liveStream:n,pub:r,subscribeUrl:a,user:o,isSubscribing:c,isHostsModalOpen:d,isSubscribedToAll:u,setIsHostsModalOpen:p,subscriptions:h,setSubscriptions:m,onSubscribeAll:f}=e,{isMobile:v,isMobileLandscape:b}=(0,_.sM)(),[y,k]=(0,s.useState)(v),S=!!(null==n?void 0:n.liveStream.is_rtmp)&&(null==n||null==(t=n.liveStreamGuests)?void 0:t.length)>0,[F,D]=(0,s.useState)(S),T=(0,g.V)(),A=!!T.active,{viewerCount:E,concurrentViewerCount:N}=(0,Y.p)({liveStream:n}),P={chatComposer:n?(0,l.Y)(C,{isMinimized:y,liveStream:n,onMaximizeChat:()=>{k(!1)}}):null,chatFeed:n?(0,l.Y)(I,{headerHeight:b?58:void 0,liveStream:n,onMinimizeChat:()=>k(!0)}):null,details:n?(0,l.Y)(x,{concurrentViewerCount:N,liveStream:n,pub:r,viewerCount:E}):null,header:(0,l.Y)(B,{closeHref:(0,ei.$_)(r),height:b?58:void 0,subscribeUrl:a,user:o}),mainContent:n?n.liveStreamInformation.desktopPlaybackUrl?(0,l.Y)(et.u,{disableZoom:!0,handle:T,liveStream:n}):(0,l.Y)(et.A,{liveStream:n}):(0,l.Y)(L,{subscribeUrl:a,user:o}),authorOverlay:(null==n||null==(i=n.liveStreamGuests)?void 0:i.length)&&n.liveStream.is_rtmp&&F?(0,l.Y)(eo,{closeHostsOverlay:()=>D(!1),guests:n.liveStreamGuests,isSubscribing:c,liveStream:n,setIsHostsModalOpen:p,showSubscribeAllButton:!u,onSubscribeAll:f}):null,hostsModal:n&&h?(0,l.Y)(J,{guests:n.liveStreamGuests,isHostsModalOpen:d,liveStream:n,setIsHostsModalOpen:p,setSubscriptions:m,subscriptions:h,user:o}):null};return(0,l.FD)(w.I1,{bg:"primary",color:"primary",style:{height:"var(--full-height)"},children:[P.hostsModal,(0,l.Y)(g.m,{handle:T,children:(0,l.Y)(b?el:v?ea:er,{isChatMinimized:y,isFullScreen:A,livestream:n,pageElements:P})})]})},er=e=>{var t;let{isChatMinimized:i,isFullScreen:n,livestream:r,pageElements:a}=e,o=(0,s.useRef)(null),{width:c,height:d}=(0,X.w)({containerRef:o,defaultWidth:600}),u=16/9;if(null==r||null==(t=r.liveStreamInformation.aspectRatio)?void 0:t.includes(":")){let[e,t]=r.liveStreamInformation.aspectRatio.split(":").map(Number);e&&t&&(u=e/t)}let p=d*u>c?c:d*u;return(0,l.FD)(w.I1,{alignItems:"stretch",style:{height:"var(--full-height)"},children:[!n&&a.header,(0,l.FD)(w.Ye,{alignItems:"stretch",flex:"grow",children:[(0,l.FD)(w.I1,{flex:"grow",position:"relative",children:[(0,l.Y)(w.I1,{ref:o,alignItems:"center",bg:"black",inset:0,justifyContent:"center",position:"absolute",children:(0,l.Y)(w.Ye,{justifyContent:"center",position:"relative",style:{width:p},children:a.mainContent})}),a.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto",maxWidth:"90%"},children:a.authorOverlay})]}),a.chatFeed&&(0,l.Y)(w.I1,{borderLeft:"detail",style:{width:400,display:i||n?"none":void 0},children:a.chatFeed})]}),a.details&&(0,l.FD)(w.Ye,{borderTop:"detail",style:{height:164,display:n?"none":void 0},children:[(0,l.Y)(w.I1,{flex:"grow",children:a.details}),(0,l.Y)(w.I1,{borderLeft:"detail",style:{width:400},children:a.chatComposer})]})]})},ea=e=>{let{isChatMinimized:t,isFullScreen:i,pageElements:n}=e;return(0,l.FD)(w.I1,{alignItems:"stretch",style:{height:"var(--full-height)"},children:[!i&&n.header,(0,l.FD)(w.I1,{bg:"black",flex:t?"grow":void 0,justifyContent:"center",position:"relative",children:[(0,l.Y)(w.Ye,{justifyContent:"center",position:"relative",children:n.mainContent}),n.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto"},children:n.authorOverlay})]}),n.chatFeed&&(0,l.Y)(w.I1,{borderTop:"detail",flex:"grow",style:{display:t||i?"none":void 0},children:n.chatFeed}),n.details&&(0,l.FD)(w.I1,{borderTop:"detail",style:{display:i?"none":void 0},children:[t&&(0,l.Y)(w.I1,{flex:"grow",children:n.details}),n.chatComposer]})]})},el=e=>{let{pageElements:t}=e;return(0,l.Y)(w.Ye,{alignItems:"stretch",style:{height:"var(--full-height)"},children:(0,l.FD)(w.I1,{flex:"grow",position:"relative",children:[(0,l.Y)(w.I1,{bg:"black",flex:"grow",justifyContent:"center",children:(0,l.Y)(w.Ye,{position:"relative",children:t.mainContent})}),t.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto"},children:t.authorOverlay})]})})},eo=e=>{let{liveStream:t,guests:i,showSubscribeAllButton:n,isSubscribing:r,onSubscribeAll:a,setIsHostsModalOpen:o,closeHostsOverlay:s}=e;return(0,l.FD)(w.Ye,{alignItems:"center",gap:8,style:{minWidth:0,maxWidth:"100%"},children:[(0,l.Y)(m.A,{onClick:()=>s()}),(0,l.Y)(es,{guests:i,isSubscribing:r,liveStream:t,setIsHostsModalOpen:o,showSubscribeAllButton:n,onSubscribeAll:a})]})},es=e=>{var t;let{liveStream:i,guests:n,showSubscribeAllButton:r,isSubscribing:a,onSubscribeAll:o,setIsHostsModalOpen:s}=e,c=[i.user.name,...n.map(e=>e.user.name)].filter(Boolean).join(", "),d=[null==(t=i.pub)?void 0:t.name,...n.map(e=>{var t;return null==(t=e.pub)?void 0:t.name})].filter(Boolean).join(", ");return(0,l.FD)(w.Ye,{alignItems:"center",bg:"secondary",gap:16,paddingLeft:4,radius:"full",style:{minWidth:0,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",cursor:"pointer",userSelect:"none"},children:[(0,l.FD)(w.Ye,{alignItems:"center",gap:8,paddingLeft:2,style:{minWidth:0,height:40},onClick:()=>s(!0),children:[(0,l.Y)(ee.Z,{direction:"rtl",size:28,users:[i.user,...n.map(e=>e.user)]}),(0,l.FD)(w.I1,{overflow:"hidden",paddingRight:20*!r,style:{minWidth:0},children:[(0,l.Y)(y.T,{color:"primary",preset:"detail-large",style:{fontWeight:500},whiteSpace:"nowrap",children:c}),(0,l.Y)(y.T,{color:"tertiary",preset:"detail-small",style:{opacity:.7,lineHeight:"16px"},whiteSpace:"nowrap",children:d})]})]}),r&&o?(0,l.Y)(f.v,{disabled:a,size:"sm",style:{marginRight:8},variant:"primary-accent",onClick:o,children:"Subscribe"}):null]})};var ec=i(22240),ed=i(73090),eu=i(64703),ep=i(16074);let eh=e=>{var t;let{livestreamPageData:i,pub:n,subscribeUrl:r,user:a}=e,{scheduledLiveStreams:o,pastLiveStreamPosts:s,pastLiveStreamSectionId:c}=i,d=null!=(t=n.sections.find(e=>e.id===c))?t:null;return(0,l.FD)(w.I1,{bg:"primary",color:"primary",style:{height:"var(--full-height)"},children:[(0,l.Y)(B,{closeHref:(0,N.$_T)(n),subscribeUrl:r,user:a}),(0,l.Y)(w.I1,{flex:"grow",overflow:"auto",paddingX:28,paddingY:40,children:(0,l.FD)(w.I1,{className:"container-sckr5Y",gap:24,children:[(0,l.Y)(ec.L,{children:"Upcoming livestreams"}),0===o.length?(0,l.Y)(y.T,{preset:"h4-sans-condensed",children:"No upcoming livestreams"}):o.map((e,t)=>(0,l.FD)(l.FK,{children:[0!==t&&(0,l.Y)(ep.c,{}),(0,l.Y)(eu.k,{liveStream:e,trackingSurface:"livestream-page"})]})),(0,l.Y)(ep.c,{}),(0,l.Y)(ec.L,{children:"Past livestreams"}),(0,l.Y)(ed.R,{posts:s}),d&&(0,l.Y)(f.v,{href:(0,N.Dor)(n,{section:d}),variant:"outline",children:"Watch more"})]})})]})};var em=i(97432),eg=i(6641);let ef={wrapper:"wrapper-JFyjIy",prompt:"prompt-LfHufc",subscribeButton:"subscribeButton-Nj91ga",input:"input-PZFqCj"},ev=e=>{let{isOpen:t,pub:i,subscribeUrl:n,user:r,audience:a}=e;return(0,l.Y)(eg.S,{hideCloseButton:!0,isOpen:t,children:(0,l.FD)(w.I1,{gap:24,children:[(0,l.FD)(w.I1,{gap:16,children:[(0,l.Y)(y.T,{align:"center",preset:"h5-sans",children:"only_founding"===a?"Unlock Premium Livestream Access":"Unlock Livestream Access"}),(0,l.Y)(y.T,{align:"center",preset:"d2-serif",children:"only_founding"===a?"This livestream is exclusively for our Premium subscribers. Upgrade to Premium now to get access to the conversation in real time and to our live chat":"only_free"===a?"This livestream is a benefit for our subscribers. Sign up below to gain access.":"We’re proud to offer livestreams as an exclusive benefit for our paid subscribers. Sign up to watch live events and never miss a moment."})]}),(0,l.FD)(w.I1,{alignItems:"center",gap:16,children:["only_free"===a?(0,l.Y)(em.A,{className:ef.wrapper,inputClassName:ef.input,inputWrapperClassName:ef.inputWrapper,placeholder:"ENTER YOUR EMAIL",promptClassName:ef.prompt,pub:i,separateInputAndSubmitButton:!0,source:P.VU.publicationLiveStream,submitButtonText:"Sign up for free",subscribeButtonClassName:ef.subscribeButton,user:r,onSuccess:()=>{location.reload()}}):(0,l.Y)(f.v,{href:n,native:!0,children:(null==r?void 0:r.is_free_subscribed)?"Upgrade Today":"Subscribe Today"}),(0,l.FD)(w.Ye,{alignItems:"center",gap:16,children:[(0,l.Y)(y.T,{preset:"caption",children:"only_free"===a?"Already have an account?":"only_founding"===a?"Already a premium subscriber?":"Already a subscriber?"}),(0,l.Y)(y.T,{as:"a",color:"accent",href:(0,q.eV6)(i,{isSignInAttempt:!0}),preset:"caption",children:"only_free"===a?"Sign in":"Switch accounts"})]})]}),(0,l.Y)(w.I1,{alignItems:"center",children:(0,l.Y)(f.v,{href:(0,q.$_T)(i),size:"sm",variant:"tertiary",children:"Back to Homepage"})})]})})};var eb=i(60986),ey=i(94729),eY=i(28528);function e_(){let e=(0,a._)(["Subscribed to "," and ",""]);return e_=function(){return e},e}function ew(){let e=(0,a._)(["Subscribed to ",", ",", and ",""]);return ew=function(){return e},e}function eC(){let e=(0,a._)(["Subscribed to ",", and ",""]);return eC=function(){return e},e}let ek=e=>{var t,i,n;let{liveStream:r,livestreamPageData:a,pub:o,user:c}=e,{activeLiveStream:m}=(0,eb.u)({preloadedLiveStream:r,pub:o}),[g,f]=(0,s.useState)(null!=a?a:null),[v,b]=(0,s.useState)(!1),[y,Y]=(0,s.useState)(!1),{subscriptions:_,isSubscribedToAll:w,setSubscriptions:C,onSubscribeAll:k}=eS({liveStream:m,user:c,existingSubscriptions:(null!=(i=null==a?void 0:a.subscriptions)?i:[]).map(e=>{var t;return{id:e.id,publication_id:e.publication_id,membership_state:null!=(t=e.membership_state)?t:"unsubscribed",is_founding:e.is_founding}}),setIsSubscribing:b,setIsHostsModalOpen:Y}),S=(0,q.my9)(o,{simple:!0,next:document.location.href,utm_source:P.VU.publicationLiveStream,utm_medium:P.Jn.web,utm_content:null!=(n=null==m||null==(t=m.liveStream)?void 0:t.id)?n:null}),I=(null==m?void 0:m.liveStream.status)==="active"&&!(null==m?void 0:m.liveStreamInformation.desktopPlaybackUrl),F=g&&!m;return(0,s.useEffect)(()=>{let e=async()=>(await d().get("/livestream/data")).body;a||e().then(f)},[a]),(0,l.Y)(eY.XL,{pub:o,user:c,children:(0,l.Y)("div",{className:"the-free-press-theme",children:(0,l.FD)(h.DH,{children:[(0,l.Y)(p.Metadata,{image:(0,q.dJ9)("https://substack.com/img/thefp/livestream_preview.jpg",600,{crop:"crop",height:600}),pub:o}),(0,l.Y)(ev,{audience:null==m?void 0:m.liveStream.audience,isOpen:I,pub:o,subscribeUrl:S,user:c}),(0,l.Y)(u.a,{children:F?(0,l.Y)(eh,{livestreamPageData:g,pub:o,subscribeUrl:S,user:c}):(0,l.Y)(en,{isHostsModalOpen:y,isSubscribedToAll:w,isSubscribing:v,liveStream:m,pub:o,setIsHostsModalOpen:Y,setSubscriptions:C,subscribeUrl:S,subscriptions:_,user:c,onSubscribeAll:k})})]})})})},eS=e=>{var t;let{liveStream:i,user:a,existingSubscriptions:c,setIsSubscribing:d,setIsHostsModalOpen:u}=e,[p,h]=(0,s.useState)(c),m=null!=(t=null==i?void 0:i.liveStreamGuests)?t:[],g=[null==i?void 0:i.pub,...m.map(e=>e.pub)].filter(e=>!!e).every(e=>{var t,i;return["free_signup","subscribed"].includes(null!=(i=null==(t=p.find(t=>t.publication_id===(null==e?void 0:e.id)))?void 0:t.membership_state)?i:"unsubscribed")}),{iString:f,iTemplate:v}=(0,U.GO)(),{popToast:b}=(0,V.d)(),y=async()=>{var e,t;if(!a)return void u(!0);let s=[null==i||null==(e=i.pub)?void 0:e.id,...m.map(e=>{var t;return null==(t=e.pub)?void 0:t.id})].filter(e=>void 0!==e),c=s.filter(e=>!p.find(t=>t.publication_id===e));if(c.length){d(!0);try{let{subscriptionResults:e}=await (0,ey.x6)("/api/v1/bulk_signup",{method:"POST",json:{publications:c,source:P.VU.liveStreamPermalink}});if(e.every(e=>e.requires_confirmation))return void b(()=>(0,l.Y)(V.y,{text:f("Check your email to confirm subscription")}));if(e.some(e=>!e.didSignup))return void b(()=>(0,l.Y)(V.y,{text:f("Unable to subscribe to all publications")}));h(e=>s.map(t=>{let i=e.find(e=>e.publication_id===t);return i?(0,r._)((0,n._)({},i),{membership_state:"free_signup"}):{id:t,publication_id:t,membership_state:"free_signup",is_founding:!1}}));let a=[null==i?void 0:i.pub,...m.map(e=>e.pub)].filter(e=>e&&c.includes(e.id)).map(e=>null==e?void 0:e.name).filter(e=>void 0!==e),d=0===a.length?"":1===a.length&&a[0]?"Subscribed to ".concat(a[0]):2===a.length&&a[0]&&a[1]?v(e_(),a[0],a[1]):3===a.length&&a[0]&&a[1]&&a[2]?v(ew(),a[0],a[1],a[2]):v(eC(),a.slice(0,-1).join(", "),null!=(t=a[a.length-1])?t:"");b(()=>(0,l.Y)(V.y,{Icon:o.A,text:d}))}catch(e){b(()=>(0,l.Y)(V.y,{text:(0,j.uX)(e)}))}d(!1)}};return{subscriptions:p,isSubscribedToAll:g,setSubscriptions:h,onSubscribeAll:y}}},19397:function(e,t,i){i.d(t,{F:()=>v});var n=i(69277),r=i(70408),a=i(10201),l=i(32485),o=i.n(l),s=i(13589),c=i(72880),d=i(63446),u=i(15894),p=i(17306),h=i(68410),m=i(16074),g=i(76977);let f={container:"container-F6lwXo",itemImage:"itemImage-xOyOyH",itemImageHoverOverlay:"itemImageHoverOverlay-Q1cWQy",itemImageMobile:"itemImageMobile-Q0peCf",itemBodyMobile:"itemBodyMobile-pajlxB"},v=e=>{let{hasMarkdownDescriptions:t,hideViewAllCta:i,items:n,showDescriptionOnMobile:r,viewAllLabel:l="View all episodes",justifyViewAllLabel:o="center",applyHoverOnTitle:s=!0}=e,{isMobile:c}=(0,h.sM)();return(0,a.Y)("div",{children:c?(0,a.Y)(g.I1,{gap:24,children:n.map((e,n)=>(0,a.FD)(a.FK,{children:[0!==n&&(0,a.Y)(m.c,{}),(0,a.Y)(b,{applyHoverOnTitle:s,hasMarkdownDescriptions:t,hideViewAllCta:i,item:e,justifyViewAllLabel:o,showDescriptionOnMobile:r,viewAllLabel:l})]}))}):(0,a.Y)("div",{className:f.container,children:n.map(e=>(0,a.Y)(b,{applyHoverOnTitle:s,hasMarkdownDescriptions:t,hideViewAllCta:i,item:e,justifyViewAllLabel:o,viewAllLabel:l}))})})},b=e=>{let{hasMarkdownDescriptions:t,hideViewAllCta:i,item:l,showDescriptionOnMobile:m,viewAllLabel:v,justifyViewAllLabel:b="center",applyHoverOnTitle:y=!0}=e,{isMobile:Y}=(0,h.sM)(),[_,w]=(0,s.Mk)(),{markdownProps:C}=(0,p.$)(l.description),k=t?(0,a.Y)(u.T,(0,r._)((0,n._)({},C),{clamp:3,preset:"d3-serif"})):(0,a.Y)(u.T,{clamp:3,preset:"d3-serif",children:l.description});return(0,a.Y)("a",{href:l.url,style:{textDecoration:"none"},children:Y?(0,a.FD)(g.Ye,{gap:24,children:[(0,a.Y)(g.I1,{className:f.itemImageMobile,flex:"auto",children:l.imageUrl&&(0,a.Y)(c.o,{className:f.itemImage,maxWidth:100,src:l.imageUrl})}),(0,a.FD)(g.I1,{className:f.itemBodyMobile,gap:8*!!m,justifyContent:m?"start":"space-between",children:[(0,a.Y)(u.T,{preset:"h5-serif",children:l.title}),m&&l.description&&k,!i&&(0,a.Y)(d.v,{justifyContent:b,size:"md",trailingIcon:"chevron-right",variant:"tertiary",children:v})]})]}):(0,a.FD)(g.I1,{className:f.itemContainer,cursor:"pointer",gap:16,children:[l.imageUrl&&(0,a.FD)(g.I1,(0,r._)((0,n._)({},w),{position:"relative",children:[(0,a.Y)(c.o,{className:f.itemImage,maxWidth:350,src:l.imageUrl}),(0,a.Y)("div",{className:o()({[f.itemImageHoverOverlay]:_})})]})),(0,a.FD)(g.I1,{gap:8,children:[(0,a.Y)(u.T,(0,r._)((0,n._)({},y?w:{}),{color:_?"accent":"primary",preset:"h5-serif",children:l.title})),k,!i&&(0,a.Y)(d.v,{justifyContent:b,size:"md",trailingIcon:"chevron-right",variant:"tertiary",width:"auto",children:v})]})]})})}},13612:function(e,t,i){i.d(t,{f:()=>p});var n=i(10201),r=i(33031),a=i.n(r),l=i(73869),o=i(82528),s=i(19397),c=i(77124),d=i(74894),u=i(39318);let p=e=>{let{pub:t,user:i}=e,{ids:r}=(0,c.q)({pub:t}),p=(0,d.Zu)(t).filter(e=>!!e.sectionId),h=a()(p,e=>{var t;return r.indexOf(null!=(t=e.sectionId)?t:-1)}).map(e=>{var i;return{title:e.podcastTitle,imageUrl:e.artUrl,description:e.description,url:(0,u.t6y)({pub:t,section:e.sectionId&&null!=(i=t.sections.find(t=>t.id===e.sectionId))?i:null,addBase:!1})}});return(0,n.Y)(o.y,{actions:(0,n.Y)(l.m,{pub:t,sectionType:"podcast",user:null!=i?i:null}),description:(0,n.FD)(n.FK,{children:["Stories you won’t hear anywhere else, conversations with the most fascinating people in the country, and deeper looks into the most talked-about stories of the day. At ",(0,n.Y)("em",{children:"The Free Press"}),", nothing is off-limits. Listen to our flagship podcast ",(0,n.Y)("em",{children:"Honestly with Bari Weiss"}),", straight talk about raising kids with Professor Emily Oster, and our series with J.K. Rowling, where we cover everything from book bans to debates on gender."]}),title:"Podcasts",children:(0,n.Y)(s.F,{hasMarkdownDescriptions:!0,items:h})})}},73090:function(e,t,i){i.d(t,{C:()=>p,R:()=>u});var n=i(10201),r=i(56778),a=i(60355),l=i(16074),o=i(76977),s=i(57820),c=i(92636),d=i(39891);let u=e=>{let{isEvents:t,posts:i}=e;return(0,n.Y)(o.I1,{gap:24,children:i.map((e,i)=>(0,n.FD)(n.FK,{children:[0!==i&&(t?(0,n.FD)(o.Ye,{alignItems:"center",gap:24,paddingY:16,children:[(0,n.Y)(o.Ye,{flex:"grow",children:(0,n.Y)(l.c,{})}),(0,n.Y)("img",{src:(0,d.dJ)("".concat((0,c.Ew)(),"/img/thefp/fp-stars.svg"),154)}),(0,n.Y)(o.Ye,{flex:"grow",children:(0,n.Y)(l.c,{})})]}):(0,n.Y)(l.c,{})),(0,n.Y)(a.R,{post:e,variant:t?"event-page":"archive"})]}))})},p=e=>{let{isLoading:t,noMorePosts:i,posts:a,onLoadMore:l}=e;return(0,n.FD)(o.I1,{gap:24,children:[(0,n.Y)(u,{posts:a}),t&&(0,n.Y)(o.Ye,{justifyContent:"center",children:(0,n.Y)(s.y$,{})}),!!a.length&&!t&&!i&&(0,n.Y)(r.A,{threshold:0,onVisible:()=>{l()}})]})}},3630:function(e,t,i){i.d(t,{o:()=>a});var n=i(10201),r=i(82528);let a=()=>(0,n.FD)(r.y,{description:(0,n.FD)("span",{children:["The Free Press reads. A lot. We're constantly running reviews, excerpts, and columns from our favorite authors.",(0,n.Y)("br",{}),(0,n.Y)("br",{}),"When we mention a book on our site, we make sure to link to it so that you can get the book, and go deeper. Of course, we mention tons of books: old ones, new ones, ones we agree with, ones we can't stand. You'll find them all below. When you purchase them through our site, we may earn an affiliate commission."]}),title:"What We’re Reading",children:[(0,n.FD)("div",{children:[(0,n.Y)("script",{"data-list-slug":"pick-of-the-month","data-type":"list",src:" https://bookshop.org/widgets.js "}),(0,n.Y)("script",{"data-list-slug":"previous-picks-of-the-month","data-type":"list",src:"https://bookshop.org/widgets.js"}),(0,n.Y)("script",{"data-list-slug":"reader-recommendations","data-type":"list",src:"https://bookshop.org/widgets.js"}),(0,n.Y)("script",{"data-list-slug":"politics-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})]}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"culture-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"history-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"science-medicine","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"tech-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"memoir-biography-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"parenting-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,n.Y)("div",{class:"bookshop__slider",children:(0,n.Y)("script",{"data-list-slug":"religion-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})})]})},55228:function(e,t,i){i.d(t,{A:()=>eo});var n=i(10201),r=i(99862),a=i(17402),l=i(87677),o=i(69277),s=i(70408),c=i(32641),d=i(63446),u=i(25006),p=i(35369),h=i(4016);let m=e=>{let{variant:t,children:i}=e,r=(0,c._)(e,["variant","children"]),a=(0,u.df)();return(0,h.lu)({pub:a})?"outline"===t?(0,n.Y)(d.v,(0,s._)((0,o._)({variant:"outline"},r),{children:i})):(0,n.Y)(d.v,(0,s._)((0,o._)({},r),{children:i})):"outline"===t?(0,n.Y)(p.$n,(0,s._)((0,o._)({priority:"secondary"},r),{children:i})):(0,n.Y)(p.$n,(0,s._)((0,o._)({},r),{children:i}))};var g=i(41880),f=i(32485),v=i.n(f);let b=(0,a.forwardRef)((e,t)=>{var{className:i,type:r="text",size:a="default"}=e,l=(0,c._)(e,["className","type","size"]);return(0,n.Y)("input",(0,s._)((0,o._)({},l),{ref:t,className:v()(i,"input-yab_Zq","sm"===a&&"inputSm-LeCzcW"),type:r}))});var y=i(76977);let Y="fullHeight-fzWhjy",_=e=>{let{label:t,content:i,onSave:r,gap:l=16,onEdit:o,isLoading:s=!1}=e,[c,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(i);return(0,n.Y)(y.I1,{className:"editRowContent-Q3ex6r",gap:l,children:(0,n.FD)(y.pT,{alignItems:"end",className:Y,gap:8,justifyContent:"space-between",children:[(0,n.FD)(y.pT,{className:"".concat(Y," ").concat("contentWrapper-IH9YEj"),direction:"column",gap:c?8:16,justifyContent:"space-between",children:[(0,n.Y)(g.WZ,{children:t}),(0,n.Y)(g.vC,{className:"content-LYcGXJ",children:c?(0,n.Y)(b,{className:"input-CUQULH",size:"sm",type:"text",value:u,onChange:e=>p(e.target.value)}):i})]}),(0,n.Y)(m,{disabled:s,size:"sm",style:{height:"40px"},variant:"outline",onClick:()=>{c?(null==r||r(u),d(!1)):o?o():d(!0)},children:c?"Save":"Edit"})]})})};var w=i(31793),C=i(6641),k=i(15894),S=i(46271),I=i(55200),F=i(68349),D=i(39318);let T="clickable-QzUIvj",A="actionItem-Th40ya",E=e=>{let{href:t,text:i}=e;return(0,n.Y)(g.Oy,{className:"actionLink-ovC95f",href:t,children:i})},N=()=>(0,n.FD)(y.I1,{gap:24,paddingTop:16,children:[(0,n.Y)(y.pT,{gap:4,children:(0,n.FD)(g.eo,{children:["For email delivery issues, ",(0,n.Y)(E,{href:"/account/email-test",text:"click here"}),"."]})}),(0,n.Y)(y.pT,{gap:4,children:(0,n.FD)(g.eo,{children:["For support, ",(0,n.Y)(E,{href:(0,D.RPh)(),text:"click here"}),"."]})}),(0,n.Y)(y.pT,{gap:4,children:(0,n.FD)(g.eo,{children:["To permanently delete your Substack account, go to your"," ",(0,n.Y)(E,{href:"/account?utm_source=user-menu",text:"Substack Settings"}),"."]})})]}),P=()=>{var e;let{name:t,updateName:i,email:r,updateEmail:o,isSendingReset:s,handlePasswordChange:c}=(0,w.E)(),d=(0,S.Jd)(),[u,p]=(0,a.useState)(!1),[h,f]=(0,a.useState)(null),[v,b]=(0,a.useState)(!1),Y=async e=>{f({email:e,confirm:e}),p(!0)},E=async()=>{h&&(await o(h.email,h.confirm),p(!1),f(null))},N=()=>{p(!1),f(null)},P=(null==d?void 0:d.subscription_first_payment_at)?new Date(d.subscription_first_payment_at).getFullYear():"";return(0,n.FD)(y.I1,{style:{width:"100%",flexGrow:1},children:[(0,n.FD)("div",{children:[(0,n.Y)(g.$E,{children:"Account Settings"}),(0,n.Y)(g.u0,{children:P?(0,n.FD)(n.FK,{children:["You've supported independent journalism since ",P,"."]}):(0,n.Y)(n.FK,{children:"Manage your account settings and preferences."})})]}),(0,n.Y)(g.Rm,{}),(0,n.FD)(y.I1,{children:[(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",paddingBottom:24,children:[(0,n.Y)(g.U2,{children:"Profile"}),(0,n.Y)(k.T,{as:"a",className:"viewProfile-u5hCP0",href:(0,I.l)(d),preset:"detail-small",children:"VIEW PROFILE"})]}),(0,n.FD)(y.pT,{gap:16,children:[(0,n.Y)("img",{alt:"Profile",src:null!=(e=null==d?void 0:d.photo_url)?e:"",style:{width:48,height:48}}),(0,n.Y)(_,{content:t,label:"Name",onSave:i})]})]}),(0,n.Y)(g.Ne,{}),(0,n.Y)(_,{content:r,label:"Email",onSave:Y}),(0,n.Y)(g.Ne,{}),(0,n.Y)(_,{content:"••••••••••••••••",isLoading:s,label:"Password",onEdit:()=>{c().then(e=>{let{success:t}=e;t&&(b(!0),setTimeout(()=>b(!1),2e4))})}}),v&&(0,n.Y)(y.pT,{paddingTop:8,children:(0,n.Y)(g.eo,{children:"Password reset email sent. Please check your inbox."})}),(0,n.Y)(g.Rm,{}),(0,n.FD)(y.I1,{children:[(0,n.Y)(g.U2,{children:"Account Actions"}),(0,n.FD)(y.pT,{alignItems:"center",className:"".concat(T," ").concat(A),justifyContent:"space-between",paddingTop:16,onClick:()=>(0,F.V2)((0,D.bgT)()),children:[(0,n.Y)(k.T,{preset:"list-item-menu",children:"Sign out"}),(0,n.Y)(l.A,{size:20})]}),(0,n.Y)(g.Ne,{}),(0,n.FD)(y.pT,{alignItems:"center",className:"".concat(T," ").concat(A),justifyContent:"space-between",onClick:()=>{c()},children:[(0,n.Y)(k.T,{preset:"list-item-menu",children:"Change password"}),(0,n.Y)(l.A,{size:20})]}),(0,n.Y)(g.Ne,{})]}),u&&(0,n.Y)(C.S,{isOpen:u,onClose:N,children:(0,n.FD)(y.I1,{gap:32,paddingBottom:0,children:[(0,n.FD)("div",{children:[(0,n.Y)(g.$E,{paddingBottom:16,children:"Change Email Address"}),(0,n.Y)(k.T,{preset:"d2-serif",children:"You will be signed out after changing your email address. You will need to sign in again with your new email address."})]}),(0,n.FD)(y.pT,{gap:16,justifyContent:"space-between",children:[(0,n.Y)(m,{variant:"outline",onClick:N,style:{flex:1},children:"CANCEL"}),(0,n.Y)(m,{onClick:E,style:{flex:1,backgroundColor:"#f55"},children:"CONTINUE"})]})]})})]})};var x=i(75107),L=i(8149),R=i(24777);let M=e=>{let{name:t,imgUrl:i,checked:r=!0,onToggle:a}=e;return(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,n.FD)(y.pT,{alignItems:"center",gap:16,children:[i&&(0,n.Y)(y.pT,{as:"div",bg:"tertiary",height:32,width:32,children:(0,n.Y)("img",{alt:t,src:i})}),(0,n.Y)(k.T,{preset:"lg-preview-byline",children:t})]}),(0,n.Y)(R.A,{checked:r,onChange:e=>null==a?void 0:a(e)})]})},B=e=>{let{title:t,newsletters:i,isExpanded:r,onToggle:a,onSelectAll:l,areAllSelected:o}=e;return(0,n.FD)(y.I1,{gap:0,width:"100%",children:[(0,n.FD)(y.pT,{alignItems:"center",className:"sectionHeader-Z3zoO8",justifyContent:"space-between",paddingBottom:24,role:"button",tabIndex:0,onClick:a,children:[(0,n.Y)(g.U2,{children:t}),(0,n.Y)(x.A,{className:"".concat("chevron-NOVYNS"," ").concat(r?"expanded-Tjjigv":""),size:24})]}),(0,n.Y)(L.N,{open:r,children:r&&(0,n.FD)(n.FK,{children:[(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,n.Y)(g.n1,{children:"SELECT ALL"}),(0,n.Y)(R.A,{checked:o,onChange:e=>l(e)})]}),(0,n.Y)(g.Ne,{}),i.map((e,t)=>(0,n.FD)("div",{children:[(0,n.Y)(M,{checked:e.selected,imgUrl:e.logoUrl||"",name:e.name,onToggle:t=>e.onToggle(t)}),t<i.length-1&&(0,n.Y)(g.Ne,{})]},e.sectionId))]})})]})},O=()=>{let{newsletters:e}=(0,w.E)(),[t,i]=(0,a.useState)({fromTheFreePress:!0,featured:!0,topic:!0,video:!0}),r=e=>{i(t=>(0,s._)((0,o._)({},t),{[e]:!t[e]}))},l=e=>e.length>0&&e.every(e=>e.selected);return(0,n.FD)(y.I1,{children:[(0,n.Y)(g.$E,{children:"Your Newsletters"}),(0,n.Y)(g.u0,{children:"Manage the email notifications you receive from us to personalize your experience."}),(0,n.Y)(g.Rm,{}),(0,n.Y)(B,{areAllSelected:l(e.fromTheFreePress.newsletters),isExpanded:t.fromTheFreePress,newsletters:e.fromTheFreePress.newsletters,title:e.fromTheFreePress.name,onSelectAll:t=>e.updateNewsletterGroup("fromTheFreePress",t),onToggle:()=>r("fromTheFreePress")}),(0,n.Y)(g.Rm,{}),(0,n.Y)(B,{areAllSelected:l(e.featured.newsletters),isExpanded:t.featured,newsletters:e.featured.newsletters,title:e.featured.name,onSelectAll:t=>e.updateNewsletterGroup("featured",t),onToggle:()=>r("featured")}),(0,n.Y)(g.Rm,{}),(0,n.Y)(B,{areAllSelected:l(e.topic.newsletters),isExpanded:t.topic,newsletters:e.topic.newsletters,title:e.topic.name,onSelectAll:t=>e.updateNewsletterGroup("topic",t),onToggle:()=>r("topic")}),(0,n.Y)(g.Rm,{}),(0,n.Y)(B,{areAllSelected:l(e.video.newsletters),isExpanded:t.video,newsletters:e.video.newsletters,title:e.video.name,onSelectAll:t=>e.updateNewsletterGroup("video",t),onToggle:()=>r("video")}),(0,n.Y)(g.Rm,{}),(0,n.FD)(y.pT,{justifyContent:"space-between",alignItems:"center",children:[(0,n.FD)(k.T,{preset:"lg-preview-byline",children:["Unsubscribe from all ",(0,n.Y)("em",{children:"Free Press"})," emails"]}),(0,n.Y)(d.v,{variant:"primary-accent",size:"sm",onClick:()=>e.unsubscribeFromAllEmails(),children:"Unsubscribe"})]})]})};var U=i(56458),j=i(46009),z=i(57324);let H=e=>{let{podcast:t}=e;return(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",paddingY:12,children:[(0,n.FD)(y.pT,{alignItems:"center",gap:16,children:[(0,n.Y)("div",{className:"podcastLogo-AAT5j_",style:{backgroundImage:t.logoUrl?"url(".concat(t.logoUrl,")"):void 0}}),(0,n.Y)(k.T,{preset:"lg-preview-byline",children:t.name})]}),(0,n.Y)(d.v,{href:t.setupUrl,native:!0,size:"sm",variant:"outline",children:"SET UP"})]})},W=()=>{let e=(0,u.df)(),t=(0,S.Jd)(),[i,r]=(0,a.useState)([]),[l,o]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{if(!e)return;let i=[],n=(0,U.th)(e);n&&n.length>0&&n.forEach(n=>{let r=(0,j.lL)({pub:e,section:n});r.title&&i.push({id:n.id,name:r.title,description:r.description||void 0,logoUrl:r.artUrl||void 0,setupUrl:(0,D.wpu)(e,{section:n,noSection:!1,addBase:!0,user:t,startAtSubscribeFlow:!t||!t.is_free_subscribed,params:{utm_source:z.VU.account}})})}),r(i),o(!1)},[e,t]),l)?(0,n.Y)(y.I1,{width:"100%",children:(0,n.Y)(k.T,{preset:"h4-sans-condensed",children:"Loading podcast feeds..."})}):0===i.length?(0,n.FD)(y.I1,{width:"100%",children:[(0,n.Y)(g.$E,{children:"Subscriber Podcast Feeds"}),(0,n.Y)(g.u0,{children:"No podcast feeds are currently available."})]}):(0,n.FD)(y.I1,{width:"100%",children:[(0,n.Y)(g.$E,{children:"Subscriber Podcast Feeds"}),(0,n.Y)(g.u0,{children:"Free Press podcasts are available anywhere. Select which shows you'd like to subscribe to, in your app of choice, below."}),(0,n.Y)(g.Rm,{}),(0,n.Y)(y.pT,{direction:"column",children:i.map((e,t)=>(0,n.FD)("div",{children:[(0,n.Y)(H,{podcast:e}),t!==i.length-1&&(0,n.Y)(g.Ne,{})]},e.id))})]})};var V=i(45773),K=i(49092),q=i(13022),G=i(12501),J=i(44333),$=i(89129),Z=i(49807),Q=i(82776);let X=e=>{let{children:t}=e;return(0,n.FD)(y.pT,{alignItems:"center",gap:16,children:[(0,n.Y)(V.A,{size:24,style:{flexShrink:0}}),(0,n.Y)(k.T,{preset:"list-item-menu",children:t})]})},ee=()=>{let[{path:e},t]=(0,J.rd)(),i=new URLSearchParams(window.location.search),r="true"===i.get("open_change_plan"),[o,s]=(0,a.useState)(!0),[c,p]=(0,a.useState)(r),f=(0,S.Jd)(),v=(0,u.df)(),{plan:b,totalAmount:Y,currency:_,isLifetime:C,isComped:I,giftCount:T}=(0,w.E)(),{result:A}=(0,G.st)({pathname:"/api/v1/subscription",auto:!!(null==f?void 0:f.is_subscribed)}),E=null==f?void 0:f.is_subscribed;(0,a.useEffect)(()=>{r&&(i.delete("open_change_plan"),t("".concat(e,"?").concat(i.toString()),!1))},[r]);let{intro:N,benefits:P}=E?f.is_founding?{intro:"As a premium subscriber to The Free Press, you get:",benefits:["Full access to all articles, investigations, and columnists, including Niall Ferguson, Coleman Hughes, Matti Friedman, and Martin Gurri","Access to the thriving comments section and the Free Press community","Text to speech and PDF-to-prints on every article","Video recordings of Honestly with Bari Weiss","First chance to purchase tickets for live Free Press events and subscriber-only discounts","Four off-the-record town halls with Bari each year","Two annual gift subscriptions","One item of merch each year (this year is TGIF socks!)","Supports the mission by sponsoring subscriptions for those who can't afford one, subsidizing free stories, and keeping the lights on"]}:{intro:"As a paid subscriber to The Free Press, you get:",benefits:["Full access to all articles, investigations, and columnists, including Niall Ferguson, Coleman Hughes, Matti Friedman, and Martin Gurri","Access to the thriving comments section and the Free Press community","Text to speech and PDF-to-prints on every article","Video recordings of Honestly with Bari Weiss","First chance to purchase tickets for live Free Press events and subscriber-only discounts"]}:{intro:"As a free subscriber to The Free Press, you get:",benefits:["The Front Page","Occasional free articles"]};return(0,n.FD)(y.I1,{width:"100%",children:[(0,n.FD)("div",{children:[(0,n.Y)(g.$E,{children:"Your Subscription"}),(0,n.Y)(g.u0,{children:E?f.is_founding?"You’re a premium subscriber!":"You’re a paid subscriber!":"You’re a free subscriber!"})]}),(0,n.Y)(g.Rm,{}),(0,n.FD)(y.I1,{gap:24,children:[(0,n.Y)(g.U2,{children:"Subscription"}),(0,n.FD)("div",{children:[(0,n.FD)(y.pT,{direction:"column",gap:16,children:[(0,n.Y)(g.n1,{children:"STATUS"}),(0,n.Y)(k.T,{preset:"list-item-menu",children:(()=>{if(!E)return"Free subscription";if(C)return"Lifetime membership";if(!A)return"";let e=null==f?void 0:f.subscription_expiry;if(!e)return"";let t=(0,$.a)(e,{stripeSub:{cancel_at_period_end:A.cancel_at_period_end,status:A.status,billing:A.is_invoiced?"send_invoice":void 0}});return"Billing period renews ".concat(t.format("M/D/YYYY"))})()})]}),(0,n.Y)(g.Ne,{}),(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,n.FD)(y.pT,{direction:"column",gap:16,children:[(0,n.Y)(g.n1,{children:"PLAN"}),(0,n.Y)(k.T,{preset:"list-item-menu",children:(()=>{if(!E)return"Free";if(C)return"Lifetime membership";if(f.is_subscribed&&(I||!f.subscription_first_payment_at))return f.is_founding?"Comped (Premium)":"Comped (Paid)";if(!b||!Y||!_)return"";let e=b.interval||"year";return"".concat((0,Q.centsToPriceString)(Y,_)," per ").concat(e)})()})]}),!C&&(0,n.Y)(m,{size:"sm",variant:"outline",onClick:()=>{if(E)p(!0);else{if(!v)return;let e=(0,D.eV6)(v,{user:f,addBase:!0,params:{utm_source:z.VU.account}});(0,F.V2)(e,{local_navigation:!1})}},children:E?"Change":"Upgrade"})]})]})]}),(0,n.Y)(g.Rm,{}),(0,n.FD)(y.I1,{gap:24,children:[(0,n.FD)(y.pT,{alignItems:"center",className:"expandable-UB3Kke",justifyContent:"space-between",onClick:()=>s(!o),children:[(0,n.Y)(g.U2,{children:"What's Included"}),o?(0,n.Y)(x.A,{size:20}):(0,n.Y)(l.A,{size:20})]}),o&&(0,n.FD)(y.I1,{gap:16,children:[(0,n.Y)(k.T,{preset:"list-item-menu",children:N}),(0,n.Y)(g.Ne,{}),P.map((e,t)=>(0,n.Y)(X,{children:e},t))]})]}),E&&(0,n.FD)(n.FK,{children:[(0,n.Y)(g.Rm,{}),(0,n.FD)(y.I1,{children:[(0,n.Y)(g.U2,{paddingBottom:24,children:"Gift Subscriptions"}),T>0?(0,n.FD)(n.FK,{children:[(0,n.Y)(k.T,{preset:"list-item-menu",children:"Gift Independent Journalism."}),(0,n.Y)(g.Ne,{}),(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,n.FD)(y.pT,{direction:"column",gap:16,children:[(0,n.Y)(g.n1,{children:"YOUR BALANCE"}),(0,n.Y)(k.T,{preset:"lg-preview-byline",children:"".concat(T," Annual Subscription").concat(1!==T?"s":"")})]}),(0,n.Y)(d.v,{href:f&&(0,q.Ay)("enable_founding_gifts")?(0,h.eh)({user:f}):v?(0,Z.jED)({pub:v}):"/account/gifts",localNavigation:!1,size:"sm",variant:"outline",children:"SEND GIFT"})]})]}):(0,n.Y)(n.FK,{children:(0,n.FD)(y.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,n.FD)(k.T,{preset:"list-item-menu",children:["Know someone who’d love ",(0,n.Y)("span",{style:{fontStyle:"italic"},children:"The Free Press"}),"?"]}),(0,n.Y)(d.v,{href:f&&(0,q.Ay)("enable_founding_gifts")?(0,h.eh)({user:f}):"/subscribe?gift=true",localNavigation:!1,size:"sm",variant:"outline",children:"SEND GIFT"})]})})]})]}),(0,n.Y)(g.Rm,{}),E&&(0,n.FD)(n.FK,{children:[(0,n.FD)(y.pT,{alignItems:"center",className:"clickable-U5bOwj",justifyContent:"space-between",paddingBottom:8,onClick:()=>{if(!v)return;let e=(0,D._nG)(v,{addBase:!0,params:{utm_source:z.VU.account}});(0,F.V2)(e,{local_navigation:!1})},children:[(0,n.Y)(k.T,{preset:"list-item-menu",children:"Cancel subscription"}),(0,n.Y)(l.A,{size:20})]}),(0,n.Y)(g.Ne,{})]}),E&&v&&A&&(0,n.Y)(K.Z,{isOpen:c,sub:A,pub:v,onClose:()=>p(!1)})]})};var et=i(68410);let ei="tab-zPdpGg",en=()=>{let e=(0,u.df)(),t=(0,S.Jd)();return(0,n.FD)(y.pT,{className:"upgradeBanner-qujPvE",gap:8,justifyContent:"space-between",alignItems:"center",children:[(0,n.Y)(k.T,{preset:"lg-preview-byline",align:"center",children:"You're a free subscriber"}),(0,n.Y)(d.v,{variant:"primary-accent",size:"md",onClick:()=>((e,t)=>{if(!e)return;let i=(null==t?void 0:t.is_subscribed)?(0,D.RF$)({utm_source:z.VU.account}):(0,D.eV6)(e,{user:t,addBase:!0,params:{utm_source:z.VU.account}});(0,F.V2)(i,{local_navigation:!1})})(e,t),children:"Upgrade to paid"})]})},er=()=>{let[e,t]=(0,a.useState)("account"),{isMobile:i}=(0,et.sM)(),r=(0,S.Jd)(),l=(null==r?void 0:r.is_free_subscribed)&&!(null==r?void 0:r.is_subscribed);return(0,a.useEffect)(()=>{let e=()=>{let e=new URLSearchParams(window.location.search).get("tab");e&&["account","subscription","newsletters","podcastFeeds"].includes(e)&&t(e)};e(),window.addEventListener("popstate",e);let i=setInterval(e,100);return()=>{window.removeEventListener("popstate",e),clearInterval(i)}},[]),(0,n.FD)(y.pT,{className:"tabContainer-ZyUff9",direction:i?"column":"row",children:[(0,n.Y)(y.pT,{alignItems:i?"stretch":"start",className:"tabMenu-TPrBTB",direction:i?"row":"column",children:[{id:"account",label:"Account"},{id:"subscription",label:"Subscription"},{id:"newsletters",label:"Newsletters"},{id:"podcastFeeds",label:"Podcast Feeds"}].map(i=>(0,n.Y)(d.v,{className:e===i.id?"".concat(ei," ").concat("selectedTab-h46kjj"):ei,variant:"tertiary",onClick:()=>{var e;let n;return t(e=i.id),void((n=new URL(window.location.href)).searchParams.set("tab",e),window.history.pushState({},"",n))},children:i.label},i.id))}),(0,n.FD)("div",{className:"tabContent-Q4YhmV",children:[l&&(0,n.Y)(en,{}),"account"===e&&(0,n.Y)(P,{}),"subscription"===e&&(0,n.Y)(ee,{}),"newsletters"===e&&(0,n.Y)(O,{}),"podcastFeeds"===e&&(0,n.Y)(W,{}),["account","subscription"].includes(e)&&(0,n.Y)(N,{})]})]})};var ea=i(13950),el=i(85478);let eo=()=>{let e=(0,el.mJ)(),t=(0,S.Jd)(),i=e.getConfigFor("enable_account_settings_revamp");return((0,a.useEffect)(()=>{t?i||(0,r.route)("/account"):(0,r.route)("/login")},[t,i]),t&&i)?(0,n.Y)("div",{className:"the-free-press-theme",children:(0,n.Y)(ea.DH,{children:(0,n.Y)(er,{})})}):null}},13482:function(e,t,i){i.d(t,{w:()=>f,X:()=>g});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(49500),d=i(17402),u=i(15894),p=i(35369),h=i(76977),m=i(7244);let g=(0,d.forwardRef)((e,t)=>{var{className:i,value:o}=e,c=(0,a._)(e,["className","value"]);return(0,l.Y)(u.T,(0,r._)((0,n._)({},c),{as:"textarea",className:s()(i,"textarea-Ohqcz2"),innerRef:t,preset:"list-item-menu",value:o}))}),f=(0,d.forwardRef)((e,t)=>{var{className:i,flex:o,liveStream:d,onSend:u}=e,f=(0,a._)(e,["className","flex","liveStream","onSend"]);return(0,l.FD)(h.I1,{flex:o,position:"relative",children:[(0,l.Y)(g,(0,r._)((0,n._)({},f),{ref:t,className:s()(i,"textareaWithIcon-kncL3t")})),(0,l.FD)(h.Ye,{className:"iconContainer-aheBDP",position:"absolute",children:[(0,l.Y)(m.s,{liveStream:d}),(0,l.Y)(p.K0,{priority:"quaternary",onClick:()=>{u()},children:(0,l.Y)(c.A,{})})]})]})})},56455:function(e,t,i){i.d(t,{m:()=>a});var n=i(10201),r=i(13950);let a=e=>{let{children:t}=e;return(0,n.Y)("div",{className:"the-free-press-theme",children:(0,n.Y)(r.DH,{children:t})})}},42032:function(e,t,i){i.d(t,{E:()=>H});var n=i(69277),r=i(70408),a=i(10201),l=i(17402),o=i(15734),s=i.n(o),c=i(13950),d=i(73869),u=i(53696),p=i(73090),h=i(98695),m=i(23623),g=i(63446),f=i(7903),v=i(15894),b=i(60250),y=i(87677),Y=i(49869),_=i(68410),w=i(95294),C=i(49807);let k=892/346,S=16/9,I=510/892,F=e=>{let{currentIndex:t,posts:i,pub:n,setCurrentIndex:r}=e,{isMobile:o}=(0,_.sM)(),s=(0,l.useRef)(null),{width:c}=(0,Y.w)({containerRef:s}),d=o?c-56:c*I,[u,p]=(0,l.useState)({currentIndex:t,targetIndex:null,stage:null,direction:null}),h=!!u.stage,m=e=>{let{targetIndex:i,direction:n}=e;p({currentIndex:t,targetIndex:i,stage:"prepare",direction:n}),requestAnimationFrame(()=>{p({currentIndex:t,targetIndex:i,stage:"animate",direction:n}),setTimeout(()=>{r(i)},150),setTimeout(()=>{p({currentIndex:i,targetIndex:null,stage:null,direction:null})},300)})},g=()=>{h||m({targetIndex:(t+i.length-1)%i.length,direction:"previous"})},f=()=>{h||m({targetIndex:(t+1)%i.length,direction:"next"})};return(0,a.FD)("div",{ref:s,className:"outerContainer-_EB7WB",style:{height:o?(c-56)/S:c/k},children:[(0,a.Y)("div",{className:"innerTrack-Kj4zL_",children:i.map((e,t)=>{let r=D({animationState:u,panelIndex:t,numPanels:i.length}),l=o?E({panelOffset:r,imageWidth:d}):A({panelOffset:r,containerWidth:c,imageWidth:d}),s="animate"===u.stage?"all ".concat(300,"ms ease"):"none";return(0,a.Y)("a",{className:"panel-Y2mj7O",href:(0,C.wu9)(n,e,{noBase:!0}),style:{width:d,transform:"translateY(-50%) translateX(".concat(l.translate,"px) scale(").concat(l.scale,")"),display:l.display,transition:s,opacity:l.opacity},onClick:e=>{0!==r&&(e.preventDefault(),e.stopPropagation(),1===r?f():g())},children:(0,a.Y)(w.D,{className:"videoPostImage-dwXmpQ",disableVideoHover:!0,disableVideoHoverFade:!0,imageAspectRatio:16/9,imageWidth:1e3,isBelowTheFold:!1,post:e,videoPlayIconVariant:"red-circle"})},e.id)})}),(0,a.Y)("div",{className:"previousBackground-l9aBt9",onClick:g,children:(0,a.Y)(b.A,{size:o?18:32,stroke:"white",strokeWidth:1.5})}),(0,a.Y)("div",{className:"nextBackground-_36RTD",onClick:f,children:(0,a.Y)(y.A,{size:o?18:32,stroke:"white",strokeWidth:1.5})})]})},D=e=>{let{animationState:t,panelIndex:i,numPanels:n}=e,{currentIndex:r,targetIndex:a,stage:l,direction:o}=t,s=T({from:"animate"===l?null!=a?a:0:r,to:i,size:n});return null===l?[-1,0,1].includes(s)?s:null:[-1,0,1].includes(s)?s:"prepare"===l?"next"===o?2:-2:"next"===o?-2:2},T=e=>{let{from:t,to:i,size:n}=e,r=(i-t+n)%n;return r>n/2&&(r-=n),r},A=e=>{let{panelOffset:t,containerWidth:i,imageWidth:n}=e;return null===t?{translate:0,scale:0,display:"none",opacity:0}:{translate:.5*i-.5*n+t*(.5*n+.3*n+24),scale:0===t?1:.6,display:"block",opacity:0===t?1:.5}},E=e=>{let{panelOffset:t,imageWidth:i}=e;return null===t?{translate:0,scale:0,display:"none",opacity:0}:{translate:28+t*(i+14),scale:1,display:"block",opacity:0===t?1:.5}};var N=i(76977);let P=e=>{var t,i;let{hasActiveLiveStream:n,posts:r,pub:o,user:s}=e,{isMobile:c,isDesktop:d}=(0,_.sM)(),[p,h]=(0,l.useState)(0),g=69+(n&&!d?62:0),f=null==r?void 0:r[p],b=(null==f?void 0:f.section_id)&&null!=(i=null==(t=o.sections)?void 0:t.find(e=>e.id===f.section_id))?i:null;return(0,a.Y)(m.a,{children:(0,a.Y)("div",{className:"header-MeQvZM",style:{paddingTop:g,marginTop:-g},children:(0,a.Y)(N.I1,{paddingY:c?40:64,children:(0,a.Y)(u.r,{children:c?(0,a.FD)(N.I1,{children:[(0,a.Y)(N.I1,{paddingBottom:20,children:(0,a.Y)(v.T,{color:"white",preset:"h1-serif",children:"Video Series"})}),(0,a.Y)(N.I1,{paddingBottom:36,children:(0,a.Y)(F,{currentIndex:p,posts:r?r.slice(0,4):[],pub:o,setCurrentIndex:h})}),(0,a.Y)(N.I1,{children:f&&(0,a.Y)(x,{isMobile:!0,post:f,pub:o,section:b,user:s})})]}):(0,a.FD)(N.I1,{gap:16,children:[(0,a.Y)(v.T,{color:"white",preset:"h1-serif",children:"Videos"}),(0,a.FD)("div",{className:"headerContents-XMY0rT",children:[(0,a.Y)(N.I1,{children:f&&(0,a.Y)(x,{isMobile:!d,post:f,pub:o,section:b,user:s})}),(0,a.Y)(F,{currentIndex:p,posts:r?r.slice(0,4):[],pub:o,setCurrentIndex:h})]})]})})})})})},x=e=>{let{post:t,pub:i,section:n,user:r,isMobile:l}=e,o=(0,C.wu9)(i,t,{noBase:!0});return(0,a.FD)(N.I1,{gap:16,children:[(0,a.FD)(N.I1,{gap:12,children:[n?(0,a.FD)(N.Ye,{alignItems:"end",justifyContent:"space-between",position:"relative",children:[(0,a.Y)(v.T,{as:"a",href:(0,C.Dor)(i,{section:n}),preset:"d2-serif",children:n.name}),(0,a.Y)(f.S,{isPodcastOrVideo:!0,minimize:l,pub:i,section:n,user:r})]}):(0,a.Y)(v.T,{preset:"d2-serif",children:"\xa0"}),(0,a.FD)(N.I1,{borderBottom:"detail",borderTop:"detail",gap:12,paddingBottom:16,paddingTop:12,children:[(0,a.Y)(v.T,{as:"a",clamp:2,href:o,preset:"h5-serif",children:t.title}),(0,a.Y)(v.T,{clamp:3,preset:"d3-serif",children:t.description})]})]}),(0,a.Y)(N.Ye,{justifyContent:"start",children:(0,a.Y)(g.v,{href:o,trailingIcon:"chevron-right",variant:"tertiary",children:"Watch Now"})})]})};var L=i(72880),R=i(95691),M=i(16074),B=i(57324);let O=e=>{let{pub:t,user:i}=e,{initialSections:n}=(0,R.P)({pub:t});return(0,a.Y)(N.I1,{gap:24,children:n.map((e,n)=>(0,a.FD)(a.FK,{children:[0!==n&&(0,a.Y)(M.c,{}),(0,a.Y)(U,{pub:t,section:e,user:i})]}))})},U=e=>{let{pub:t,section:i,user:n}=e,{isMobile:r}=(0,_.sM)(),l=(0,C.Dor)(t,{section:i}),o=(0,C.eV6)(t,{addBase:!0,user:n,params:{next:document.location.href,utm_medium:B.Jn.web,utm_source:B.VU.videosPage}});return(0,a.FD)(N.Ye,{className:"sectionContainer-g1nief",gap:r?24:40,children:[i.logo_url&&(0,a.Y)(N.I1,{as:"a",flex:"auto",href:l,children:(0,a.Y)(L.o,{className:"sectionImage-OVlQ8l",maxWidth:300,src:i.logo_url})}),(0,a.FD)(N.I1,{gap:8*!r,overflow:"hidden",children:[(0,a.Y)(v.T,{as:"a",clamp:1,className:"sectionTitle-Aad7Bm",href:l,preset:"h5-serif",children:i.name}),(0,a.Y)(N.I1,{flex:r?void 0:"grow",paddingBottom:r?16:8,children:(0,a.Y)(v.T,{as:"a",clamp:3,href:l,preset:"d3-serif",children:i.description})}),!(null==n?void 0:n.is_subscribed)&&(0,a.FD)(N.Ye,{gap:8,children:[(0,a.Y)(v.T,{preset:"sm-preview-byline",children:"Free with Ads"}),(0,a.Y)(v.T,{as:"a",color:"accent",href:o,preset:"sm-preview-byline",children:"Listen Ad-Free"})]})]})]})};var j=i(60986),z=i(28528);let H=e=>{var t;let{activeLiveStream:i,pub:o,user:m,videoPageData:g}=e,{isMobile:f}=(0,_.sM)(),{activeLiveStream:v}=(0,j.u)({pub:o,preloadedLiveStream:i}),[b,y]=(0,l.useState)(!1),[Y,w]=(0,l.useState)((null!=(t=null==g?void 0:g.recentPosts.length)?t:0)<7),[C,k]=(0,l.useState)("latest"),[S,I]=(0,l.useState)(null!=g?g:null),F=null!=S?S:g,{recentPosts:D}=null!=F?F:{};(0,l.useEffect)(()=>{let e=async()=>{let e=await s().get("/videos/data");return e.body.recentPosts.length<7?w(!0):w(!1),e.body};if(g){var t;w((null!=(t=null==g?void 0:g.recentPosts.length)?t:0)<7),I(g)}else e().then(I)},[g]);let T=async()=>{var e;y(!0);let{body:t}=await s().get("/videos/data").query({offset:null!=(e=null==D?void 0:D.length)?e:0,limit:7});I(e=>(0,r._)((0,n._)({},e),{recentPosts:[...e?e.recentPosts:[],...t.recentPosts]})),t.recentPosts.length<7&&w(!0),y(!1)};return(0,a.Y)(z.XL,{pub:o,children:(0,a.Y)(c.DH,{children:(0,a.FD)(N.I1,{children:[(0,a.Y)(P,{hasActiveLiveStream:!!v,posts:null!=D?D:null,pub:o,user:m}),(0,a.Y)(u.r,{children:(0,a.Y)("div",{className:"bodyContents-ivBy3X",children:(0,a.FD)(N.I1,{gap:40,paddingY:40,children:[(0,a.FD)(N.Ye,{justifyContent:"center",position:"relative",children:[(0,a.Y)(h.p,{activeTabId:C,tabs:[{title:"Latest Videos",id:"latest"},{title:"All Series",id:"series"}],onClick:k}),"series"===C&&!f&&(0,a.Y)(N.Ye,{position:"absolute",style:{right:0,top:0},children:(0,a.Y)(d.m,{pub:o,sectionType:"video",user:null!=m?m:null})})]}),"latest"===C&&D&&(0,a.Y)(p.C,{isLoading:b,noMorePosts:Y,posts:D,onLoadMore:T}),"series"===C&&(0,a.Y)(O,{pub:o,user:m})]})})})]})})})}},94125:function(e,t,i){i.d(t,{w:()=>C});var n=i(10201),r=i(83673),a=i.n(r),l=i(38970),o=i.n(l),s=i(72102),c=i(17402),d=i(73869),u=i(82528),p=i(82011),h=i(63446),m=i(19397),g=i(15894),f=i(1918),v=i(8149),b=i(76977),y=i(39318),Y=i(72032);let _="letters@thefp.com",w="tips@thefp.com",C=e=>{let{pub:t,user:i}=e,{ids:r}=(0,f.i)({pub:t}),l=o()(t.authorPagesInfo,"user_id"),[C,k]=(0,c.useState)(!0),[S,I]=(0,c.useState)(!0),F=e=>{var i;let r=l[e];return r?{title:(0,n.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",paddingRight:32*!!r.primary_section_id,position:"relative",children:[(0,n.Y)(g.T,{preset:"h5-serif",children:r.name}),!!r.primary_section_id&&(0,n.Y)(p.L,{authorId:r.user_id,minimize:!0})]}),imageUrl:r.photo_url,description:r.bio,url:null!=(i=(0,y.cxh)({userId:r.user_id,pub:t}))?i:""}:null},D=a()(r.filter(e=>{var t;return!!(null==(t=l[e])?void 0:t.primary_section_id)}).map(F)),T=a()(r.filter(e=>{var t;return!(null==(t=l[e])?void 0:t.primary_section_id)}).map(F)),A=D.length>0;return(0,n.Y)(u.y,{actions:(0,n.Y)(d.m,{pub:t,sectionType:"who-we-are",user:null!=i?i:null}),description:(0,n.FD)(n.FK,{children:["If you have a letter to the editor, commenting on one of our stories, write to"," ",(0,n.Y)("a",{href:"mailto:".concat(_),rel:"noopener noreferrer",target:"_blank",children:_}),".",(0,n.Y)("br",{}),"To share a tip about story going on in your neighborhood or institution, write to"," ",(0,n.Y)("a",{href:"mailto:".concat(w),rel:"noopener noreferrer",target:"_blank",children:w}),"."]}),hideDivider:A,title:"Who We Are",children:(0,n.FD)(b.I1,{gap:40,children:[A&&(0,n.FD)(n.FK,{children:[(0,n.FD)(b.I1,{gap:8,children:[(0,n.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,n.Y)(g.T,{preset:"h4-sans-condensed",children:"Columnists"}),(0,n.Y)(h.v,{variant:"accordion",onClick:()=>{k(!C)},children:(0,n.Y)(s.A,{className:"".concat(Y.A.caret," ").concat(C?"":Y.A.collapsed),height:36,width:36})})]}),(0,n.Y)("div",{className:Y.A.thickRule})]}),(0,n.Y)(v.N,{open:C,children:(0,n.Y)(m.F,{applyHoverOnTitle:!1,hasMarkdownDescriptions:!0,items:D,justifyViewAllLabel:"start",showDescriptionOnMobile:!0,viewAllLabel:"Read more"})}),(0,n.FD)(b.I1,{gap:8,children:[(0,n.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,n.Y)(g.T,{preset:"h4-sans-condensed",children:"Staff Writers and Editors"}),(0,n.Y)(h.v,{variant:"accordion",onClick:()=>{I(!S)},children:(0,n.Y)(s.A,{className:"".concat(Y.A.caret," ").concat(S?"":Y.A.collapsed),height:36,width:36})})]}),(0,n.Y)("div",{className:Y.A.thickRule})]})]}),(0,n.Y)(v.N,{open:S,children:(0,n.Y)(m.F,{applyHoverOnTitle:!1,hasMarkdownDescriptions:!0,items:T,justifyViewAllLabel:"start",showDescriptionOnMobile:!0,viewAllLabel:"Read more"})})]})})}},91315:function(e,t,i){i.d(t,{V:()=>W});var n=i(10201),r=i(32485),a=i.n(r),l=i(75107),o=i(87677),s=i(17402),c=i(13950),d=i(72880),u=i(44815),p=i(22884);let h={coverImage:"coverImage-lDa1UL",headerImage:"headerImage-YvCrC1",datetimeInput:"datetimeInput-W3o29e",formLabel:"formLabel-YcWPTP",columnLabel:"columnLabel-FiYzFV",tabs:"tabs-pvo6fW",carouselSection:"carouselSection-o6Vatv",viewAll:"viewAll-G3ryYO",activeIndicator:"activeIndicator-QrOuU6",body:"body-jM2qDJ",header:"header-qyY_LG",section:"section-eGkqMh",overviewContent:"overviewContent-woD8Go",storyFilters:"storyFilters-TUKs8u",filterDrawer:"filterDrawer-xiacDR",halfWidth:"halfWidth-Kvs4D8",fullWidth:"fullWidth-huxevk",link:"link-d7W3vi",presentingSponsorItem:"presentingSponsorItem-iRdcBr",logoImage:"logoImage-n6AJcY",sponsorsSection:"sponsorsSection-sBBwhX",presentingSponsors:"presentingSponsors-IdhPjQ",associateSponsorItem:"associateSponsorItem-JmCeIG",associateSponsors:"associateSponsors-E6uJdd",eventSponsors:"eventSponsors-QajGni",accentText:"accentText-PJoM9f",clearAll:"clearAll-PlzbdB",grid2:"grid2-Qn3XQs",radioButton:"radioButton-xrh_v2",contentBlock:"contentBlock-ZJEFvK",thickDivider:"thickDivider-nMBiD6",subscribeButton:"subscribeButton-y1jTFS",authorCard:"authorCard-rbBteZ",eventCard:"eventCard-kqvX4w",eventsPreview:"eventsPreview-iW8fgn",manifesto:"manifesto-pnC01w",keepReading:"keepReading-zXEd47",gridContentWide:"gridContentWide-qDAfp5"},m=e=>{let{isAdmin:t,user:i,post:r,pub:a,eventId:l,goToEvent:o,refetchEvents:s,allEvents:c}=e,d=c.filter(e=>e.value.isA250);if(l){let e=d.find(e=>e.key===l);return(0,n.Y)("div",{className:h.body,children:(0,n.Y)(u.s,{eventData:e,eventId:l,goToEvent:o,post:r,pub:a,surface:"fp-america250",user:i})})}return(0,n.Y)("div",{className:h.body,children:(0,n.Y)(p.y,{allEvents:d,eventKeyPrefix:"event-",goToEvent:o,isA250:!0,isAdmin:t,post:r,pub:a,refetchEvents:s,showSeries:!1,user:i})})};var g=i(76977);let f=e=>{let{imageUrl:t,isEventPage:i,children:r}=e;return(0,n.Y)("div",{className:a()(i?"backgroundAlternate-_7s7DT":"background-TS_gqR"),children:(0,n.FD)("div",{className:a()(i?"containerAlternate-WGXWZq":"container-yxf71B"),children:[(0,n.Y)("img",{className:a()(i?"headerImageAlternate-Arp7Tv":"headerImage-Y8cPSt"),src:t}),(0,n.Y)(g.I1,{alignItems:"center",className:a()(i?"contentAlternate-Z6mfO4":"content-iscROM"),justifyContent:"center",position:"relative",textAlign:"center",children:r})]})})};var v=i(15894),b=i(52050);let y=e=>{let{sponsor:t}=e;return(0,n.FD)("a",{className:h.presentingSponsorItem,href:t.sponsorLink,target:"_blank",children:[(0,n.Y)("img",{alt:t.name,className:h.logoImage,src:t.imageUrl}),(0,n.Y)(v.T,{preset:"h6-sans",children:t.name})]})},Y=e=>{let{sponsor:t}=e;return(0,n.Y)("a",{className:h.associateSponsorItem,href:t.sponsorLink,target:"_blank",children:(0,n.Y)("img",{alt:t.name,className:h.logoImage,src:t.imageUrl})})},_=()=>(0,n.FD)("div",{className:h.body,children:[(0,n.FD)(g.Ye,{className:"".concat(b.A.gridContainer," ").concat(h.sponsorsSection),children:[(0,n.Y)("div",{children:(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"PRESENTING SPONSORS"})}),(0,n.Y)(g.I1,{children:(0,n.Y)("div",{className:h.presentingSponsors,children:[{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"}].map(e=>(0,n.Y)(y,{sponsor:e},e.name))})})]}),(0,n.FD)(g.Ye,{className:"".concat(b.A.gridContainer," ").concat(h.sponsorsSection),children:[(0,n.Y)("div",{children:(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"ASSOCIATE SPONSORS"})}),(0,n.Y)(g.I1,{children:(0,n.Y)("div",{className:h.associateSponsors,children:[{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"}].map(e=>(0,n.Y)(Y,{sponsor:e},e.name))})})]}),(0,n.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,n.Y)("div",{children:(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"PARTNERSHIPS"})}),(0,n.FD)(g.I1,{children:[(0,n.Y)(v.T,{preset:"h5-serif",style:{fontWeight:600,marginBottom:16},children:"Interested in sponsorship or advertising partnerships?"}),(0,n.FD)(v.T,{preset:"detail-small",style:{fontWeight:700},children:["Reach out to us at"," ",(0,n.Y)("a",{href:"mailto:partnerships@thefp.com",style:{color:"#f2312c"},children:"partnerships@thefp.com"})]})]})]})]});var w=i(57456),C=i(63446),k=i(68410),S=i(60355),I=i(16074),F=i(95477);let D=["all","videos","podcasts","articles"],T=()=>{let{isMobile:e}=(0,k.sM)(),[t,i]=(0,s.useState)("all"),[r,l]=(0,s.useState)(0),{result:o,hasMore:c}=(0,w.t)(r,20),d="all"===t?o:null==o?void 0:o.filter(e=>"podcast"===e.type&&!!e.podcast_url&&"podcasts"===t||"podcast"===e.type&&!!e.video_upload_id&&"videos"===t||"newsletter"===e.type&&"articles"===t||!1);return(0,n.Y)("div",{className:h.body,children:(0,n.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,n.FD)(g.I1,{children:[(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"STORIES"}),(0,n.Y)(v.T,{className:h.columnLabel,preset:"detail-large",children:"FILTER BY"}),e?(0,n.Y)(g.Ye,{className:h.storyFilters,gap:12,children:D.map(e=>(0,n.Y)(C.v,{className:a()(t===e?h.checked:""),variant:t===e?"outline":"inactive",onClick:()=>i(e),children:e.toUpperCase()},e))}):(0,n.Y)(g.I1,{gap:24,children:D.map(e=>(0,n.FD)(g.Ye,{gap:8,onClick:()=>i(e),children:[(0,n.Y)(F.s,{checked:t===e,name:"story-filter",theme:"dark",value:e}),(0,n.Y)(v.T,{preset:"detail-small",children:e.toUpperCase()})]},e))})]}),(0,n.FD)(g.I1,{className:h.section,gap:24,children:[null==d?void 0:d.map((e,t)=>(0,n.FD)(g.I1,{children:[(0,n.Y)(S.R,{post:e,variant:"archive"}),t<d.length-1&&(0,n.Y)(I.c,{paddingTop:24})]},e.id)),c&&(0,n.Y)(C.v,{onClick:()=>l(r+20),children:"Load More"})]})]})})};var A=i(38486),E=i(14739),N=i(57898),P=i(53696),x=i(25006),L=i(44333),R=i(68349),M=i(28528),B=i(16291),O=i(39318),U=i(9036);let j=e=>{let{isAdmin:t,isMobile:i,user:r,pub:c,goToTab:d,allEvents:u}=e,{result:p}=(0,w.t)(0,3),[m,f]=(0,s.useState)(!1),y=u.filter(e=>"published"===e.value.status&&e.value.dateTime&&new Date(e.value.dateTime)>new Date&&e.value.isA250).slice(0,3),Y=(null==y?void 0:y.length)===1;return(0,n.FD)(g.I1,{className:h.body,gap:24,children:[(0,n.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"Manifesto"}),(0,n.FD)(g.I1,{className:a()(h.manifesto,h.section),gap:12,children:[(0,n.Y)(v.T,{preset:"body",children:"America is turning 250. And we’re throwing a yearlong celebration of the greatest country on Earth."}),(0,n.Y)(v.T,{preset:"body",children:"The greatest? Yes. The greatest. "}),(0,n.Y)(v.T,{preset:"body",children:"We realize that’s not a popular thing to say these days. Americans have a way of taking this country for granted: A recent Gallup poll shows that American pride has reached a new low. And the world at large, which is wealthier and freer than it has ever been in history, thanks to American power and largesse, often resents us."}),(0,n.Y)(v.T,{preset:"body",children:" We get it. "}),(0,n.FD)(v.T,{preset:"body",children:["As journalists, we spend most of our time finding problems, exposing them. It’s what the job calls for."," "]}),(0,n.Y)(v.T,{preset:"body",children:"But if you only focus on the negatives, you get a distorted view of reality. As America hits this milestone birthday, it’s the perfect moment to step back and look closely at where we actually are—and the reality of life in America today compared to other times and places. That reality is pretty spectacular."}),!m&&(0,n.FD)(v.T,{className:h.keepReading,color:"accent",preset:"detail-large",onClick:()=>f(!0),children:["KEEP READING ",(0,n.Y)(l.A,{})]}),m&&(0,n.FD)(n.FK,{children:[(0,n.FD)(v.T,{preset:"body",children:[" ","Could Thomas Jefferson and the men gathered in Philadelphia who wrote down the words that made our world—We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness—ever have imagined what their declaration of independence would bring?"]}),(0,n.FD)(v.T,{preset:"body",children:[" ","The Constitution. The end of slavery—and the defeat of Hitler. Astonishing wealth and medical breakthroughs. Silicon Valley. The most powerful military in the world. The moon landing. Hollywood. The Hoover Dam. The Statue of Liberty (a gift from France). Actual liberation (a thing we gave France). Humphrey Bogart and Tom Hanks. Josephine Baker and Beyonc\xe9 Knowles. Hot dogs. Corn dogs. American Chinese food. American Italian food. The Roosevelts and the Kennedys. The Barrymores and the Fondas. Winston Churchill (his mom was from Brooklyn). The Marshall Plan and Thurgood Marshall. Star Wars. Missile defense shields. Baseball. Football. The military-industrial complex. Freedom of religion. UFO cults. Television. The internet. The pill. The Pope. The automobile, the airplane, and AI. Jazz and the blues. The polio vaccine and GLP-1s. The UFC and Dolly Parton."]}),(0,n.Y)(v.T,{preset:"body",children:" The list goes on because it’s really, truly endless."}),(0,n.Y)(v.T,{preset:"body",children:"Ours is a country where you can hear 800 languages spoken in New York City, drive two hours, and end up among the Amish in Pennsylvania. We are 342 million people, from California to New York Island, gathered together as one."}),(0,n.Y)(v.T,{preset:"body",children:"Each of those 342 million will tell you that ours is not a perfect country. But we suspect most of them would agree that their lives would not be possible without it."}),(0,n.FD)(v.T,{preset:"body",children:["So for the next 12 months, we’re going to toast to our freedoms. And we’re doing it the"," ",(0,n.Y)("em",{children:"Free Press"})," way: by delving into all of it—the bad and the good and the great, the strange and the wonderful and the wild."]})]})]})]}),(0,n.Y)(I.c,{}),(0,n.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,n.Y)(v.T,{className:a()(h.upcomingEventsHeader,h.header),preset:"st3",children:"UPCOMING EVENTS"}),(0,n.FD)(g.I1,{className:a()(b.A.gridContentWide,h.section),children:[(0,n.FD)(v.T,{className:h.viewAll,color:"accent",preset:"detail-large",onClick:()=>d("events",void 0,!0),children:["View All ",(0,n.Y)(o.A,{})]}),(0,n.Y)(g.Ye,{className:a()(h.eventsPreview,!i&&Y?"desktop":void 0),gap:40,children:null==y?void 0:y.map(e=>(0,n.Y)(E.L,{eventConfig:e,goToEvent:e=>d("events",e,!0),hideIcons:!1,isAdmin:t,isMobile:i,pub:c,showSeries:!1,surface:"fp-america250",user:r},e.key))})]})]}),(0,n.Y)(I.c,{}),(0,n.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,n.Y)(v.T,{className:h.header,preset:"st3",children:"STORIES"}),(0,n.FD)(g.I1,{className:a()(b.A.gridContentWide,h.section),children:[(0,n.FD)(v.T,{className:h.viewAll,color:"accent",preset:"detail-large",onClick:()=>d("stories",void 0,!0),children:["View All ",(0,n.Y)(o.A,{})]}),(0,n.Y)(g.pT,{className:h.overviewContent,direction:i?"column":"row",gap:40,children:null==p?void 0:p.map(e=>(0,n.Y)(S.R,{post:e,variant:i?"archive":"square"},e.id))})]})]})]})},z=e=>{let{activeTabId:t,tabs:i,onClick:r}=e;return(0,n.Y)(g.Ye,{children:i.map(e=>{let i=e.id===t;return(0,n.FD)(g.Ye,{cursor:"pointer",padding:16,position:"relative",role:"button",onClick:()=>{r(e.id)},children:[(0,n.Y)(v.T,{preset:"detail-large",children:e.title}),i&&(0,n.Y)("div",{className:h.activeIndicator})]})})})},H=e=>{let{event:t,pub:i,user:r,post:a}=e,l=t?(0,A.dN)(t.location):null;return t?(0,n.FD)(n.FK,{children:[(0,n.Y)(v.T,{color:"white",preset:"h2-serif",children:t.title}),(0,n.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:t.dateTime&&"".concat((0,B.A)(t.dateTime).format("MMMM D, YYYY")," ").concat((0,B.A)(t.dateTime).format("h:mma"))}),(0,n.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:[l," at ",t.place]}),(0,n.Y)(N.z,{event:t,isHeader:!0,post:a,pub:i,surface:"fp-america250",user:r})]}):null},W=e=>{var t;let{pub:i,user:r}=e,{isMobile:a}=(0,k.sM)(),[l]=(0,L.rd)(),o=(0,U.m)(l.url),[u,p]=(0,s.useState)(null!=(t=o.tab)?t:"overview"),[b,y]=(0,s.useState)(o.eventId),Y=(null==r?void 0:r.is_admin)&&!l.url.includes("hideAdmin"),{result:C,refetch:S}=(0,A.ZJ)(),I=(null==C?void 0:C.configs)||[],F=b?I.find(e=>e.key===b):void 0,D=null==F?void 0:F.value,E=(0,w.i)(null==D?void 0:D.postSlug);(0,s.useEffect)(()=>{var e;p(null!=(e=o.tab)?e:"overview"),y(o.eventId)},[l.url]);let N=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p(e),y(t);let n=new URL(window.location.href),r=new URLSearchParams(n.search);r.set("tab",e),t?r.set("eventId",t):r.delete("eventId"),i?(0,R.V2)("".concat(n.pathname,"?").concat(r)):(0,R.dJ)("".concat(n.pathname,"?").concat(r))},B="events"===u&&b;return(0,n.Y)(x.Eo,{pub:i,children:(0,n.Y)(M.XL,{pub:i,children:(0,n.FD)(c.DH,{children:[(0,n.Y)(f,{imageUrl:B?(null==D?void 0:D.image)||"":(0,O.dJ9)("".concat((0,O.Ewe)(),"/img/thefp/").concat(a?"america250Mobile.png":"america250Final.png")),isEventPage:!!B,children:B?(0,n.Y)(n.FK,{children:(0,n.Y)(H,{event:D,post:E,pub:i,user:r})}):(0,n.FD)(n.FK,{children:[(0,n.Y)(v.T,{color:"white",preset:"h4-sans-condensed",style:{maxWidth:a?"400px":"312px"},children:"THE FREE PRESS PRESENTS"}),(0,n.Y)(d.o,{className:h.headerImage,maxWidth:a?250:400,src:(0,O.dJ9)("".concat((0,O.Ewe)(),"/img/thefp/americaAt250.png"))}),(0,n.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:"An unprecedented series of premium events, conversations, and experiences celebrating America’s 250th."})]})}),(0,n.Y)(g.Ye,{className:h.tabs,justifyContent:"center",children:(0,n.Y)(z,{activeTabId:u,tabs:[{title:"Overview",id:"overview"},{title:"Events",id:"events"},{title:"Stories",id:"stories"}],onClick:e=>{e&&N(e)}})}),(0,n.Y)(P.r,{children:(0,n.Y)(g.I1,{alignSelf:"center",className:h.eventsContainer,gap:40,maxWidth:a?480:void 0,paddingBottom:64,children:(0,n.Y)(g.I1,{gap:32,children:(()=>{switch(u){case"overview":return(0,n.Y)(j,{allEvents:I,goToTab:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return N(e,t,i)},isAdmin:!!Y,isMobile:a,pub:i,user:r});case"events":return(0,n.Y)(m,{allEvents:(null==C?void 0:C.configs)||[],eventId:b,goToEvent:e=>N("events",e,!0),isAdmin:!!Y,post:E,pub:i,refetchEvents:S,user:r});case"stories":return(0,n.Y)(T,{});case"sponsors":return(0,n.Y)(_,{});default:return null}})()})})})]})})})}},57456:function(e,t,i){i.d(t,{i:()=>l,t:()=>a});var n=i(17402),r=i(12501);let a=function(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,[a,l]=(0,n.useState)([]),[o,s]=(0,n.useState)(!0),c=(0,r.st)({pathname:"/api/v1/archive",query:{sort:"new",limit:i,offset:e,post_tag_id:"d4bbb715-5635-4137-8f5f-aaf89ed80ca9"},auto:!0,deps:[e]});return(0,n.useEffect)(()=>{!o&&c.isLoading?s(!0):!c.isLoading&&o&&c.result&&(l(e=>[...e,...c.result||[]]),s(!1))},[c.result,c.isLoading]),{result:a,hasMore:!c.isLoading&&(null==(t=c.result)?void 0:t.length)===i}},l=e=>{let t=(0,r.st)({pathname:"/api/v1/posts/".concat(e),query:{preview:!0},auto:!1});return(0,n.useEffect)(()=>{e&&t.refetch()},[e]),e?t.result:null}},14739:function(e,t,i){i.d(t,{L:()=>v});var n=i(10201),r=i(32485),a=i.n(r),l=i(32307),o=i(76069),s=i(72880),c=i(57456),d=i(38486),u=i(57898),p=i(15894),h=i(76977),m=i(16291),g=i(39862);let f={eventCard:"eventCard-uFRmX6",eventCardHeader:"eventCardHeader-uVMduR",eventCardTitle:"eventCardTitle-HyD3H8",eventActions:"eventActions-UyJo9k",eventTypes:"eventTypes-DizLQi",eventDescription:"eventDescription-MzE2D1",typeTag:"typeTag-dtvX8u","in-person":"in-person-bGFEFa",inPerson:"in-person-bGFEFa",livestream:"livestream-EzMp0v",actionButton:"actionButton-CdUeYP",deleteButton:"deleteButton-EwTebW",eventStatusLabel:"eventStatusLabel-Jeu7Gn",eventCardBottom:"eventCardBottom-HEIxGW",coverImage:"coverImage-EDvboy",eventSeriesLink:"eventSeriesLink-VmrOOC"},v=e=>{let{eventConfig:t,hideIcons:i,goToEvent:r,goToSeries:v,onEdit:b,onDelete:y,user:Y,pub:_,isAdmin:w,isMobile:C,surface:k,showSeries:S}=e,I=(0,c.i)(t.value.postSlug);return(0,n.FD)("div",{className:f.eventCard,onClick:()=>r(t.key),children:[w&&b&&y&&(0,n.FD)("div",{className:f.eventActions,children:[(0,n.Y)("button",{className:f.actionButton,onClick:e=>{e.stopPropagation(),b(t)},children:"Edit"}),(0,n.Y)("button",{className:"".concat(f.actionButton," ").concat(f.deleteButton),onClick:e=>{e.stopPropagation(),y(t.key)},children:"Delete"}),(0,n.Y)("span",{className:f.eventStatusLabel,children:t.value.status})]}),(0,n.Y)(s.o,{className:f.coverImage,maxWidth:310,src:t.value.placeholderImage,onClick:()=>r(t.key)}),(0,n.FD)(h.I1,{className:f.eventCardHeader,gap:8,onClick:()=>r(t.key),children:[(0,n.Y)(p.T,{className:f.eventCardTitle,preset:"h4-sans-condensed",children:t.value.title}),S&&C&&t.value.series&&(0,n.Y)(p.T,{className:f.eventSeriesLink,color:"accent",preset:"detail-small",onClick:()=>t.value.series&&(null==v?void 0:v(t.value.series)),children:g.n[t.value.series]}),(0,n.FD)(h.I1,{gap:8,children:[(0,n.FD)(p.T,{color:"tertiary",preset:"detail-small",children:[!i&&(0,n.Y)(l.A,{size:16}),t.value.dateTime&&(0,m.A)(t.value.dateTime).format("MMMM D, YYYY")]}),(0,n.FD)(p.T,{color:"tertiary",preset:"detail-small",children:[!i&&(0,n.Y)(o.A,{size:16})," ",(0,d.dN)(t.value.location)]})]}),(0,n.Y)(h.pT,{className:f.eventTypes,direction:C?"column":"row",children:(Array.isArray(t.value.type)?t.value.type:[t.value.type]).map(e=>(0,n.Y)("span",{className:a()(f.typeTag,f[e.toString()]),children:(0,n.Y)(p.T,{preset:"detail-large",children:e})}))})]}),(0,n.FD)(h.I1,{className:f.eventCardBottom,onClick:e=>e.stopPropagation(),children:[(0,n.FD)(h.I1,{gap:8,children:[S&&!C&&t.value.series&&(0,n.Y)(p.T,{className:f.eventSeriesLink,color:"accent",preset:"detail-small",onClick:()=>t.value.series&&(null==v?void 0:v(t.value.series)),children:g.n[t.value.series]}),(0,n.Y)(p.T,{clamp:3,className:f.eventDescription,preset:"body",children:t.value.description})]}),(0,n.Y)(u.z,{event:t.value,isHeader:!1,post:I,pub:_,surface:k,user:Y})]})]})}},44815:function(e,t,i){i.d(t,{s:()=>F});var n=i(69277),r=i(70408),a=i(10201),l=i(32485),o=i.n(l),s=i(87677),c=i(60250),d=i(72880),u=i(57456),p=i(38486),h=i(57898),m=i(82011),g=i(15894),f=i(32600),v=i(17306),b=i(11574),y=i(68410),Y=i(60355),_=i(16074),w=i(76977),C=i(16291),k=i(52050);let S=e=>{let{author:t,isMobile:i}=e,l=parseInt(t.id,10),{hasSection:o}=(0,f.C)(l),{markdownProps:c}=(0,v.$)(null==t?void 0:t.bio);return(0,a.FD)(w.I1,{className:k.A.authorCard,gap:8,children:[(0,a.FD)(w.pT,{direction:i?"row":"column",gap:8,children:[(null==t?void 0:t.imageUrl)&&(0,a.Y)(d.o,{maxWidth:i?90:310,src:null==t?void 0:t.imageUrl,width:i?90:"100%"}),(0,a.FD)(w.I1,{gap:8,justifyContent:"end",position:i?void 0:"relative",children:[(0,a.Y)(g.T,{preset:"h5-serif",children:null==t?void 0:t.name}),(0,a.Y)(g.T,{preset:"detail-large",children:null==t?void 0:t.role}),o&&(0,a.Y)(m.L,{authorId:l,className:k.A.subscribeButton,minimize:!i})]})]}),(0,a.Y)(g.T,(0,r._)((0,n._)({},c),{preset:"d3-serif"})),(null==t?void 0:t.handle)&&(0,a.FD)(g.T,{as:"a",className:k.A.link,href:"/w/".concat(t.handle),preset:"detail-large",children:["READ MORE ",(0,a.Y)(s.A,{})]})]},t.id)},I=e=>{let{event:t,post:i,isMobile:n}=e,r=(null==t?void 0:t.dateTime)&&new Date(t.dateTime)<new Date&&(null==t?void 0:t.postSlug);return i?(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:40,children:[r&&(0,a.Y)(g.T,{preset:"st3",children:"IN CASE YOU MISSED IT..."}),(0,a.Y)(w.Ye,{className:n?"":k.A.halfWidth,children:(0,a.Y)(Y.R,{post:i,variant:n?"archive":"square"},i.id)})]}),(0,a.Y)(_.c,{paddingY:64})]}):null},F=e=>{var t,i;let{eventId:l,pub:s,user:m,post:f,goToEvent:Y,eventData:F,surface:D}=e,{isMobile:T}=(0,y.sM)(),{result:A}=(0,p.uL)(l),{result:E}=(0,u.t)(0,5),N=(null==F?void 0:F.value)||(null==A||null==(t=A.config)?void 0:t.value),{markdownProps:P}=(0,v.$)(null==N?void 0:N.description),x=null==N?void 0:N.speakers;return F||A?N?(0,a.FD)(a.FK,{children:[(0,a.FD)(w.Ye,{className:k.A.gridContainer,gap:40,children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.FD)(g.T,{className:k.A.link,preset:"detail-large",onClick:()=>Y(),children:[(0,a.Y)(c.A,{})," BACK TO EVENTS"]}),(0,a.Y)(g.T,{preset:"st3",children:N.title}),(0,a.FD)(w.I1,{children:[(0,a.Y)(g.T,{preset:"d2-serif",children:N.dateTime&&(0,C.A)(N.dateTime).format("MMMM D, YYYY")}),(0,a.Y)(g.T,{preset:"d2-serif",children:N.dateTime&&(0,C.A)(N.dateTime).format("h:mma")}),(0,a.FD)(g.T,{preset:"d2-serif",children:[(0,p.dN)(N.location)," at ",N.place]})]}),(0,a.Y)(w.Ye,{gap:8,children:(Array.isArray(N.type)?N.type:[N.type]).map(e=>(0,a.Y)("span",{className:o()(k.A.typeTag,k.A[e.toString()]),children:(0,a.Y)(g.T,{preset:"detail-large",children:e})},e.toString()))}),(0,a.Y)(h.z,{event:N,isDetailView:!0,isHeader:!1,post:f,pub:s,surface:D,user:m}),T&&(0,a.Y)(_.c,{paddingTop:24})]}),(0,a.FD)(w.I1,{children:[(0,a.Y)(g.T,(0,r._)((0,n._)({},P),{preset:"body"})),(0,a.Y)(_.c,{paddingY:T?40:64}),!!(null==x?void 0:x.length)&&(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.Y)(g.T,{preset:"st3",children:"PRESENTING"}),(0,a.Y)(w.pT,{className:k.A.speakerContainer,direction:T?"column":"row",gap:40,children:null==x?void 0:x.map((e,t)=>(0,a.Y)(S,{author:e,isMobile:T},t))})]}),(0,a.Y)(_.c,{paddingY:T?40:64})]}),(0,a.Y)(I,{event:N,isMobile:T,post:f}),!!N.sponsors.length&&(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.Y)(g.T,{preset:"st3",children:"SPONSORS"}),(0,a.Y)("div",{className:k.A.eventSponsors,children:null==(i=N.sponsors)?void 0:i.map((e,t)=>(0,a.Y)("a",{href:null==e?void 0:e.sponsorLink,style:{textDecoration:"none"},target:"_blank",children:(0,a.FD)(w.I1,{gap:16,children:[(null==e?void 0:e.imageUrl)&&(0,a.Y)(d.o,{maxWidth:T?90:310,src:null==e?void 0:e.imageUrl,width:T?90:void 0}),(0,a.Y)(g.T,{preset:"h6-sans",children:e.name})]},t)}))})]}),(0,a.Y)(_.c,{paddingY:T?40:64})]}),(0,a.FD)(w.I1,{gap:16,children:[(0,a.Y)(g.T,{preset:"h5-serif",children:"Interested in sponsorship or advertising partnerships?"}),(0,a.FD)(g.T,{preset:"detail-large",children:["REACH OUT TO US AT ",(0,a.Y)("span",{className:k.A.accentText,children:"PARTNERSHIPS@THEFP.COM"})]})]}),!T&&(0,a.Y)(_.c,{paddingBottom:80,paddingTop:64})]})]}),!T&&(0,a.Y)("div",{className:k.A.contentBlock,children:(0,a.Y)(b.$,{headerVariant:"align-right",posts:E,title:"More from The Free Press",variant:"large-in-middle"})})]}):(0,a.FD)(w.Ye,{className:k.A.gridContainer,children:[(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"st3",children:"Event Not Found"})}),(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"body",children:"The requested event could not be found."})})]}):(0,a.FD)(w.Ye,{className:k.A.gridContainer,children:[(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"st3",children:"Loading..."})}),(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"body",children:"Loading event details..."})})]})}},22884:function(e,t,i){i.d(t,{y:()=>z});var n=i(10201),r=i(32485),a=i.n(r),l=i(72102),o=i(60250),s=i(17402),c=i(17988),d=i(69277),u=i(70408),p=i(63446),h=i(6641),m=i(13482),g=i(15894),f=i(12501),v=i(68349),b=i(60322),y=i(21258),Y=i(49045),_=i(48535),w=i(76977),C=i(84270),k=i(60141),S=i(36372),I=i(39862),F=i(52050);let D=e=>{let{label:t,children:i}=e;return(0,n.FD)(w.I1,{gap:12,children:[(0,n.Y)(g.T,{color:"primary",preset:"body",children:t}),i]})},T=e=>{let{children:t,onRemove:i}=e;return(0,n.FD)(w.I1,{gap:16,padding:16,style:{border:"1px solid var(--color-detail)",borderRadius:"8px",backgroundColor:"var(--color-secondary)"},children:[i&&(0,n.Y)(w.Ye,{justifyContent:"end",children:(0,n.Y)(p.v,{size:"sm",variant:"outline",onClick:i,children:"Remove"})}),t]})},A=e=>{let{children:t}=e;return(0,n.Y)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:t})},E=[{value:"",label:"None"},...Object.entries(I.n).map(e=>{let[t,i]=e;return{label:i,value:t}})],N=e=>{var t;let{pub:i,isOpen:r,isA250Page:a=!1,onClose:l,onEventCreated:o,editingEvent:c=null}=e,I=(0,S.d)(),N=!!c,[P,x]=(0,s.useState)(()=>c?(0,u._)((0,d._)({},c.value),{speakers:c.value.speakers||[],sponsors:c.value.sponsors||[],dateTime:new Date(c.value.dateTime)}):{title:"",description:"",placeholderImage:"",dateTime:new Date,place:"",image:"",location:"",ticketLink:"",postSlug:"",speakers:[],sponsors:[],type:["in-person"],isA250:a}),[L,R]=(0,s.useState)(!1),{refetch:M}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"PUT"}),{refetch:B}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"PUT"});(0,s.useEffect)(()=>{c?x((0,u._)((0,d._)({},c.value),{speakers:c.value.speakers||[],sponsors:c.value.sponsors||[],dateTime:new Date(c.value.dateTime)})):x({title:"",description:"",placeholderImage:"",dateTime:new Date,place:"",image:"",location:"",ticketLink:"",postSlug:"",speakers:[],sponsors:[],type:["in-person"],isA250:a})},[c]);let O=async e=>{e.preventDefault(),R(!0);try{let e=(0,d._)({},P);if(N&&c)await B({query:{key:c.key},json:{value:e}}),I.popToast(()=>(0,n.Y)(S.y,{text:"Event updated successfully!"}));else{let t="event-".concat((()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let i=0;i<10;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t})());await M({query:{key:t},json:{value:e}}),I.popToast(()=>(0,n.Y)(S.y,{text:"Event created successfully!"}))}l(),o()}catch(t){let e=N?"updating":"creating";I.popToast(()=>(0,n.Y)(S.y,{text:"Error ".concat(e," event: ").concat((0,v.uX)(t))}))}finally{R(!1)}},U=(e,t,i)=>{x((0,u._)((0,d._)({},P),{speakers:P.speakers.map((n,r)=>r===e?(0,u._)((0,d._)({},n),{[t]:i}):n)}))},j=(null==(t=i.authorPagesInfo)?void 0:t.filter(e=>["contributor","admin","byline"].includes(e.role)).filter(e=>!P.speakers.find(t=>t.id===e.user_id.toString())))||[],z=(e,t)=>{x((0,u._)((0,d._)({},P),{sponsors:P.sponsors.map(i=>i.name===e.name?t:i)}))};return(0,n.Y)(h.S,{isOpen:r,width:600,onClose:l,children:(0,n.FD)(w.I1,{className:F.A.modal,gap:24,paddingBottom:24,children:[(0,n.Y)(g.T,{preset:"h4-sans-condensed",children:N?"Edit Event":"Add New Event"}),(0,n.Y)("form",{onSubmit:O,children:(0,n.FD)(w.I1,{gap:20,children:[(0,n.Y)(C.z,{options:[{value:"draft",label:"Draft"},{value:"published",label:"Published"}],value:P.status||"draft",onChange:e=>{x((0,u._)((0,d._)({},P),{status:e}))}}),(0,n.Y)(k.A,{label:"Title",value:P.title||"",onChange:e=>x((0,u._)((0,d._)({},P),{title:e}))}),(0,n.Y)(D,{label:"Description",children:(0,n.Y)(m.X,{placeholder:"Event description...",value:P.description||"",onChange:e=>x((0,u._)((0,d._)({},P),{description:e.target.value}))})}),(0,n.Y)(D,{label:"Date & Time",children:(0,n.Y)(_.ZZ,{value:P.dateTime,onChange:e=>x((0,u._)((0,d._)({},P),{dateTime:new Date(e.currentTarget.value)}))})}),(0,n.Y)(k.A,{label:"Place/Venue",placeHolder:"The Empire State Building",value:P.place||"",onChange:e=>x((0,u._)((0,d._)({},P),{place:e}))}),(0,n.Y)(k.A,{label:"Location",placeHolder:"20 W 34th St., New York, NY",value:P.location||"",onChange:e=>x((0,u._)((0,d._)({},P),{location:e}))}),(0,n.Y)(D,{label:"Event Type",children:(0,n.Y)(y.K,{options:[{value:"in-person",label:"In Person"},{value:"livestream",label:"Livestream"}],value:P.type||["in-person"],onChange:e=>x((0,u._)((0,d._)({},P),{type:e}))})}),(0,n.Y)(k.A,{label:"Main Image URL",value:P.image||"",onChange:e=>x((0,u._)((0,d._)({},P),{image:e}))}),(0,n.Y)(k.A,{label:"Thumbnail Image URL",value:P.placeholderImage||"",onChange:e=>x((0,u._)((0,d._)({},P),{placeholderImage:e}))}),(0,n.Y)(k.A,{label:"Ticket Link",placeHolder:"https://...",value:P.ticketLink||"",onChange:e=>x((0,u._)((0,d._)({},P),{ticketLink:e}))}),(0,n.FD)(D,{label:"Additional Options",children:[(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!P.isSoldOut,onChange:e=>x((0,u._)((0,d._)({},P),{isSoldOut:e}))}),(0,n.Y)(g.T,{preset:"body",children:"Is Sold Out"})]}),(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!P.isA250,onChange:e=>x((0,u._)((0,d._)({},P),{isA250:e}))}),(0,n.Y)(g.T,{preset:"body",children:"Is America 250 Event"})]})]}),(0,n.Y)(k.A,{label:"Associated Post Slug",placeHolder:"Post slug",value:P.postSlug||"",onChange:e=>x((0,u._)((0,d._)({},P),{postSlug:e}))}),(0,n.Y)(k.A,{label:"LiveStream Id",placeHolder:"",value:P.liveStreamId||"",onChange:e=>x((0,u._)((0,d._)({},P),{liveStreamId:e}))}),(0,n.Y)(D,{label:"Speakers",children:(0,n.FD)(w.I1,{gap:16,children:[P.speakers.map((e,t)=>(0,n.FD)(T,{onRemove:()=>{x((0,u._)((0,d._)({},P),{speakers:P.speakers.filter((e,i)=>i!==t)}))},children:[(0,n.FD)(A,{children:[(0,n.Y)(k.A,{label:"Name",value:e.name,onChange:e=>U(t,"name",e)}),(0,n.Y)(k.A,{label:"Role",value:e.role,onChange:e=>U(t,"role",e)})]}),(0,n.FD)(A,{children:[(0,n.Y)(k.A,{label:"Handle",value:e.handle||"",onChange:e=>U(t,"handle",e)}),(0,n.Y)(k.A,{label:"Image URL",value:e.imageUrl||"",onChange:e=>U(t,"imageUrl",e)})]}),(0,n.Y)(k.A,{label:"Bio",value:e.bio||"",onChange:e=>U(t,"bio",e)})]},t)),(0,n.FD)(w.I1,{gap:8,children:[(0,n.Y)(g.T,{color:"primary",preset:"body",children:"Add Speaker"}),(0,n.Y)(Y.Z,{options:j.map(e=>({value:e.user_id,label:e.name})),placeholder:"Search and select a publication user...",value:null,onChange:e=>{e&&(e=>{var t;let n=null==(t=i.authorPagesInfo)?void 0:t.find(t=>t.user_id===e);if(n&&!P.speakers.find(t=>t.id===e.toString())){let t={id:e.toString(),name:n.name,role:"",handle:n.handle||void 0,bio:n.bio||void 0,imageUrl:n.photo_url||void 0,isCustom:!1};x((0,u._)((0,d._)({},P),{speakers:[...P.speakers,t]}))}})(e)}})]})]})}),(0,n.Y)(D,{label:"Sponsors",children:(0,n.FD)(w.I1,{gap:16,children:[P.sponsors.map((e,t)=>(0,n.FD)(T,{onRemove:()=>{var t;return t=e.name,void x((0,u._)((0,d._)({},P),{sponsors:P.sponsors.filter(e=>{let{name:i}=e;return i!==t})}))},children:[(0,n.FD)(A,{children:[(0,n.Y)(k.A,{label:"Name",value:e.name,onChange:t=>z(e,(0,u._)((0,d._)({},e),{name:t}))}),(0,n.Y)(k.A,{label:"Image URL",value:e.imageUrl,onChange:t=>z(e,(0,u._)((0,d._)({},e),{imageUrl:t}))})]}),(0,n.Y)(k.A,{label:"Sponsor Link",placeHolder:"https://...",value:e.sponsorLink||"",onChange:t=>z(e,(0,u._)((0,d._)({},e),{sponsorLink:t}))})]},t)),(0,n.Y)(p.v,{variant:"outline",onClick:()=>{x((0,u._)((0,d._)({},P),{sponsors:[...P.sponsors,{name:"New Sponsor",imageUrl:"",sponsorLink:""}]}))},children:"Add Sponsor"})]})}),(0,n.Y)(D,{label:"Series",children:(0,n.Y)(C.z,{options:E,value:P.series||"",onChange:e=>x((0,u._)((0,d._)({},P),{series:e}))})}),(0,n.FD)(w.Ye,{gap:16,justifyContent:"end",children:[(0,n.Y)(p.v,{disabled:L,variant:"outline",onClick:l,children:"Cancel"}),(0,n.Y)(p.v,{disabled:L,type:"submit",variant:"primary",children:L?N?"Updating...":"Creating...":N?"Update Event":"Add Event"})]})]})})]})})};var P=i(38486),x=i(14739),L=i(16074);let R=e=>{let{filterValue:t,onChangeDate:i,eventDates:r}=e;return(0,n.Y)(w.pT,{className:F.A.filterDrawer,direction:"column",gap:16,children:Object.entries(r).map(e=>(0,n.FD)(w.I1,{alignItems:"start",gap:8,children:[(0,n.Y)(g.T,{color:"tertiary",preset:"detail-large",children:e[0]}),(0,n.Y)("div",{className:F.A.gridDrawer,children:e[1].map(r=>{var a;let l="".concat(e[0],"-").concat(r);return(0,n.FD)(w.Ye,{gap:8,children:[(0,n.Y)(b.S,{checked:!!(null==(a=t.dates)?void 0:a.includes(l)),name:l,onChange:e=>i(e,l)}),(0,n.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var e;return i(!(null==(e=t.dates)?void 0:e.includes(l)),l)},children:r})]},l)})})]},e[0]))})},M=e=>{let{eventLocations:t,filterValue:i,onChangeLocation:r}=e;return(0,n.Y)(w.I1,{className:F.A.filterDrawer,gap:8,children:(0,n.Y)(w.I1,{gap:8,children:t.map(e=>{var t;return(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!(null==(t=i.locations)?void 0:t.includes(e)),name:e,onChange:t=>r(t,e)}),(0,n.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var t;return r(!(null==(t=i.locations)?void 0:t.includes(e)),e)},children:e})]},e)})})})},B=e=>{var t,i;let{filterValue:r,onChangeType:a}=e;return(0,n.Y)("div",{className:F.A.filterDrawer,children:(0,n.FD)("div",{className:F.A.gridDrawer,children:[(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!(null==(t=r.types)?void 0:t.includes("in-person")),name:"IN-PERSON",onChange:e=>a(e,"in-person")}),(0,n.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",children:"IN-PERSON"})]}),(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!(null==(i=r.types)?void 0:i.includes("livestream")),name:"LIVESTREAM",onChange:e=>a(e,"livestream")}),(0,n.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",children:"LIVESTREAM"})]})]})})},O=e=>{let{eventSeries:t,filterValue:i,onChangeSeries:r}=e;return(0,n.Y)(w.I1,{className:F.A.filterDrawer,gap:8,children:(0,n.Y)(w.I1,{gap:8,children:t.map(e=>{var t;return(0,n.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(b.S,{checked:!!(null==(t=i.series)?void 0:t.includes(e)),name:e,onChange:t=>r(t,e)}),(0,n.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var t;return r(!(null==(t=i.series)?void 0:t.includes(e)),e)},children:I.n[e]})]},e)})})})},U=e=>{let{filter:t,openFilters:i,isMobile:r,numberOfFilters:o,setOpenFilters:s,children:c}=e,d=i.includes(t);return(0,n.Y)(p.v,{className:F.A.filterButton,variant:"accordion",children:(0,n.FD)(w.I1,{className:F.A.filterButton,children:[(0,n.FD)(w.Ye,{className:a()(F.A.filterLabel,d?F.A.isOpen:""),justifyContent:"space-between",onClick:()=>{s(i.includes(t)?i.filter(e=>e!==t):r?[t]:[...i,t])},children:[(0,n.FD)(g.T,{color:d?"accent":"tertiary",preset:"detail-large",children:[t.toUpperCase(),o>0&&" (".concat(o,")")]}),(0,n.Y)(l.A,{className:"".concat(F.A.caret," ").concat(d?"":F.A.collapsed),height:36,width:36})]}),d&&(0,n.Y)("div",{className:F.A.filterInput,children:c})]})})},j=e=>{let{seriesConfig:t,goToSeries:i,isMobile:r}=e;return(0,n.FD)(n.FK,{children:[(0,n.FD)(w.Ye,{className:a()(F.A.gridContainer,F.A.minusPadding),gap:40,children:[(0,n.Y)(w.I1,{className:F.A.eventFilterSidebar,gap:24*!r,children:(0,n.Y)(g.T,{preset:"st3",children:"EVENT SERIES"})}),(0,n.Y)(w.Ye,{className:a()(F.A.gridContentWide),gap:16,overflowX:"auto",children:null==t?void 0:t.map(e=>(0,n.FD)(w.I1,{className:F.A.seriesItem,gap:8,width:r?200:300,onClick:()=>null==i?void 0:i(e.id),children:[(0,n.Y)("img",{alt:"Logo for ".concat(e.title),src:e.imageUrl}),(0,n.Y)(g.T,{preset:"h5-sans",children:e.title}),(0,n.Y)(g.T,{clamp:3,preset:"body",children:e.description})]},e.title))})]}),(0,n.Y)("div",{className:a()(F.A.thickDivider,F.A.gridContainer)})]})},z=e=>{var t,i,r,a;let{isAdmin:l,user:d,pub:u,goToEvent:h,goToSeries:m,refetchEvents:b,allEvents:y,seriesConfig:Y,showSeries:_=!1,showBackToEvents:C=!1,isA250:k=!1}=e,I=(0,c.useMediaQuery)({query:"only screen and (max-width: 834px)"}),D=(0,c.useMediaQuery)({query:"only screen and (max-width: 768px)"}),[T,A]=(0,s.useState)(!1),[E,z]=(0,s.useState)(null),H=(0,S.d)(),{refetch:W}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"DELETE"}),V=(0,s.useMemo)(()=>y.map(e=>e.value),[y]),{openFilters:K,filterValue:q,eventLocations:G,eventDates:J,eventSeries:$,setOpenFilters:Z,onChangeDate:Q,onChangeLocation:X,onChangeType:ee,onChangeSeries:et,resetFilters:ei}=(0,P.dB)(V),en=e=>{z(e),A(!0)},er=async e=>{if(confirm("Are you sure you want to delete this event?"))try{await W({query:{key:e}}),H.popToast(()=>(0,n.Y)(S.y,{text:"Event deleted successfully!"})),b()}catch(e){H.popToast(()=>(0,n.Y)(S.y,{text:"Error deleting event: ".concat((0,v.uX)(e))}))}},ea=(0,P.qb)(y,q,!!l),el=ea.filter(e=>new Date(e.value.dateTime)>new Date),eo=ea.filter(e=>new Date(e.value.dateTime)<new Date);return(0,n.FD)(n.FK,{children:[C&&D&&(0,n.FD)(g.T,{className:F.A.link,preset:"detail-large",onClick:()=>h(),children:[(0,n.Y)(o.A,{})," BACK TO ALL EVENTS"]}),_&&!!(null==Y?void 0:Y.length)&&(0,n.Y)(j,{goToSeries:m,isMobile:D,seriesConfig:Y}),D&&(0,n.FD)(w.I1,{className:F.A.gridElement,gap:40,children:[(0,n.Y)(g.T,{preset:"st3",children:"Upcoming Events"}),(0,n.Y)(g.T,{preset:"detail-large",children:"Filter by"})]}),(0,n.FD)(w.Ye,{className:F.A.gridContainer,gap:40,paddingTop:D?24:32,children:[(0,n.FD)(w.I1,{className:F.A.eventFilterSidebar,gap:24*!D,children:[C&&!D&&(0,n.FD)(g.T,{className:F.A.link,preset:"detail-large",onClick:()=>h(),children:[(0,n.Y)(o.A,{})," BACK TO ALL EVENTS"]}),l&&(0,n.Y)(w.Ye,{paddingTop:12,children:(0,n.Y)(p.v,{variant:"primary",onClick:()=>A(!0),children:"Add Event"})}),!D&&(0,n.FD)(w.Ye,{justifyContent:"space-between",children:[(0,n.Y)(g.T,{preset:"detail-large",children:"Filter By"}),(0,n.Y)(g.T,{className:F.A.clearAll,color:"tertiary",preset:"detail-large",onClick:()=>{Z([]),ei()},children:"Clear All"})]}),(0,n.FD)("div",{className:F.A.eventFiltersContainer,children:[(0,n.FD)(w.pT,{className:F.A.eventFilters,direction:D?"row":"column",children:[(0,n.Y)(U,{filter:"date",isMobile:D,numberOfFilters:(null==(t=q.dates)?void 0:t.length)||0,openFilters:K,setOpenFilters:Z,children:!D&&(0,n.Y)(R,{eventDates:J,filterValue:q,onChangeDate:Q})}),!D&&(0,n.Y)(L.c,{className:F.A.fullWidth}),(0,n.Y)(U,{filter:"location",isMobile:D,numberOfFilters:(null==(i=q.locations)?void 0:i.length)||0,openFilters:K,setOpenFilters:Z,children:!D&&(0,n.Y)(M,{eventLocations:G,filterValue:q,onChangeLocation:X})}),!D&&(0,n.Y)(L.c,{className:F.A.fullWidth}),(0,n.Y)(U,{filter:"type",isMobile:D,numberOfFilters:(null==(r=q.types)?void 0:r.length)||0,openFilters:K,setOpenFilters:Z,children:!D&&(0,n.Y)(B,{filterValue:q,onChangeType:ee})}),!D&&(0,n.Y)(L.c,{className:F.A.fullWidth}),_&&(0,n.Y)(U,{filter:"series",isMobile:D,numberOfFilters:(null==(a=q.series)?void 0:a.length)||0,openFilters:K,setOpenFilters:Z,children:!D&&(0,n.Y)(O,{eventSeries:$,filterValue:q,onChangeSeries:et})})]}),D&&K.includes("date")&&(0,n.Y)(R,{eventDates:J,filterValue:q,onChangeDate:Q}),D&&K.includes("location")&&(0,n.Y)(M,{eventLocations:G,filterValue:q,onChangeLocation:X}),D&&K.includes("type")&&(0,n.Y)(B,{filterValue:q,onChangeType:ee}),D&&_&&K.includes("series")&&(0,n.Y)(O,{eventSeries:$,filterValue:q,onChangeSeries:et})]})]}),(0,n.FD)(w.I1,{className:F.A.gridContentWide,children:[el.length>0&&(0,n.FD)(w.I1,{className:I?"":"desktop",gap:24,children:[!D&&(0,n.Y)(g.T,{preset:"st3",children:"Upcoming Events"}),el.map((e,t)=>(0,n.FD)(n.FK,{children:[(0,n.Y)(x.L,{eventConfig:e,goToEvent:h,goToSeries:m,hideIcons:!I,isAdmin:l,isMobile:I,pub:u,showSeries:_,surface:"fp-events",user:d,onDelete:er,onEdit:en},e.key),t<el.length-1&&(0,n.Y)(L.c,{paddingY:8})]}))]}),eo.length>0&&(0,n.FD)(w.I1,{className:I?"":"desktop",gap:24,children:[el.length>0&&(0,n.Y)("div",{className:F.A.thickDivider}),(0,n.Y)(g.T,{preset:"st4",children:"Past Events"}),eo.map((e,t)=>(0,n.FD)(n.FK,{children:[(0,n.Y)(x.L,{eventConfig:e,goToEvent:h,goToSeries:m,hideIcons:!I,isAdmin:l,isMobile:I,pub:u,showSeries:_,surface:"fp-events",user:d,onDelete:er,onEdit:en},e.key),t<eo.length-1&&(0,n.Y)(L.c,{paddingY:8})]}))]})]}),l&&(0,n.Y)(N,{editingEvent:E,isA250Page:k,isOpen:T,pub:u,onClose:()=>{A(!1),z(null)},onEventCreated:()=>{b()}})]})]})}},57898:function(e,t,i){i.d(t,{z:()=>h});var n=i(10201),r=i(17402),a=i(22076),l=i(63446),o=i(15894),s=i(12501),c=i(76977),d=i(49807);let u="getTicketsHeaderWrapper-SZWsSS",p="addToCalendar-Ly6tvS",h=e=>{var t;let{pub:i,post:h,event:m,user:g,isHeader:f,isDetailView:v,surface:b}=e,{result:y,refetch:Y}=(0,s.st)({pathname:"/api/v1/live_stream/".concat(m.liveStreamId),auto:!1}),_=null==y||null==(t=y.activeLiveStream)?void 0:t.liveStream,w=f?"getTicketsHeader-x8EjLy":"getTicketsButton-kg7NHY";if((0,r.useEffect)(()=>{m.liveStreamId&&Y()},[m.liveStreamId]),m.dateTime&&new Date(m.dateTime)<new Date){if(m.liveStreamId)return(0,n.Y)(l.v,{className:w,href:"".concat((0,d.$_T)(i),"/live-stream/").concat(m.liveStreamId),target:"_blank",variant:"outline",children:"Watch Recording"});else if(null==h?void 0:h.videoUpload)return(0,n.Y)(l.v,{className:w,href:(0,d.wu9)(i,h),target:"_blank",variant:"outline",children:"Watch Recording"})}else if(m.ticketLink&&!m.isSoldOut)return(0,n.FD)(c.I1,{className:f?u:"",children:[(0,n.Y)(l.v,{className:w,href:m.ticketLink,target:"_blank",variant:f?"outline":"primary",children:"Get Tickets"}),v&&_&&(0,n.Y)(a.n,{liveStream:_,trackingSurface:b,trigger:(0,n.Y)("div",{className:p,children:(0,n.Y)(l.v,{className:w,variant:"outline",children:"ADD LIVESTREAM TO CALENDAR"})})})]});else if(m.liveStreamId)return(null==g?void 0:g.is_subscribed)?(0,n.FD)(c.I1,{className:f?u:"",children:[m.isSoldOut&&(0,n.Y)(o.T,{align:"center",color:"tertiary",preset:"detail-small",children:"This event is sold out"}),_&&(0,n.Y)(a.n,{liveStream:_,trackingSurface:b,trigger:(0,n.Y)("div",{className:p,children:(0,n.Y)(l.v,{className:w,variant:f?"outline":"primary",children:"ADD LIVESTREAM TO CALENDAR"})})})]}):(0,n.FD)(c.I1,{className:f?u:"",children:[m.isSoldOut&&(0,n.Y)(o.T,{align:"center",color:"tertiary",preset:"detail-small",children:"This event is sold out"}),(0,n.Y)(l.v,{className:w,href:(0,d.eV6)(i),target:"_blank",variant:f?"outline":"primary",children:"GET LIVESTREAM ACCESS"})]});else if(m.isSoldOut)return(0,n.Y)(l.v,{className:w,disabled:!0,variant:"outline",children:"SOLD OUT"});return null}},38486:function(e,t,i){i.d(t,{ZJ:()=>s,dB:()=>d,dN:()=>o,qb:()=>u,uL:()=>c});var n=i(69277),r=i(70408),a=i(17402),l=i(12501);let o=e=>{let t=e.split(",");if(3===t.length){var i;return(null==(i=t[1])?void 0:i.trim())||""}return e},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"event-",{result:t,refetch:i}=(0,l.st)({pathname:"/api/v1/islands/client/config",query:{prefix:e},auto:!0,deps:[]});return{result:t,refetch:i}},c=e=>{let{result:t}=(0,l.st)({pathname:"/api/v1/islands/client/config",query:{key:e},auto:!0,deps:[e],skip:!e});return{result:e?t:null}},d=e=>{let[t,i]=(0,a.useState)([]),[l,s]=(0,a.useState)({}),[c,d]=(0,a.useState)([]),[u,p]=(0,a.useState)({}),[h,m]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(e.length>0){d([...new Set(e.map(e=>e.location?o(e.location):""))]);let t={};e.forEach(e=>{if(e.dateTime){let i=new Date(e.dateTime),n=i.getFullYear().toString(),r=i.toLocaleString("default",{month:"long"});t[n]||(t[n]=[]),t[n].includes(r)||t[n].push(r)}}),p(t),m([...new Set(e.map(e=>e.series).filter(e=>void 0!==e))])}},[e]),{openFilters:t,filterValue:l,eventLocations:c,eventDates:u,eventSeries:h,setOpenFilters:i,onChangeDate:(e,t)=>{s(i=>{let a=i.dates||[];return(0,r._)((0,n._)({},i),{dates:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeLocation:(e,t)=>{s(i=>{let a=i.locations||[];return(0,r._)((0,n._)({},i),{locations:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeType:(e,t)=>{s(i=>{let a=i.types||[];return(0,r._)((0,n._)({},i),{types:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeSeries:(e,t)=>{s(i=>{let a=i.series||[];return(0,r._)((0,n._)({},i),{series:e?[...a,t]:a.filter(e=>e!==t)})})},resetFilters:()=>{s({})}}},u=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;return i||(n=n.filter(e=>"published"===e.value.status)),t.locations&&t.locations.length>0&&(n=n.filter(e=>{var i;return!!e.value.location&&(null==(i=t.locations)?void 0:i.includes(o(e.value.location)))})),t.dates&&t.dates.length>0&&(n=n.filter(e=>{var i;if(!e.value.dateTime)return!1;let n=new Date(e.value.dateTime),r=n.getFullYear().toString(),a=n.toLocaleString("default",{month:"long"}),l="".concat(r,"-").concat(a);return null==(i=t.dates)?void 0:i.includes(l)})),t.types&&t.types.length>0&&(n=n.filter(e=>{var i;let n=Array.isArray(e.value.type)?e.value.type:[e.value.type];return null==(i=t.types)?void 0:i.some(e=>n.includes(e))})),t.series&&t.series.length>0&&(n=n.filter(e=>{var i;return e.value.series&&(null==(i=t.series)?void 0:i.includes(e.value.series))})),n.sort((e,t)=>{let i=new Date(e.value.dateTime),n=new Date(t.value.dateTime);return i.getTime()-n.getTime()}),n}},65479:function(e,t,i){i.d(t,{o:()=>W});var n=i(10201),r=i(17402),a=i(17988),l=i(13950),o=i(53696),s=i(15894),c=i(69277),d=i(70408),u=i(60250),p=i(87677),h=i(99862),m=i(13589),g=i(72880),f=i(63446),v=i(68410),b=i(60355),y=i(76977),Y=i(49807);let _="titleLink-En3yx0",w=e=>{let{description:t,posts:i,pub:r,sections:l,title:o,url:s}=e,{isMobile:c}=(0,v.sM)(),d=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"});if(l&&i)throw Error("FPIntroCarousel cannot have both sections and posts");return!d&&c?(0,n.Y)(k,{description:t,posts:i,pub:r,sections:l,title:o,url:s}):(0,n.Y)(C,{description:t,posts:i,pub:r,sections:l,title:o,url:s})},C=e=>{let{description:t,posts:i,pub:a,sections:l,title:o,url:c}=e,d=(0,r.useMemo)(()=>{var e;return null!=(e=null!=i?i:l)?e:[]},[i,l]),[h,m]=(0,r.useState)(()=>d.map((e,t)=>t)),[g,v]=(0,r.useState)(!1),[Y,w]=(0,r.useState)(0),[C,k]=(0,r.useState)(!1),I=(0,r.useRef)(null),F=[,,,].fill(h.map(e=>d[e]).filter(Boolean)).flat(),D=324*d.length,T=(0,r.useCallback)(()=>{g||(v(!0),w(-1),setTimeout(()=>{w(0),m(e=>{let t=[...e],i=t.pop();return void 0!==i&&t.unshift(i),t}),v(!1)},300))},[g]),A=(0,r.useCallback)(()=>{g||(v(!0),w(1),setTimeout(()=>{w(0),m(e=>{let t=[...e],i=t.shift();return void 0!==i&&t.push(i),t}),v(!1)},300))},[g]);return(0,r.useEffect)(()=>{let e=I.current;if(!e)return;let t=null,i=e=>{let i=Math.abs(e.deltaX)>Math.abs(e.deltaY)||e.shiftKey,n=Math.abs(e.deltaX)>0;if((i||n&&Math.abs(e.deltaY)<2*Math.abs(e.deltaX))&&e.preventDefault(),i&&i){if(g||t)return;let i=e.deltaX||e.deltaY;if(10>Math.abs(i))return;i>0?A():i<0&&T(),t=setTimeout(()=>{t=null},1e3)}};return e.addEventListener("wheel",i,{passive:!1}),()=>{e.removeEventListener("wheel",i),t&&clearTimeout(t)}},[g,T,A]),(0,r.useEffect)(()=>{if(!C)return;let e=e=>{"ArrowLeft"===e.key?(e.preventDefault(),T()):"ArrowRight"===e.key&&(e.preventDefault(),A())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[C,T,A]),(0,n.FD)(y.Ye,{gap:24,style:{alignItems:"stretch"},children:[(0,n.FD)(y.I1,{justifyContent:"space-between",style:{minWidth:240,maxWidth:310,flexShrink:0},children:[(0,n.FD)(y.I1,{gap:16,children:[c?(0,n.Y)(s.T,{as:"a",className:_,href:c,preset:"st3",children:o}):(0,n.Y)(s.T,{preset:"st3",children:o}),(0,n.Y)(s.T,{preset:"body",children:t})]}),(0,n.FD)(y.Ye,{justifyContent:"space-between",children:[(0,n.Y)(f.v,{className:_,size:"lg",variant:"tertiary",onClick:T,children:(0,n.Y)(u.A,{size:32,strokeWidth:1})}),(0,n.Y)(f.v,{className:_,size:"lg",variant:"tertiary",onClick:A,children:(0,n.Y)(p.A,{size:32,strokeWidth:1})})]})]}),(0,n.Y)("div",{ref:I,className:"carouselContainer-h0k1wv",style:{flex:1},onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:(0,n.Y)("div",{className:"carouselTrack-LROA1y",style:{overflow:"hidden"},children:(0,n.FD)(y.Ye,{gap:24,style:{transform:"translateX(".concat(-(D+324*Y),"px)"),transition:0!==Y?"transform 0.3s ease-in-out":"none"},children:[i&&F.map((e,t)=>(0,n.Y)("div",{style:{width:300,flexShrink:0},children:(0,n.Y)(b.R,{post:e,titlePreset:"h5-sans",variant:"square"})},"post-".concat(t))),l&&F.map((e,t)=>(0,n.Y)("div",{style:{width:300,flexShrink:0},children:(0,n.Y)(S,{pub:a,section:e})},"section-".concat(t)))]})})})]})},k=e=>{var t;let{description:i,posts:r,sections:a,title:l,pub:o,url:c}=e,d=201*(null!=(t=null!=r?r:a)?t:[]).length-16;return(0,n.FD)(y.I1,{gap:16,children:[(0,n.FD)(y.I1,{gap:8,children:[c?(0,n.Y)(s.T,{as:"a",className:_,href:c,preset:"st3",children:l}):(0,n.Y)(s.T,{preset:"st3",children:l}),(0,n.Y)(s.T,{preset:"body",children:i})]}),(0,n.Y)("div",{className:"mobileScrollContainer-vr1ryM",children:(0,n.FD)(y.Ye,{gap:16,style:{width:d},children:[null==r?void 0:r.map(e=>(0,n.Y)("div",{style:{width:185},children:(0,n.Y)(b.R,{post:e,titlePreset:"h5-sans",variant:"square"})},e.id)),null==a?void 0:a.map(e=>(0,n.Y)("div",{style:{width:185},children:(0,n.Y)(S,{pub:o,section:e})},e.id))]})})]})},S=e=>{let{pub:t,section:i}=e,[a,l]=(0,m.Mk)(),o=(0,r.useCallback)(()=>{(0,h.route)((0,Y.Dor)(t,{section:i}))},[i,t]);return(0,n.FD)(y.I1,(0,d._)((0,c._)({gap:8,onClick:o},l),{style:{cursor:"pointer"},children:[i.logo_url&&(0,n.Y)(g.o,{alt:i.name,className:"sectionLogo-gK1870",imageIsFixedWidth:!0,maxWidth:300,src:i.logo_url,useRetinaSizing:!0}),(0,n.Y)(s.T,{color:a?"accent":"primary",preset:"h5-sans",children:i.name})]}))};var I=i(39318);let F=()=>{let{isMobile:e}=(0,v.sM)(),t=(0,r.useCallback)(()=>{window.scrollTo({top:window.innerHeight,behavior:"smooth"})},[]);return(0,n.FD)(y.I1,{alignItems:"center",className:"container-jez8Y9",gap:e?16:40,justifyContent:"center",paddingY:40,style:{height:"calc(var(--full-height) - ".concat(69,"px)")},children:[(0,n.FD)(y.I1,{alignItems:"center",gap:e?16:24,style:{flex:"1 1 auto",minHeight:0},children:[(0,n.Y)("div",{className:"intro-Yvh6eZ",children:"An introduction to"}),(0,n.Y)("img",{alt:"The Free Press",className:"logo-zLbeFo",src:(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/thefp-intro-logo.svg"))})]}),(0,n.Y)(f.v,{trailingIcon:"chevron-down",variant:"red-text",onClick:t,children:"Keep Reading"})]})};var D=i(65812),T=i(68349),A=i(22092),E=i(57324);let N="container-NehaVk",P="containerInner-ntGWZj",x=e=>{let{pub:t,user:i,onRegister:a}=e,[l,o]=(0,r.useState)(!1);return l?(0,n.Y)(y.I1,{className:N,children:(0,n.Y)("div",{className:P,children:(0,n.FD)(y.I1,{alignItems:"center",gap:16,children:[(0,n.Y)(s.T,{color:"white",preset:"h6-sans",style:{paddingTop:46},children:"WELCOME TO THE FREE PRESS"}),(0,n.Y)(s.T,{align:"center",color:"white",preset:"body",style:{maxWidth:"330px",paddingBottom:46},children:"You’ll now get our stories delivered straight to your inbox."})]})})}):(0,n.Y)(y.I1,{className:N,children:(0,n.Y)("div",{className:P,children:(0,n.FD)(y.I1,{alignItems:"center",gap:16,children:[(0,n.Y)(s.T,{color:"white",preset:"h6-sans",children:"SUBSCRIBE TO THE FREE PRESS"}),(0,n.Y)("div",{className:"emailFormWrapper-JpcLKh",children:(0,n.Y)(D.A,{allowEmptyInput:!0,preset:"accent",pub:t,submitButtonText:"sign up for free",user:i,utmSource:E.VU.freePressIntroPage,onSuccess:e=>{var i,n,r;(null==e||null==(i=e.body)?void 0:i.email)&&"admin@example.com"!==e.body.email&&((null==e||null==(n=e.body)?void 0:n.prompt_to_login)||(null==e||null==(r=e.body)?void 0:r.requires_confirmation)?(0,T.V2)((0,A._)(t,{isSignInAttempt:!0,next:document.location.href,email:e.body.email})):(o(!0),a()))}})}),(0,n.Y)(s.T,{color:"white",preset:"detail-small",children:"Already have an account?"}),(0,n.Y)("a",{className:"whiteSignInLink-INYUOp",href:(0,I.my9)(t,{isSignInAttempt:!0}),children:(0,n.Y)(s.T,{color:"white",preset:"detail-small",children:"Sign in"})})]})})})};var L=i(59307);let R="videoWrapper-gU8vC5",M="smallScreenVideo-UKN5BQ",B="playButton-elyoq5",O=()=>{let{isMobile:e}=(0,v.sM)(),t=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"}),[i,l]=(0,r.useState)(!1),o=(0,r.useRef)(null),c=()=>{var e;l(!0),null==(e=o.current)||e.play()},d=()=>{o.current&&(o.current.paused?(o.current.play(),l(!0)):(o.current.pause(),l(!1)))},u="https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-square.mp4",p="https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-square-still-2.png",h="See what we’re all about";return!t&&e?(0,n.FD)(y.I1,{children:[(0,n.Y)(s.T,{preset:"st3",children:h}),(0,n.Y)(y.I1,{className:"mobileContainer-qor88J",children:(0,n.FD)("div",{className:R,onClick:d,children:[(0,n.Y)("video",{ref:o,className:M,playsInline:!0,poster:"https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-vertical-still-2.png",preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,n.Y)("source",{src:"https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-vertical.mp4",type:"video/mp4"})}),!i&&(0,n.Y)("div",{className:B,onClick:e=>{e.stopPropagation(),c()},children:(0,n.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})})]}):t?(0,n.FD)(y.I1,{gap:16,children:[(0,n.Y)(s.T,{preset:"st3",children:h}),(0,n.FD)("div",{style:{position:"relative"},onClick:d,children:[(0,n.Y)("video",{ref:o,className:M,playsInline:!0,poster:p,preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,n.Y)("source",{src:u,type:"video/mp4"})}),!i&&(0,n.Y)("div",{className:B,onClick:e=>{e.stopPropagation(),c()},children:(0,n.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})]}):(0,n.FD)(y.Ye,{gap:24,style:{alignItems:"stretch"},children:[(0,n.Y)(y.I1,{justifyContent:"space-between",style:{minWidth:240,maxWidth:310,flexShrink:0},children:(0,n.Y)(s.T,{preset:"st3",children:h})}),(0,n.FD)("div",{className:R,onClick:d,children:[(0,n.Y)("video",{ref:o,className:"video-E02_Ms",playsInline:!0,poster:p,preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,n.Y)("source",{src:u,type:"video/mp4"})}),!i&&(0,n.Y)("div",{className:B,onClick:e=>{e.stopPropagation(),c()},children:(0,n.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})]})};var U=i(28528),j=i(16074),z=i(92636),H=i(39891);let W=e=>{let{pageData:t,pub:i,user:c,showSubscribeCta:d}=e,{isMobile:u}=(0,v.sM)(),p=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"}),[h,m]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1);return(0,n.Y)(U.XL,{pub:i,user:c,children:(0,n.Y)(l.DH,{children:(0,n.FD)(o.r,{children:[(0,n.Y)(F,{}),(0,n.FD)(y.I1,{alignSelf:"center",gap:u?40:64,paddingBottom:u?40:64,paddingTop:24,style:{maxWidth:p?560:u?330:659},children:[(0,n.FD)(y.I1,{gap:24,children:[(0,n.Y)(s.T,{preset:"body",children:"Whether you’ve been reading us since the beginning, or this is the first time you’re hearing of The Free Press: welcome."}),(0,n.Y)(s.T,{preset:"body",children:"The Free Press is built on the ideals that once were the bedrock of American journalism: honesty, doggedness, and fierce independence. We make sense of the world as it actually is—with the quality once expected from the legacy press, but the fearlessness of the new."}),(0,n.Y)(s.T,{preset:"body",children:"You won’t agree with everything we run, and that’s the point. We’re a Free Press for free people."})]}),(0,n.FD)(y.Ye,{alignItems:"center",gap:24,paddingY:16,style:{width:"100%"},children:[(0,n.Y)(j.c,{flex:"grow"}),(0,n.Y)("img",{alt:"stars",src:(0,H.dJ)("".concat((0,z.Ew)(),"/img/thefp/fp-stars.svg"),154),style:{height:15,width:"auto",flexShrink:0}}),(0,n.Y)(j.c,{flex:"grow"})]})]}),(0,n.FD)(y.I1,{gap:u?40:64,paddingBottom:u?40:64,children:[t.slice(0,3).map(e=>(0,n.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:i,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),d&&!g&&(0,n.Y)(x,{pub:i,user:c,onRegister:()=>{m(!0)}}),t.slice(3,6).map(e=>(0,n.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:i,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),t.slice(6).map(e=>(0,n.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:i,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),(0,n.Y)(O,{})]}),d&&!h&&(0,n.Y)(x,{pub:i,user:c,onRegister:()=>{f(!0)}})]})})})}},36233:function(e,t,i){i.d(t,{Ay:()=>m,Oq:()=>p});var n=i(10201),r=i(17402),a=i(86500),l=i(94729),o=i(58418),s=i(16291),c=i(82776);let d=function(e){let{timeout:t=5e3,className:i="",dismissable:a=!1,beforeDismiss:l=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;o=o||document.body;let s=document.createElement("div");s.setAttribute("id","toast"),s.setAttribute("role","alert"),i&&s.classList.add(i),o.appendChild(s);let c=()=>{l&&l(),s.classList.remove("in"),setTimeout(()=>{s.remove()},500)};(0,r.render)([(0,n.Y)("p",{children:e}),a&&(0,n.Y)("a",{className:"dismiss",onClick:c,children:"Dismiss"})],s),setTimeout(()=>{s.classList.add("in")}),a||setTimeout(c,t)},u=e=>{let{children:t,className:i,dismissKey:n,dismissDurationInSeconds:r,beforeDismiss:a,container:l}=e,[s,c]=(0,o.A)(n,r,a);if(!s)return d(t,{className:i,beforeDismiss:c,dismissable:!0},l)},p=e=>{let{user:t,pub:i,container:r}=e;return t&&i&&t.is_subscribed?(0,n.Y)(h,{pub:i,container:r}):null},h=e=>{let{pub:t,container:i}=e,[o,d]=(0,r.useState)(null);return((0,r.useEffect)(()=>{(0,l.x6)("/api/v1/subscription").then(e=>d(e)).catch(e=>{console.error("Failed to fetch subscription data: ",e)})},[]),(e=>{if(e&&e.cardExpiresAt){let t=(0,s.A)(e.expiry).subtract(c.GRACE_PERIOD_DAYS,"day"),i=(0,s.A)(e.cardExpiresAt),n=(0,s.A)().add(12,"day");return i.isBefore(t)&&t.isBefore(n)}return!1})(o))?(0,n.FD)(u,{className:"urgent",dismissKey:"card-expiring-toast.dismissed",dismissDurationInSeconds:+c.WEEK_IN_SECONDS,beforeDismiss:()=>{(0,a.u4)(a.qY.CARD_EXPIRED_WARNING_DISMISSED,{type:"toast"})},container:i,children:["Your credit card is expiring soon."," ",(0,n.Y)("a",{href:"/account/billing",native:!0,onClick:()=>{(0,a.u4)(a.qY.UPDATE_EXPIRED_CARD_LINK_CLICKED,{type:"toast"})},children:"Update your card"})," before you lose access to ".concat(t.name),"."]}):null},m=d},45197:function(e,t,i){i.d(t,{Ay:()=>U,qE:()=>G});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(89230),d=i(44080),u=i(81143),p=i(17402),h=i(82519),m=i(2929),g=i(68058),f=i(92707),v=i(92170),b=i(44512),y=i(40554),Y=i(13950),_=i(62668),w=i(84605),C=i(97640),k=i(86500),S=i(55200),I=i(68410),F=i(24078),D=i(15040),T=i(35369),A=i(76977),E=i(88774),N=i(63136),P=i(39318),x=i(80856),L=i(49807),R=i(57324),M=i(72285);let B=R.VU.userMenu,O="https://support.substack.com/hc/en-us/?utm_source=".concat(B);function U(e){var{user:t,pub:i}=e,o=(0,a._)(e,["user","pub"]);let{iString:c}=(0,w.GO)(),d=(0,p.useContext)(_.d),{isMobile:u}=(0,I.sM)();return(0,l.Y)(l.FK,{children:t?(0,l.Y)(j,(0,r._)((0,n._)({},o),{user:t,pub:i})):(0,l.Y)(T.$n,{href:(0,P.a7q)({for_pub:null==i?void 0:i.subdomain}),priority:"tertiary",size:u?"sm":"md",className:s()({"force-desktop":d}),native:!0,children:c("Sign in")})})}function j(e){var t,i,{user:o,pub:s}=e,d=(0,a._)(e,["user","pub"]);let{isMobile:u}=(0,I.sM)(),p=u&&(null==s||null==(i=s.theme)||null==(t=i.custom_header)?void 0:t.navStyle)!=="stacked"||!o.photo_url?(0,l.Y)(T.K0,{priority:"tertiary",size:"sm",children:(0,l.Y)(c.A,{size:20})}):(0,l.Y)(z,{user:o});return(0,l.Y)(H,(0,r._)((0,n._)({},d),{user:o,pub:s,trigger:p}))}let z=(0,p.forwardRef)((e,t)=>{var{user:i}=e,o=(0,a._)(e,["user"]);let{isMobile:s}=(0,I.sM)();return(0,l.Y)(T.Nm,(0,r._)((0,n._)({},o),{resetCss:!0,position:"relative",className:M.A.avatarButton,showFocus:!0,animate:!0,radius:"full",ref:t,children:(0,l.Y)(D.Ex,{priority:"secondary",theme:"default",fillIcon:!0,placement:"bottom-right",content:(0,l.Y)(h.A,{size:14}),children:(0,l.Y)(F.eu,{user:i,size:s?32:40,"aria-hidden":!0})})}))});function H(e){let{trigger:t,user:i,pub:n,enableCustomerServiceMode:r,disableCustomerServiceMode:a,freeSignup:o}=e,{iString:s}=(0,w.GO)(),{activityUnreadCount:c}=(0,C.Vd)(),{onOpen:d,onClose:u}=(0,Y.xF)(),p=e=>()=>{(0,k.u4)(e)};return(0,l.FD)(E.W1,{trigger:t,onOpen:()=>{(0,k.u4)(k.qY.USER_MENU_OPENED),d()},onClose:()=>{(0,k.u4)(k.qY.USER_MENU_DISMISSED),u()},"aria-label":s("More options"),children:[(0,l.Y)(W,{user:i}),(0,l.FD)(E.H9,{children:[(0,l.Y)(E.Dr,{href:(0,P.oT5)({urlParams:{utm_source:B}}),onClick:p(k.qY.USER_MENU_FEED_CLICKED),leading:(0,l.Y)(f.A,{size:20}),native:!0,children:s("Home")}),(0,l.Y)(E.Dr,{href:(0,P.q$g)({utm_source:B}),onClick:p(k.qY.USER_MENU_READER_CLICKED),leading:(0,l.Y)(v.A,{size:20}),native:!0,children:s("Subscriptions")}),(0,l.Y)(E.Dr,{href:(0,L.ehp)(),onClick:p(k.qY.USER_MENU_CHAT_CLICKED),leading:(0,l.Y)(g.A,{size:20}),native:!0,children:s("Chat")}),(0,l.Y)(E.Dr,{href:(0,P.M)({utm_source:B}),onClick:p(k.qY.USER_MENU_ACTIVITY_CLICKED),leading:(0,l.Y)(m.A,{size:20}),native:!0,children:(0,l.FD)(A.pT,{flex:"grow",justifyContent:"space-between",children:[s("Activity"),c>0&&(0,l.Y)(y.T,{className:"indicator-badge",count:c})]})}),(0,l.Y)(E.Dr,{href:(0,P.U4Y)(),onClick:p(k.qY.USER_MENU_DISCOVER_CLICKED),leading:(0,l.Y)(b.A,{size:20}),native:!0,children:s("Explore")})]}),(0,l.Y)(V,{freeSignup:null!=o&&o,pub:null!=n?n:null,user:i}),(0,l.Y)(K,{pub:null!=n?n:null}),!i.reader_installed_at&&(0,l.Y)(E.H9,{children:(0,l.Y)(E.Dr,{href:(0,P.DS2)({utm_campaign:R._9.appMarketing,utm_content:R.fL.userMenuLink}),priority:"accent",native:!0,children:s("Get the app")})}),(0,l.Y)(q,{enableCustomerServiceMode:r,disableCustomerServiceMode:a,pub:null!=n?n:null,user:i}),(0,l.Y)(G,{pub:null!=n?n:null})]})}let W=e=>{let{user:t}=e,{iString:i}=(0,w.GO)(),n=(0,S.l)(t,{utm_source:B}),r="",a="";return t&&(r=(null==t?void 0:t.profile_set_up_at)&&t.name?t.name:t.email,a=(null==t?void 0:t.profile_set_up_at)?t.handle?"@".concat(t.handle):null:i("Set up your profile")),(0,l.Y)(E.Dr,{href:n,onClick:()=>(0,k.u4)(k.qY.USER_MENU_PROFILE_CLICKED),native:!0,children:(0,l.FD)(A.pT,{gap:12,alignItems:"center",children:[(0,l.Y)(F.eu,{size:40,user:null!=t?t:void 0,"aria-hidden":!0}),(0,l.FD)(A.I1,{flex:"grow",children:[(0,l.Y)(N.EY.B4,{weight:"semibold",children:r}),a&&(0,l.Y)(N.EY.B4,{color:"secondary",children:a})]})]})})},V=e=>{let{freeSignup:t,user:i,pub:n}=e,{iString:r}=(0,w.GO)(),a=n&&(t||i&&(i.is_subscribed||i.is_free_subscribed)),o=!!(null==i?void 0:i.subdomain),s=i?(0,P.yRA)(i,{params:{utm_source:R.VU.substack}}):void 0;return o||a?(0,l.FD)(E.H9,{children:[a&&(0,l.Y)(E.Dr,{href:(0,P.yRP)("/account",{utm_source:B}),onClick:()=>(0,k.u4)(k.qY.USER_MENU_MANAGE_SUBSCRIPTION_CLICKED),priority:"secondary",native:!0,children:r("Manage subscription")}),o&&s&&(0,l.Y)(E.Dr,{priority:"secondary",href:s,native:!0,trailing:(0,l.Y)(d.A,{}),children:r("Dashboard")})]}):null},K=e=>{let{pub:t}=e,{iString:i}=(0,w.GO)();return(0,l.FD)(E.H9,{children:[(0,l.Y)(E.Dr,{href:(0,P.tFi)({utm_source:B}),onClick:()=>(0,k.u4)(k.qY.USER_MENU_ACCOUNT_SETTINGS_CLICKED),priority:"secondary",native:!0,children:i("Settings")}),(0,l.Y)(E.Dr,{href:O,priority:"secondary",children:i("Support")}),(0,l.Y)(E.Dr,{href:(0,P.bgT)({utm_source:B,for_pub:null==t?void 0:t.subdomain}),priority:"secondary",native:!0,children:i("Sign out")})]})},q=e=>{let{disableCustomerServiceMode:t,enableCustomerServiceMode:i,pub:n,user:r}=e;return(null==r?void 0:r.is_global_admin)&&(i||t)?(0,l.FD)(E.H9,{children:[i&&(0,l.Y)(E.Dr,{priority:"secondary",onClick:i,trailing:(0,l.Y)(u.A,{}),native:!0,children:"Enter support mode"}),t&&(0,l.Y)(E.Dr,{priority:"secondary",onClick:t,trailing:(0,l.Y)(u.A,{}),native:!0,children:"Exit support mode"}),n&&(0,l.Y)(E.Dr,{priority:"secondary",href:"".concat((0,L.$_T)({subdomain:"admin"}),"/publications/").concat(n.id),trailing:(0,l.Y)(u.A,{}),native:!0,children:"Open in Underground"})]}):null},G=e=>{let{pub:t}=e,{iString:i}=(0,w.GO)();return(0,l.Y)(E.H9,{children:(0,l.Y)(N.EY.B4,{size:12,color:"secondary",children:(0,l.FD)(A.pT,{gap:12,padding:8,className:"footer",children:[(0,l.Y)(N.Yq,{href:(0,P.DNs)(null,{params:{utm_source:B}}),native:!0,children:i("About")}),(0,l.Y)(N.Yq,{href:(0,x._)({pub:t,utm_source:B}),children:i("Privacy")}),(0,l.Y)(N.Yq,{href:(0,x.Ru)({pub:t,utm_source:B}),children:i("Terms")}),(0,l.Y)(N.Yq,{href:(0,x.iQ)({utm_source:B}),children:i("Data")}),(0,l.Y)(N.Yq,{href:(0,x.an)({utm_source:B}),children:i("Accessibility")})]})})})}},41873:function(e,t,i){i.d(t,{A:()=>I,b:()=>F});var n=i(99851),r=i(69277),a=i(70408),l=i(10201),o=i(32485),s=i.n(o),c=i(17402),d=i(68414),u=i(59307),p=i(13505),h=i(86500),m=i(13022),g=i(17186),f=i(68349),v=i(89490),b=i(35369),y=i(13348),Y=i(91392),_=i(39318),w=i(9036),C=i(82776),k=i(18012);let S={hls:"application/x-mpegURL",mp4:"video/mp4"};class I extends c.Component{componentDidMount(){if(this._initHlsjs(),null===f.dO||void 0===f.dO||f.dO.on("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.addEventListener("keydown",this.onGlobalKeyDown,!1),window.addEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.volume=1,this.player.addEventListener("loadedmetadata",this.onLoadedMetadata),this.player.addEventListener("loadeddata",this.onLoadedData),this.player.addEventListener("canplay",this.onCanPlay),this.player.addEventListener("play",this.onPlay),this.player.addEventListener("pause",this.onPause),this.player.addEventListener("ended",this.onEnded),this.player.addEventListener("timeupdate",this.onTimeUpdate),this.player.addEventListener("waiting",this.onWaiting),this.player.addEventListener("playing",this.onPlaying),this.player.addEventListener("contextmenu",this.onContextMenu),this.player.addEventListener("click",this.onUserInteraction),this.player.addEventListener("mouseover",this.onUserInteraction),this.player.addEventListener("mousedown",this.onUserInteraction),this.player.addEventListener("touchstart",this.onUserInteraction),this.player.addEventListener("seeked",this.onSeeked)),this.onTimeUpdate(),window&&window._preloads.mux_env_key&&!(window._preloads.disabledCookies||[]).includes(Y.HY.MUX_DATA)){let{entityType:e}=this.getEntityKeyAndType();i.e("5505").then(i.t.bind(i,21624,23)).then(t=>{var i;let n=t.default||t;n.monitor(this.player,{Hls:this.hlsModule,hlsjs:this.hls,debug:!1,data:{env_key:window._preloads.mux_env_key,player_name:null!=(i=this.props.surface)?i:"substack",player_init_time:n.utils.now(),video_id:this.props.mediaUpload.id,video_stream_type:e}})})}}componentWillUnmount(){this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,null===f.dO||void 0===f.dO||f.dO.off("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.removeEventListener("keydown",this.onGlobalKeyDown,!1),window.removeEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.player.removeEventListener("loadeddata",this.onLoadedData),this.player.removeEventListener("canplay",this.onCanPlay),this.player.removeEventListener("play",this.onPlay),this.player.removeEventListener("pause",this.onPause),this.player.removeEventListener("ended",this.onEnded),this.player.removeEventListener("timeupdate",this.onTimeUpdate),this.player.removeEventListener("waiting",this.onWaiting),this.player.removeEventListener("playing",this.onPlaying),this.player.removeEventListener("contextmenu",this.onContextMenu),this.player.removeEventListener("click",this.onUserInteraction),this.player.removeEventListener("mouseover",this.onUserInteraction),this.player.removeEventListener("mousedown",this.onUserInteraction),this.player.removeEventListener("touchstart",this.onUserInteraction)),this.onVideoReachEnd({resetTime:!1,triggerCallback:!1,track:!1}),null!=this.hls&&this.hls.destroy()}componentDidUpdate(e,t){var i,n,a;if((this.props.noPreview!==e.noPreview||this.props.noControls!==e.noControls||this.props.noKeyboardShortcuts!==e.noKeyboardShortcuts||this.props.mediaUpload.id!==e.mediaUpload.id)&&(this._initHlsjs(),this.resetDurationTracking()),!this.state.playing&&"number"==typeof this.state.waiting&&"number"!=typeof t.waiting){let{useHLSJS:e,browserCanPlayHLS:t,HLSerrored:i}=this.state;this.track(h.qY.VIDEO_BUFFERING_STARTED,{use_hlsjs:e,browser_can_play_hls:t,hls_errored:i})}if(!this.state.playing||t.playing||this.state.waiting||"number"!=typeof t.waiting||this.track(h.qY.VIDEO_BUFFERING_COMPLETED,{buffering_duration:Date.now()-t.waiting}),this.state.playing&&!(null==(i=this.player)?void 0:i.ended)&&Math.floor(this.state.currentTime)!==Math.floor(t.currentTime)&&Math.floor(this.state.currentTime)%5==0&&(this.trackMedia(h.qY.MEDIA_PLAYBACK_CONTINUED),this.props.mediaUpload.post_id&&this.state.duration&&(!this.props.surface||"post"===this.props.surface)&&(!this.props.videoType||"post"===this.props.videoType)&&!this.props.isClip)){let e=Math.min(Math.max(0,this.state.currentTime/this.state.duration),1);(0,p.AG)(this.props.mediaUpload.post_id,"video",e)}if(!this.state.playing&&t.playing&&(null==(n=this.player)?void 0:n.ended)&&this.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED),this.props.mediaUpload.id&&(0,m.Ay)("use_preloaded_player_sources")&&(this.props.mediaUpload.id!==e.mediaUpload.id||!(null==(a=Object.keys(this.state.sources))?void 0:a.length))){let e=async e=>fetch((0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src.json"),{type:e})).then(e=>e.json()).then(t=>({[e]:t.src}));Promise.all(["hls"].map(t=>e(t))).then(e=>{let t=e.reduce((e,t)=>(0,r._)({},e,t),{});this.setState({sources:t})})}}getPlaybackLocationKey(){return"".concat("video:playback_location:").concat(this.props.mediaUpload.id)}getPlaybackRestoreLocation(){if(this.playbackEnabled()&&this.props.restorePlaybackLocation&&this.props.mediaUpload.duration&&this.props.mediaUpload.duration>240){let e=(0,g.xm)(this.getPlaybackLocationKey());if((null==e?void 0:e.currentTime)>5&&null!==this.props.duration&&void 0!==this.props.duration&&this.props.duration-e.currentTime>60){let t=3*(Date.now()-e.watchedAt>60),i=Math.max(0,e.currentTime-t);if(i)return i}}return null}setPlaybackRestoreLocation(){var e;this.playbackEnabled()&&(null==(e=this.player)?void 0:e.currentTime)&&(0,g.X3)(this.getPlaybackLocationKey(),{currentTime:this.player.currentTime,watchedAt:Date.now()})}onPreviewClick(e){var t,i,n;if(this.props.stopPropagation&&(e.preventDefault(),e.stopPropagation()),null==(t=this.player)||t.setAttribute("data-user-changed-playback","true"),this.state.previewHidden){this.player&&(!(0,f.nr)()||(0,f.nr)()&&!this.props.stopPropagation)&&(this.player.paused?this.player.play():this.player.pause());return}if(!this.href()){if(!this.playbackEnabled())return void this.onClickNonPlayableVideo();this.state.attemptingToPlay?(this.lastTimeUpdate=null,this.setState({attemptingToPlay:!1,autoPlay:!1}),null==(i=this.player)||i.pause(),this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout)):(this.setState({attemptingToPlay:!0}),null==(n=this.player)||n.play(),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({previewHidden:!0}),3e3))}}track(e){var t,i,n,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=this.props.communityPostEmbedPostId||this.props.mediaUpload.post_id,o=this.props.mediaUpload.user_id;(0,h.u4)(e,Object.assign({post_id:l,video_user_id:o,community_post_id:this.props.communityPostId,media_upload_id:this.props.mediaUpload.id,live_stream_id:this.props.liveStreamId,current_time:this.state.currentTime?Math.floor(this.state.currentTime):0,duration:this.state.duration?Math.floor(this.state.duration):0,is_clip:null!=(i=this.props.isClip)&&i,surface:this.props.surface,is_preview:null!=(n=this.props.usePreview)&&n,muted:null!=(r=null==(t=this.player)?void 0:t.muted)&&r,video_type:this.props.videoType,display:(0,f.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline"},a))}trackMedia(e){var t,i,n,l,o,s,c,d;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mediaUpload:p,videoType:m,surface:g,primaryEntityKey:v,primaryEntityType:b,contentType:y,feedItemTrackingParameters:Y}=this.props,_=null!=y?y:m?null!=(n=({communityCommentReply:"communityComment","video-embed":"embed"})[m])?n:m:"unknown",{entityKey:w,entityType:C}=this.getEntityKeyAndType(),k=Array.from(null!=(l=null==(t=this.player)?void 0:t.textTracks)?l:[]),S=k.length>0,I=this.isShowingCaptionsElsewhere||k.some(e=>["subtitles","captions"].includes(e.kind)&&"showing"===e.mode);(0,h.u4)(e,(0,r._)((0,a._)((0,r._)({},Y),{media_type:"video",video_upload_id:p.id,src_video_upload_id:p.src_media_upload_id,content_type:_,primary_entity_key:String(null!=v?v:w),primary_entity_type:null!=b?b:C,entity_key:String(w),entity_type:C,publication_id:p.publication_id,surface:g,display:(0,f.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline",muted:null!=(o=null==(i=this.player)?void 0:i.muted)&&o,captions_enabled:S?I:null,autoplay:this.state.autoPlay&&!this.state.failedAutoplay,is_preview:null!=(s=this.props.usePreview)&&s,current_time:Math.floor(null!=(c=this.state.currentTime)?c:0),duration:Math.floor(null!=(d=this.state.duration)?d:0),duration_played:Math.floor(this.state.durationPlayed),duration_played_id:this.state.durationPlayedId}),u))}render(){var e;let t=this.props,i=null!=(e=this.state)?e:{},{height:n,width:r}=(0,C.videoPlayerDimensions)(t.mediaUpload,{isStatic:!1}),a=s()("video-player",{"video-player-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor},t.videoPlayerClassName);return(0,l.Y)(D,{className:s()(t.className,{"with-preview":!i.previewHidden,"full-width":r>=960,"video-player-wrapper-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor}),linkClassName:a,href:this.href(),width:r,height:n,onClick:this.onPreviewClick,style:t.style,liveStreamId:t.liveStreamId,children:this.renderPlayer(this.props,this.state)})}renderPlayer(e,t){let{hidePlayButton:i,mediaUpload:n,noControls:r,noPreview:a,renderPlayButton:o,startMuted:s,videoClassName:d,liveStreamId:p,loop:h,thumbnailUrl:g,noPictureInPicture:v=!1}=e,{autoPlay:Y,attemptingToPlay:w,previewHidden:C,showControls:k,useHLSJS:I,browserCanPlayHLS:F,HLSerrored:D,failedAutoplay:E}=t,N=!a&&!C,P=!this.playbackEnabled(),x=this.getBaseVideoSrc(),L=[];L=p?["hls"]:F?["hls","mp4"]:I?[]:(0,f.m0)()?["hls","mp4"]:D?["mp4"]:["hls","mp4"];let R=(0,f.rr)(),M=!!(0,m.Ay)("use_preloaded_player_sources")&&R,B=Y&&!E&&this.playbackEnabled(),O=g||"".concat((0,_.H10)(n),"?refresh=").concat(n.updated_at);return[this.playbackEnabled()&&"undefined"!=typeof window&&(0,l.Y)("video",{ref:this.assignPlayer,controls:k&&!r&&!N,controlsList:"nodownload",autoPlay:B,poster:O,muted:s,loop:h,className:d,playsInline:R,disablePictureInPicture:v,crossOrigin:"anonymous",children:M?Object.entries(this.state.sources).map((e,t)=>{let[i,n]=e;return(0,l.Y)("source",{src:n,type:S[i],onError:t===Object.keys(this.state.sources).length-1?this.onAllSourcesFailed:void 0},"".concat(i,"_").concat(t))}):L.map((e,t)=>(0,l.Y)("source",{src:(0,_.oRR)(x,{type:e}),type:S[e],onError:t===L.length-1?this.onAllSourcesFailed:void 0},"".concat(e,"_").concat(t)))}),N&&!i&&(0,l.FD)(c.Fragment,{children:[P&&(0,l.Y)(T,{mediaUpload:n,thumbnailUrl:O}),!o&&(0,l.Y)(A,{children:this.cta()?(0,l.Y)(b.Bj,{href:this.href(),loading:w&&this.playbackEnabled(),"aria-label":"play",leading:(0,l.Y)(u.A,{height:16,width:16,style:{stroke:"none",fill:"white"}}),children:this.cta()}):(0,l.Y)(y.ro,{isPlaying:!1,href:this.href(),size:72,loading:w&&this.playbackEnabled()})}),o&&(0,l.Y)(A,{children:o()})]})]}isChromeWithBrokenNativeHLS(){var e;if("undefined"==typeof navigator)return!1;let t=null==(e=navigator.userAgentData)?void 0:e.brands;if(!t)return!1;let i=t.find(e=>"Google Chrome"===e.brand);return i&&parseInt(i.version)>=141}_initHlsjs(){let e=!!(this.player&&this.player.canPlayType("application/vnd.apple.mpegurl"));if(e&&!(0,f.m0)()&&!this.isChromeWithBrokenNativeHLS()){this.setState({browserCanPlayHLS:e}),this.autoPlayVideo();return}i.e("9234").then(i.bind(i,40137)).then(e=>{this._initHlsjsWrapped(e.default)})}autoPlayVideo(){if(this.state.autoPlay&&this.player){let e=new IntersectionObserver(t=>{t.forEach(t=>{if(e.unobserve(t.target),t.isIntersecting&&this.player){var i;this.player.muted=null!=(i=this.props.startMuted)&&i,this.player.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1}),this.player&&(this.player.muted=!0,this.player.play().then(()=>{var e,t;null==(e=(t=this.props).onAutoplayMuted)||e.call(t)}).catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1})}))})}})},{threshold:.5});e.observe(this.player)}}_initHlsjsWrapped(e){let t=this,i=e.isSupported();if(!e.isSupported()){this.setState({useHLSJS:i}),this.autoPlayVideo();return}null!=this.hls&&this.hls.destroy();let n=new e((0,r._)({enableWorker:!1},{}));null!=this.player&&n.attachMedia(this.player);let a=this.getBaseVideoSrc("hls");n.on(e.Events.MEDIA_ATTACHED,()=>{n.loadSource(a),n.on(e.Events.MANIFEST_PARSED,()=>{this.autoPlayVideo()})}),n.on(e.Events.ERROR,function(i,r){if(r.fatal)switch(r.type){case e.ErrorTypes.NETWORK_ERROR:var a;t.setState({useHLSJS:!1}),null==(a=t.hls)||a.destroy(),n.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:n.recoverMediaError();break;default:this._initHlsjs()}}),this.hls=n,this.hlsModule=e}constructor(e,t){var i,l;super(e,t),i=this,(0,n._)(this,"player",null),(0,n._)(this,"previewHiddingTimeout",null),(0,n._)(this,"lastTimeUpdate",null),(0,n._)(this,"_accumulatedDurationPlayed",0),(0,n._)(this,"containerRef",(0,c.createRef)()),(0,n._)(this,"isShowingCaptionsElsewhere",!1),(0,n._)(this,"assignPlayer",e=>{this.player=e}),(0,n._)(this,"resetDurationTracking",()=>{this.lastTimeUpdate=null,this.setState({durationPlayed:0,durationPlayedId:(0,d.v4)()})}),(0,n._)(this,"onLoadedMetadata",()=>{this.state.playbackRestoreLocation&&(this.player&&(this.player.currentTime=this.state.playbackRestoreLocation),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({playbackRestoreLocation:null,previewHidden:!0}),3e3))}),(0,n._)(this,"onLoadedData",()=>{this.state.playbackRestoreLocation&&(this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.setState({playbackRestoreLocation:null,previewHidden:!0}))}),(0,n._)(this,"onCanPlay",()=>{this.onTimeUpdate()}),(0,n._)(this,"onPlay",()=>{null===f.dO||void 0===f.dO||f.dO.emit("play",this),this.setState({playing:!0}),this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_PLAYBACK_STARTED)}),(0,n._)(this,"onPause",()=>{var e;this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),(null==(e=this.player)?void 0:e.ended)||this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.player&&this.player.currentTime>this.player.duration-.1&&this.onVideoReachEnd()}),(0,n._)(this,"onEnded",()=>{this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.onVideoReachEnd()}),(0,n._)(this,"onTimeUpdate",()=>{if(!this.player||!isFinite(this.player.duration))return;let e=this.player.currentTime,t=Date.now();if(this.state.playing&&null!==this.lastTimeUpdate){let e=(t-this.lastTimeUpdate)/1e3;e>0&&e<1&&(this._accumulatedDurationPlayed=(this._accumulatedDurationPlayed||0)+e,this._accumulatedDurationPlayed>=1&&(this.setState(e=>({durationPlayed:e.durationPlayed+this._accumulatedDurationPlayed})),this._accumulatedDurationPlayed=0))}this.lastTimeUpdate=t,(this.props.duration||this.state.duration===this.player.duration)&&this.state.currentTime===e?this.setState({waiting:!1}):this.setState({duration:this.props.duration||this.player.duration,currentTime:e,waiting:!1})}),(0,n._)(this,"onWaiting",()=>{this.lastTimeUpdate=null,this.setState({waiting:Date.now()})}),(0,n._)(this,"onPlaying",()=>{this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.lastTimeUpdate=Date.now(),this.setState({playing:!0,waiting:!1,previewHidden:!0,attemptingToPlay:!1,autoPlay:!1,hasPlayed:!0})}),(0,n._)(this,"onSeeked",()=>{this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_SEEKED)}),(0,n._)(this,"onVideoReachEnd",function(){let{resetTime:e=!0,triggerCallback:t=!0,track:n=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.lastTimeUpdate=null,i.player&&!i.player.paused&&i.player.pause(),i.state.previewHidden&&i.setState({previewHidden:!1,attemptingToPlay:!1,hasReachedEnd:!0}),e&&i.player&&!(0,f.gI)()&&!i.props.doNotResetOnEnd&&(i.player.currentTime=0),(0,f.Eh)(),(0,f.wp)(),i.props.onFinishVideo&&t&&i.props.onFinishVideo(),n&&i.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED)}),(0,n._)(this,"onContextMenu",e=>{e.preventDefault()}),(0,n._)(this,"onUserInteraction",()=>{this.state.showControls||this.setState({showControls:!0})}),(0,n._)(this,"onAllSourcesFailed",()=>{var e,t;console.info("Failed to load all video sources, falling back to preview image"),this.setState((0,a._)((0,r._)({},this.props.liveStreamId?{}:{previewHidden:!1,attemptingToPlay:!1,autoPlay:!1}),{allSourcesFailed:!0})),null==(e=(t=this.props).onPlaybackFailed)||e.call(t)}),(0,n._)(this,"onBeforeUnload",()=>{this.setPlaybackRestoreLocation(),this.state.previewHidden&&this.setState({previewHidden:!1,attemptingToPlay:!1}),this.player&&!this.player.paused&&this.player.pause()}),(0,n._)(this,"onGlobalPlay",e=>{this!==e&&this.player&&!this.player.paused&&this.player.pause()}),(0,n._)(this,"onGlobalKeyDown",e=>{var t;this.props.noKeyboardShortcuts||e.metaKey||e.altKey||e.ctrlKey||document.activeElement!==document.body||!this.player||(!((null!=(t=null===f.dO||void 0===f.dO?void 0:f.dO.listenerCount("play"))?t:0)>1)||!this.player.paused)&&("f"===e.key?(0,f.aS)()?(0,f.Eh)()&&e.preventDefault():((0,f.gK)(this.player)&&e.preventDefault(),this.player.paused&&this.player.play()):" "!==e.key||(0,f.aS)()?"ArrowRight"===e.key?this.player.currentTime+5>this.player.duration?this.onVideoReachEnd():(this.player.currentTime+=5,this.state.previewHidden||this.setState({previewHidden:!0,attemptingToPlay:!1})):"ArrowLeft"===e.key&&(this.player.currentTime-=5):(e.preventDefault(),this.player.paused?this.player.play():this.player.pause()))}),(0,n._)(this,"getEntityKeyAndType",()=>{let{mediaUpload:e,communityPostId:t,entityKey:i,entityType:n}=this.props;return i?{entityKey:i,entityType:n}:t?{entityKey:t,entityType:"community_post"}:e.post_id?{entityKey:String(e.post_id),entityType:"post"}:{entityKey:i,entityType:n}}),(0,n._)(this,"getBaseVideoSrc",e=>{var t;let i={token:this.props.reaction_token,override_publication_id:null==(t=this.props.pub)?void 0:t.id,preview:this.props.usePreview};return e&&(i.type=e),(0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src"),i)}),(0,n._)(this,"hls",null),(0,n._)(this,"hlsModule",void 0),(0,n._)(this,"cta",()=>""),(0,n._)(this,"href",()=>this.props.href),(0,n._)(this,"playbackEnabled",()=>!0),(0,n._)(this,"onClickNonPlayableVideo",()=>{});const o="undefined"!=typeof window?(0,w.m)(window.location.href):{};let s=null;o.timestamp?s=parseInt(o.timestamp):o.t&&(s=parseInt(o.t));const u=null!==s&&!isNaN(s);u||(0,f.qm)("timestamp");const p=u?s:this.getPlaybackRestoreLocation();this.state={playbackRestoreLocation:p,currentTime:0,waiting:!0,duration:null!=(l=e.mediaUpload.duration)?l:null,autoPlay:e.autoPlay,playing:!1,attemptingToPlay:e.autoPlay,previewHidden:null!==p&&p>0,showControls:!1,hasPlayed:!1,hasReachedEnd:!1,browserCanPlayHLS:!1,useHLSJS:!0,HLSerrored:!1,allSourcesFailed:!1,failedAutoplay:!1,sources:{},durationPlayed:0,durationPlayedId:(0,d.v4)()},this.onPreviewClick=this.onPreviewClick.bind(this)}}function F(e){let{className:t,mediaUpload:i,href:n}=e;return(0,l.Y)(D,(0,a._)((0,r._)({},(0,C.videoPlayerDimensions)(i,{isStatic:!0})),{className:s()(t,"video-player-with-background","is-static"),linkClassName:"video-player-with-background",href:n,children:(0,l.Y)(T,{mediaUpload:i,testId:"video-player-static-preview-image",isStatic:!0})}))}function D(e){let{className:t,linkClassName:i,width:n,height:r,href:a,onClick:o,children:c,style:d,liveStreamId:u}=e,p={paddingBottom:"".concat(Math.min(u?56.25:60,100*r/n).toFixed(4),"%")};return(0,l.Y)("div",{className:s()(t,"video-player-wrapper",n>=960&&"full-width"),onClick:o,role:"region","aria-label":"Video player",style:d,children:(0,l.Y)(a?"a":"div",{className:s()("video-player",i),href:a,style:p,children:c})})}function T(e){let{mediaUpload:t,thumbnailUrl:i,testId:n,isStatic:r}=e;return(0,l.Y)("img",{className:"video-player-preview",width:550,src:i||(0,_.Pzx)(t,{isStatic:r}),"data-component-name":"VideoPlayer-PreviewImg","data-testid":n})}let A=(0,v.I4)({position:"absolute",className:s()(k.A.buttonContainer,"video-player-button")})},69324:function(e,t,i){i.d(t,{Ku:()=>u,yl:()=>h});var n=i(10201),r=i(83673),a=i.n(r),l=i(6411),o=i.n(l),s=i(17402),c=i(12501),d=i(21398);function u(){return(0,s.useContext)(p)}let p=(0,s.createContext)({open:()=>void 0,isOpen:!1});function h(e){let{children:t,load:r,useLocalNavigation:l}=e,[u,h]=(0,s.useState)(!1),[m,g]=(0,s.useState)(!1),f=(0,c.st)({pathname:"/api/v1/search/suggestions_v2",auto:m,deps:[m]}),v=f.result?a()([f.result.featuredTopic,...f.result.suggestedSearches]):[];(0,s.useEffect)(()=>{if(!r)return;let e=e=>{e.preventDefault(),h(!0),g(!0)};return o().bind(["/","command+k"],e),()=>{o().unbind(["/",e]),o().unbind(["command+k",e])}},[r]);let b=(0,s.useMemo)(()=>({open:()=>{r&&(h(!0),g(!0))},isOpen:u}),[r,u]);return r?(0,n.FD)(p.Provider,{value:b,children:[t,(0,n.Y)(d.Ic,{module:"@/frontend/substack/GlobalSearch",resolve:e=>e.GlobalSearch,onRequest:()=>Promise.all([i.e("5381"),i.e("4921"),i.e("4950")]).then(i.bind(i,88737)),isOpen:u,onClose:()=>h(!1),useLocalNavigation:l,suggestedSearches:v})]}):(0,n.Y)(n.FK,{children:t})}},82936:function(e,t,i){i.d(t,{Hv:()=>m,_N:()=>h,bd:()=>g,hU:()=>b,uL:()=>v});var n=i(10201),r=i(63122),a=i(40972),l=i(17402),o=i(46271),s=i(94729);i(12501);var c=i(68349),d=i(88774),u=i(36372);let p=(0,l.createContext)({result:{mutes:[],blocks:[],blocked:[]},refetch:async()=>null,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1});function h(e){let{isBlockingUser:t,isBlockedByUser:i}=(0,l.useContext)(p);return e?i(e)?"blocking":t(e)?"blocked":null:null}function m(e){let{isBlockingUser:t,isBlockedByUser:i,isMutedByUser:n}=(0,l.useContext)(p);return e?n(e)?"muting":i(e)?"blocking":t(e)?"blocked":null:null}function g(e,t){let{surface:i,noteId:h,onClick:g}=t,f=(0,o.Jd)(),v=!!(f&&e&&f.id!==e.id),b=(0,l.useContext)(p),y=m(null==e?void 0:e.id),Y=(0,u.d)(),_=async()=>{if(e){try{await (0,s.x6)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"mute",surface:i,noteId:h}})}catch(e){Y.popToast(()=>(0,n.Y)(u.y,{text:(0,c.uX)(e)}));return}b.refetch(),Y.popToast(()=>(0,n.Y)(u.y,{text:"".concat(e.name||"User"," muted"),Icon:r.A})),null==g||g("mute")}},w=async()=>{if(e){try{await (0,s.x6)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:i,noteId:h}})}catch(e){Y.popToast(()=>(0,n.Y)(u.y,{text:(0,c.uX)(e)}));return}b.refetch(),Y.popToast(()=>(0,n.Y)(u.y,{text:"".concat(e.name||"User"," unmuted"),Icon:r.A})),null==g||g("unmute")}},C=async()=>{if(e){try{await (0,s.x6)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"block",surface:i,noteId:h}})}catch(e){Y.popToast(()=>(0,n.Y)(u.y,{text:(0,c.uX)(e)}));return}b.refetch(),Y.popToast(()=>(0,n.Y)(u.y,{text:"".concat(e.name||"User"," blocked"),Icon:a.A})),null==g||g("block")}},k=async()=>{if(e){try{await (0,s.x6)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:i,noteId:h}})}catch(e){Y.popToast(()=>(0,n.Y)(u.y,{text:(0,c.uX)(e)}));return}b.refetch(),Y.popToast(()=>(0,n.Y)(u.y,{text:"".concat(e.name||"User"," unblocked"),Icon:a.A})),null==g||g("unblock")}},S=[];return v&&("blocking"!==y&&S.push((0,n.Y)(d.Dr,{leading:(0,n.Y)(r.A,{}),priority:"destructive",onClick:"muting"===y?w:_,children:"muting"===y?"Unmute":"Mute"})),S.push((0,n.Y)(d.Dr,{leading:(0,n.Y)(a.A,{}),priority:"destructive",onClick:"blocking"===y?k:C,children:"blocking"===y?"Unblock":"Block"}))),S}p.displayName="UserBlockContext";let f=(0,l.createContext)(!1);function v(e){let{muteFree:t=!0,children:i}=e;return(0,n.Y)(f.Provider,{value:t,children:i})}function b(){return(0,l.useContext)(f)}f.displayName="MuteFreeZone"},94794:function(e,t,i){i.d(t,{QR:()=>l,aZ:()=>o});var n=i(10201),r=i(17402);let a=(0,r.createContext)(null);function l(e){let{crossPost:t=null,children:i}=e;return(0,n.Y)(a.Provider,{value:t,children:i})}function o(){return(0,r.useContext)(a)}a.displayName="CrossPostContext"},19672:function(e,t,i){i(10201),i(4169),i(63558),i(43510),i(84605),i(30230),i(35369),i(76977),i(48625)},30230:function(e,t,i){i.d(t,{Al:()=>h,X$:()=>p,_z:()=>u});var n=i(20347),r=i(3849),a=i(69277),l=i(70408),o=i(10201),s=i(74715),c=i(82100),d=i(97515);function u(e){let{children:t}=e;return(0,o.Y)(s.Z,{padding:16,gap:20,elevated:!1,children:t})}function p(e){let{isDragging:t,dragProps:i,children:n}=e;return(0,o.Y)(c.Q,{padding:16,gap:20,isDragging:t,dragProps:i,elevated:!1,children:n})}function h(e){var t=(0,n._)({},(0,r._)(e));return(0,o.Y)(d.p,(0,l._)((0,a._)({},t),{padding:4}))}i(1140)},21003:function(e,t,i){i.d(t,{x:()=>d});var n=i(10201),r=i(32485),a=i.n(r);i(83673);var l=i(38221),o=i.n(l);i(63375),i(17402),i(15734),i(99070),i(52077),i(84605),i(19672),i(56463),i(95064),i(39598),i(26289),i(86500),i(68349),i(98394),i(89490),i(35369),i(76977),i(22602);var s=i(63136);i(65842),i(36372),i(66511),i(39318),i(82776),i(92967);var c=i(38610);o()((e,t,i,n)=>{e.current.resetAfterIndex(t,!0),i(n)});let d=e=>{let{searchTerm:t,rowIndex:i,isFocused:r,text:l}=e,o=RegExp("(".concat(t,")"),"gi"),d=l.split(o);return(0,n.Y)(s.EY.B3,{padding:2,color:"primary","data-chunk-index":i,className:c.A.text,children:d.map(e=>{var t;return e.match(o)?(0,n.Y)("span",{className:a()(c.A.searchResult,{[null!=(t=c.A.isFocused)?t:"undefined"]:r}),children:e}):e})})}},95064:function(e,t,i){i.d(t,{IS:()=>w,Of:()=>_,Qj:()=>C});var n=i(10201),r=i(38221),a=i.n(r),l=i(98445),o=i(48697),s=i(72102),c=i(75107),d=i(17402),u=i(44518),p=i(84605);i(77441);var h=i(86500),m=i(68410),g=i(35369),f=i(76977);i(88774);var v=i(63136),b=i(9367);i(16291),i(50874),i(82776);var y=i(38610);let Y=(0,d.createContext)({isSearching:!1,items:[],setIsSearching:()=>void 0,setItems:()=>void 0,focusedItemStart:null,setFocusedItemStart:()=>void 0,filteredItems:[],searchTerm:null,setSearchTerm:()=>void 0,hasFiltered:!1}),_=e=>{let{children:t}=e,[i,r]=(0,d.useState)(!1),[a,l]=(0,d.useState)([]),[o,s]=(0,d.useState)(null),[c,p]=(0,d.useState)(null),{filteredItems:h,setQuery:m,hasFiltered:g}=(0,u.S)({items:a,getKeys:e=>[e.text],sortFunc:(e,t)=>e.start-t.start});return(0,d.useEffect)(()=>{var e,t;s(null!=(t=null==(e=h[0])?void 0:e.start)?t:null)},[h]),(0,n.Y)(Y.Provider,{value:{isSearching:i,setIsSearching:r,items:a,setItems:l,focusedItemStart:o,setFocusedItemStart:s,filteredItems:h,hasFiltered:g,searchTerm:c,setSearchTerm:e=>{p(e),m(e)}},children:t})},w=()=>(0,d.useContext)(Y),C=e=>{let{postId:t,closeAlwaysVisible:i=!0}=e,{iString:r}=(0,p.GO)(),{isMobile:u}=(0,m.sM)(),Y=(0,d.useRef)(null),{setSearchTerm:_,setIsSearching:C,hasFiltered:k,filteredItems:S,setFocusedItemStart:I,focusedItemStart:F,searchTerm:D}=w();(0,d.useEffect)(()=>{!D&&Y.current&&(Y.current.value="")},[D]);let T=S.findIndex(e=>e.start===F),A=()=>{let e=T+1>=S.length?0:T+1;I(S[e].start)},E=()=>{_(""),C(!1),(0,h.u4)(h.qY.TRANSCRIPTION_SEARCH_CANCELLED,{post_id:t})};return(0,n.FD)(f.Ye,{gap:8,justifyContent:"space-between",alignItems:"center",className:y.A.searchForm,children:[(0,n.Y)(b.c,{ref:Y,leftIcon:(0,n.Y)(f.Ye,{children:(0,n.Y)(l.A,{size:16})}),rightIcon:(0,n.Y)(f.Ye,{cursor:"pointer",onClick:E,children:D||i?(0,n.Y)(o.A,{size:16}):null}),placeholder:r("Search"),onChange:a()(e=>{_(e.target.value),(0,h.u4)(h.qY.TRANSCRIPTION_SEARCHED,{post_id:t})},100),onKeyDown:e=>{"Enter"===e.key&&A(),"Escape"===e.key&&E()}}),k&&(0,n.Y)(f.Ye,{gap:8,paddingRight:8*!!u,children:(0,n.FD)(f.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(v.EY.B4,{paddingLeft:u?4:16,className:y.A.resultsValue,color:"primary",weight:"semibold",children:"".concat(T+1," / ").concat(S.length)}),(0,n.FD)(f.Ye,{children:[(0,n.Y)(g.K0,{priority:"tertiary",size:"sm",onClick:()=>{let e=T-1<0?S.length-1:T-1;I(S[e].start)},children:(0,n.Y)(s.A,{size:20})}),(0,n.Y)(g.K0,{priority:"tertiary",size:"sm",onClick:A,children:(0,n.Y)(c.A,{size:20})})]})]})})]})}},56463:function(e,t,i){i(10201),i(76977)},80520:function(e,t,i){i.d(t,{N:()=>v});var n=i(10201),r=i(46110),a=i(17402),l=i(22857),o=i(84605),s=i(27749),c=i(2675),d=i(75840),u=i(35369),p=i(76977),h=i(16993),m=i(63136),g=i(504),f=i(44307);function v(e){let{item:t,pub:i,post:l}=e,[s,c]=(0,a.useState)(!1),{iString:d}=(0,o.GO)();return(0,n.FD)(n.FK,{children:[(0,n.Y)(u.K0,{priority:"quaternary",size:"sm",className:f.A.moreButton,onClick:()=>c(!0),children:(0,n.Y)(r.A,{size:16})}),(0,n.FD)(h.aF,{isOpen:s,onClose:()=>c(!1),width:440,children:[(0,n.Y)(h.rQ,{icon:(0,n.Y)(r.A,{size:20}),title:d("Auto-generated clip"),showClose:!0,onClose:()=>c(!1)}),(0,n.Y)(h.cw,{children:(0,n.Y)(p.I1,{gap:16,children:(0,n.Y)(m.EY.B3,{children:d("Substack automatically selected this clip for you from the full video below.")})})}),(0,n.Y)(h.jl,{primaryButton:(0,n.Y)(b,{item:t,pub:i,post:l,onClose:()=>c(!1)}),secondaryButton:(0,n.Y)(u.$n,{priority:"secondary",onClick:()=>c(!1),children:d("Done")})})]})]})}let b=e=>{let{item:t,pub:i,post:r,onClose:p}=e,{iString:h}=(0,o.GO)(),m=(0,c.vZ)({post:r,publication:i}),f=(0,s.PK)(),v=(0,a.useContext)(d.P);return(0,n.Y)(l.q,{children:(0,n.Y)(u.$n,{priority:"primary",onClick:e=>{(0,g.Qb)(t,f,"watch_full_episode",{tabId:v}),m(e),p()},children:h("View Full Episode")})})}},27332:function(e,t,i){i.d(t,{Iz:()=>O,LY:()=>E,M6:()=>B,X6:()=>H,j6:()=>T,jS:()=>N,l8:()=>P,qv:()=>W,wF:()=>x});var n=i(69277),r=i(70408),a=i(10201),l=i(75107);i(58050);var o=i(84605),s=i(85478),c=i(46271);i(95282);var d=i(27749),u=i(80520),p=i(77405),h=i(25859),m=i(58292),g=i(89490),f=i(35369),v=i(76977),b=i(88774),y=i(63136),Y=i(504),_=i(83629),w=i(85050),C=i(16884),k=i(49095),S=i(16291),I=i(75914),F=i(49807),D=i(57324);let T=["post_like","post_restack","comment_like"],A=["search","note-related","profile","publication","permalink"];function E(e){let{author:t,post:i,comment:n,onClick:r,utm_content:l,publication:o,item:c,allowHide:h=!1,timestamp:m,hideSubscribeCta:g}=e,f=(0,d.PK)(),b=m||(null==n?void 0:n.date)||(null==i?void 0:i.post_date),y=A.includes(f),Y=!!(0,s.mJ)().getConfigFor("feed_item_source_debug_mode"),_=Y&&c&&"trackingParameters"in c,w=c&&(0,I.tL)(c,n);return(0,a.FD)(H,{children:[(0,a.FD)(W,{children:[(0,a.Y)(x,{user:t,onClick:r,utm_content:l}),b&&(0,a.Y)(O,{timestamp:b,comment:n}),Y&&c&&(0,a.Y)(U,{item:c,showEntityKey:!0,showDebugDot:null!=_&&_})]}),!g&&t&&c&&!y&&(0,a.Y)(L,{author:t,item:c,comment:null!=n?n:void 0,post:null!=i?i:void 0,publication:null!=o?o:void 0}),w&&"post"===c.type&&i&&o&&(0,a.Y)(u.N,{item:c,pub:o,post:i}),(0,a.Y)(v.pT,{maxHeight:20,gap:12,alignItems:"center",children:(0,a.Y)(p.s,{publication:o,post:i,comment:n,item:c,allowHide:h})})]})}function N(e){let{user:t,setTargetUser:i,eligibleTargetUsers:n,targetUser:r}=e;return(0,a.Y)(H,{children:(0,a.Y)(W,{children:(0,a.Y)(b.W1,{trigger:(0,a.Y)(f.$n,{priority:"quaternary",size:"sm",color:"primary",trailing:(0,a.Y)(l.A,{size:16}),children:(0,a.Y)(P,{user:null!=r?r:t})}),children:n.map(e=>(0,a.Y)(b.Dr,{onClick:()=>{e.id===t.id?i(null):i(e)},children:e.name},e.id))})})})}function P(e){let{user:t}=e;return(0,a.Y)(H,{children:(0,a.FD)(W,{children:[(0,a.Y)(y.EY,{as:"span",weight:"medium",children:t.name}),(0,a.Y)(k.UserStatusSymbols,{status:t.status,userId:t.id,size:"xs"})]})})}function x(e){let{user:t,onClick:i,utm_content:n}=e;return(0,a.Y)(a.FK,{children:(0,a.FD)(y.EY,{as:"span",weight:"medium",children:[(0,a.Y)(h.yp,{user:t,onClick:i,utm_source:D.VU.substackFeedItem,utm_content:n,children:t.name})," ",(0,a.Y)(k.UserStatusSymbols,{tier:t.bestseller_tier,status:t.status,userId:t.id,inline:!0,size:"xs"})]})})}function L(e){let{author:t,comment:i,post:n,item:r,permalink:l,publication:o}=e,{finalPublication:s,isSubscribed:u,showCta:p,handleClick:h,currentUser:m}=function(e){var t,i;let{targetUser:n,item:r,comment:a,post:l,publication:o}=e,s=(0,c.Jd)(),u=(0,d.PK)(),p=a?"comment":l?"post":void 0,h=null!=(i=null!=(t=null==a?void 0:a.id)?t:null==l?void 0:l.id)?i:0,m=p?(0,F.Vvu)(h,p):void 0,g=null!=o?o:null==n?void 0:n.primary_publication,f=(0,w.s)({surface:"substack-feed-item",zIndex:1001})(g),v=(0,C.Zm)({user:n,publicationId:null==g?void 0:g.id,publicationName:null==g?void 0:g.name,subscriptionSource:"substack-feed-item",sourceNoteId:m});return{finalPublication:g,isSubscribed:v.isSubscribed,showCta:v.showCta,handleClick:e=>{r&&(0,Y.Qb)(r,u,"subscribe"),!s&&g?f(e):v.isSubscribed?v.unsubscribe(e):v.subscribe(e)},currentUser:s}}({targetUser:t,item:r,comment:i,post:n,publication:o});return(!m||m.id!==t.id)&&s&&p?(0,a.Y)(l?M:R,{isSubscribed:u,onClick:h}):null}function R(e){let{isSubscribed:t,onClick:i}=e,{iString:n}=(0,o.GO)();return(0,a.Y)(f.$n,{priority:t?"quaternary":"tertiary-accent",size:"xs",onClick:i,children:n(t?"Subscribed":"Subscribe")})}function M(e){let{isSubscribed:t,onClick:i}=e,{iString:n}=(0,o.GO)();return(0,a.Y)(f.$n,{priority:t?"quaternary":"primary",size:"sm",onClick:i,children:n(t?"Subscribed":"Subscribe")})}let B=new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"});function O(e){let{timestamp:t,comment:i,post:n,publication:r}=e;return(0,a.Y)(h.Yq,{href:i?(0,F.Zgx)(i,{noBase:_.Z}):n?(0,F.q$n)(r,n):void 0,color:"secondary",title:B.format((0,S.A)(t).toDate()),children:(0,a.Y)(m.iE,{timestamp:t})})}function U(e){let{item:t,showEntityKey:i,showDebugDot:n}=e;return(0,a.FD)(v.pT,{flex:"grow",gap:4,alignItems:"center",justifyContent:"end",children:[i&&(0,a.Y)(j,{item:t}),n&&(0,a.Y)(z,{item:t})]})}function j(e){let{item:t}=e;return"entity_key"in t?(0,a.Y)(y.EY.B4,{as:"span",color:"secondary",children:t.entity_key}):null}function z(e){var t;let i,n,{item:r}=e,{iString:l}=(0,o.GO)(),s=null==(t=r.trackingParameters)?void 0:t.item_source;return s?"model"===s?(i="accent-green",n="Model"):s.includes("db")?(i="accent-blue",n="DB"):s.includes("new-user")?(i="accent-purple",n="New user"):s.includes("topic-injection")?(i="accent-orange",n="Topic injection"):s.includes("trending")?(i="accent-red",n="Trending"):(i="tertiary",n="Other"):(i="accent-yellow",n="No source info"),(0,a.Y)("span",{children:(0,a.Y)(g.az,{height:8,width:8,radius:"full",bg:i,color:"secondary",title:l(n)})})}let H=(0,g.I4)((0,r._)((0,n._)({},y.nS),{display:"flex",minWidth:0,gap:8,alignItems:"center",height:20}));(0,g.I4)((0,r._)((0,n._)({},y.nS),{display:"flex",minWidth:0,gap:12,alignItems:"center"}));let W=(0,g.I4)({display:"flex",flex:"grow",minWidth:0,gap:8,alignItems:"center"})},15557:function(e,t,i){i.d(t,{o:()=>o});var n=i(10201),r=i(13950),a=i(76977),l=i(21398);function o(){return(0,n.Y)(l.Ic,{module:"../feed/PublicationPage",onRequest:()=>i.e("6071").then(i.bind(i,54874)),resolve:e=>e.PublicationFeedPage,whileLoading:(0,n.Y)(s,{})})}function s(){return(0,n.Y)(r.DH,{children:(0,n.Y)(a.pT,{bg:"primary",style:{minHeight:800}})})}},25859:function(e,t,i){i.d(t,{NY:()=>Y,RC:()=>w,Yq:()=>C,yp:()=>_});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o);i(17402);var c=i(27437),d=i(84777),u=i(84605),p=i(46271),h=i(99662),m=i(63136),g=i(83629),f=i(83357),v=i(39318),b=i(28700),y=i(4438);function Y(e){var{user:t,utm_source:i,utm_content:o,ellipsis:s,useYou:c,onClick:d}=e,h=(0,a._)(e,["user","utm_source","utm_content","ellipsis","useYou","onClick"]);let{iString:m}=(0,u.GO)(),g=(0,p.Jd)(),f=(null==t?void 0:t.id)||(null==t?void 0:t.user_id)||0,v=c&&(null==g?void 0:g.id)===f?m("You"):"name"in t?t.name:m("User");return(0,l.Y)(_,(0,r._)((0,n._)({user:t,utm_source:i,utm_content:o,ellipsis:s,onClick:d},h),{children:v}))}function _(e){var{user:t,utm_source:i,utm_content:o,children:s,onClick:d,ellipsis:u}=e,p=(0,a._)(e,["user","utm_source","utm_content","children","onClick","ellipsis"]);let m=(0,r._)((0,n._)({},t),{id:t.author_id||t.user_id||t.id,name:t.user_profile_name||t.author_name||t.name,handle:(null==t?void 0:t.handle)||(null==t?void 0:t.author_handle)});return(0,l.Y)(c.ProfileHoverCard,{subject:m,utmSource:"feed",trigger:(0,l.Y)(C,(0,r._)((0,n._)({href:(0,b.gY)(t,{noBase:g.Z,utm_content:o,utm_source:i}),onClick:d,showBack:!0,ellipsis:u,className:p.className,target:(0,h.y)()?"_blank":void 0},p),{children:s}))})}function w(e){var{publication:t,utm_source:i,utm_content:o,children:s,onClick:c,ellipsis:u}=e,p=(0,a._)(e,["publication","utm_source","utm_content","children","onClick","ellipsis"]);return(0,l.Y)(d.m,{pubId:t.id,utmSource:"feed",trigger:(0,l.Y)(C,(0,r._)((0,n._)({href:(0,v.yRP)("".concat(t.base_url,"/"),{utm_content:o,utm_source:i}),onClick:c,ellipsis:u,className:p.className,target:(0,h.y)()?"_blank":void 0},p),{children:s}))})}function C(e){var{weight:t,color:i,decoration:o="hover-underline",ellipsis:c,native:d,className:u}=e,p=(0,a._)(e,["weight","color","decoration","ellipsis","native","className"]);let h=p.href,g=null==h?void 0:h.match(/^([a-z]+:)?\/\//),v=null!=d?d:g&&!(null==h?void 0:h.startsWith(document.location.origin));return(0,l.Y)(m.EY,{as:"span",ellipsis:c,weight:t,color:i,decoration:o,children:v?(0,l.Y)("a",(0,r._)((0,n._)({},p),{className:s()(u,y.A.link)})):(0,l.Y)(f.N,(0,r._)((0,n._)({},p),{className:s()(u,y.A.link)}))})}},96503:function(e,t,i){i.d(t,{C:()=>l});var n=i(10201),r=i(17402),a=i(36372);function l(){let e=(0,a.d)();return(0,r.useEffect)(()=>{let t=new URL(location.toString());t.searchParams.get("founding-member-confirmation")&&(t.searchParams.delete("founding-member-confirmation"),history.replaceState({},"",t),e.popToast(()=>(0,n.Y)(a.y,{text:"You upgraded to a founding tier subscription. Thank you!"})))},[]),null}},3142:function(e,t,i){i.d(t,{J:()=>a,_:()=>r});var n=i(17402);function r(){let e=e=>{var t,i;"https://embed.bsky.app"===e.origin?function(e){if(!e.data.id||!e.data.height)return;let t=document.querySelector('[data-bluesky-id="'.concat(e.data.id,'"]'));t&&(t.style.height="".concat(e.data.height,"px"))}(e):("3pc.supported"===e.data||"3pc.unsupported"===e.data)&&("3pc.supported"===e.data&&Array.from(document.getElementsByClassName("tiktok-wrap outer")).forEach(e=>{var t,i;let n=e.querySelector(".tiktok-iframe");if(!n)return;n.classList.add("visible"),null==(t=e.querySelector(".tiktok-wrap.static"))||t.classList.add("hidden");let r=e.querySelector(".fallback-failure");null==r||r.classList.add("no-border");try{let e=n.contentDocument||(null==(i=n.contentWindow)?void 0:i.document);(null==e?void 0:e.readyState)=="complete"&&(null==r||r.classList.add("visible"))}catch(e){}n.onload=()=>{null==r||r.classList.add("visible")},n.onerror=()=>{null==r||r.classList.add("visible")},n.onabort=()=>{null==r||r.classList.add("visible")}}),null==(i=Array.from(document.getElementsByClassName("third-party-cookie-check-iframe")))||null==(t=i.forEach)||t.call(i,e=>e.remove()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}function a(){(0,n.useEffect)(r,[])}},66714:function(e,t,i){i.d(t,{X:()=>s});var n=i(69277),r=i(70408),a=i(17402),l=i(94729),o=i(68349);let s=e=>{let{mediaUploadId:t}=e,[i,s]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[u,p]=(0,a.useState)(null),h=async()=>{try{let e=await (0,l.x6)("/api/v1/video/upload/".concat(t));s((0,r._)((0,n._)({},e),{updated_at:new Date})),d(!1)}catch(e){console.error("Failed to load media upload:",e),p((0,o.uX)(e)),d(!1)}};return(0,a.useEffect)(()=>{t?h():(s(null),d(!1))},[t,u]),{mediaUpload:i,loading:c,error:u,refetch:h}}},74049:function(e,t,i){i.d(t,{P:()=>m,k:()=>h});var n=i(10201),r=i(7350),a=i.n(r),l=i(17402),o=i(15734),s=i.n(o),c=i(84605),d=i(86500),u=i(36372),p=i(57324);let h=e=>{let t=(0,u.d)(),{iString:i}=(0,c.GO)(),[r,o]=(0,l.useState)(0),h=a()(e=>{o(e)},100),m=(0,l.useCallback)(async()=>{var t,i;let n,r,a=!e.live_stream_id||(null==(t=e.liveStream)?void 0:t.is_rtmp)?"original":"mp4",l="/api/v1/video/upload/".concat(e.id,"/src.json?type=").concat(a),{body:{src:c}}=await s().get(l),u=await fetch(c),m=null==(i=u.body)?void 0:i.getReader(),g=u.headers.get("Content-Length");if(!m||!g)throw Error("Failed to read the response body or content length is missing.");let f=parseInt(g),v=0,b=[];do{let e=await m.read();n=e.done,(r=e.value)&&(b.push(r),h((v+=r.length)/f*100))}while(!n);let y=new Blob(b),Y=window.URL.createObjectURL(y),_=document.createElement("a");_.href=Y,_.download="undefined"!==e.name&&e.name?e.name:"original.webm",_.target="_blank",_.rel="noopener noreferrer",_.style.display="none",document.body.appendChild(_),_.click(),document.body.removeChild(_),(0,d.u4)(d.qY.VIDEO_CLIP_DOWNLOAD_BUTTON_CLICKED,{name:"download",post_id:e.post_id,utm_campaign:p._9.substackClips,utm_medium:p.Jn.web,media_upload_id:e.id}),setTimeout(()=>o(0),200)},[e]);return{startDownload:()=>{o(0),m(),t.popToast(()=>(0,n.Y)(u.y,{text:i("Download started, do not close the window until download is completed")}))},downloadPercentage:r}},m=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"original",n="/api/v1/video/upload/".concat(e.id,"/src.json?type=").concat(i),{body:{src:r},status:a}=await s().get(n);if(a>=400){let e="there was an error generating the pre-signed url of the original source";throw console.warn(e),Error(e)}let l=await fetch(r);if(l.status>=400){let e="there was an error downloading the original source";throw console.warn(e),Error(e)}let o=await l.blob(),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=t?"".concat(t,".mp4"):"".concat(e.name),u.target="_blank",u.rel="noopener noreferrer",u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),(0,d.u4)(d.qY.VIDEO_CLIP_DOWNLOAD_BUTTON_CLICKED,{name:"download",post_id:e.post_id,utm_campaign:p._9.substackClips,utm_medium:p.Jn.web,media_upload_id:e.id})}},92476:function(e,t,i){i.d(t,{AF:()=>u,II:()=>h,V:()=>g,n6:()=>m});var n=i(69277),r=i(70408),a=i(13022),l=i(16291),o=i(56262),s=i(39318),c=i(82776),d=i(57324);function u(e){let{name:t,url:i,description:r,potentialAction:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===a&&(a={"@type":"SearchAction",name:"Search ".concat(e.name),target:"".concat(e.base_url).concat((0,s.Xt9)(e),"?utm_source=").concat(d.VU.google,"&sort=search&search={search_term_string}"),"query-input":"required name=search_term_string"}),{"@context":"https://schema.org","@type":"WebSite",name:t||e.name,publisher:(0,n._)({"@type":"Organization",name:e.name,url:e.base_url},e.logo_url?{logo:{"@type":"ImageObject",url:e.logo_url}}:{},e.twitter_screen_name?{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]}:{}),url:i||e.base_url,mainEntityOfPage:{"@type":"WebPage",url:i||e.base_url},description:r||e.hero_text,potentialAction:a}}function p(e){var t,i,a,l;return(0,n._)((0,r._)((0,n._)({"@type":"Organization",name:e.name,url:(0,s.$_T)(e),description:e.hero_text},e.rankingDetailFreeIncludedOrderOfMagnitude&&{interactionStatistic:{"@type":"InteractionCounter",name:"Subscribers",interactionType:"https://schema.org/SubscribeAction",userInteractionCount:e.rankingDetailFreeIncludedOrderOfMagnitude}}),{identifier:"pub:".concat(e.id)}),e.logo_url&&{logo:{"@type":"ImageObject",url:e.logo_url,contentUrl:(0,s.dJ9)(null!=(t=e.logo_url)?t:""),thumbnailUrl:(0,s.dJ9)(null!=(i=e.logo_url)?i:"",128,{height:128})},image:{"@type":"ImageObject",url:e.logo_url,contentUrl:(0,s.dJ9)(null!=(a=e.logo_url)?a:""),thumbnailUrl:(0,s.dJ9)(null!=(l=e.logo_url)?l:"",128,{height:128})}},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]})}function h(e,t){var i,d;let u=(0,c.getBylineUsers)(t),h=p(e),m=(0,a.Ay)("add_section_and_tag_metadata");return(0,n._)((0,r._)((0,n._)({"@context":"https://schema.org","@type":"NewsArticle",url:(0,s.wu9)(e,t),mainEntityOfPage:(0,s.wu9)(e,t),headline:t.search_engine_title||t.social_title||t.title,description:t.search_engine_description||t.description,image:t.cover_image?[{"@type":"ImageObject",url:t.cover_image}]:[],datePublished:(0,l.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),dateModified:(0,l.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),isAccessibleForFree:!(0,o.isPaidAudience)(t.audience)},t.post_paywall_content_for_google&&{hasPart:[{"@type":"WebPageElement",isAccessibleForFree:!0,cssSelector:".available-content"},{"@type":"WebPageElement",isAccessibleForFree:!1,cssSelector:".paywall-content"}]}),{author:u.length>0?u.map(e=>(0,n._)({"@type":"Person",name:e.name,url:(0,s.gYq)(e),description:e.bio,identifier:"user:".concat(e.id)},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]},e.photo_url&&{image:{"@type":"ImageObject",contentUrl:(0,s.dJ9)(e.photo_url),thumbnailUrl:(0,s.dJ9)(e.photo_url,128,{height:128})}})):h,publisher:h}),m&&{articleSection:null==(i=t.section)?void 0:i.name,keywords:null==(d=t.postTags)?void 0:d.map(e=>e.slug)})}function m(e){return(0,n._)({"@context":"https://schema.org","@type":"Person",image:(null==e?void 0:e.photo_url)&&(0,s.dJ9)(e.photo_url),name:"".concat(null==e?void 0:e.name),url:e&&(0,s.gYq)(e),jobTitle:null==e?void 0:e.bio,description:null==e?void 0:e.bio},(null==e?void 0:e.twitter_screen_name)?{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]}:{})}function g(e,t,i,r){let{usePreview:a}=r,o=(0,c.getBylineUsers)(t),d=p(e);return(0,n._)({"@context":"https://schema.org","@type":"VideoObject",name:t.search_engine_title||t.social_title||t.title,description:t.search_engine_description||t.description,thumbnailUrl:(0,s.H10)(i),uploadDate:(0,l.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),contentUrl:(0,s.oRR)("".concat((0,s.$_T)(e),"/api/v1/video/upload/").concat(i.id,"/src"),{preview:a,override_publication_id:e.id,type:"mp4"}),publisher:d,author:o.length>0?o.map(e=>(0,n._)({"@type":"Person",name:e.name,url:(0,s.gYq)(e),description:e.bio,identifier:"user:".concat(e.id)},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]},e.photo_url&&{image:{"@type":"ImageObject",contentUrl:(0,s.dJ9)(e.photo_url),thumbnailUrl:(0,s.dJ9)(e.photo_url,128,{height:128})}})):d},i.duration&&{duration:"PT".concat(Math.floor(i.duration),"S")})}},43528:function(e,t,i){i.d(t,{Os:()=>s,cz:()=>o,tL:()=>d});var n=i(94729),r=i(12501),a=i(68349),l=i(41086);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("selection");let{isLoading:i,error:n,result:a}=(0,r.st)({pathname:"/api/v1/post_selection/".concat(e),auto:!!e,deps:[e]});return{isLoading:i,error:n,postSelection:null!=a?a:null,highlightSelection:()=>{a&&c(a,t)}}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("selection");let i=null;try{i=await (0,n.x6)("/api/v1/post_selection/".concat(e))}catch(e){console.error("could not fetch post selection",e)}i&&c(i,t)}function c(e){var t,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.ignoreSafari&&(0,a.nr)()||!e.text)return;let r=(null!=(i=null==(t=/^[^.]+\./.exec(e.text))?void 0:t[0])?i:e.text).replace(/\.+$/g,"");if(!r)return;let l="#:~:text=".concat(encodeURIComponent(r));history.replaceState({},document.title,l),document.location.replace(l)}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("imgSelection");let i=null;try{i=(await (0,n.x6)("/api/v1/post_selection/image/".concat(e))).selection}catch(t){console.error("Couldn't find post image selection with id ".concat(e),t)}i&&function(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(i.ignoreSafari&&(0,a.nr)())&&e.img_src){for(let i of document.getElementsByTagName("img"))if(i.src===e.img_src){t=i;return}t&&t.scrollIntoView()}}(i,t)}},93946:function(e,t,i){i.d(t,{Ac:()=>d,Mv:()=>s,TZ:()=>p,Zq:()=>c,nr:()=>u});var n=i(10201),r=i(17402),a=i(84605),l=i(67734),o=i(82776);let s=(e,t)=>{var i,n,l;let o="undefined"!=typeof window&&null!=(l=null==(n=window._preloads)||null==(i=n.pub)?void 0:i.language)?l:"en";(0,r.render)((0,r.createElement)(a.Pz,{language:o,children:e}),t)},c=e=>e.podcast_url&&e.podcast_duration>0?"podcast":e.videoUpload&&e.videoUpload.duration&&e.videoUpload.duration>0?"video":"thread"===e.type?"thread":"newsletter",d=function(e){let t,i,r,a,s,{currency:c,totalAmount:d,discount:u,quantity:p=1,trial_end_override:h,noTrial:m=!1,recurring:g=!0,isGroupSubscription:f=!1,isUnlimitedGroupSubscription:v=!1,language:b="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{iString:y,iPlural:Y}=I18N.i(b);if(c||(c=e.currency),void 0!==d)t=d;else{let i=(0,l.id)(e,c);if(void 0===i){var _;c=e.currency,i=null!=(_=e.amount)?_:0}t=i*p}let w=(0,o.centsToPriceString)(t,c);if(u&&!u.loading&&!u.error&&(u.percent_off||u.amount_off)){let e;u.percent_off?e=Math.round(t*(1-(u.percent_off_precise||u.percent_off)/100)):u.amount_off&&(e=Math.max(0,t-u.amount_off)),i=(0,o.centsToPriceString)(e,c)}let C=i||w;e.is_bitcoin?("month"===e.interval&&(r=Y("%2/1 month","%2/%1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2/1 week","%2/%1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2/1 day","%2/%1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2/1 year","%2/%1 years",e.interval_count,C))):e&&g&&!f&&!v?("month"===e.interval&&(r=Y("%2 per month","%2 per %1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 per week","%2 per %1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 per day","%2 per %1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 per year","%2 per %1 years",e.interval_count,C))):!e||g||f||v?e&&g&&f&&!v?("month"===e.interval&&(r=Y("%2 for one month per person","%2 for %1 months per person",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week per person","%2 for %1 weeks per person",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day per person","%2 for %1 days per person",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year per person","%2 for %1 years per person",e.interval_count,C))):e&&g&&f&&v&&("month"===e.interval&&(r=Y("%2 for one month for unlimited seats","%2 for %1 months for unlimited seats",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week for unlimited seats","%2 for %1 weeks for unlimited seats",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day for unlimited seats","%2 for %1 days for unlimited seats",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year for unlimited seats","%2 for %1 years for unlimited seats",e.interval_count,C))):("month"===e.interval&&(r=Y("%2 for one month","%2 for %1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week","%2 for %1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day","%2 for %1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year","%2 for %1 years",e.interval_count,C)));let k=Math.max(0,"trial_period_days"in e&&e.trial_period_days||0,u&&u.trial_period_days||0,h?Math.ceil((h-Date.now()/1e3)/60/60/24):0);if(!m&&k>0&&(a=Y("1 day free trial","%1 day free trial",k)),u&&i&&g&&"forever"!==u.duration){let t="once"===u.duration?1:u.duration_in_months/("year"===e.interval?12:1)*e.interval_count;"month"===e.interval&&(s=Y("for first month","for first %1 months",t)),"week"===e.interval&&(s=Y("for first week","for first %1 weeks",t)),"day"===e.interval&&(s=Y("for first day","for first %1 days",t)),"year"===e.interval&&(s=Y("for first year","for first %1 years",t))}return u&&u.loading?(0,n.FD)(n.FK,{children:[r," ",(0,n.FD)("span",{className:"discount-price",children:[" (",y("coupon loading"),")"]})]}):u&&u.error?(0,n.FD)(n.FK,{children:[r," ",(0,n.FD)("span",{className:"discount-price error",children:[" (",y("coupon invalid or expired"),")"]})]}):i?(0,n.FD)(n.FK,{children:[(0,n.Y)("span",{className:"crossed-out",children:w})," ",(0,n.FD)("span",{className:"discount-price",children:[r," ",s?"(".concat(s,") "):"",a]})]}):(0,n.FD)(n.FK,{children:[r," ",a]})};async function u(e){let{timeout:t=5e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("video");i.volume=0;let n=!1,r=Promise.race([new Promise(e=>{i.onloadedmetadata=()=>{i.onloadedmetadata=null,i.duration===1/0?(i.currentTime=Number.MAX_SAFE_INTEGER,i.ontimeupdate=()=>{i.ontimeupdate=null,n=!0,e(i.duration),i.currentTime=0}):e(i.duration)},i.onerror=t=>{n=!0;let i=null;"string"==typeof t?i=t:t.target&&"error"in t.target&&(i=t.target.error),e({is_error:!0,err:i})}}),new Promise(e=>{setTimeout(()=>{n||e({is_error:!0,err:Error("Blob duration fetching timed out")})},t)})]);try{i.src="string"==typeof e||"string"==typeof e?e:window.URL.createObjectURL(e)}catch(e){return{is_error:!0,err:e}}return r}let p=e=>{try{return new URL(e),!0}catch(e){return!1}}},55376:function(e,t,i){i.d(t,{wI:()=>P});var n=i(79785),r=i(10201),a=i(418),l=i(16079),o=i(17402),s=i(15734),c=i.n(s),d=i(84605),u=i(92538),p=i(5646),h=i(12387),m=i(24078),g=i(89490),f=i(35369),v=i(76977),b=i(20500),y=i(16993),Y=i(84843),_=i(57820),w=i(94996),C=i(81929),k=i(63136),S=i(16291);function I(){let e=(0,n._)(["Ban or suspend ",""]);return I=function(){return e},e}function F(){let e=(0,n._)(["Prevent this person from commenting on your publication in the future."]);return F=function(){return e},e}function D(){let e=(0,n._)(["Ban ",""]);return D=function(){return e},e}function T(){let e=(0,n._)(["Previously banned "," time(s), last on ",""]);return T=function(){return e},e}function A(){let e=(0,n._)([""," is permanently banned."]);return A=function(){return e},e}function E(){let e=(0,n._)([""," is banned until ","."]);return E=function(){return e},e}function N(){let e=(0,n._)(["Leave a reply"]);return N=function(){return e},e}let P=e=>{var t,i,n,a;let{comment:l,onReply:s,onBan:c,onClose:d}=e,{sub:p,loading:h,bans:m,bansHistory:g,error:f,submitBan:v}=B(l,c),b=(0,u.n)(),Y=null==(t=b[1])?void 0:t[0],[_,w]=(0,o.useState)(Y),[C,k]=(0,o.useState)("visible"),I=!!l||h,F=null!=(a=null==(n=b.find(e=>{let[t]=e;return t===_}))||null==(i=n[1])?void 0:i.toLowerCase())?a:"",D=m.filter(e=>(0,S.A)(e.expiry).isAfter((0,S.A)()));return(0,r.FD)(y.aF,{isOpen:I,onClose:d,children:[0===D.length&&(0,r.Y)(x,{comment:l,sub:p,bans:m,bansHistory:g,loading:h,error:f,selectedExpiry:_,setSelectedExpiry:w,selectedCommentVisibility:C,setSelectedCommentVisibility:k,expiryText:F,onClose:d,submitBan:v}),D.length>0&&(0,r.Y)(M,{comment:l,bans:m,onClose:d,onReply:()=>{s&&l&&(s(l.id),d())}})]})},x=e=>{var t,i;let{comment:n,sub:a,bans:l,bansHistory:o,loading:s,error:c,selectedExpiry:h,setSelectedExpiry:g,selectedCommentVisibility:Y,setSelectedCommentVisibility:S,expiryText:T,onClose:A,submitBan:E}=e,{iString:N,iTemplate:P}=(0,d.GO)(),x=(0,u.n)(),M=(0,p.T)();return(0,r.FD)(r.FK,{children:[(0,r.Y)(y.rQ,{showClose:!0,onClose:A,title:P(I(),null!=(t=null==n?void 0:n.name)?t:"user"),showDivider:!0,alignItems:"center",icon:(0,r.Y)(m.eu,{photoUrl:null!=(i=null==n?void 0:n.photo_url)?i:void 0,size:56}),description:(0,r.FD)(v.VP,{alignItems:"center",gap:8,children:[(null==a?void 0:a.is_subscribed)&&(0,r.Y)(C.vw,{priority:"secondary",children:N("Paid subscriber")}),(0,r.Y)(k.EY,{children:P(F())})]})}),(0,r.Y)(y.cw,{children:(0,r.FD)(v.VP,{gap:20,children:[(0,r.Y)(R,{bans:l,bansHistory:o}),c&&(0,r.Y)(b.yn,{children:N("An error occurred. Please try again.")}),s&&(0,r.Y)(_.y$,{padding:32,alignItems:"center",justifyContent:"center"}),!s&&(0,r.FD)(r.FK,{children:[(0,r.FD)(L,{children:[(0,r.Y)(k.EY.B3,{weight:"semibold",children:N("Ban duration")}),(0,r.FD)(w.I,{name:"expiry",value:h,onChange:e=>{g(e.target.value)},children:[(0,r.Y)(w.K,{children:N("Select a duration")}),x.map(e=>{let[t,i]=e;return(0,r.Y)("option",{value:t,children:null==i?void 0:i.replace(/^For /,"")})})]})]}),(0,r.FD)(L,{children:[(0,r.Y)(k.EY.B3,{weight:"semibold",children:N("Delete comments")}),(0,r.FD)(w.I,{name:"comment_visibility",value:Y,onChange:e=>{S(e.target.value)},children:[(0,r.Y)(w.K,{children:N("Select whether to delete comments")}),M.map(e=>{let[t,i]=e;return(0,r.Y)("option",{value:t,children:i})})]})]})]})]})}),(0,r.Y)(y.jl,{direction:"column",showDivider:!0,primaryButton:(0,r.Y)(f.$n,{priority:"destructive",onClick:()=>E(h,Y),children:P(D(),T)})})]})},L=(0,g.I4)({display:"flex",justifyContent:"space-between",alignItems:"center"}),R=e=>{let{bans:t,bansHistory:i}=e,{iTemplate:n}=(0,d.GO)();if(!t[0])return null;let l=i.length?i.length:t.filter(e=>e.user_id).length;return(0,r.Y)(h.F,{title:n(T(),l,(0,S.A)(t[0].start).standardDatetimeWithYear()),theme:"default",priority:"secondary",Icon:a.A,showClose:!1})},M=e=>{var t,i;let{comment:n,bans:a,onClose:o,onReply:s}=e,{iString:c,iTemplate:u}=(0,d.GO)(),p=a.find(e=>e.user_id),h=p&&(0,S.A)(p.expiry).isAfter((0,S.A)().add(100,"years"))?u(A(),null!=(t=null==n?void 0:n.name)?t:"This user"):u(E(),null!=(i=null==n?void 0:n.name)?i:"This user",(0,S.A)(null==p?void 0:p.expiry).standardDatetimeWithYear());return p?(0,r.FD)(r.FK,{children:[(0,r.Y)(y.rQ,{title:h,alignItems:"center",icon:(0,r.Y)(Y.qx,{icon:(0,r.Y)(l.A,{})}),showClose:!0,onClose:o,description:c("We recommend leaving a reply to tell them why they are banned, and to let other readers know what kinds of comments are not acceptable.")}),(0,r.Y)(y.q1,{}),(0,r.Y)(y.jl,{direction:"column",primaryButton:(0,r.Y)(f.$n,{priority:"primary-mono",onClick:s,children:u(N())})})]}):null},B=(e,t)=>{let[i,n]=(0,o.useState)(null),[r,a]=(0,o.useState)(!1),[l,s]=(0,o.useState)([]),[d,u]=(0,o.useState)([]),[p,h]=(0,o.useState)(null),m=async(i,n)=>{a(!0);try{var r;if(!e)throw Error("comment undefined, cannot submitBan");let o=await c().post("/api/v1/comment_ban/".concat(e.id)).send({user_id:e.user_id,expiry:i,commentVisibility:n});"visible"!==n&&document.location.reload(),(r=o.body.bans).forEach(e=>{-1==r.findIndex(t=>t.id===e.id)&&r.push(e)}),s(r),a(!1),t&&t(e,l)}catch(e){console.error("Failed to submit ban",e),h(!0)}a(!1)};return(0,o.useEffect)(()=>{(async()=>{if(e){a(!0),s([]),u([]),h(null),n(null);try{var t;let[i,r]=await Promise.all([c().get("/api/v1/user/".concat(e.user_id,"/bans")),c().get("/api/v1/moderation/publications/".concat(e.publication_id,"/users/").concat(e.user_id,"/bans")).query({type:"comment",limit:20})]),a=i.body;s(a.bans),n(a.sub),u(null!=(t=r.body.data)?t:[])}catch(e){console.error("Failed to get bans:",e),h(!0)}a(!1)}})()},[e]),{sub:i,loading:r,bans:l,bansHistory:d,error:p,submitBan:m,setLoading:a,setError:h}}},10728:function(e,t,i){i.d(t,{h:()=>_});var n=i(10201),r=i(32485),a=i.n(r),l=i(38970),o=i.n(l),s=i(33031),c=i.n(s),d=i(13950),u=i(72880),p=i(84605),h=i(74894),m=i(68410),g=i(12592),f=i(35369),v=i(16074),b=i(76977),y=i(63136),Y=i(39318);let _=e=>{let{pub:t}=e,{iString:i}=(0,p.GO)(),r=o()(t.sections,"id"),l=c()((0,h.Zu)(t),"podcastTitle");return(0,n.Y)("div",{className:a()("page","typography"),children:(0,n.Y)(g.c,{children:(0,n.FD)(b.I1,{gap:24,children:[(0,n.Y)(y.EY.H2,{children:i("Podcasts")}),(0,n.Y)(b.I1,{gap:24,children:l.map((e,i)=>{var a,l;let o=null!=(l=r[null!=(a=e.sectionId)?a:"undefined"])?l:null;return(0,n.FD)(n.FK,{children:[0!==i&&(0,n.Y)(v.c,{}),(0,n.Y)(w,{podcastForDisplay:e,pub:t,section:o})]})})})]})})})},w=e=>{let{podcastForDisplay:t,pub:i,section:r}=e,{iString:a}=(0,p.GO)(),{isMobile:l}=(0,m.sM)(),o=(0,Y.t6y)({pub:i,section:r});return(0,n.Y)(d.DH,{children:(0,n.FD)(b.Ye,{gap:24,children:[(0,n.Y)(b.I1,{width:l?140:180,flex:"auto",children:t.artUrl&&(0,n.Y)("a",{href:o,children:(0,n.Y)(u.o,{className:"image-QMta6W",imageIsFixedWidth:!0,maxWidth:l?140:180,src:t.artUrl,useRetinaSizing:!0})})}),(0,n.FD)(b.I1,{gap:12,children:[(0,n.FD)(b.I1,{gap:8,children:[(0,n.Y)(y.EY.H3,{as:"a",href:o,children:t.podcastTitle}),(0,n.Y)(y.EY.B3,{children:t.description})]}),(0,n.Y)("div",{children:(0,n.Y)(f.$n,{href:o,priority:"secondary",size:"sm",children:a("See episodes")})})]})]})})}},88559:function(e,t,i){i.d(t,{Q:()=>I});var n=i(10201),r=i(32485),a=i.n(r),l=i(65892),o=i(17402),s=i(73090),c=i(84605),d=i(12501),u=i(11574),p=i(77433),h=i(68410),m=i(17028),g=i(84270),f=i(16993),v=i(4016);let b=e=>{let{isShowsEpisodePage:t,posts:i,title:r,user:c,postTags:d,selectedPostTagId:g,postId:f,postTheme:v}=e,{isMobile:b}=(0,h.sM)(),[Y,_]=(0,o.useState)(!1);return(0,n.Y)(m.pT,{className:a()({"container-Q5omP8":!t,"containerForShows-FydmKs":t}),children:t?(0,n.FD)(m.I1,{gap:24,children:[(0,n.Y)(p.M,{title:r,titlePreset:"st1",variant:"align-right"}),(0,n.Y)(s.R,{posts:i})]}):(0,n.FD)(n.FK,{children:[(null==c?void 0:c.is_admin)&&!b&&(0,n.Y)("div",{className:"editButtonContainer-O6BQ51",children:(0,n.Y)(m.K0,{priority:"primary-mono",size:"sm",onClick:()=>{_(!0)},children:(0,n.Y)(l.A,{size:16})})}),(0,n.Y)(u.$,{headerVariant:"align-right",posts:i,title:r,variant:"large-in-middle"}),(0,n.Y)(y,{currentPostTagId:g,isOpen:Y,postId:f,postTags:d,postTheme:v,user:c,onClose:()=>_(!1)})]})})},y=e=>{let{user:t,isOpen:i,onClose:r,postTags:a,currentPostTagId:l,postId:s,postTheme:u}=e,{isMobile:p}=(0,h.sM)(),{iString:v}=(0,c.GO)(),[b,y]=(0,o.useState)(l),{refetch:Y,error:_}=(0,d.st)({pathname:"/api/v1/post/".concat(s,"/theme"),method:"PATCH"});if(p||!(null==t?void 0:t.is_admin))return null;let w=()=>{y(l),r()},C=async()=>{await Y({json:{header_variant:u.header_variant,featured_post_tag_id:b}}),_||window.location.reload()},k=null==a?void 0:a.map(e=>({value:e.id,label:e.name}));return(0,n.FD)(f.aF,{disableCloseOnBackdropClick:!0,isOpen:i,onClose:w,children:[(0,n.Y)(f.rQ,{showClose:!0,title:v("Choose a tag to feature"),onClose:r}),(0,n.Y)(f.cw,{children:(0,n.Y)(g.z,{options:k,value:b,onChange:e=>y(e)})}),(0,n.Y)(f.jl,{primaryButton:(0,n.Y)(m.$n,{disabled:l===b,onClick:C,children:v("Save")}),secondaryButton:(0,n.Y)(m.$n,{priority:"secondary",onClick:w,children:v("Cancel")})})]})};var Y=i(16447),_=i(93800),w=i(76977),C=i(63136);let k=()=>{let{isMobile:e}=(0,h.sM)();return(0,n.Y)(w.I1,{paddingX:8*!e,paddingBottom:8,children:(0,n.Y)(w.I1,{borderBottom:"detail-themed",paddingBottom:8,children:(0,n.Y)(C.EY,{className:"title-lJNKDo",children:"Latest"})})})};var S=i(89490);let I=e=>{var t;let{delayFirstLoad:i,filterPostsPredicate:r,isBelowTheFold:a,isShowsEpisodePageForTheFP:l,maxPosts:o,pub:s,search:d,sort:u,sortTabs:p,source:m,user:g,post:f}=e,{isMobile:y}=(0,h.sM)(),{iString:w}=(0,c.GO)(),C=(0,v.lu)({pub:s}),I=(0,v.S2)({pub:s}),F=null==(t=s.sections)?void 0:t.find(e=>e.id===f.section_id),D=l&&(null==F?void 0:F.is_podcast)||F&&!!f.videoUpload&&l,T=(e=>{var t,i,n,r,a,l,o;let{post:s,pub:c,showPodcastEpisodesOnly:d}=e;if(!s||!(0,v.lu)({pub:c}))return;if(d)return{featuredSectionId:null!=(r=s.section_id)?r:void 0,title:"More Episodes"};let{postTheme:u}=s;if(null==u?void 0:u.featured_post_tag_id){let e=null==s||null==(a=s.postTags)?void 0:a.find(e=>{let{id:t}=e;return t===(null==u?void 0:u.featured_post_tag_id)});return e?{featuredPostTagId:null==u?void 0:u.featured_post_tag_id,title:"More in ".concat(e.name)}:void 0}if(s.section_id&&(s.section_name||(null==(t=s.section)?void 0:t.name)))return{featuredSectionId:s.section_id,title:"More in ".concat(null!=(o=s.section_name)?o:null==(l=s.section)?void 0:l.name)};let p=new Set(null==(i=s.publishedBylines)?void 0:i.map(e=>e.name)),h=null==(n=s.postTags)?void 0:n.find(e=>{let{name:t,hidden:i}=e;return!i&&!p.has(t)});if(h)return{featuredPostTagId:null==h?void 0:h.id,title:"More in ".concat(null==h?void 0:h.name)}})({post:f,pub:s,showPodcastEpisodesOnly:D});return(0,n.Y)(S.az,{paddingY:24,style:y?void 0:{marginLeft:-8,marginRight:-8},"aria-label":w("Top Posts Footer"),role:"region",children:(0,n.Y)(Y.M,{delayFirstLoad:i,filterPostsPredicate:r,hideCommunity:I,hideTop:I,isBelowTheFold:a,isPodcast:D,maxPosts:o,pub:s,search:d,sort:(null==T?void 0:T.featuredPostTagId)?"new":u,sortTabs:p,source:m,user:g,postTagId:null==T?void 0:T.featuredPostTagId,sectionId:null==T?void 0:T.featuredSectionId,postId:f.id,renderTabs:I?()=>(0,n.Y)(k,{}):void 0,children:e=>{var t,i;let{posts:r,linkToComments:a,onClickPost:o}=e;return C?(0,n.Y)(b,{isShowsEpisodePage:l,postId:f.id,postTheme:f.postTheme,selectedPostTagId:null==T?void 0:T.featuredPostTagId,posts:r,title:null!=(i=null==T?void 0:T.title)?i:"Top posts",user:g,postTags:null==f?void 0:f.postTags}):(0,n.Y)(_.m,{hideImages:null==(t=s.theme)?void 0:t.hide_images_from_list,linkToComments:a,posts:r,variant:"two-column-list",onClickPost:o})}})})}},2684:function(e,t,i){i.d(t,{u:()=>m});var n=i(10201),r=i(32485),a=i.n(r),l=i(17402),o=i(79192),s=i(12592),c=i(35369),d=i(76977),u=i(63136),p=i(39318),h=i(39891);let m=e=>{let{pub:t,user:i,freeSignupEmail:r,redemptionLink:m}=e,g=null==i?void 0:i.is_subscribed,f=(null==i?void 0:i.is_free_subscribed)||!!r,v=(0,l.useMemo)(()=>{if(!i)return"";try{let e=new URL(m);return e.searchParams.set("email",i.email),e.toString()}catch(e){return""}},[m,i]);return(0,n.Y)("div",{className:a()("page","typography"),children:(0,n.Y)(o.Z,{children:(0,n.Y)(s.c,{children:(0,n.FD)(d.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,n.Y)("img",{style:{width:300},src:(0,h.dJ)("/img/a24/A24_logo.png",600)}),g?(0,n.FD)(n.FK,{children:[(0,n.FD)(u.EY.B1,{children:["Your subscription to ",t.name," includes a 3-month subscription to AAA24, an exciting new streaming service by A24. To redeem your membership, please visit:"]}),(0,n.Y)(c.$n,{priority:"primary",localNavigation:!1,href:v,children:"BECOME A MEMBER"})]}):f?(0,n.FD)(n.FK,{children:[(0,n.FD)(u.EY.B1,{children:["Paid subscribers to ",t.name," have access to a 3-month subscription to AAA24, an exciting new streaming service by A24."]}),(0,n.Y)(c.$n,{priority:"primary",localNavigation:!1,href:(0,p.my9)(t,{utm_source:"a24_landing_page",next:"/a24"}),children:"Upgrade"})]}):(0,n.FD)(n.FK,{children:[(0,n.FD)(u.EY.B1,{children:["Paid subscribers to ",t.name," have access to a 3-month subscription to AAA24, an exciting new streaming service by A24."]}),(0,n.Y)(c.$n,{priority:"primary",localNavigation:!1,href:(0,p.my9)(t,{utm_source:"a24_landing_page",next:"/a24"}),children:"Subscribe"})]})]})})})})}},30226:function(e,t,i){i.d(t,{A:()=>x});var n=i(69277),r=i(10201),a=i(32485),l=i.n(a),o=i(84934),s=i(17402),c=i(17988),d=i(15734),u=i.n(d),p=i(7358),h=i(79909),m=i(15113),g=i(13950),f=i(81209),v=i(19449),b=i(56778),y=i(86500),Y=i(56804),_=i(1459),w=i(68349),C=i(24078),k=i(35369),S=i(76977),I=i(81203),F=i(63136),D=i(4016),T=i(39318),A=i(57324);let E=e=>{let{pub:t,user:i,freeSignup:n,freeSignupEmail:a}=e,o="enabled"===t.payments_state&&(null==i?void 0:i.is_free_subscribed)&&!(null==i?void 0:i.is_subscribed)?"paid_upsell":"free_upsell";return(0,s.useEffect)(()=>{(0,y.u4)(y.qY.ABOUT_PAGE_END_CTA_RENDERED,{pub_id:t.id,type:o})},[]),(0,r.FD)(r.FK,{children:[(0,r.Y)(b.A,{onVisible:()=>{(0,y.u4)(y.qY.ABOUT_PAGE_END_CTA_SEEN,{pub_id:t.id,type:o})}}),(0,r.FD)(S.I1,{alignItems:"center",gap:16,padding:24,className:l()("container-QYwuRw","end-cta-container"),children:[t.author_photo_url?(0,r.Y)(C.eu,{photoUrl:t.author_photo_url,size:64}):t.logo_url?(0,r.Y)(I.Nq,{logoUrl:t.logo_url,size:64,radius:"sm"}):null,(0,r.FD)(S.I1,{alignItems:"center",children:[(0,r.FD)(F.EY.H2,{lineHeight:30,align:"center",color:"pub-primary-text",children:["Subscribe to ",t.name]}),t.hero_text&&(0,r.Y)(F.EY.Meta,{size:12,className:"heroText-vjETGo",align:"center",color:"pub-secondary-text",children:t.hero_text})]}),(0,r.Y)(f.A,{pub:t,user:i,freeSignup:n,freeSignupEmail:a,isStatic:!1,source:"about-page-end-cta"})]})]})};function N(e){let{pub:t,user:i,freeSignup:n,freeSignupEmail:a,subscribeContent:l}=e;return"string"!=typeof l?(0,r.FD)("div",{className:"content-about-silhouette",children:[(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"})]}):(0,r.Y)("div",{className:"content-about",children:(0,r.Y)(m.A,{html:l,pub:t,user:i,freeSignup:n,freeSignupEmail:a,isAboutPage:!0})})}function P(e){let{pub:t,people:i}=e,n=(0,c.useMediaQuery)({maxWidth:540}),a=n?[[]]:[[],[]];for(let e=0;e<i.length;++e){let t=i[e];if(t){var l;null==(l=a[n?0:e%2])||l.push(t)}}return(0,r.Y)("div",{className:"content-people",children:a.map(e=>(0,r.Y)("div",{className:"people-column",children:e.map(e=>(0,r.Y)("div",{className:"content-person",onClick:i=>(0,Y.o)(i,(0,T.laT)(e,t,{utm_source:A.VU.aboutPage}),{native:!0}),children:(0,r.Y)(p.a,{subject:e,utmSource:"about-page"})}))}))})}class x extends s.Component{async componentDidMount(){this.loadPeople(),this.loadAbout()}async loadAbout(){if(""!==this.state.subscribeContent)try{let{body:e}=await u().get("/api/v1/publication/subscribe_content");this.setState({subscribeContent:e})}catch(e){console.error("Failed to load about content:",e)}}async loadPeople(){if(!this.state.people)try{let e=(await u().get("/api/v1/publication/users/ranked").query({public:!0})).body;this.setState({people:e})}catch(e){console.error("Failed to load people:",e)}}render(){var e;let{pub:t,user:i,freeSignup:a,freeSignupEmail:l,metadata:s}=this.props,{subscribeContent:c,people:d}=null!=(e=this.state)?e:{};if((0,D.lu)({pub:t})&&c)return(0,r.Y)(v.r,{pub:t,user:i||void 0,type:"about",html:c,isAboutPage:!0});let u=(0,D.S2)({pub:t}),p=(!i||!(0,_.e)(i,t))&&function(e){if("undefined"==typeof window)return!0;let t=document.createElement("div");t.innerHTML=e;for(let e=t.childNodes.length-1;e>=0;e--){let i=t.childNodes[e];if((0,w.nB)(i,"button-wrapper")||(0,w.nB)(i,"subscription-widget-wrap"))return!1}return!0}(c);return(0,r.Y)(g.DH,{children:(0,r.FD)("div",{className:"page typography about-page typography post",children:[s&&(0,r.Y)(h.Metadata,(0,n._)({},s)),(0,r.FD)("div",{className:"container",children:[(null==i?void 0:i.is_contributor)&&(0,r.Y)(k.$n,{priority:"secondary",href:(0,T.yRP)("/publish/settings/edit",{title:"About page",bodyField:"subscribe_content",redirect:document.location.href}),localNavigation:!1,leading:(0,r.Y)(o.A,{size:20}),children:"Edit"}),(0,r.Y)("div",{className:"about-content-wrap",children:(0,r.Y)(N,{pub:t,user:i,freeSignup:a,freeSignupEmail:l,subscribeContent:c})}),p?(0,r.Y)(E,{pub:t,user:i,freeSignup:a,freeSignupEmail:l}):null,!u&&(null!=d?d:[]).length>0&&(0,r.FD)(S.I1,{gap:24,children:[(0,r.Y)("h3",{className:"about-page-section-title",children:"People"}),(0,r.Y)(P,{pub:t,people:d})]})]})]})})}constructor(e,t){super(e,t),this.state={subscribeContent:e.subscribeContent,people:e.people}}}},30466:function(e,t,i){i.d(t,{A:()=>u});var n=i(69277),r=i(10201),a=i(32485),l=i.n(a),o=i(79909),s=i(13950),c=i(16447),d=i(93800);function u(e){var t,i;let{children:a,title:u,pub:p,user:h,sort:m,search:g,newPostsForArchive:f,topPostsForArchive:v,communityPostsForArchive:b,searchPosts:y,slug:Y,isPodcast:_,metadata:w}=e,C=!!(null==p?void 0:p.theme),k=null==(t=p.sections)?void 0:t.find(e=>e.slug===Y),S=null!=(i=null==k?void 0:k.id)?i:_?"pubPodcast":"pub",I=null==f?void 0:f[S],F=null==v?void 0:v[S],D=null==b?void 0:b[S];return(0,r.FD)(s.DH,{children:[w&&(0,r.Y)(o.Metadata,(0,n._)({},w)),(0,r.Y)("div",{className:l()("archive-page typography","container-b1BW1a",{"use-theme-bg":C}),children:(0,r.FD)("div",{className:"container",children:[u&&(0,r.Y)("h2",{children:u}),(0,r.Y)(c.M,{communityPosts:D,isPodcast:_,newPosts:I,pub:p,search:g,searchPosts:y,sectionId:null==k?void 0:k.id,showMonthDividers:!0,sort:m,source:"archive",topPosts:F,user:h,variant:"list",children:e=>{var t;let{posts:i,linkToComments:n,onClickPost:a}=e;return(0,r.Y)(d.m,{hideImages:null==(t=p.theme)?void 0:t.hide_images_from_list,linkToComments:n,posts:i,variant:"two-column-list",onClickPost:a})}}),a]})})]})}},93564:function(e,t,i){i.d(t,{Jk:()=>$,Nm:()=>J,iQ:()=>K,o6:()=>q});var n=i(99851),r=i(69277),a=i(79785),l=i(10201),o=i(17402),s=i(15734),c=i.n(s),d=i(67616),u=i(34746),p=i(30653),h=i(13950),m=i(55136),g=i(58398),f=i(61193),v=i(77481),b=i(58997),y=i(84605),Y=i(85478),_=i(73684),w=i(86500),C=i(68349),k=i(17096),S=i(56878),I=i(12010),F=i(47570),D=i(93354),T=i(36757),A=i(87087),E=i(73957),N=i(76977),P=i(63136),x=i(36372),L=i(56007),R=i(11510),M=i(4016),B=i(56262),O=i(39318),U=i(41086),j=i(82776),z=i(70515);function H(){let e=(0,a._)(["Comments on this "," are for "," subscribers"]);return H=function(){return e},e}class W extends o.Component{async componentDidMount(){var e;let{iString:t}=this.props;if((0,C.cH)(this.onWindowVisibilityChange),this.props.publication.community_enabled||this.props.inline?await this.loadPost():document.location.href="./",null==(e=this.props.matches)?void 0:e.feedCommentUrl){let e=this.props.matches.feedCommentUrl,i=new URL(location.toString());i.searchParams.delete("feedCommentUrl"),history.replaceState({},"",i),this.props.popToast(()=>(0,l.Y)(x.y,{text:t("Note Shared."),cta:t("View now"),href:e}))}}componentWillUnmount(){(0,C.Gr)(this.onWindowVisibilityChange),clearInterval(this.loadTimeout)}async componentDidUpdate(e,t){if(e.slug!==this.props.slug||t.sort!==this.state.sort){let e=this.props.post&&this.props.post.slug===this.props.slug;await (0,C.wb)(this,{post:e?this.props.post:null,comments:[]}),await this.loadPost()}else if(this.state.post&&this.state.comments&&!this.commentsViewed&&!this.state.loading){let e=0;(0,z.WD)(this.state.comments,()=>{e++}),this.state.post.comment_count!==e&&(this.state.post.comment_count=e,this.setState({post:this.state.post}),this.props.onChange&&this.props.onChange({post:this.state.post}))}}queueRefresh(){if(!this.commentsViewed&&this.state.comments&&this.state.post){this.commentsViewed=!0;let{post:e}=this.state;(0,w.u4)(w.qY.COMMENTS_VIEWED,{post_id:e.id,comment_count:this.state.comments.length}),this.props.publication.community_enabled&&!("thread"===e.type||(0,j.canSeeComments)(this.props.user,e))&&(0,w.u4)(w.qY.COMMENT_PAYWALL_SHOWN,{post_id:e.id,post_type:e.type}),"thread"===e.type&&this.props.user&&Promise.resolve(c().post("/api/v1/posts/".concat(e.id,"/seen")))}clearTimeout(this.loadTimeout),"undefined"!=typeof window&&(this.loadTimeout=window.setTimeout(()=>this.loadPost(),3e4))}async loadPost(){let e;if(this.state.comments&&!(0,C.Tf)())return;clearTimeout(this.loadTimeout),this.setState({loading:!0});let t=this.state.comments&&this.state.comments.length>0;this.state.comments&&(e=null,(0,z.WD)(this.state.comments,t=>{!t.deleted&&t.date&&(!e||t.date>e)&&(e=t.date)}));try{let t=this.props.slug,i=this.state.sort,n={token:this.props.post_reaction_token||"",all_comments:!0,sort:i,last_comment_at:e};this.state.post&&this.props.commentId&&(n.comment_id=this.props.commentId);let r=await c().get(this.state.post?"/api/v1/post/".concat(this.state.post.id,"/comments"):"/api/v1/posts/".concat(t)).query(n);if(this.setState({loading:!1}),t!==this.props.slug||i!==this.state.sort)return;let a=this.state.sort;!this.state.post&&r.body.default_comment_sort&&(a=r.body.default_comment_sort);let l=r.body.comments,o=this.state.comments;if(!this.state.post||!o||l){let e=o&&l?(0,D.t)(o,l):null!=l?l:[];await (0,C.wb)(this,{post:this.state.post||r.body,comments:e,sort:a})}}catch(e){console.error("Failed to load post:",e),400===e.statusCode&&await (0,C.wb)(this,{notAllowedToFetchComments:!0}),this.setState({loading:!1})}!t&&this.state.comments&&this.state.comments.length>0&&(0,C.H7)(),(0,C.Tf)()&&this.queueRefresh(),this.triggerShareOnLoad()}onSortSelected(e){var t,i;this.setState({sort:e}),(0,w.u4)(w.qY.COMMENTS_SORTED,{post_id:null==(t=this.state.post)?void 0:t.id,post_type:null==(i=this.state.post)?void 0:i.type,sort:e})}triggerShareOnLoad(){"share"===(0,U.y)("action")&&(window.history.replaceState({},document.title,(0,O.oRR)({action:null})),this.setState({shareModalOpen:!0,shareModalMedium:"email"}))}_isPub(e){let{publication:t}=this.props;return(null==t?void 0:t.subdomain)===e}render(){var e;let{slug:t,user:i,freeSignup:n,freeSignupEmail:r,publication:a,post_reaction_token:o,inline:s,commentId:c,selectionFromQuery:u,imgSelectionFromQuery:p,freeTrialCoupon:f,show_reaction_upsell:v,bannedFromNotes:y,iString:Y}=this.props,{sort:w,post:C,comments:F,notAllowedToFetchComments:D,reactionSigninComment:T}=null!=(e=this.state)?e:{};if(!C||!a.community_enabled)return s&&C?(0,l.Y)("div",{className:"container",children:(0,l.Y)(J,{post:C})}):(0,l.Y)("div",{className:"comments-page",children:(0,l.Y)("div",{className:"container",children:(0,l.Y)(b.D,{})})});let N=(0,M.lu)({pub:a}),P=a.community_enabled&&C&&"none"!==C.write_comment_permissions,x=D||P&&!(0,j.canSeeComments)(i,C),L=async(e,t)=>$({user:i,reactionToken:o,comments:F,id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>{let{comment:t}=e;return new Promise(e=>this.setState({reactionSigninComment:t},()=>{var t;return null==(t=this.modalRef.current)?void 0:t.open(e)}))}});return(0,l.Y)(h.DH,{children:(0,l.FD)("div",{className:"comments-page",children:[c&&(null==F?void 0:F[0])?(0,l.Y)(_.j,{comment:F[0],post:C,publication:a}):(0,l.Y)(E.PostMetaTags,{post:C,publication:a,isCommentPage:!this.props.inline,selection:u,imgSelection:p}),(0,l.Y)(g.Z,{isOpen:!!this.state.shareModalOpen,onClose:()=>this.setState({shareModalOpen:!1,shareModalMedium:void 0}),user:i,pub:a,post:C,reaction_token:o,comments:F,commentId:c,medium:this.state.shareModalMedium||"web"}),!s&&!c&&(0,l.Y)("div",{className:"container",children:(0,l.Y)(b.X,{pub:a,post:Object.assign({},C,{comment_url_override:(0,O.wu9)(a,C,{comments:!0})}),user:i,freeSignup:n,freeSignupEmail:r,hidden:!(0,j.isUUID)(t)&&C.hidden,truncated:"thread"!==C.type,post_reaction_token:o,onChange:e=>this.setState(null!=e?e:{}),showUnsubscribeNotice:!0,gap:0,showShare:!1,children:(0,l.Y)("div",{className:"full-container-border"})})}),x&&(0,l.Y)(G,{freeSignup:n,freeSignupEmail:r,freeTrialCoupon:f,inline:s,post:C,publication:a,user:i}),"thread"===C.type||(0,j.canSeeComments)(i,C)?(0,l.FD)("div",{className:"container",children:[!s&&F&&(0,l.Y)(q,{comments:F,post:C,sort:w,notAllowedToFetchComments:D,commentId:c,publication:a,handleSort:e=>this.onSortSelected(e),useFreePressTheme:N}),F&&F.length>0&&!P&&(0,l.Y)(J,{post:C}),P&&(0,l.Y)(S.g,{user:i,freeSignup:n,freeSignupEmail:r,pub:a,post:C,token:o,autoFocus:(0,A.Wn)(),onSuccess:e=>this.setState({comments:[e].concat(F)}),bannedFromNotes:y}),c&&F&&(0,l.Y)("a",{className:"return-to-thread-link",href:(0,O.wu9)(a,C,{comments:!0,commentId:c,highlightComment:!0}),children:Y("⭠ Return to thread")}),F||D?F.length>0?[(0,l.Y)("div",{className:"comment-list-container",ref:this.scrollRef,children:(0,l.Y)(k.Wh,{user:i,freeSignup:n,freeSignupEmail:r,pub:a,post:C,comments:F,reaction_token:o,depth:0,collapseAtDepth:s?10:F.length>3&&"most_recent_first"===w?k.ko:k.cQ,onChange:this.onChange,pageSize:s||this._isPub("astralcodexten")?k.Gs:"thread"===C.type?k.WR:k.yQ,scrollRef:this.scrollRef,retainUserCollapseState:!0,updateCommentReacted:this.updateCommentReacted,noRestack:!0},C.id)})]:null:[(0,l.Y)(I.U,{}),(0,l.Y)(I.U,{})]]}):null,T&&(0,l.Y)(m.LZ,{comment:T,pub:a,user:i,react:()=>L(T.id,!0),modalRef:this.modalRef}),v?(0,l.Y)(d.Cv,{user:i,pub:a,post:C}):null,this.state.upsellModalOpen&&(0,l.Y)(V,{isOpen:this.state.upsellModalOpen,onClose:()=>this.setState({upsellModalOpen:!1}),action:"comment",post:C,pub:a})]})})}constructor(e,t){let i;super(e,t),(0,n._)(this,"modalRef",(0,o.createRef)()),(0,n._)(this,"scrollRef",void 0),(0,n._)(this,"onboardingModalRef",void 0),(0,n._)(this,"loadTimeout",void 0),(0,n._)(this,"commentsViewed",void 0),(0,n._)(this,"onWindowVisibilityChange",()=>{(0,C.Tf)()?setTimeout(()=>{this.loadPost()},100):clearTimeout(this.loadTimeout)}),(0,n._)(this,"onChange",e=>{this.setState({comments:(0,T.f)(this.state.comments,e)})}),(0,n._)(this,"updateCommentReacted",(e,t)=>{let{user:i,post_reaction_token:n}=this.props,{comments:r}=this.state;$({user:i,reactionToken:n,comments:r,id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>{let{comment:t}=e;return new Promise(e=>this.setState({reactionSigninComment:t},()=>{var t;return null==(t=this.modalRef.current)?void 0:t.open(e)}))}})}),e.post&&e.post.slug===e.slug&&(i=e.post);const r=e.sort||i&&i.default_comment_sort||e.publication.default_comment_sort||"best_first",a=e.initialComments;this.scrollRef=(0,o.createRef)(),this.onboardingModalRef=(0,o.createRef)();const l="undefined"!=typeof window?(0,U.y)("show_app_upsell"):null;this.state={post:i,sort:r,comments:a,loading:!1,reactionSigninComment:null,upsellModalOpen:"comment"===l}}}function V(e){let{isOpen:t,onClose:i,action:n,post:r,pub:a}=e,s=(0,R.Iu)(),c=(0,o.useMemo)(()=>{var e;let t=null==(e=r.publishedBylines)?void 0:e[0];return(null==t?void 0:t.name)&&(t.photo_url||a.logo_url)?{author:{id:t.id,name:t.name,photo_url:t.photo_url||null},pub:{subdomain:a.subdomain,name:a.name,logo_url:a.logo_url}}:null},[r.publishedBylines,a.subdomain,a.name,a.logo_url]);return t&&s&&c?(0,l.Y)(p.M,{isOpen:!0,setOpen:i,author:c.author,pub:c.pub,action:n,postId:r.id,postSlug:r.slug}):null}let K=(0,Y.P_)((0,L.Ho)((0,y.wr)(W))),q=e=>{let{comments:t,post:i,sort:n,notAllowedToFetchComments:r,commentId:a,publication:o,handleSort:s,useFreePressTheme:c=!1,commentCount:d,disableMobileBottomSheet:u}=e,{iString:p,iPlural:h}=(0,y.GO)(),m=null!=d?d:i.comment_count;return c?(0,l.Y)(f.W,{comments:t,post:i,publication:o,notAllowedToFetchComments:r,handleSort:s,sort:n,disableMobileBottomSheet:u}):(0,l.FD)(N.Ye,{alignItems:"center",justifyContent:"space-between",paddingY:8,children:[(0,l.Y)(P.EY.B1,{color:"primary",weight:"bold",children:t.length>0?h("1 Comment","%1 Comments",m):p("Comments")}),t.length>1&&!r&&!a&&(0,l.Y)(F.D,{currentSort:n,isLoading:!t,handleSort:s,pub:o,disableMobileBottomSheet:u})]})},G=e=>{let{freeSignup:t,freeSignupEmail:i,freeTrialCoupon:n,inline:r,post:a,publication:o,user:s}=e,{iTemplate:c,iString:d}=(0,y.GO)();return(0,M.lu)({pub:o})?(0,l.Y)(v.n,{publication:o,post:a,user:s,freeSignupEmail:i,showHeader:!r}):(0,l.Y)("div",{className:"container",children:(0,l.Y)(u.pU,{user:s,freeSignupEmail:i,freeSignup:t,publication:o,post:a,title:c(H(),"podcast"===a.type?"episode":"post",(0,B.isFoundingAudience)(a.audience)?"founding":"paid"),reauthenticationTitle:d("To see the comments, please re-authenticate."),coupon:n})})},J=e=>{let{post:t}=e,{iString:i}=(0,y.GO)();return(0,l.Y)("div",{className:"locked-comments",children:i("adhoc_email"===t.type?"Commenting has been turned off for this email":"Commenting has been turned off for this post")})};async function $(e){let{user:t,reactionToken:i,comments:n,id:a,reacted:l,setComments:o,onNeedsSignin:s}=e,c=(0,A.pU)(a,n);if(!c)return;let d=(0,r._)({},c);(0,m.wx)(t,d,l),o((0,A.cx)(n.slice(0),d));try{await (0,m.xu)(d,!0,l,i)}catch(e){var u;if((0,m.wx)(t,d,!l),o((0,A.cx)(n.slice(0),(0,r._)({},d))),(null==(u=e.response)?void 0:u.statusCode)!==401)return void alert((0,C.uX)(e));await s({comment:d})}}},38304:function(e,t,i){i.d(t,{Jk:()=>r.Jk,Nm:()=>r.Nm,PG:()=>a.PG,cx:()=>a.cx,gi:()=>n.g,iQ:()=>r.iQ});var n=i(56878);i(17096);var r=i(93564);i(12010);var a=i(87087)},53130:function(e,t,i){i.d(t,{m:()=>D});var n=i(99851),r=i(10201),a=i(32485),l=i.n(a),o=i(83673),s=i.n(o),c=i(17402),d=i(15734),u=i.n(d),p=i(6212),h=i(13950),m=i(56778),g=i(94794),f=i(84565),v=i(53989),b=i(85478),y=i(86500),Y=i(3142),_=i(68349),w=i(73957),C=i(88559),k=i(76977),S=i(79564),I=i(39318),F=i(41086);class D extends c.Component{async componentDidMount(){(0,_.H7)(),this.cleanEmbedResizeListener=(0,Y._)(),this.state.post||await this.loadPost(),this.triggerShareOnLoad(),this.fillEmbeddedEmailInputs()}componentWillUnmount(){var e;null==(e=this.cleanEmbedResizeListener)||e.call(this)}async componentDidUpdate(){this.state.embeddedEmailInputsFilled||this.fillEmbeddedEmailInputs()}async loadPost(){if(this.setState({embeddedEmailInputsFilled:!1}),this.props.post)this.setState({post:this.props.post},()=>(0,_.H7)());else try{let e=await u().get("/api/v1/cross-posts/".concat(this.props.post_id));await (0,_.wb)(this,{post:e.body.post,introText:e.body.intro_text,crossPostedPub:e.body.crossPostedPub,crossPostingByLine:e.body.crossPostingByLine,userWithCrossPostedPubContext:e.body.userWithCrossPostedPubContext,crossPostedPublicationSettings:e.body.crossPostedPublicationSettings,crossPostedSiteConfig:e.body.crossPostedSiteConfig}),(0,_.H7)()}catch(e){console.error("Failed to load post:",e),alert((0,_.uX)(e))}}triggerShareOnLoad(){"share"===(0,F.y)("action")&&(window.history.replaceState({},document.title,(0,I.oRR)({action:null})),this.post&&this.post.triggerShare({fromEmail:!0}))}render(){var e,t;let{freeSignup:i,freeSignupEmail:n,publication:a}=this.props,{post:o,user:c,introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y,crossPostedPublicationSettings:Y,crossPostedSiteConfig:_}=null!=(e=this.state)?e:{},I=(null==o?void 0:o.type)==="podcast",F=["video","podcast"].includes(null!=(t=null==o?void 0:o.type)?t:"");return u?(0,r.Y)("div",{children:(0,r.Y)(h.DH,{children:(0,r.FD)("div",{className:l()("single-post-container"),children:[(0,r.Y)("div",{className:l()({container:!I}),children:(0,r.FD)("div",{className:"single-post",children:[(0,r.Y)(w.PostMetaTags,{post:o,publication:a}),o&&Y&&_?(0,r.Y)(v.Fm,{settings:Y,children:(0,r.Y)(b.eE,{siteConfigs:_,children:(0,r.Y)(g.QR,{crossPost:{crossPostedPub:u},children:F?(0,r.Y)(S.H,{ref:this.assignPost,user:y,post:o,pub:u,freeSignup:i,freeSignupEmail:n,paywall:!1,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,crossPostInfo:{introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y}}):(0,r.Y)(p.L4,{ref:this.assignPost,user:y,post:o,pub:u,freeSignup:i,freeSignupEmail:n,paywall:!1,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,crossPostInfo:{introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y}})})})}):(0,r.Y)(p.DZ,{pub:a})]})}),a.has_posts&&o?(0,r.Y)(k.Ye,{justifyContent:"center",borderTop:"detail",paddingTop:8,children:(0,r.Y)("div",{className:"single-post-section",children:(0,r.FD)("div",{className:"container",children:[(0,r.Y)(m.A,{onVisible:()=>{this.onVisible("Top Posts Footer")}}),(0,r.Y)(C.Q,{user:c,freeSignup:i,freeSignupEmail:n,pub:a,maxPosts:3,filterPostsPredicate:e=>e.id!==(null==o?void 0:o.id),stateInUrl:!0,sortTabs:e=>{if(this.context.getConfigFor("related_posts_enabled")){let t=e.findIndex(e=>"related"===e.id);if(-1!==t)return s()([e[t]].concat(e.filter((e,i)=>i!==t)))}let t=e.findIndex(e=>"top"===e.id);return -1!==t?s()([e[t]].concat(e.filter((e,i)=>i!==t))):null},delayFirstLoad:1e3,source:"post",isBelowTheFold:!0,post:o})]})})}):null]})})}):(0,r.Y)("div",{})}constructor(e,t){super(e,t),(0,n._)(this,"cleanEmbedResizeListener",void 0),(0,n._)(this,"post",void 0),(0,n._)(this,"assignPost",e=>{this.post=e}),(0,n._)(this,"onVisible",e=>{let t="".concat(e," Seen");!this.state.post||this.state[t]||(this.setState({[t]:!0}),(0,y.u4)(t,{post_id:this.state.post.id,post_audience:this.state.post.audience,post_type:this.state.post.type}))}),(0,n._)(this,"fillEmbeddedEmailInputs",()=>{var e;let t=document.querySelectorAll('article.post input[type="email"]'),i=(null==(e=this.state.user)?void 0:e.email)||this.props.freeSignupEmail;i&&t.forEach(e=>e.value=i),this.setState({embeddedEmailInputsFilled:!0})});const{user:i}=e;e.post?this.state={post:e.post,user:i,introText:e.introText,crossPostedPub:e.crossPostedPub,crossPostingByLine:e.crossPostingByLine,userWithCrossPostedPubContext:e.userWithCrossPostedPubContext,crossPostedPublicationSettings:e.crossPostedPublicationSettings,crossPostedSiteConfig:e.crossPostedSiteConfig}:this.state={user:i}}}(0,n._)(D,"contextType",f.Ke)},67728:function(e,t,i){i.d(t,{A:()=>_});var n=i(99851),r=i(10201),a=i(32485),l=i.n(a),o=i(17402),s=i(91370),c=i(34206),d=i(9266),u=i(81209),p=i(85478),h=i(1683),m=i(68349),g=i(35369),f=i(63136),v=i(39318),b=i(80856),y=i(49807),Y=i(57324);class _ extends o.Component{componentDidMount(){(0,m.NN)((0,v.dJ9)("/img/substack_wordmark.png",200));let e=this.props.freeSignupEmail||this.props.user&&this.props.user.email;if(e&&this.emailInput)this.emailInput.value=e;else if(!(0,m.rr)()){var t;null==(t=this.emailInput)||t.focus()}}onPrepareData(e){!this.props.pub.plans&&this.context.getConfigFor("no_embed_redirect")||this.subscribeWindow||(this.subscribeWindow=window.open("about:blank","_blank"))}onSignup(e){this.setState({freeSignup:!0,freeSignupEmail:e.body.email}),this.subscribeWindow&&(this.subscribeWindow.location=(0,y.eV6)(this.props.pub,{addBase:!0,params:{just_signed_up:!0,skip_redirect_check:!0,utm_medium:Y.Jn.web,utm_source:Y.VU.embed,freeSignupEmail:e.body.email}}))}onError(e){if(this.subscribeWindow){try{this.subscribeWindow.close()}catch(e){console.error("Failed to close subscribe window:",e)}this.subscribeWindow=null}}render(){var e;let{pub:t,user:i,no_border:n}=this.props,{freeSignup:a,freeSignupEmail:o,loading:p,success:y}=null!=(e=this.state)?e:{},_=o||i&&i.email;return(0,r.FD)("div",{className:"embed-page ".concat(n?"no-border":""),children:[(0,r.FD)("div",{className:"embed-page-inner",children:[t.logo_url&&(0,r.Y)("a",{href:"".concat(t.base_url,"/"),target:"_blank",children:(0,r.Y)("img",{className:"publication-logo",src:(0,v.dJ9)(t.logo_url,170,{quality:"auto:best"}),alt:"Logo"})}),(0,r.Y)("h1",{className:"publication-name".concat(t.logo_url?"":" no-logo"),children:(0,r.Y)("a",{href:"".concat(t.base_url,"/"),target:"_blank",children:(0,r.Y)(s.A,{text:t.name})})}),!!t.hero_text&&(0,r.Y)("p",{className:"publication-tagline",children:(0,r.Y)(s.A,{text:t.hero_text})}),(0,r.Y)("div",{className:"publication-meta",children:(0,r.Y)(s.A,{text:(0,d.Be)(t,{includePrice:!1,includeBadge:!0,rankingDetailOverrideText:t.rankingDetailFreeSubscriberCount,includeRankingDetail:!!t.rankingDetailFreeSubscriberCount})})}),t.invite_only?(0,r.FD)(c.Ay,{className:"subscription-request-form",ref:this.assignForm,noInlineErrors:!0,action:(0,v.yRP)("/api/v1/subscription/request"),noJsAction:(0,v.yRP)("/api/v1/subscription/request",{nojs:!0}),onSuccess:()=>this.setState({success:!0}),onError:e=>{this.setState({loading:!1}),alert((0,m.uX)(e,"Failed to request a subscription"))},children:[(0,r.Y)("input",{type:"hidden",name:"first_url",value:h.R9}),(0,r.Y)("input",{type:"hidden",name:"first_referrer",value:h.b7}),(0,r.Y)("input",{type:"hidden",name:"current_url",value:h.AT}),(0,r.Y)("input",{type:"hidden",name:"current_referrer",value:h.uC}),(0,r.Y)("input",{type:"hidden",name:"first_session_url",value:h.K0}),(0,r.Y)("input",{type:"hidden",name:"first_session_referrer",value:h.OG}),!!_&&(0,m.o7)(),(0,r.FD)("div",{className:"sideBySideWrap",children:[(0,r.Y)("input",{className:l()(y?"secondary":"primary"),type:"email",name:"email",ref:this.assignEmailInput,readOnly:!!(_||p),disabled:!!(p||y||_),placeholder:"Type your email…"}),(0,r.Y)(g.$n,{priority:y?"secondary":"primary",type:"submit",disabled:!!(p||y),onClick:()=>{this.setState({loading:!0})},children:y?"Requested":"Subscribe"})]}),(0,r.Y)("div",{id:"error-container"})]}):(0,r.Y)(u.A,{source:"embed",pub:t,user:i,freeSignup:a,freeSignupEmail:o,forceEmailInput:!0,onPrepareData:e=>this.onPrepareData(e),onSignup:e=>this.onSignup(e),onError:e=>this.onError(e)}),(0,r.Y)("div",{className:"embed-tos",children:(0,r.FD)(f.EY.B4,{color:"pub-secondary-text",size:12,lineHeight:16,align:"center",children:["By subscribing you agree to"," ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b.Ru)({pub:t,utm_source:"embed_publication"}),children:"Substack's Terms of Use"}),", ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b._)({pub:t,utm_source:"embed_publication"}),children:"our Privacy Policy"})," ","and"," ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b.iQ)({utm_source:"embed_publication"}),children:"our Information collection notice"})]})}),(i||a)&&(0,r.Y)("p",{className:"sign-out-block",children:(0,r.Y)("span",{className:"account-info-logout",children:(0,r.Y)("a",{href:(0,v.bgT)({redirect:document.location.href,for_pub:t.subdomain}),native:!0,children:"Sign out"})})})]}),(0,r.Y)("a",{href:"".concat((0,v.Ewe)(),"/?utm_source=").concat(Y.VU.embed,"&utm_content=").concat(t.subdomain),target:"_blank",children:(0,r.Y)("img",{ref:this.assignImg,className:"substack-watermark",src:(0,v.dJ9)("/img/substack_wordmark.black.png",200),onMouseEnter:()=>{this.img&&(this.img.src=(0,v.dJ9)("/img/substack_wordmark.png",200))},onMouseLeave:()=>{this.img&&(this.img.src=(0,v.dJ9)("/img/substack_wordmark.black.png",200))},alt:"Substack"})})]})}constructor(e,t){super(e,t),(0,n._)(this,"emailInput",void 0),(0,n._)(this,"subscribeWindow",void 0),(0,n._)(this,"form",void 0),(0,n._)(this,"img",void 0),(0,n._)(this,"assignEmailInput",e=>{this.emailInput=e}),(0,n._)(this,"assignForm",e=>{this.form=e}),(0,n._)(this,"assignImg",e=>{this.img=e}),this.state={freeSignup:e.freeSignup,freeSignupEmail:e.freeSignupEmail,success:!1}}}(0,n._)(_,"contextType",p.W8)},80083:function(e,t,i){i.d(t,{A:()=>d});var n=i(10201),r=i(17402),a=i(15734),l=i.n(a),o=i(99070),s=i(68349),c=i(9036);let d=e=>{var t,i;let{pub:a,slug:d}=e,[u,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{!async function(){try{let e=await l().get("/api/v1/posts/".concat(d));p(e.body)}catch(e){console.error("Failed to load post:",e),404===e.status?alert("Post not found"):alert((0,s.uX)(e))}}()},[d]);let h=!1;return"undefined"!=typeof window&&(h="1"===(null!=(t=(0,c.m)(window.location.href).autoplay)?t:"0")),u?(0,n.Y)(o.A,{feature:"Audio",pub:a,post:u,src:u.podcast_url,autoPlay:h,metricsPost:u,isFancy:!0,showCTAs:!0,mediaUpload:null!=(i=u.podcastUpload)?i:void 0,trackingProps:{surface:"external",contentType:"post",entityType:"post",entityKey:u.id}}):(0,n.Y)("div",{className:"loading-container"})}},46887:function(e,t,i){i.d(t,{A:()=>r});var n=i(10201);function r(){return(0,n.Y)("div",{className:"embed-test-page",children:(0,n.Y)("iframe",{style:{border:"1px solid #EEE",background:"white"},width:"480",height:"320",src:"/embed",frameBorder:"0",scrolling:"no"})})}},78368:function(e,t,i){i.d(t,{A:()=>p});var n=i(10201),r=i(17402),a=i(15734),l=i.n(a),o=i(41873),s=i(68349),c=i(68410),d=i(13348),u=i(9036);let p=e=>{var t,i;let{pub:a,slug:p}=e,[h,m]=(0,r.useState)(null),{isMobile:g}=(0,c.sM)();(0,r.useEffect)(()=>{!async function(){try{let e=await l().get("/api/v1/posts/".concat(p));m(e.body)}catch(e){console.error("Failed to load post:",e),404===e.status?alert("Post not found"):alert((0,s.uX)(e))}}()},[p]);let f=!1;return"undefined"!=typeof window&&(f="1"===(null!=(t=(0,u.m)(window.location.href).autoplay)?t:"0")),(null==h?void 0:h.videoUpload)?(0,n.Y)("div",{className:"video-player-embed-container",children:(0,n.Y)(o.A,{mediaUpload:h.videoUpload,pub:a,autoPlay:f,videoType:"video-embed",renderPlayButton:()=>(0,n.Y)(d.ro,{isPlaying:!1,size:g?40:56}),contentType:"embed",entityType:"post",entityKey:null!=(i=null==h?void 0:h.id)?i:"unknown",surface:"external"})}):(0,n.Y)("div",{className:"loading-container"})}},27179:function(e,t,i){i.d(t,{A:()=>h});var n=i(10201),r=i(17402),a=i(69277),l=i(70408),o=i(97731);let s=e=>(0,n.Y)(o.A,(0,l._)((0,a._)({},e),{name:"ChevronIcon",svgParams:{height:24,width:24,stroke:"#666666",viewBox:"0 0 24 24"},children:(0,n.Y)("path",{d:"M9.88507 18.9609L15.8851 12.9609L9.88507 6.96094",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})),c=e=>(0,n.FD)(o.A,(0,l._)((0,a._)({},e),{name:"DownloadIcon",svgParams:{height:32,width:32},children:[(0,n.Y)("rect",{width:"32",height:"32",rx:"6",fill:e.fill||"black"}),(0,n.Y)("path",{d:"M23.5 18.5V21.8333C23.5 22.2754 23.3244 22.6993 23.0118 23.0118C22.6993 23.3244 22.2754 23.5 21.8333 23.5H10.1667C9.72464 23.5 9.30072 23.3244 8.98816 23.0118C8.67559 22.6993 8.5 22.2754 8.5 21.8333V18.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.Y)("path",{d:"M11.8333 14.3335L16 18.5002L20.1667 14.3335",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.Y)("path",{d:"M16 18.5V8.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})),d=e=>(0,n.FD)(o.A,(0,l._)((0,a._)({},e),{name:"PanelsIcon",svgParams:{height:32,width:32},children:[(0,n.Y)("rect",{width:"32",height:"32",rx:"6",fill:"black"}),(0,n.Y)("rect",{x:"7.19995",y:"7.2002",width:"8.49554",height:"11.8938",rx:"0.424777",fill:"white"}),(0,n.Y)("rect",{opacity:"0.7",x:"7.19995",y:"19.603",width:"8.49554",height:"6.79643",rx:"0.424777",fill:"white"}),(0,n.Y)("path",{opacity:"0.7",d:"M16.2048 7.62497C16.2048 7.39037 16.395 7.2002 16.6296 7.2002H20.4526C23.737 7.2002 26.3995 9.8627 26.3995 13.1471C26.3995 16.4314 23.737 19.094 20.4526 19.094H16.6296C16.395 19.094 16.2048 18.9038 16.2048 18.6692V7.62497Z",fill:"white"})]}));var u=i(39318),p=i(82776);function h(e){var t;let{file:i="undefined"!=typeof window&&"file"in window._preloads&&(null==(t=window._preloads)?void 0:t.file)||{},pub:a}=e,[l,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{if(!i.fileKey){let e=await fetch("/api/v1/file/entry/".concat(window.location.pathname.split("/").pop()));e.redirected&&(window.location.href=e.url),o(await e.json())}})()},[i.fileKey]),(0,n.Y)(m,{file:l||i,pub:a})}function m(e){var t,i,r,a;let{file:l,pub:o}=e;if(!l.id)return(0,n.Y)("div",{className:"page",children:(0,n.FD)("div",{className:"container",children:[(0,n.Y)("h3",{children:"Read Now"}),(0,n.Y)("div",{className:"popup-container",children:(0,n.Y)("div",{className:"overlay"})})]})});let h=null==(i=l.file_key)||null==(t=i.split(".").pop())?void 0:t.toUpperCase(),m=(0,p.numberToHumanFileSize)(l.num_bytes),g=(r=null!=h?h:"","".concat(null==(a=l.title)?void 0:a.toLowerCase().replace(/\s/g,"_"),".").concat(r.toLowerCase()));return(0,n.Y)("div",{className:"page",children:(0,n.FD)("div",{className:"container",children:[(0,n.FD)("span",{className:"table-list-title",children:[(0,n.Y)("h3",{children:"Read Now"}),(0,n.Y)("a",{className:"file-sidebar-header-button",href:"".concat((0,u.$_T)(o),"/p/").concat(l.post_id),children:"Back"})]}),(0,n.FD)("div",{className:"table-list",children:[(0,n.FD)("div",{className:"table-list-row table-list-header",children:[(0,n.Y)("img",{className:"table-list-thumbnail ".concat(l.thumbnail&&-1===l.thumbnail.indexOf("/img/attachment_icon.svg")?"":"default"),src:l.thumbnail||"".concat((0,u.$_T)(o),"/img/attachment_icon.svg")}),(0,n.FD)("div",{className:"table-list-col",children:[(0,n.Y)("div",{className:"table-list-h1",children:l.title||"Unknown File"}),(0,n.FD)("div",{className:"table-list-h2",children:[m," ∙ ",h," File"]})]})]}),(0,n.FD)("a",{className:"table-list-row table-list-item",href:"".concat((0,u.$_T)(o),"/api/v1/file/panels/").concat(l.file_key),children:[(0,n.Y)(d,{}),(0,n.FD)("span",{className:"table-list-grow",children:[(0,n.Y)("div",{className:"table-list-h1",children:"Open in Panels"}),(0,n.Y)("div",{className:"table-list-h2",children:"Comic reader for iOS"})]}),(0,n.Y)(s,{stroke:"#666",strokeWidth:0,isStatic:!0})]}),(0,n.FD)("a",{className:"table-list-row table-list-item",download:g,href:"".concat((0,u.$_T)(o),"/api/v1/file/").concat(l.file_key),children:[(0,n.Y)(c,{}),(0,n.FD)("span",{className:"table-list-grow",children:[(0,n.Y)("div",{className:"table-list-h1",children:"Download file"}),(0,n.Y)("div",{className:"table-list-h2",children:g})]}),(0,n.Y)(s,{stroke:"#666",strokeWidth:0,isStatic:!0})]})]})]})})}},54077:function(e,t,i){i.d(t,{A:()=>d});var n=i(99851),r=i(10201),a=i(17402),l=i(15734),o=i.n(l),s=i(5109),c=i(68349);class d extends a.Component{componentDidMount(){this.props.user||(0,c.jL)()}render(){var e;let{pub:t,post:i,user:n,freeSignup:a,freeSignupEmail:l,inviteToPost:o,primaryEligiblePublications:c,switchAccountRedirectUrl:d}=this.props,{error:u}=null!=(e=this.state)?e:{};if(u)return(0,r.FD)("div",{className:"container invite-success",children:[(0,r.Y)("h3",{children:"Error"}),(0,r.Y)("p",{children:u})]});let p=o&&i&&"podcast"===i.type,h=p&&n?"Fill out your profile for your podcast appearance":p&&!n?"Set up your profile for your podcast appearance":o&&n?"Set up your profile":o&&!n?"Fill out your profile":"Your invite to ".concat(t.name),m=p?"Listeners will want to know more about you. Use your profile as a chance to express yourself.":o?"Readers will want to know more about you and even follow your writing. Use your profile as a chance to express yourself.":"Before you can accept your invite, finish setting up your profile:",g=o?"Update Profile & Accept Invite":"Accept Invite",f=n?"Already a writer?":"Already have an account?",v=n?"Switch accounts":"Login";return(0,r.FD)("div",{className:"container finish-invite",children:[(0,r.Y)("h3",{children:h}),(0,r.Y)("p",{children:m}),(0,r.Y)(s.dx,{pageTitle:"",user:n,freeSignup:a,freeSignupEmail:l,needsPhoto:!1,optionalPhoto:o,isPostInvite:o,primaryEligiblePublications:c,onSuccess:this.acceptInvite,text:g}),o&&d&&(0,r.FD)("div",{className:"invite-switch-account",children:[f," ",(0,r.Y)("a",{href:d,children:v})]})]})}constructor(...e){super(...e),(0,n._)(this,"acceptInvite",async()=>{try{var e,t;let i=await o().post("/api/v1/publication_user_invite/".concat(this.props.matches.id,"/accept"));(null==(e=i.body)?void 0:e.postUrl)?location.href=null==(t=i.body)?void 0:t.postUrl:(0,c.V2)("/invite-success/".concat(this.props.matches.id))}catch(t){let e=(0,c.uX)(t);this.setState({error:e})}})}}(0,n._)(d,"defaultProps",{inviteToPost:!1,primaryEligiblePublications:[]})},43440:function(e,t,i){i.d(t,{z:()=>d});var n=i(10201),r=i(17402),a=i(34206),l=i(97432),o=i(79909),s=i(35369),c=i(82776);class d extends r.Component{renderNotAvailable(e){let{time:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.FD)("div",{className:"container reward-page gift-reward-page",children:[(0,n.Y)("h2",{children:"All gone"}),e,(0,n.FD)("p",{children:["Sorry, ",t?"this gift has expired":"all of these gifts have already been claimed",". You can still subscribe if you like."]}),(0,n.Y)("div",{className:"signup",children:(0,n.Y)(l.A,{source:"viral_gift_none_left",pub:this.props.pub,onSuccess:()=>{document.location.href="/subscribe"}})})]})}renderForSender(){var e;return[(0,n.FD)("h3",{className:"sender-hint",children:[(0,n.FD)("span",{children:[(e=this.props.user).name?e.name.trim().split(/\s+/g)[0]:e.email.split("@")[0],", share this page to give your gift"]}),(0,n.Y)("a",{className:"button twitter-button",href:this.props.viral_gift_data.tweet_link,native:!0,children:"Share on Twitter"})]})]}render(){var e;let{pub:t,t:i,user:r,freeSignupEmail:l,viral_gift_data:d}=this.props,{sender_name:u,count_remaining:p,sender_id:h}=d,m=(0,c.getGiftValueText)(null!=(e=t.plans)?e:[]),g=m?" (value: ".concat(m,")"):"",f="A three-month subscription to ".concat(t.name).concat(g),v=(0,n.Y)(o.Metadata,{title:"Accept ".concat(u||"your friend","'s gift"),description:f,image:t.logo_url});if(!i||!p)return this.renderNotAvailable(v);let b=null;r&&r.id==h&&(b=this.renderForSender());let y="",Y=l||"";return r&&!b&&(y=r.name,Y=r.email),(0,n.FD)("div",{className:"container reward-page receive-page",children:[b,v,(0,n.Y)("h2",{children:"Accept Gift Subscription"}),(0,n.FD)("p",{children:[u||"Your friend"," would like to give you a free, three-month subscription. ",g]}),(0,n.Y)("p",{children:(0,n.Y)("b",{children:"".concat(p," left")})}),(0,n.FD)(a.Ay,{action:"/api/v1/viral_gifts/accept_gift_from_link",onSuccess:()=>document.location.href="/account/gifts/accept",children:[(0,n.Y)("input",{type:"text",name:"name",placeholder:"Your name",value:y}),(0,n.Y)("input",{type:"email",name:"email",placeholder:"Your email",value:Y}),(0,n.Y)("input",{type:"hidden",value:i,name:"token"}),(0,n.Y)("div",{id:"error-container"}),(0,n.Y)("div",{className:"button-container",children:(0,n.Y)(s.$n,{priority:"primary",type:"submit",children:"Accept Gift"})})]})]})}}},5567:function(e,t,i){i.d(t,{V:()=>u});var n=i(10201),r=i(13950),a=i(16447),l=i(10939),o=i(93800),s=i(6998),c=i(12592),d=i(97778);let u=e=>{var t,i,u;let{author_id_or_slug:p,authorInfo:h,posts:m,pub:g,user:f,utm:v}=e,{authorInfo:b,posts:y}=(0,d.Y)({author_id_or_slug:p,authorInfoPreload:h,postsPreload:m,pub:g});return b&&y?(0,n.Y)(c.c,{children:(0,n.FD)(r.DH,{children:[(0,n.Y)(s.X,{description:null!=(t=b.bio)?t:null,logoUrl:null!=(i=b.photo_url)?i:null,name:null!=(u=b.name)?u:"",pub:g}),(0,n.Y)(l.r,{}),(0,n.Y)(a.M,{authorId:b.user_id,newPosts:y,pub:g,sort:"new",source:"author-archive",user:f,utm:v,children:e=>{var t;let{posts:i,linkToComments:r,onClickPost:a}=e;return(0,n.Y)(o.m,{hideImages:null==(t=g.theme)?void 0:t.hide_images_from_list,linkToComments:r,posts:i,variant:"two-column-list",onClickPost:a})}})]})}):null}},57376:function(e,t,i){i.d(t,{m:()=>g});var n=i(10201),r=i(17402),a=i(36233),l=i(91089),o=i(57961),s=i(17028),c=i(57322),d=i(47408),u=i(39461),p=i(72147),h=i(11510),m=i(58278);let g=e=>{let{blurbs:t,freeSignup:i,freeSignupEmail:s,hide_intro_popup:g,notify_user:v,pub:b,referralCode:y,showWelcome:Y,user:_,launchWelcomePage:w,skipIntroPopupRender:C,initialData:k,subpath:S}=e;(0,r.useEffect)(()=>{v&&"undefined"!=typeof window&&(0,a.Ay)(v)},[v]);let I=(0,h.Iu)();if(!b.theme)return null;let F=["subscribers","followers","following"].includes(S),D=b.author_handle||"".concat(b.author_id,"-").concat((0,m.d9)(b.author_name));return(0,n.FD)("div",{className:"home-page home-page--modular",children:[(0,n.Y)(l.PageMetaData,{isHomepage:!0,pub:b}),(0,n.Y)(f,{children:k&&(0,n.FD)(n.FK,{children:[!I&&(0,n.Y)(c.W,{drawer:null,native:!0,requireLogin:null}),!F&&(0,n.Y)("div",{className:"reader-nav-page",children:(0,n.Y)(u.n7,{id:D,initialData:k,subpath:S?"/".concat(S):"/"})}),S&&F&&(0,n.Y)("div",{className:"profile-connections",children:(0,n.Y)(p.X,{id:D,subpath:"/".concat(S)})}),I&&(0,n.Y)(d.w,{})]})}),C?null:(0,n.Y)(o.l,{blurbs:t,freeSignup:i,freeSignupEmail:s,hide_intro_popup:g,launchWelcomePage:w,pub:b,referralCode:y,showWelcome:Y,user:_})]})},f=(0,s.I4)({className:"profile-theme",position:"relative",zIndex:0})},6998:function(e,t,i){i.d(t,{X:()=>u});var n=i(10201),r=i(32485),a=i.n(r),l=i(68410),o=i(76977),s=i(63136),c=i(4016),d=i(39318);let u=e=>{let{description:t,logoUrl:i,name:r,pub:u}=e,{isMobile:p}=(0,l.sM)();return(0,n.FD)(o.I1,{gap:12,paddingX:8*!p,children:[i&&(0,n.Y)("img",{alt:r,className:"logo-Q8LqG3",src:(0,d.dJ9)(i,144)}),(0,n.Y)(s.EY.H1,{className:a()({"pillarHeader-Q57NYM":(0,c.S2)({pub:u})}),color:"pub-primary-text",font:"pub-headings",children:r}),t&&(0,n.Y)(s.EY.B3,{color:"pub-secondary-text",children:t})]})}},68410:function(e,t,i){i.d(t,{bH:()=>c,sM:()=>s});var n=i(17402),r=i(17988),a=i(15734),l=i.n(a),o=i(98949);let s=()=>{let e,t=(0,o.Fr)(),i=(0,r.useMediaQuery)({query:"only screen and (max-width: 1024px)"}),a=(0,r.useMediaQuery)({query:"only screen and (max-width: 768px)"}),l=(0,r.useMediaQuery)({query:"(orientation: landscape)"});return e="undefined"==typeof window?t?"mobile":"desktop":a?"mobile":i?"tablet":"desktop",(0,n.useMemo)(()=>({breakpoint:e,isMobile:"mobile"===e,isMobileLandscape:t&&l,isTablet:"tablet"===e,isDesktop:"desktop"===e}),[e,l,t])},c=e=>{let{preloadedHomepageData:t,isPreview:i}=e,[r,a]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=async()=>{a((await l().get("/api/v1/homepage_data").query({preview:i})).body)};t||e()},[t,i]),null!=t?t:r}},7761:function(e,t,i){i.d(t,{WO:()=>o,b$:()=>l});var n=i(10201),r=i(17402);let a=(0,r.createContext)({getPubPinInfo:()=>({showPin:!1}),getSectionPinInfo:()=>({showPin:!1})}),l=()=>(0,r.useContext)(a),o=e=>{let{children:t,pub:i,showPubPins:l,showSectionPins:o}=e,s=(0,r.useCallback)(e=>{var t;let{post:n}=e;return{showPin:l&&!!(null==(t=n.pins)?void 0:t.includes(i.id))}},[i.id,l]),c=(0,r.useCallback)(e=>{let{post:t}=e;return{showPin:o&&t.is_section_pinned}},[o]);return(0,n.Y)(a.Provider,{value:{getPubPinInfo:s,getSectionPinInfo:c},children:t})}},88553:function(e,t,i){i.d(t,{H9:()=>s,Uv:()=>c,dn:()=>l,fg:()=>o});var n=i(17402),r=i(39318),a=i(18947);let l=(0,n.createContext)({setIsOnboarding:null}),o=1.5,s=16/9,c=e=>{let{linkToComments:t,post:i,pub:n,utm:l}=e;return t?(0,a.wu)(n,i,{comments:!0,urlParams:{utm:l}}):"video"===i.type?(0,r.oRR)(i.canonical_url,{autoPlay:!0,utm:l}):l?(0,r.yRP)(i.canonical_url,{utm:l}):i.canonical_url}},97778:function(e,t,i){i.d(t,{Y:()=>c});var n=i(69277),r=i(70408),a=i(83673),l=i.n(a),o=i(12501),s=i(58278);let c=e=>{var t,i;let{author_id_or_slug:a,authorInfoPreload:c,postsPreload:d,pub:u}=e,p=!!(0,s.ID)({slugOrId:a,pub:(0,r._)((0,n._)({},u),{authorPagesInfo:l()([c])})}),h=(0,o.st)({pathname:"/w/".concat(a,"/info"),auto:!p,initialResult:p&&c&&d?{authorInfo:c,posts:d}:void 0,deps:[a]});return{authorInfo:null==(t=h.result)?void 0:t.authorInfo,posts:null==(i=h.result)?void 0:i.posts}}},19692:function(e,t,i){i.d(t,{A:()=>h});var n=i(99851),r=i(10201),a=i(17402),l=i(15734),o=i.n(l),s=i(34206),c=i(68349),d=i(35369),u=i(16291),p=i(82776);class h extends a.Component{componentDidMount(){this.hasInvites()?this.loadInvites():(0,c.Lm)(this.props.pub)}hasInvites(){let{pub:e,user:t}=this.props;return!!e.invite_only&&(!!t&&!!t.is_contributor||!!(e.subscriber_invites>0)&&!!(t&&t.is_subscribed))}async loadInvites(){try{let e=await o().get("/api/v1/publication/invite");this.setState({invites:e.body,loading:!1})}catch(e){console.error("Failed to fetch invites:",e),alert((0,c.uX)(e))}}render(){var e;let{pub:t,user:i}=this.props,{loading:n,invites:a}=null!=(e=this.state)?e:{};if(!this.hasInvites())return(0,r.Y)("p",{className:"main-loader",children:"Loading…"});let l=i&&i.is_contributor,o=Math.max(i&&i.invites,a.length),c=Math.max(o,t.subscriber_invites),h=c-o;return(0,r.Y)("div",{className:"invite-page page",children:(0,r.FD)("div",{className:"container",children:[(0,r.Y)("h3",{children:"Your invites"}),(0,r.FD)("p",{children:[t.name," is invite-only, but you’ve been granted"," ",l?"an infinite number of invites":(0,p.pluralize)(c,"invite")," to give out."]}),(h>0||l)&&[!l&&(0,r.FD)("h5",{children:["You have ",(0,p.pluralize)(h,"invite")," left"]}),(0,r.FD)(s.Ay,{ref:this.assignForm,action:"/api/v1/publication/invite",onSuccess:this.onSuccess,noInlineErrors:!0,children:[(0,r.FD)("div",{className:"sideBySideWrap",children:[(0,r.Y)("input",{type:"text",name:"name",placeholder:"Name…"}),(0,r.Y)("input",{type:"text",name:"email",placeholder:"Email…"}),(0,r.Y)(d.$n,{priority:"primary",type:"submit",children:"Invite"})]}),(0,r.Y)("div",{id:"error-container"})]})],n&&o>0?(0,r.FD)("p",{children:[(0,r.Y)("br",{}),"Loading…"]}):a.length>0?[(0,r.Y)("h5",{children:"Used invites"}),(0,r.Y)("ul",{children:a.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,r.FD)("li",{children:[e.inviteeUser&&e.inviteeUser.name||""," on"," ",(0,u.A)(e.created_at).standardDate()]}))})]:null]})})}constructor(...e){super(...e),(0,n._)(this,"form",void 0),(0,n._)(this,"assignForm",e=>{this.form=e}),(0,n._)(this,"state",{loading:!0,invites:[]}),(0,n._)(this,"onSuccess",async()=>{alert("Invite sent!"),document.location.reload()})}}},20292:function(e,t,i){i.d(t,{A:()=>s});var n=i(10201),r=i(35369),a=i(76977),l=i(63136),o=i(39318);function s(e){let{pub:t,post:i}=e;return(0,n.FD)(a.I1,{alignItems:"center",className:"container",gap:32,children:[(0,n.FD)(a.I1,{alignItems:"center",gap:4,children:[(0,n.Y)(a.I1,{paddingTop:24,paddingBottom:16,children:(0,n.FD)(l.EY.H1,{children:["You rejected your invite to ",t.name]})}),(0,n.Y)(l.EY.B3,{children:"If you change your mind, you can accept from your email invitation."}),i.is_published?(0,n.FD)(l.EY.B3,{children:["Your byline has been removed from this post: ",(0,n.Y)("a",{href:(0,o.wu9)(t,i),children:i.title})]}):null]}),(0,n.Y)(r.$n,{href:t.base_url,children:"Go to ".concat(t.name)})]})}},38248:function(e,t,i){i.d(t,{A:()=>d});var n=i(10201),r=i(17402),a=i(37767),l=i(5109),o=i(35369),s=i(76977),c=i(63136);function d(e){let{pub:t,user:i,post:d,freeSignup:u,freeSignupEmail:p}=e,[h,m]=(0,r.useState)(!1);if(!d)return(0,n.Y)(s.I1,{paddingTop:32,children:(0,n.FD)("div",{className:"container invite-success",children:[(0,n.FD)("p",{children:["You accepted your invite to ",t.name,"."]}),(0,n.Y)("p",{children:"If you need admin access, ask your inviter to change your status in the publication settings."}),(0,n.FD)("p",{children:["If you expect to be shown on this publication's author list, make sure your"," ",(0,n.Y)(a.A,{onClick:()=>m(!0),children:"profile is up to date"})]}),(0,n.Y)(l.QL,{isOpen:h,onClose:()=>m(!1),user:i,freeSignup:u,freeSignupEmail:p,needsPhoto:!0})]})});let g="podcast"===d.type?"We’ll let you know when the podcast episode goes live":"We’ll let you know when your guest post is live";return(0,n.FD)(s.I1,{alignItems:"center",className:"container",gap:32,children:[(0,n.FD)(s.I1,{alignItems:"center",gap:4,children:[(0,n.Y)(s.I1,{paddingTop:24,paddingBottom:16,children:(0,n.Y)(c.EY.H1,{children:g})}),(0,n.Y)(c.EY.B3,{children:"Your profile is set up and good to go!"})]}),(0,n.Y)(o.$n,{href:t.base_url,children:"Go to ".concat(t.name)})]})}},39352:function(e,t,i){i.d(t,{Z:()=>q});var n=i(79785),r=i(10201),a=i(32485),l=i.n(a),o=i(80697),s=i(93893),c=i(17402),d=i(15734),u=i.n(d),p=i(27437),h=i(17436),m=i(86224),g=i(69277),f=i(70408),v=i(97731);let b=e=>(0,r.Y)(v.A,(0,f._)((0,g._)({},e),{name:"TwitterIcon",svgParams:{height:24,width:24},children:(0,r.Y)("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"})}));var y=i(41181),Y=i(84605),_=i(76977),w=i(63136);i(37764);function C(){let e=(0,n._)(["You're here!"]);return C=function(){return e},e}let k=e=>{let{isSelected:t,tier:i}=e,{iString:n,iTemplate:a,iPlural:l}=(0,Y.GO)(),o={comp_one_month:n("1 month comp"),comp_three_months:n("3 month comp"),comp_six_months:n("6 month comp"),comp_nine_months:n("9 month comp"),comp_twelve_months:n("12 month comp"),custom:n("Custom")};return(0,r.FD)(_.I1,{className:"rewardBox-wSCnji",border:"detail-themed",radius:"md",justifyContent:"space-between",alignItems:"center",flex:"grow",paddingTop:{desktop:20,mobile:20},paddingBottom:{desktop:8,mobile:8},paddingX:{desktop:8,mobile:8},sizing:"border-box",style:{borderColor:t?"var(--color-accent-themed)":void 0},children:[(0,r.Y)(_.Ye,{gap:4,alignItems:"center",children:Array(i.display_order).fill(0).map(()=>(0,r.Y)(y.A,{size:20,fill:"var(--color-accent-themed)",stroke:"var(--color-accent-themed)"}))}),(0,r.Y)(w.EY.H4,{weight:"bold",font:"pub-headings",color:"pub-primary-text",textAlign:"center",textWrap:"balance",children:"custom"===i.reward_type?i.reward_description:o[i.reward_type]}),(0,r.Y)(w.EY.Meta,{weight:"semibold",style:{color:t?"var(--color-accent-themed)":void 0},children:t?a(C()):l("1 Referral","%1 Referrals",i.num_referrals_required)})]})};var S=i(86500),I=i(1683),F=i(12501),D=i(95641),T=i(68349),A=i(24078),E=i(89490),N=i(35369),P=i(45064),x=i(81203),L=i(36372),R=i(39318),M=i(41086),B=i(49807),O=i(57324);let U={wrapper:"wrapper-tJi0TK",headerWrapper:"headerWrapper-EjRfuK",shareButton:"shareButton-JVF5KK",referrerRow:"referrerRow-N5KSEa",referrerRowInverted:"referrerRowInverted-CeLqXo",referrerLink:"referrerLink-nE7Cs1",responsiveHeader:"responsiveHeader-yuaZkv",shareButtons:"shareButtons-xB8IiL"};function j(){let e=(0,n._)(["You’ve qualified for the Tier "," reward."]);return j=function(){return e},e}function z(){let e=(0,n._)(["Refer friends to ",""]);return z=function(){return e},e}function H(){let e=(0,n._)(["Subscribe and invite friends to ",""]);return H=function(){return e},e}function W(){let e=(0,n._)(["No referrers yet. Be the first on ","'s leaderboard by helping them find new readers."]);return W=function(){return e},e}let V=(e,t)=>{(0,S.u4)(S.qY.SHARE_LINK_CLICKED,{name:t,source:"leaderboard"}),e&&(e.startsWith("http")?window.open(e,"_blank"):document.location.href=e)},K=e=>{let{user:t,rank:i,referrals:n,isSelf:a,isHighlighted:o}=e,{iString:s}=(0,Y.GO)();return(0,r.Y)(w.EY,{as:t?"a":"div",href:t?(0,B.rfn)(t.id,t.name):void 0,className:U.referrerLink,children:(0,r.FD)(_.Ye,{sizing:"border-box",style:{width:"100%"},alignItems:"center",border:a||o?"detail-themed":"transparent",radius:"md",paddingLeft:12,paddingY:a?16:8,paddingRight:20,justifyContent:"space-between",className:l()(U.referrerRow,{[U.referrerRowInverted]:!a}),children:[(0,r.FD)(_.Ye,{gap:8,alignItems:"center",children:[(0,r.FD)(w.EY.Digit,{weight:"semibold",paddingRight:4,color:"pub-primary-text",children:[i,"."]}),t?(0,r.Y)(p.ProfileHoverCard,{subject:t,trigger:(0,r.Y)(A.eu,{size:36,user:t})}):(0,r.Y)(A.eu,{size:36}),(0,r.Y)(w.EY.B4,{color:"pub-primary-text",weight:"semibold",children:(null==t?void 0:t.name)||s("Anonymous Reader")})]}),(0,r.Y)(w.EY.B4,{color:"pub-primary-text",weight:"semibold",children:n})]})})},q=e=>{let t,i,{pub:n,user:a,freeSignupEmail:l}=e,{iString:d,iTemplate:p,iPlural:g}=(0,Y.GO)(),f=(0,L.d)(),{result:v,isLoading:y,refetch:C}=(0,F.st)({pathname:"/api/v1/reader_referrals/leaderboard",auto:!0}),{refetch:A}=(0,D.E)({auto:!1,pathname:"/api/v1/subscription/visibilities",method:"post"});if((0,c.useEffect)(()=>{y||v||(0,T.V2)((0,B.$_T)(n))},[v,y,n]),y||!v)return(0,r.Y)("div",{className:"page typography signup-page",children:(0,r.Y)("div",{className:"container"})});let{current_user_stats:q,tiers:G,top_referrers:J,current_user_can_share:$,current_user_id:Z,current_user_profile_hidden:Q}=v,X=null==a?void 0:a.is_admin,ee=null==a?void 0:a.is_contributor,et=(0,M.y)("referrer_token"),ei=a&&!a.is_magic&&a.email||l||null,en=(0,B.yRP)((0,B.$_T)(n),{r:(null==Z?void 0:Z.toString(36))||et});G.find((e,n)=>{let r=(null==q?void 0:q.referrals)||0,a=G[n+1];r>=e.num_referrals_required&&(!a||r<a.num_referrals_required)&&(t=e,i=a)});let er="";return!t&&q?er="".concat(g("You have %1 referral","You have %1 referrals",q.referrals)," - ").concat(g("only %1 more referral to earn your first reward!","only %1 more referrals to earn your first reward!",G[0].num_referrals_required-q.referrals)):t&&i&&q?er="".concat(g("You’ve referred %1 reader!","You’ve referred %1 readers!",q.referrals)," ").concat(p(j(),t.display_order)," ").concat(g("Invite %1 more reader to earn the Tier %2 reward!","Invite %1 more readers to earn the Tier %2 reward!",i.num_referrals_required-q.referrals,i.display_order)):t&&!i&&q&&(er="".concat(g("You’ve referred %1 reader!","You’ve referred %1 readers!",q.referrals)," You’re number #").concat(q.rank," on the leaderboard.")),(0,r.Y)("div",{className:"page typography signup-page",children:(0,r.Y)("div",{className:"container",children:(0,r.FD)(_.I1,{gap:64,className:U.wrapper,children:[(X||ee)&&(0,r.FD)(_.I1,{border:"detail-themed",gap:16,paddingX:24,paddingY:16,radius:"md",children:[(0,r.FD)(_.I1,{gap:4,children:[(0,r.Y)(w.EY.Meta,{color:"pub-primary-text",children:X?"Admin View":"Contributor View"}),(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:d(X?"A view of your leaderboard as it appears to your subscribers. Note: As an admin your referrals will not appear on the leaderboard.":"A view of your leaderboard as it appears to your subscribers. Note: As a contributor your referrals will not appear on the leaderboard.")})]}),X&&(0,r.Y)(N.$n,{priority:"secondary",href:"/publish/settings#referrals",localNavigation:!1,children:d("Edit Referral Settings")})]}),(0,r.Y)(_.I1,{alignItems:"center",children:(0,r.FD)(_.I1,{gap:24,className:U.headerWrapper,alignItems:"center",children:[(0,r.Y)(E.az,{children:(0,r.Y)(x.Nq,{pub:n,size:64})}),(0,r.FD)(_.I1,{alignItems:"center",gap:4,children:[(0,r.Y)(w.EY,{className:U.responsiveHeader,font:"pub-headings",color:"pub-primary-text",align:"center",children:p($||et?z():H(),n.name)}),(0,r.FD)(w.EY.B3,{translated:!0,color:"pub-secondary-text",align:"center",className:U.introText,children:["Show your support by sharing ",I18N.p(n.name)," and earn rewards for your referrals."]})]}),!$&&!et&&!(ee||X)&&(0,r.Y)(_.I1,{style:{width:"100%"},children:(0,r.Y)(N.$n,{flex:"grow",priority:"primary",onClick:async e=>{let t;e.preventDefault();try{if(ei){let e=await u().post("/api/v1/free").send({source:"referral-leaderboard",email:ei,first_url:I.R9,first_referrer:I.b7,current_url:I.AT,current_referrer:I.uC,first_session_url:I.K0,first_session_referrer:I.OG});t=e.body.referral_token,(0,S.$5)(e.body.requires_confirmation)}}catch(e){(0,S.u4)(S.qY.FREE_SIGNUP_FAILED,{reason:e.message,source:"referral-leaderboard"})}window.location.href=(0,B.eV6)(n,{addBase:!0,params:{simple:!0,next:document.location.href,utm_source:O.VU.referralLeaderboard,utm_medium:O.Jn.web,skip_redirect_check:!0,just_signed_up:!0,referral_token:t}})},href:(0,B.yRP)("/subscribe",{next:(0,B.tLs)(n,void 0,{addBase:!0}),utm_source:O.VU.referralLeaderboard}),localNavigation:!1,children:(0,r.FD)(_.Ye,{alignItems:"center",gap:8,children:[(0,r.Y)(o.A,{size:20}),d("Subscribe")]})})})]})}),($||ee||X||et)&&(0,r.FD)(_.I1,{alignItems:"center",gap:16,style:{width:"100%"},children:[(0,r.Y)(_.Ye,{style:{width:"100%"},children:(0,r.Y)(P.c,{value:en})}),(0,r.FD)(_.pT,{className:U.shareButtons,gap:{desktop:16,mobile:8},style:{width:"100%"},children:[(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(b,{width:18,height:18,style:{paddingTop:2}}),onClick:()=>V((0,R.gKg)({url:en,text:n.name}),"twitter"),children:"Twitter"}),(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(m.A,{height:20,width:20}),onClick:()=>V((0,B.yRP)("https://www.facebook.com/sharer/sharer.php",{u:en}),"facebook"),children:"Facebook"}),(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(h.A,{strokeWidth:1,height:20,width:20,style:{paddingTop:2}}),onClick:()=>V((0,B.yRP)("mailto:",{subject:n.name,body:en}),"email"),children:"Email"})]})]}),(0,r.FD)(_.I1,{alignItems:"start",style:{width:"100%"},gap:16,children:[(0,r.Y)(w.EY.H3,{translated:!0,font:"pub-headings",color:"pub-primary-text",children:"Rewards and Progress"}),(0,r.Y)(_.Ye,{gap:{desktop:16,mobile:12},style:{width:"100%"},children:G.map(e=>(0,r.Y)(k,{tier:e,isSelected:e.display_order===(null==t?void 0:t.display_order)},e.display_order))}),$&&q&&(0,r.FD)(_.I1,{gap:8,style:{width:"100%"},alignItems:"center",children:[(0,r.Y)(K,{user:a,isSelf:!0,referrals:q.referrals,rank:q.rank}),!Q&&(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:er}),Q&&(0,r.FD)(_.Ye,{sizing:"border-box",style:{width:"100%"},alignItems:"center",border:"detail-themed",radius:"md",paddingX:12,paddingY:16,justifyContent:"space-between",bg:"secondary",gap:32,children:[(0,r.FD)(_.I1,{gap:4,children:[(0,r.Y)(w.EY.B4,{translated:!0,weight:"semibold",color:"pub-primary-text",children:"Your subscription is private"}),(0,r.FD)(w.EY.B4,{translated:!0,color:"pub-secondary-text",children:["To appear on the leaderboard, turn on visibility for ",I18N.p(n.name)]})]}),(0,r.Y)(N.$n,{priority:"primary",onClick:async()=>{await A({body:{ids:[v.current_user_subscription_id],visibility:"public"}}),C(),f.popToast(()=>(0,r.Y)(L.y,{text:"".concat(n.name," is now visible on your profile!")}))},children:d("Show on profile")})]})]})]}),(0,r.FD)(_.I1,{alignItems:"start",style:{width:"100%"},gap:16,children:[(0,r.Y)(w.EY.H3,{translated:!0,font:"pub-headings",color:"pub-primary-text",children:"Leaderboard"}),(null==J?void 0:J.length)===0&&(0,r.FD)(_.I1,{alignItems:"center",justifyContent:"center",paddingX:48,sizing:"border-box",style:{width:"100%",minHeight:350},gap:4,border:"detail-themed",radius:"md",children:[(0,r.Y)(s.A,{size:22,stroke:"var(--color-fg-secondary-themed)"}),(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:p(W(),n.name)})]}),(null==J?void 0:J.length)>0&&(0,r.FD)(_.I1,{gap:8,style:{width:"100%"},children:[(0,r.FD)(_.Ye,{alignItems:"center",style:{width:"100%"},justifyContent:"space-between",paddingBottom:2,children:[(0,r.Y)(w.EY.Meta,{translated:!0,weight:"semibold",children:"Referrer"}),(0,r.Y)(w.EY.Meta,{translated:!0,weight:"semibold",children:"Referrals"})]}),null==J?void 0:J.map(e=>(0,r.Y)(K,{user:e.user,isHighlighted:e.isCurrentUser,rank:e.rank,referrals:e.referrals},e.rank))]})]})]})})})}},83704:function(e,t,i){i.d(t,{J:()=>d});var n=i(10201),r=i(48697),a=i(68349),l=i(35369),o=i(39318),s=i(41086),c=i(62227);let d=e=>{let{pub:t}=e;return(0,n.Y)(l.K0,{onClick:()=>{let e=(0,s.y)("referrer"),i=null!=e?e:(0,o.fOI)(t);(0,a.V2)(i,{local_navigation:!1})},className:c.A.closeButton,size:"sm",priority:"secondary-outline",children:(0,n.Y)(r.A,{size:20})})}},20771:function(e,t,i){i.d(t,{H:()=>c});var n=i(10201),r=i(13022),a=i(24078),l=i(76977),o=i(81203),s=i(62227);let c=e=>{let{pub:t,user_id:i,user_profile_photo_url:c,children:d}=e;return(0,r.y0)("meetings_embed_publication_name")?(0,n.FD)(l.I1,{gap:20,alignItems:"center",paddingTop:32,children:[(0,n.Y)(o.Nq,{className:s.A.pubLogo,pub:t,size:112}),d]}):(0,n.FD)(l.I1,{gap:20,alignItems:"center",paddingTop:32,children:[(0,n.FD)("div",{className:s.A.avatarWithPubLogo,children:[(0,n.Y)(a.eu,{className:s.A.avatar,user:{id:i,photo_url:c},size:112}),(t.logo_url||t.cover_photo_url)&&(0,n.Y)(o.Nq,{className:s.A.pubAvatar,pub:t,size:40})]}),d]})}},33107:function(e,t,i){i.d(t,{p:()=>V});var n=i(69277),r=i(32641),a=i(10201),l=i(17402),o=i(13022),s=i(68349),c=i(20771),d=i(82853),u=i(35404),p=i(35369),h=i(76977),m=i(63136),g=i(36372),f=i(16291),v=i(49807),b=i(82776);let y={meetingDetails:"meetingDetails-vrQSc_"},Y=e=>{var t,i,n,r,l,o,c,f,y,Y,_,w,C,k,S,I,F,D,T,A,E,N,P,x,L,R,M,B,O,U,j,z,H,W,V,K;let{order:q,isStatic:G=!1,pub:J=null}=e,$=(0,g.d)(),{href:Z,label:Q,copyContent:X}=(t=q,i=G,n=J,(null==(r=t.location)?void 0:r.location)||(null==(l=t.location)?void 0:l.join_url)?({zoom:{href:null==(o=t.location)?void 0:o.join_url,copyContent:null==(c=t.location)?void 0:c.join_url,label:"Join Zoom"},zoom_conference:{href:null==(f=t.location)?void 0:f.join_url,copyContent:null==(y=t.location)?void 0:y.join_url,label:"Join Zoom"},google:{href:null==(Y=t.location)?void 0:Y.join_url,copyContent:null==(_=t.location)?void 0:_.join_url,label:"Join Meet"},google_conference:{href:null==(w=t.location)?void 0:w.join_url,copyContent:null==(C=t.location)?void 0:C.join_url,label:"Join Meet"},inbound_call:{href:"tel:".concat(null==(k=t.location)?void 0:k.location),copyContent:null==(S=t.location)?void 0:S.location,label:null==(I=t.location)?void 0:I.location},outbound_call:{href:null,label:"".concat((0,b.guessFirstName)(t.user_name)," will call you at ").concat(null==(F=t.location)?void 0:F.location)},microsoft_teams:{href:null==(D=t.location)?void 0:D.join_url,copyContent:null==(T=t.location)?void 0:T.join_url,label:"Join Teams"},microsoft_teams_conference:{href:null==(A=t.location)?void 0:A.join_url,copyContent:null==(E=t.location)?void 0:E.join_url,label:"Join Teams"},webex:{href:null==(N=t.location)?void 0:N.join_url,copyContent:null==(P=t.location)?void 0:P.join_url,label:"Join Webex"},webex_conference:{href:null==(x=t.location)?void 0:x.join_url,copyContent:null==(L=t.location)?void 0:L.join_url,label:"Join Webex"},gotomeeting:{href:null==(R=t.location)?void 0:R.join_url,copyContent:null==(M=t.location)?void 0:M.join_url,label:"Join GoToMeeting"},gotomeeting_conference:{href:null==(B=t.location)?void 0:B.join_url,copyContent:null==(O=t.location)?void 0:O.join_url,label:"Join GoToMeeting"},physical:{href:null,label:null!=(W=null==(U=t.location)?void 0:U.location)?W:"Unknown"},ask_invitee:{href:null,label:null!=(V=null==(j=t.location)?void 0:j.location)?V:"Unknown"},custom:{href:null,label:null!=(K=null==(z=t.location)?void 0:z.location)?K:"Unknown"}})[null==(H=t.location)?void 0:H.type]||{}:i&&n?{href:(0,v.vrI)(n,t.id,{addBase:!0}),label:"View here"}:{href:null,label:"Processing..."}),ee=(0,a.Y)(m.EY.B3,{align:"right",children:Z?(0,a.Y)("a",{href:Z,children:Q}):Q});return G||!X?ee:(0,a.FD)(h.Ye,{gap:4,alignItems:"center",children:[ee,(0,a.Y)(p.K0,{size:"sm",onClick:()=>{(0,s.lW)(X),$.popToast(()=>(0,a.Y)(g.y,{Icon:d.A,text:"Copied link to clipboard"}))},children:(0,a.Y)(u.A,{height:20})})]})},_=e=>{var t,i;let{order:n,pub:r}=e,l=(0,f.A)(null!=(t=n.start_time)?t:void 0),o=(0,f.A)(null!=(i=n.end_time)?i:void 0),s="".concat(l.format("MMMM D, YYYY")," at ").concat(l.format("h:mm A z")),c=o.diff(l,"minute");return(0,a.FD)(h.I1,{gap:8,className:y.meetingDetails,children:[(0,a.FD)(h.Ye,{justifyContent:"space-between",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Time"}),(0,a.Y)(m.EY.B3,{children:s})]}),(0,a.FD)(h.Ye,{justifyContent:"space-between",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Length"}),(0,a.FD)(m.EY.B3,{children:[c," minutes"]})]}),(0,a.FD)(h.Ye,{justifyContent:"space-between",alignItems:"center",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Location"}),(0,a.Y)(Y,{order:n,pub:r})]}),(0,a.Y)(m.EY.B3,{align:"center",className:y.description,paddingTop:16,children:(0,a.Y)("i",{children:n.description})})]})};var w=i(39318),C=i(41086);let k=e=>{let{booking:t,settings:i,pub:n}=e,r=(0,o.y0)("meetings_embed_publication_name")?n.name:t.user_name;return t.cancelled_at?(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:n,user_id:i.user_id,user_profile_photo_url:i.user_profile_photo_url,children:(0,a.FD)(m.EY.H2,{align:"center",children:["Your meeting with ",r," has been cancelled"]})}),t.cancellation_reason&&(0,a.FD)(a.FK,{children:[(0,a.Y)(m.EY.B3,{align:"center",paddingBottom:16,children:"The author provided the following reason:"}),(0,a.Y)(m.EY.B4,{align:"center",paddingBottom:32,children:t.cancellation_reason})]}),t.refunded_at&&(0,a.Y)(m.EY.B3,{align:"center",children:"A refund has been issued to your original form of payment."}),i.enabled&&(0,a.Y)(m.EY.B3,{align:"center",paddingBottom:16,children:(0,a.FD)(a.FK,{children:["You can book another meeting"," ",(0,a.Y)("a",{href:(0,v.SJN)(n,{params:{source:"cancellation-rebook"}}),children:"here"}),"."]})})]}):(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:n,user_id:i.user_id,user_profile_photo_url:i.user_profile_photo_url,children:(0,a.FD)(m.EY.H2,{align:"center",children:["Your meeting with ",r," has been ",t.num_rebookings>0?"rebooked":"booked"]})}),(0,a.FD)(h.I1,{gap:16,alignItems:"center",children:[(0,a.Y)(_,{order:t,pub:n}),(0,a.Y)(m.EY.B4,{align:"center",children:"A confirmation of your booking has been emailed to you."}),t.refunded_at&&(0,a.Y)(m.EY.B4,{align:"center",children:"A refund has been issued to your original form of payment."}),(0,a.Y)(p.$n,{onClick:()=>{let e=(0,C.y)("referrer"),t=null!=e?e:(0,w.fOI)(n);(0,s.V2)(t,{local_navigation:!1})},children:"Done"})]})]})};var S=i(44383),I=i.n(S),F=i(48697),D=i(15734),T=i.n(D),A=i(34206),E=i(15809),N=i(86500),P=i(58326),x=i(11587),L=i(65842),R=i(66511),M=i(72879),B=i(18189);let O=e=>{let{stripe_publishable_key:t,onComplete:i,user:n,pub:r,booking:s,settings:d}=e,[u,g]=(0,l.useState)(s.name),[f,v]=(0,l.useState)(s.description),[y,Y]=(0,l.useState)(null),[_,w]=(0,l.useState)(null),[C,k]=(0,l.useState)(null),[S,D]=(0,l.useState)(null),[O,U]=(0,l.useState)(!1),[j,z]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=(0,A.YV)(t,r),i=e&&(0,A.Me)(e);w(e),k(i)},[r,t,w,k]),(0,l.useEffect)(()=>{(0,N.u4)(B.q.MEETING_ORDER_PAGE_VIEWED,{user_id:n.id,publication_id:r.id})},[]),(0,l.useEffect)(()=>{(async()=>{var e;let t=await T().get("/api/v1/subscription/last4");(null==(e=t.body)?void 0:e.last4)&&D(t.body.last4)})()},[r]);let{price:H,duration:W,subscriber_price:V,founding_price:K,currency:q}=d.selected_event_type,G=H;n.is_subscribed&&V&&(G=V),n.is_founding&&K&&(G=K);let J=!!(null==n?void 0:n.has_saved_payment),$=(0,l.useCallback)(async()=>C?_?await _.createToken(C):{token:null,error:{message:""}}:(console.error("stripeCard is null, cannot createToken"),{token:null,error:{message:"Internal error"}}),[_,C]),Z=(0,l.useCallback)(async()=>{let e;if(U(!0),z(null),!J){let{token:t,error:i}=await $();if(i){U(!1),z(i&&i.message),(0,N.u4)(B.q.MEETING_MISSING_PAYMENT,{type:i&&"type"in i&&i.type,code:i&&"code"in i&&i.code,decline_code:i&&"decline_code"in i&&i.decline_code,reason:i&&i.message});return}e=t}let t=new FormData;t.append("name",u),t.append("description",f),e&&t.append("stripe_token",JSON.stringify(e)),y&&t.append("attachment",y);let a=Intl.DateTimeFormat().resolvedOptions().timeZone;a&&t.append("timezone",a),(0,N.u4)(B.q.MEETING_SUBMIT_PRESSED,{publication_id:r.id,user_id:n.id});try{let e=await T().post("/api/v1/meetings/book").send(t);history.pushState({},"","/meetings/book/".concat(e.body.order_id)),i("schedule",I()(e.body,["order_id","calendly_scheduling_uri","name","email","description"]))}catch(e){var l,o,s,c;(null==(o=e.response)||null==(l=o.body)?void 0:l.error)?z(null==(c=e.response)||null==(s=c.body)?void 0:s.error):z("Something went wrong.")}U(!1)},[u,f,$,y,U,z]),Q=!!u&&!!f;return(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:r,user_id:d.user_id,user_profile_photo_url:d.user_profile_photo_url,children:(0,a.FD)("div",{children:[(0,a.Y)(m.EY.H2,{align:"center",size:20,children:"Book a meeting with"}),(0,a.Y)(m.EY.H2,{align:"center",paddingTop:4,children:(0,o.y0)("meetings_embed_publication_name")?r.name:d.user_name}),(0,a.FD)(m.EY.B3,{align:"center",paddingTop:8,children:[G<H&&(0,a.Y)("span",{className:"originalPrice-OtRI61",children:(0,b.centsToPriceString)(H,q)}),(0,b.centsToPriceString)(G,q)," \xb7 ",W,"-minute meeting"]})]})}),(0,a.FD)(h.I1,{gap:32,children:[(0,a.Y)(M.M,{alignment:"vertical",label:"Your name",children:(0,a.Y)(L.ks,{name:"name",value:u||"",onChange:e=>g(e.currentTarget.value),placeholder:"Name...",disabled:O,maxLength:500})}),(0,a.Y)(M.M,{alignment:"vertical",label:"What do you want to talk about?",children:(0,a.Y)(x.T,{name:"description",value:f,onChange:e=>v(e.currentTarget.value),rows:4,maxLength:1e3,placeholder:"E.g. I’m really interested in knowing...",disabled:O})}),y?(0,a.FD)("div",{children:[(0,a.Y)(m.EY.B4,{weight:"semibold",paddingBottom:8,children:"Add an attachment (optional)"}),(0,a.FD)(h.Ye,{className:"fileAttachment-fKUmWJ",gap:8,alignItems:"center",flex:"auto",children:[(0,a.Y)(F.A,{onClick:()=>Y(null),className:"fileRemoveIcon-fRmA6k",height:24}),(0,a.Y)(m.EY.B3,{className:"fileName-yGqqsU",children:y.name})]})]}):(0,a.FD)("div",{children:[(0,a.Y)(m.EY.B4,{weight:"semibold",paddingBottom:8,children:"Add an attachment (optional)"}),(0,a.Y)(P.N,{className:"filePicker-sGpV6W",onFileSelected:e=>Y(e),acceptableTypes:".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/pdf, image/*, audio/*, video/*, .pdf, .xls, .xlsx"})]}),(0,a.FD)("div",{className:"checkoutBox-B3gOs5",children:[J&&(0,a.FD)(h.Ye,{className:"savedCard-bAi8SY",padding:12,gap:12,children:[(0,a.Y)(E.A,{className:"cardOnFileIcon-CDsU3Y"}),(0,a.Y)(m.EY.B4,{children:S?"**** **** **** ".concat(S):"Use card on file"})]}),!J&&C&&(0,a.Y)(A.Oo,{className:"input-FRaHpS",element:C}),j&&(0,a.Y)(m.EY.B4,{paddingTop:12,className:"errorContainer-TdnCG0",children:j}),(0,a.Y)(h.pT,{paddingTop:12,children:(0,a.Y)(R.m_,{text:d.enabled?"You must provide your name and a topic for the meeting before booking.":"You must enable Meetings before one can be booked.",disabled:O||Q&&d.enabled,children:(0,a.Y)(p.$n,{className:"button-qJPITd",flex:"grow",type:"submit",onClick:Z,disabled:O||!Q||!d.enabled,children:O?"Loading...":"Book meeting"})})})]})]}),(0,a.FD)(m.EY,{className:"tos-KUjQ2h",paddingBottom:16,size:14,align:"center",color:"secondary",children:["By booking, you will be automatically signed up for a free subscription to ",r.name,". Additionally, you agree to Substack's"," ",(0,a.Y)("a",{href:"https://substack.com/tos",target:"__blank",children:"Terms of Service"}),", our"," ",(0,a.Y)("a",{href:"https://substack.com/privacy",target:"__blank",children:"Privacy Policy"}),", and our"," ",(0,a.Y)("a",{href:"https://substack.com/ccpa#personal-data-collected",target:"__blank",children:"Information Collection Notice"}),"."]})]})};var U=i(64154),j=i(17988),z=i(57820);let H=e=>{let{booking:t,onComplete:i,settings:n,pub:r}=e,[s,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1),{duration:g}=n.selected_event_type,f=(0,o.y0)("meetings_embed_publication_name")?r.name:t.user_name,v=(0,j.useMediaQuery)({maxWidth:698});return((0,U.yl)({onEventScheduled:async e=>{var n,r,a;let l=null==(a=e.data)||null==(r=a.payload)||null==(n=r.event)?void 0:n.uri;d(!0);try{let e=await T().put("/api/v1/meetings/order/".concat(t.order_id)).send({calendly_event_uri:l});await new Promise(e=>setTimeout(e,2e3)),i("confirmation",e.body)}catch(e){p(!0)}}}),u)?(0,a.Y)(c.H,{pub:r,user_id:n.user_id,user_profile_photo_url:n.user_profile_photo_url,children:(0,a.Y)(m.EY.H2,{align:"center",children:"Something went wrong with your booking. Please contact meetings@substackinc.com."})}):s?(0,a.Y)(h.pT,{justifyContent:"center",children:(0,a.Y)(z.y$,{})}):(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:r,user_id:n.user_id,user_profile_photo_url:n.user_profile_photo_url,children:(0,a.FD)("div",{children:[(0,a.FD)(m.EY.H2,{align:"center",children:[t.num_rebookings>0?"Rebook":"Book"," your meeting with ",f]}),(0,a.FD)(m.EY.B3,{align:"center",paddingTop:8,children:["Schedule your ",g,"-minute meeting"]})]})}),"undefined"!=typeof window&&t.calendly_scheduling_uri&&(0,a.Y)(U.Cs,{iframeTitle:"calendly",url:"".concat(t.calendly_scheduling_uri,"?hide_gdpr_banner=1"),prefill:{name:t.name||"",email:t.email,customAnswers:{a1:t.description}},styles:{minWidth:"320px",height:"700px",marginTop:v?"0px":"-66px"}})]})};var W=i(83704);let V=e=>{let{stripe_publishable_key:t,pub:i,user:o,order:s,order_id:c,settings:d}=e,u=c?s.calendly_scheduling_uri?"schedule":"confirmation":"order",[p,m]=(0,l.useState)(u),[g,f]=(0,l.useState)((0,n._)({name:o.name,email:o.email,description:""},s)),v=(e=>{var{step:t}=e,i=(0,r._)(e,["step"]);switch(t){case"order":return(0,a.Y)(O,(0,n._)({},i));case"schedule":return(0,a.Y)(H,(0,n._)({},i));case"confirmation":return(0,a.Y)(k,(0,n._)({},i))}})({step:p,booking:g,settings:d,order:s,onComplete:(e,t)=>{f((0,n._)({},g,t)),m(e)},pub:i,stripe_publishable_key:t,user:o,orderId:c});return(0,a.FD)(a.FK,{children:[(0,a.Y)(W.J,{pub:i}),(0,a.Y)(h.pT,{style:{minHeight:"var(--full-height)"},bg:"secondary",alignItems:"center",justifyContent:"center",children:(0,a.Y)(h.I1,{paddingX:24,gap:32,style:{width:"schedule"===p?"100%":450,maxWidth:"100%",boxSizing:"border-box"},children:v})})]})}},62724:function(e,t,i){i.d(t,{V:()=>_});var n=i(10201),r=i(32485),a=i.n(r),l=i(57423),o=i(68309),s=i(17402),c=i(86500),d=i(13022),u=i(83704),p=i(20771),h=i(35369),m=i(76977),g=i(63136),f=i(56458),v=i(39318),b=i(41086),y=i(82776),Y=i(62227);let _=e=>{var t,i,r,_;let{pub:w,user:C,settings:k}=e,{selected_event_type:{price:S,subscriber_price:I,founding_price:F,currency:D,description_html:T,duration:A,num_availabilities:E},user_name:N}=k,P=S,x=null;null!=(i=null==(t=w.plans)?void 0:t.length)&&i&&((null==C?void 0:C.is_subscribed)&&I&&(P=I,x="SUBSCRIBER DISCOUNT"),(null==C?void 0:C.is_founding)&&F&&(P=F,x="".concat(null==(r=(0,f.m4)(w)||"FOUNDING")?void 0:r.toUpperCase()," DISCOUNT"))),(0,s.useEffect)(()=>{var e,t;(0,c.u4)(c.qY.MEETING_PAGE_VIEWED,{publication_id:w.id,user_id:C.id,referrer:null!=(e=(0,b.y)("referrer"))?e:null,source:null!=(t=(0,b.y)("source"))?t:null})},[]);let L=null!=(_=(0,b.y)("referrer"))?_:void 0,R=(0,v.oRR)("/meetings/book",{referrer:L}),M=E>0,B=T?{__html:T.replace(/<br>/g,"")}:{__html:""};return(0,n.FD)(n.FK,{children:[(0,n.Y)(u.J,{pub:w}),(0,n.Y)(m.I1,{style:{minHeight:"var(--full-height)"},bg:"secondary",alignItems:"center",justifyContent:"center",children:(0,n.FD)(m.I1,{paddingX:24,gap:32,style:{width:400,maxWidth:"100%",boxSizing:"border-box"},children:[(0,n.Y)(p.H,{pub:w,user_id:k.user_id,user_profile_photo_url:k.user_profile_photo_url,children:(0,n.FD)("div",{children:[(0,n.Y)(g.EY.H2,{align:"center",size:20,children:"Book a meeting with"}),(0,n.Y)(g.EY.H2,{align:"center",paddingTop:4,children:(0,d.y0)("meetings_embed_publication_name")?w.name:N})]})}),(0,n.FD)(m.I1,{bg:"primary",className:a()(Y.A.offer,{[Y.A.unavailable]:!M}),radius:"md",shadow:"xl",padding:20,children:[x&&(0,n.Y)("div",{className:Y.A.displayedBadge,children:x}),(0,n.FD)(m.Ye,{justifyContent:"space-between",paddingBottom:16,children:[(0,n.Y)(m.I1,{children:P&&D&&A&&(0,n.FD)(n.FK,{children:[(0,n.FD)(g.EY.H3,{color:M?"primary":"secondary",children:[A,"-minute meeting"]}),(0,n.FD)(g.EY.B4,{color:M?"primary":"secondary",paddingTop:4,children:[P<S&&(0,n.Y)("span",{className:Y.A.originalPrice,children:(0,y.centsToPriceString)(S,D)}),(0,y.centsToPriceString)(P,D)," \xb7"," ",M?E>50?"Many availabilities":"".concat((0,y.pluralize)(E,"slot")," available this month"):"No slots available in the next week"]})]})}),M?(0,n.Y)(l.A,{className:Y.A.check,size:28}):(0,n.Y)(o.A,{size:28,className:Y.A.disabledCheck})]}),(0,n.Y)(g.EY.B4,{color:"secondary",children:(0,n.Y)("div",{className:Y.A.description,dangerouslySetInnerHTML:B})})]}),(0,n.Y)(h.$n,{className:Y.A.button,disabled:!M,flex:"grow",localNavigation:!1,href:R,children:M?"Continue to book":"No meetings available"})]})})]})}},94255:function(e,t,i){i.d(t,{j:()=>l});var n=i(10201),r=i(79909),a=i(39318);let l=e=>{let{subdomain:t}=e;return(0,n.FD)("div",{className:"page typography signup-page",path:"/not-found",children:[(0,n.Y)(r.Metadata,{title:"Not Found"}),(0,n.FD)("div",{className:"container",children:[(0,n.Y)("h2",{children:"Not Found"}),(0,n.Y)("p",{children:"The page you are attempting to access is not found."}),(0,n.Y)("p",{children:"If you want to claim this URL you can start a Substack today"}),(0,n.Y)("p",{children:(0,n.Y)("a",{href:(0,a.f5H)(),class:"button primary",rel:"nofollow",children:"Start a Substack"})}),(0,n.Y)("p",{children:(0,n.FD)("a",{href:(0,a.Tvl)({query:t,params:{searching:"publication"}}),children:['Search Substack for "',t,'"']})})]})]})}},56519:function(e,t,i){i.d(t,{x:()=>w});var n=i(10201),r=i(95201),a=i.n(r),l=i(17402),o=i(15734),s=i.n(o),c=i(79192),d=i(84605),u=i(25006),p=i(85478),h=i(46271),m=i(68349),g=i(12592),f=i(12387),v=i(35369),b=i(76977),y=i(57820),Y=i(63136),_=i(39318);let w=()=>{let e=(0,h.Jd)(),t=(0,u.df)(),{iString:i}=(0,d.GO)(),{getConfigFor:r}=(0,p.mJ)(),[o,w]=(0,l.useState)([]),[C,k]=(0,l.useState)(!0),[S,I]=(0,l.useState)(null),F=(0,l.useCallback)(async()=>{try{k(!0),I(null);let e=await s().get("/api/v1/sponsorship-perks/subscriber");w(e.body.perks||[])}catch(e){console.error("Failed to load perks:",e),I(i("Failed to load rewards. Please try again later."))}finally{k(!1)}},[i]);(0,l.useEffect)(()=>{F()},[F]);let D=r("enable_sponsorship_perks");if((0,l.useEffect)(()=>{D||(window.location.href="/")},[D]),!D)return(0,n.Y)(n.FK,{});function T(e){let{perk:t}=e,{iString:i}=(0,d.GO)(),[r,o]=(0,l.useState)(null),[c,u]=(0,l.useState)(!1),p=async()=>{if("one-time-code"===t.type)try{u(!0);let e=(await s().post("/api/v1/sponsorship-perks/".concat(t.id,"/redeem"))).body;e.success&&o(e.code)}catch(t){var e;alert(null!=(e=(0,m.uX)(t))?e:"Failed to redeem code. Please try again later.")}finally{u(!1)}else o(t.universal_value)};return(0,n.FD)(b.I1,{gap:16,padding:24,border:"detail",radius:"md",bg:"primary",justifyContent:"space-between",style:{maxWidth:250},children:[(0,n.Y)("img",{src:t.image_url,alt:t.title,style:{width:"100%"}}),(0,n.FD)(b.I1,{gap:16,children:[(0,n.Y)(b.I1,{gap:8,children:(0,n.Y)(Y.EY.H3,{children:t.title})}),(0,n.Y)(Y.EY.B2,{style:{wordWrap:"break-word"},children:(0,n.Y)(a(),{options:{target:"_blank",attributes:{rel:"noopener noreferrer"}},children:t.description})}),(0,n.Y)(b.I1,{gap:12,children:r?(0,n.FD)(b.I1,{gap:8,padding:12,style:{backgroundColor:"var(--color-bg-secondary)",borderRadius:4},children:[(0,n.Y)(Y.EY.B3,{children:i("universal-link"===t.type?"Your reward link:":"Your code:")}),"universal-link"===t.type?(0,n.Y)("a",{rel:"noopener noreferrer",target:"_blank",href:r,children:r}):(0,n.Y)(Y.EY.B2,{style:{fontFamily:"monospace",fontWeight:600,color:"var(--color-accent-primary)",wordBreak:"break-all"},children:r})]}):(0,n.Y)(v.$n,{priority:"primary",onClick:p,loading:c,disabled:t.is_redeemed&&"one-time-code"===t.type,children:i(t.is_redeemed&&"one-time-code"===t.type?"Already Redeemed":"universal-link"===t.type?"Get Link":"Reveal Code")})})]})]})}return e?C?(0,n.Y)("div",{className:"page typography",children:(0,n.Y)(c.Z,{children:(0,n.Y)(g.c,{children:(0,n.FD)(b.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,n.Y)(y.y$,{}),(0,n.Y)(Y.EY.B1,{children:i("Loading perks...")})]})})})}):(0,n.Y)("div",{className:"page typography",children:(0,n.Y)(c.Z,{children:(0,n.Y)(g.c,{children:(0,n.FD)(b.I1,{gap:48,alignItems:"center",children:[(0,n.FD)(b.I1,{gap:16,alignItems:"center",textAlign:"center",children:[(0,n.Y)(Y.EY.H1,{children:i("Subscriber Perks")}),(0,n.FD)(Y.EY.B1,{translated:!0,children:["Exclusive perks for ",I18N.p((null==t?void 0:t.name)||"")," subscribers"]})]}),S&&(0,n.Y)(f.F,{description:S}),!S&&(0,n.Y)(n.FK,{children:0===o.length?(0,n.FD)(b.I1,{gap:24,alignItems:"center",textAlign:"center",children:[(0,n.Y)(Y.EY.H2,{children:i("No perks available")}),(0,n.Y)(Y.EY.B1,{children:i("There are currently no subscriber rewards available at your subscription level.")})]}):(0,n.Y)(b.Ye,{wrap:"wrap",gap:16,style:{maxWidth:600},alignItems:"center",justifyContent:"center",children:o.map(e=>(0,n.Y)(T,{perk:e},e.id))})}),(0,n.FD)(Y.EY.B4,{translated:!0,children:["Gift a subscription from the"," ",(0,n.Y)("a",{native:!0,href:"/account",children:"account page"}),"."]})]})})})}):(0,n.Y)("div",{className:"page typography",children:(0,n.Y)(c.Z,{children:(0,n.Y)(g.c,{children:(0,n.FD)(b.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,n.Y)(Y.EY.H1,{children:i("Subscriber Perks")}),(0,n.Y)(Y.EY.B1,{children:i("Subscribe or Sign In to access subscriber perks")}),(0,n.Y)(v.$n,{priority:"primary",localNavigation:!1,href:(0,_.my9)(t,{utm_source:"perks_page",next:"/perks"}),children:i("Subscribe")})]})})})})}},49032:function(e,t,i){i.d(t,{E:()=>e7});var n=i(99851),r=i(69277),a=i(70408),l=i(10201),o=i(32485),s=i.n(o),c=i(17159),d=i.n(c),u=i(83673),p=i.n(u),h=i(69843),m=i.n(h),g=i(87677),f=i(15977),v=i(99862),b=i(17402),y=i(15734),Y=i.n(y),_=i(37343),w=i(28308),C=i(89333),k=i(9266),S=i(67616),I=i(6212),F=i(13950),D=i(55136),T=i(7e4),A=i(97432),E=i(10996);function N(e){let{children:t}=e;return(0,l.Y)(E.NP,{theme:"pubInvertedTheme-U483dz",children:t})}var P=i(84605),x=i(89490),L=i(35369),R=i(63136),M=i(39318),B=i(82776),O=i(57324);function U(e){let{user:t,freeSignup:i,freeSignupEmail:n,publication:r}=e,{iString:a,language:o}=(0,P.GO)(),s=!!t&&t.is_subscribed,c=!!i||!!t&&t.is_free_subscribed&&!t.is_contributor;return s||c&&!r.plans?null:(0,l.Y)(N,{children:(0,l.Y)(j,{children:(0,l.FD)(z,{children:[(0,l.Y)(R.EY.H3,{weight:"semibold",color:"primary",textAlign:"center",children:a("Ready for more?")}),c?(0,l.Y)(L.$n,{priority:"primary",href:(0,M.eV6)(r,{utm_source:O.VU.readyForMore}),className:"cta-HDi22T",native:!0,children:(0,B.getSubscribeText)(r,{language:o,isFreeSubscribed:c})}):(0,l.Y)(A.A,{freeSignupEmail:n,onAccentBackground:!0,pub:r,source:O.VU.subscribeFooter,submitButtonText:(0,B.getSubscribeText)(r),user:t,onSuccess:e=>{if(r.plans){let i=(0,M.eV6)(r,{just_signed_up:!0,referral_token:e.body.referral_token});if(e.body.prompt_to_login){var t;i="/account/login?redirect=".concat(encodeURIComponent(i),"&email=").concat(encodeURIComponent(null!=(t=e.body.email)?t:""))}document.location.href=i}else window.location.reload()}})]})})})}let j=(0,x.I4)({display:"flex",direction:"column",alignItems:"center",justifyContent:"center",bg:"primary",padding:{desktop:48,mobile:24},className:"container-jsOc9L"}),z=(0,x.I4)({display:"flex",direction:"column",alignItems:"center",gap:24,wrap:"wrap",className:"content-jLbYeh"});var H=i(61193),W=i(77481),V=i(19449),K=i(82011),q=i(15894),G=i(32600),J=i(85478),$=i(17306),Z=i(68410),Q=i(76977),X=i(75303),ee=i(18742);let et=e=>{let{bio:t,byline:i,name:n,photoUrl:o,pub:s}=e,{getConfigFor:c}=(0,J.mJ)(),{isMobile:d}=(0,Z.sM)(),{markdownProps:u}=(0,$.$)(t),{hasSection:p}=(0,G.C)(i.id),h=(0,M.gYq)(i);if(c("enable_author_pages")){var m;h=null!=(m=(0,M.cxh)({userId:i.id,pub:s}))?m:h}return(0,l.FD)(Q.pT,{className:"authorInfo-uQxGwM",direction:d?"column":"row",gap:16*!!d,padding:24*!!d,position:"relative",children:[(0,l.FD)(X.AE,{href:h,native:!0,children:[o&&!(0,ee.DH)(o)&&(0,l.Y)(x.az,{className:"authorImg-RBQVJm",style:{background:"url(".concat((0,M.dJ9)(o,(d?200:430)*2,{height:430}),") lightgray 50% / cover no-repeat")}}),(0,l.FD)(Q.I1,{gap:16,padding:40*!d,children:[(0,l.Y)(q.T,{color:"white",preset:"h5-serif",children:n}),(0,l.Y)(q.T,(0,a._)((0,r._)({},u),{clamp:4,color:"white",preset:"d3-serif"}))]})]}),p&&(0,l.Y)(K.L,{authorId:i.id,className:"notifyButton-dcpYYD",minimize:!d})]})};var ei=i(63446),en=i(65812),er=i(86227),ea=i(49807);let el=e=>{var t;let{pub:i,post:n}=e,{iString:r}=(0,P.GO)(),a=null==(t=n.postTags)?void 0:t.filter(e=>{var t,i,r;return!e.hidden&&e.name!==(null==(i=n.publishedBylines)||null==(t=i[0])?void 0:t.name)&&e.name!==(null==(r=n.section)?void 0:r.name)});return a&&0!==a.length?(0,l.FD)(Q.Ye,{alignItems:"center",className:"tagList-aHQ9ej",gap:16,wrap:"wrap",children:[(0,l.Y)(q.T,{preset:"detail-small",children:r("Tags:")}),a.map(e=>(0,l.Y)("a",{className:"tagBox-lyb9LX",href:(0,ea.ii9)(i,e),children:(0,l.Y)(q.T,{color:"tertiary",preset:"detail-small",children:e.name})}))]}):null},eo=e=>{var t;let{post:i,user:n,pub:r,includeUFI:a=!0,freeSignupEmail:o}=e,{iString:s}=(0,P.GO)();return(0,l.Y)(F.DH,{children:(0,l.FD)(Q.I1,{alignItems:"center","aria-label":s("Post footer"),className:"postFooter-urmQJ_",gap:40,children:[(null==(t=i.postTheme)?void 0:t.header_variant)!=="title_and_image_only"&&(0,l.Y)(es,{freeSignupEmail:o,post:i,pub:r,user:n}),(0,l.Y)(el,{post:i,pub:r}),a&&(0,l.Y)(er.u,{post:i,pub:r,user:n})]})})},es=e=>{let{post:t,pub:i,user:n,freeSignupEmail:r}=e,{isMobile:a}=(0,Z.sM)(),o=t.publishedBylines.map(e=>{var t,n;let r=null==(t=i.authorPagesInfo)?void 0:t.find(t=>t.user_id===e.id);return{name:null!=(n=null==r?void 0:r.name)?n:e.name,bio:null==r?void 0:r.bio,photo_url:null==r?void 0:r.photo_url,byline:e}}).filter(e=>e.bio&&e.name),s=!(null==n?void 0:n.is_subscribed)&&!t.hidden;if(0===o.length&&!s)return null;let c=!n&&!r,d=(0,l.FD)(Q.I1,{alignItems:"center",className:"upgradeCtaContainer-B3vHAT",gap:24,padding:40,paddingTop:24,children:[(0,l.FD)(Q.I1,{alignItems:"center",gap:16,children:[(0,l.Y)(q.T,{align:"center",preset:"h5-sans",children:"Become a Paid Subscriber"}),(0,l.Y)(q.T,{align:"center",preset:"body",wrap:"balance",children:"Get access to our comments section, special columns like TGIF and Things Worth Remembering, tickets in advance to our live events, and more."})]}),(0,l.Y)(Q.Ye,{className:"upgradeCtaInputContainer-I6n3O5",justifyContent:"center",children:c?(0,l.Y)(en.A,{post:t,pub:i,user:n,utmSource:O.VU.freePressPostEndCta}):(0,l.Y)(ei.v,{href:(0,M.my9)(i,{utm_source:O.VU.freePressPostEndCta,next:(0,ea.wu9)(i,t)}),localNavigation:!1,children:(null==n?void 0:n.is_free_subscribed)?"Upgrade today":"Subscribe today"})}),(0,l.FD)(Q.Ye,{gap:16,children:[(0,l.Y)(q.T,{preset:"caption",children:"Already a paid subscriber?"}),(0,l.Y)("a",{className:"upgradeCtaSwitchAccounts-uPAFOo",href:(0,M.a7q)({for_pub:i.subdomain,change_user:!0}),native:!0,children:(0,l.Y)(q.T,{color:"accent",preset:"caption",children:"Switch Accounts"})})]})]});return(0,l.FD)(Q.I1,{alignItems:"center",className:"authorInfoContainer-XS7yHj",gap:a?16:32,children:[s?d:null,o.map(e=>{var t,n;return(0,l.Y)(et,{bio:null!=(t=e.bio)?t:"",byline:e.byline,name:null!=(n=e.name)?n:"",photoUrl:null==e?void 0:e.photo_url,pub:i})})]})};var ec=i(72880),ed=i(16993),eu=i(84843);let ep=()=>{let[e,t]=(0,b.useState)(!0),{iString:i}=(0,P.GO)(),n=()=>{t(!1)};return(0,l.FD)(ed.aF,{isOpen:e,onClose:n,children:[(0,l.Y)(eu.Io,{showClose:!1,image:(0,l.Y)(x.az,{radius:"md",overflow:"hidden",children:(0,l.Y)(ec.o,{maxWidth:400,useRetinaSizing:!0,imageIsFixedWidth:!0,src:(0,ea.dJ9)("/img/publish/selection.gif")})})}),(0,l.Y)(ed.rQ,{showClose:!1,alignItems:"center",title:i("Select a chunk of text"),description:i("We'll convert your selection into a shareable video to help promote this post")}),(0,l.Y)(ed.q1,{}),(0,l.Y)(ed.jl,{direction:"column",primaryButton:(0,l.Y)(L.$n,{onClick:n,priority:"primary",children:i("Okay")})})]})};var eh=i(56778),em=i(84565),eg=i(53989),ef=i(46271),ev=i(27749),eb=i(44451),ey=i(86500),eY=i(53928),e_=i(44803),ew=i(3142),eC=i(94729),ek=i(13022),eS=i(17186),eI=i(92476),eF=i(43528),eD=i(76528),eT=i(68349),eA=i(38304),eE=i(17096),eN=i(73957),eP=i(88559),ex=i(72170),eL=i(84934),eR=i(58398),eM=i(81209),eB=i(1459),eO=i(16291);let eU={container:"container-zWi_VI",imageContainer:"imageContainer-nn2nS0",postContainer:"postContainer-pVTsPs",imagePreview:"imagePreview-gmfk3B",shareButton:"shareButton-TCXuA9",foundingButton:"foundingButton-jUuPk2",upsellDescription:"upsellDescription-ILV1gy",countdownContainer:"countdownContainer-gvKChz",countdownInnerContainer:"countdownInnerContainer-P186WI",refreshLink:"refreshLink-qARRi5"},ej=e=>{var t,i,n,r,a,o,s,c,d,u;let{post:p,publication:h,user:m,freeSignup:g,freeSignupEmail:f}=e,[v,y]=(0,b.useState)(!1),Y=p.cover_image,_=p.title,w=p.description,C=(0,B.getPrintedByline)(h,p),k=(null==(t=p.postSchedule)?void 0:t.email_audience)==="founding"&&(null==m?void 0:m.is_founding)||(null==(i=p.postSchedule)?void 0:i.email_audience)==="only_paid"&&m&&(0,eB.e)(m,h)||(null==(n=p.postSchedule)?void 0:n.email_audience)==="everyone"&&(null==m?void 0:m.is_free_subscribed),[S,I]=(0,b.useState)((0,eO.A)(null==(r=p.postSchedule)?void 0:r.trigger_at).diff((0,eO.A)(),"second")),D=Math.floor(S/60/60/24),T=Math.floor(S/60/60%24),A=Math.floor(S/60%60);return(0,b.useEffect)(()=>{let e=setInterval(()=>{var e;I((0,eO.A)(null==(e=p.postSchedule)?void 0:e.trigger_at).diff((0,eO.A)(),"second"))},500);return()=>{clearInterval(e)}}),(0,b.useEffect)(()=>{(0,ey.u4)(ey.qY.SCHEDULED_POST_SEEN,{post_id:p.id})},[]),(0,l.FD)(F.DH,{children:[(0,l.Y)(eN.PostMetaTags,{post:p,publication:h}),(0,l.FD)(Q.I1,{className:eU.container,alignItems:"center",gap:96,paddingTop:{desktop:64,mobile:32},paddingX:12,children:[(0,l.FD)(Q.I1,{className:eU.postAndImageContainer,alignItems:"center",gap:32,children:[Y&&(0,l.Y)("div",{className:eU.imageContainer,children:(0,l.Y)("img",{src:Y,className:eU.imagePreview})}),(0,l.FD)(Q.I1,{className:eU.postContainer,alignItems:"center",gap:4,children:[(0,l.Y)(R.EY.H2,{align:"center",children:_}),(0,l.Y)(R.EY.B3,{color:"secondary",align:"center",children:(0,B.truncateText)(w,135)}),(0,l.FD)(R.EY.Meta,{color:"secondary",align:"center",children:[(null==(a=p.postSchedule)?void 0:a.email_audience)==="founding"?(0,l.FD)(l.FK,{children:[(0,l.Y)(R.EY.Meta,{as:"span",color:"accent",children:"Founding"}),C?"\xa0\xa0•\xa0\xa0":""]}):(null==(o=p.postSchedule)?void 0:o.email_audience)==="only_paid"?(0,l.FD)(l.FK,{children:[(0,l.Y)(R.EY.Meta,{as:"span",color:"accent",children:"Paid"}),C?"\xa0\xa0•\xa0\xa0":""]}):"",C?"By ".concat(C):""]})]})]}),(0,l.FD)(Q.I1,{className:eU.upsellContainer,alignItems:"center",children:[k?(0,l.FD)(Q.Ye,{gap:12,children:[(0,l.Y)(L.$n,{onClick:()=>{(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?(0,eT.V2)((0,ea.U_V)(h,p.id),{local_navigation:!1}):y(!0)},className:eU.shareButton,leading:(0,l.Y)(ex.A,{size:20}),priority:"primary",children:"Share"}),(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?(0,l.Y)(L.$n,{onClick:()=>{(0,eT.V2)((0,ea.I_S)(h,p.id),{local_navigation:!1})},className:eU.shareButton,leading:(0,l.Y)(eL.A,{size:20}),priority:"secondary",children:"Edit Post"}):null]}):(null==(s=p.postSchedule)?void 0:s.email_audience)!=="founding"||(null==m?void 0:m.is_founding)?(0,l.Y)(eM.A,{pub:h,post:p,user:m,freeSignup:g,freeSignupEmail:f,isStatic:!1,source:"post-scheduled-page"}):(0,l.Y)(L.$n,{className:eU.foundingButton,onClick:()=>{var e,t;let i=null==(t=h.plans)||null==(e=t.find(e=>{var t;return null==(t=e.metadata)?void 0:t.founding}))?void 0:e.id;(0,eT.V2)(i?(0,ea.eV6)(h,{addBase:!0,params:{next:document.location.href,utm_source:O.VU.postScheduledPage,utm_medium:O.Jn.web,utm_content:p.id,selectedPlanId:i}}):(0,M.my9)(h,{simple:!0,next:document.location.href,utm_source:O.VU.postScheduledPage,utm_medium:O.Jn.web,utm_content:p.id,plan:"founding"}),{local_navigation:!1})},children:"Upgrade to founding"}),(0,l.FD)(R.EY.B3,{className:eU.upsellDescription,color:"pub-primary-text",align:"center",children:["Publishes on ",(0,eO.A)(null==(c=p.postSchedule)?void 0:c.trigger_at).format("MMMM Do, h:mma"),"."," ",(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?"":k?"You’ll receive this post in your inbox when it’s live. Meanwhile, help spread the word!":(null==(d=p.postSchedule)?void 0:d.email_audience)==="founding"&&(null==m?void 0:m.is_free_subscribed)?"Upgrade to founding and receive this post in your inbox when it’s live":(null==(u=p.postSchedule)?void 0:u.email_audience)==="only_paid"&&(null==m?void 0:m.is_free_subscribed)?"Upgrade to paid and receive this post in your inbox when it’s live":"Subscribe now and receive the post in your inbox when it’s live"]})]})]}),(0,l.Y)("div",{className:eU.countdownContainer,children:(0,l.Y)(Q.I1,{className:eU.countdownInnerContainer,alignItems:"center",gap:4,children:S>0?(0,l.FD)(R.EY.B3,{color:"pub-secondary-text",align:"center",children:["Available in ",D>0?"".concat((0,B.pluralize)(D,"day"),", "):"",D>0||T>0?"".concat((0,B.pluralize)(T,"hour"),", "):"",D>0||T>0||A>0?"".concat((0,B.pluralize)(A,"minute")).concat(D>0||T>0?",":""," and "):"",(0,B.pluralize)(S%60,"second")]}):(0,l.FD)(R.EY.B3,{color:"pub-secondary-text",align:"center",children:["Available now!"," ",(0,l.Y)(R.EY.B3,{as:"a",color:"pub-secondary-text",align:"center",onClick:()=>{location.reload()},className:eU.refreshLink,decoration:"underline",children:"Refresh to see the post"}),"."]})})}),(0,l.Y)(eR.Z,{isOpen:v,onClose:()=>y(!1),user:m,pub:h,post:p,medium:"web"})]})};var ez=i(22057),eH=i(97515),eW=i(57820),eV=i(21356),eK=i(44502),eq=i(5180),eG=i(46453),eJ=i(2481),e$=i(62088),eZ=i(79564),eQ=i(7755),eX=i(56458),e0=i(4016),e1=i(56262),e2=i(78979),e4=i(41086),e3=i(98949);let e6="discussionContainerFP-YrbLts";class e7 extends b.Component{shouldForcePostReloadForAnonUser(e){var t;return!this.props.user&&((null==(t=this.props.siteConfigs)?void 0:t.post_metering_enabled)&&(null==e?void 0:e.meter_type)!=="none"||this.props.publication.supports_ip_content_unlock)}async componentDidMount(){(0,eT.H7)(),this.cleanEmbedResizeListener=(0,ew._)();let e=this.props.post&&[this.props.post.slug,this.props.post.uuid].filter(e=>e).includes(this.props.slug)?this.props.post:null;this.shouldRedirectToComments(e)&&e?this.redirectToComments(e):this.shouldForcePostReloadForAnonUser(e)?await this.loadPost({forceLoad:!0}):this.state.post||await this.loadPost(),this.triggerShareOnLoad(),this.fillEmbeddedEmailInputs(),this.props.justPublished&&(0,eT.qm)("justPublished"),(this.props.embeddedPostPublications||""===this.props.embeddedPostPublications)&&(0,eT.qm)("embeddedPostPublications"),this.props.showRestackModal&&(0,eT.qm)("showRestackModal"),"restack-comment"===this.props.action&&(0,eT.qm)("action"),this.props.showWelcome||this.props.launchWelcomePage||(0,eT.cH)(this.updateSubscribeTakeover),this.props.showWelcome&&((0,eT.qm)("showWelcome"),this.updateSubscribeTimers()),this.props.showWelcomeOnShare&&((0,eT.qm)("showWelcomeOnShare"),(this.props.launchWelcomePage||this.props.skipIntroPopupRender)&&this.updateSubscribeTimers()),this.props.selectionFromQuery&&(0,eF.Os)(this.props.selectionFromQuery),this.props.imgSelectionFromQuery&&(0,eF.tL)(this.props.imgSelectionFromQuery),this.props.trackFrontendVisit&&(0,ey.u4)(ey.qY.POST_PAGE_VISIT_TRACKED,{post_id:null==e?void 0:e.id}),await this.loadWelcomePageData()}async loadWelcomePageData(){if(!this.shouldShowWelcomePage()||(0,e3.Fr)())return;let e=await (0,eC.x6)("/api/v1/welcome_page_data");this.setState(e)}shouldShowWelcomePage(){return!!(!this.props.skipIntroPopupRender&&(this.props.launchWelcomePage||this.props.showWelcome||this.state.showSubscribeTakeover))}componentWillUnmount(){var e;null==(e=this.cleanEmbedResizeListener)||e.call(this),(0,eT.Gr)(this.updateSubscribeTakeover)}async componentDidUpdate(e){e.slug!==this.props.slug&&this.loadPost(),this.state.embeddedEmailInputsFilled||this.fillEmbeddedEmailInputs()}shouldRedirectToComments(e){if(e&&"thread"===e.type)return!0}redirectToComments(e){(0,v.route)((0,M.wu9)(this.props.publication,e,{comments:!0,noBase:!0}),!0)}async loadPost(){let{forceLoad:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.setState({embeddedEmailInputsFilled:!1}),this.props.post&&[this.props.post.slug,this.props.post.uuid].filter(e=>e).includes(this.props.slug)&&!this.shouldRedirectToComments(this.props.post)&&!e)this.setState({post:this.props.post,comments:this.props.renderedComments},()=>(0,eT.H7)());else{this.setState({post:null,comments:null});try{let e=(await Y().get("/api/v1/posts/".concat(this.props.slug)).query({postPreview:this.props.postPreview,updated:this.props.updated,sub:this.props.sub,device:this.props.device,audience:this.props.audience,free_preview:this.props.free_preview,freemail:this.props.freemail,utm_campaign:this.props.utm_campaign})).body;if(this.shouldRedirectToComments(e))this.redirectToComments(e);else{var t,i;if(await (0,eT.wb)(this,{post:e,comments:e.comments,stateThemeVariables:e.themeVariables}),(0,ek.Ay)("add_section_and_tag_metadata")&&!(0,e_.wc)()){let e={url:document.location.origin+document.location.pathname+document.location.search,urlref:document.referrer||"",js:1,data:{audience:(0,e_.fe)(this.props.user)}};"undefined"!=typeof window&&window.PARSELY&&window.PARSELY.loaded&&window.PARSELY.beacon&&window.PARSELY.beacon.trackPageView&&window.PARSELY.beacon.trackPageView(e)}(0,eY.Mz)({path:document.location.pathname,title:e.title,sections:(null==(t=e.section)?void 0:t.name)||"",authors:(null==(i=e.publishedBylines)?void 0:i.map(e=>e.name).join(", "))||""}),(0,eT.H7)()}}catch(e){console.error("Failed to load post:",e),404===e.status?this.setState({notFound:!0}):alert((0,eT.uX)(e))}}}triggerShareOnLoad(){var e,t;"share"===(0,e4.y)("action")&&(window.history.replaceState({},document.title,(0,M.oRR)({action:null})),this.post&&(null==(e=(t=this.post).triggerShare)||e.call(t,{fromEmail:!0})))}render(){var e,t,i,n;let{slug:o,freeSignup:c,freeSignupEmail:d,readerInstalledAt:u,publication:h,reaction_token:m,hide_intro_popup:g,sort:f,search:v,children:b,showWelcome:y,launchWelcomePage:Y,justPublished:w,readerIsSearchCrawler:D,postPreview:A,selectionFromQuery:E,embeddedPublications:N,siteConfigs:P={},freeTrialCoupon:x,showRestackModal:L,action:R,publicationSettings:M,show_reaction_upsell:O,stripe_publishable_key:j,bannedFromNotes:z,themeVariables:H,referringUser:W,clip:K,recentEpisodes:q,followPrompt:G,imgSelectionFromQuery:J,postSelectionStyle:$,shareImageVariantFromQuery:Z}=this.props,{comments:Q,notFound:X,post:ee,user:et,stateThemeVariables:ei,hideSubscribePrompt:en,blurbs:er,topThreePosts:ea,topThreeSubscribers:el}=null!=(e=this.state)?e:{},{iString:es}=this.I18N,ec=this._inlineComments(),ed=null==ee||!ee.audience||(0,e1.userHasFullAccessToPost)(et,ee),eu=(null==et?void 0:et.is_subscribed)&&ed,em=ee&&ee.slug&&"coming-soon"!==ee.slug&&"page"!==ee.type,eg=(0,B.commentsEnabledForPost)({publication:h,post:ee}),ef=(0,B.showCommentsOnPost)({publication:h,post:ee}),ev=eu||(null==et?void 0:et.is_free_subscriber)||c,eb=(0,e0.lu)({pub:h}),ey=!!(ee&&["video","podcast"].includes(ee.type)),eY=ei||H,e_=!(null==ee?void 0:ee.hidden)&&((0,B.isUUID)(o)||eu||D||ee&&ee.current_user_post_meter||ee&&ee.unlockedWithIP||ee&&!(0,e1.isPaidAudience)(ee.audience)||ee&&!ee.slug);eb&&(e_=!!e_&&(!(null==(t=this.props.utm_medium)?void 0:t.includes("paid-social_"))||!!eu));let ew=!!ee&&(0,eX.Ed)({post:ee})&&!eu,eC=!e_||(null==et?void 0:et.is_contributor)&&ee&&(0,e1.isPaidAudience)(ee.audience)||eb,eS=w&&(null==et?void 0:et.is_contributor)&&!this.props.publication.invite_only&&ee&&!["page"].includes(ee.type)&&(null==N?void 0:N.length),eI=!1;if("undefined"!=typeof window&&(eI="true"===new URLSearchParams(window.location.search).get("selectQuote")),eb&&ee&&"page"===ee.type)return(0,l.Y)(V.r,{type:ee.slug,html:ee.body_html||"",post:ee,pub:this.props.publication,user:this.props.user});if(ee&&"is_scheduled"in ee&&ee.is_scheduled)return(0,l.Y)(ej,{freeSignup:c,freeSignupEmail:d,user:et,post:ee,publication:h});let eF=ee?(0,l.Y)(e5,{commentsEnabled:eg,comments:Q,post:ee,slug:o,user:et,freeSignup:c,freeSignupEmail:d,publication:h,reaction_token:m,onVisible:this.onVisible,onChangeComment:this.onChangeComment,inlineComments:ec,isShowsEpisodePage:ey,selectionFromQuery:E,imgSelectionFromQuery:J,onChange:e=>{let{post:t}=e;ee?this.setState({post:(0,a._)((0,r._)({},ee),{comment_count:t.comment_count})}):console.error("post not set with CommentsAndRestacks onChange")},bannedFromNotes:z}):null,eD=["podcast","video"].includes(null!=(i=null==ee?void 0:ee.type)?i:"")&&(null==ee?void 0:ee.videoUpload)&&(0,ek.Ay)("enable_video_seo_data");return(0,l.FD)("div",{children:["restack-comment"===R&&(0,l.Y)(ti,{post:ee,pub:h,selection:E,imgSelection:null!=J?J:void 0}),(0,l.Y)(te,{pub:h,post:ee}),eD&&(0,l.Y)(tt,{pub:h,post:ee,hasPaywall:!e_}),this.shouldShowWelcomePage()?(0,l.Y)(k.Ay,{freeSignup:c,freeSignupEmail:d,user:et,post:ee,publication:h,hidden:g,launchWelcomePage:Y,showOnMount:Y,blurbs:er,topThreePosts:ea,topThreeSubscribers:el}):null,(0,l.FD)(_.HY,{children:[!ey&&(0,l.Y)(l.FK,{children:(0,l.Y)(e8,{user:et,readerInstalledAt:u,post:ee,publication:h,readerIsSearchCrawler:D,publicationSettings:M})}),(0,l.FD)("div",{className:s()("single-post-container",{"singlePostContainerPillar-sdUBxf":(0,e0.S2)({pub:h})}),"aria-label":es("Post"),role:"main",children:[(0,l.Y)("div",{className:s()({container:!(ey||(null==ee?void 0:ee.postTheme)&&eb)}),children:(0,l.FD)("div",{className:"single-post",children:[(0,l.Y)(eN.PostMetaTags,{shareImageVariantFromQuery:Z,publication:h,post:null!=ee?ee:void 0,clip:K,selection:E,siteConfigs:P,selectionStyle:$}),ee?(0,l.Y)(F.DH,{children:ey?(0,l.Y)(eZ.H,{ref:this.assignPost,isServingFreePodcastUrl:ew,isShowsEpisodePage:ey,isTheFreePressTheme:eb,postPreview:A,showComments:ef,user:null!=et?et:null,post:ee,pub:h,freeSignup:c,freeSignupEmail:d,reaction_token:m,disableSubscribePrompt:en||(Y||y)&&!g,paywall:!e_,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,freeTrialCoupon:x,showRestackModal:!!L,stripe_publishable_key:j,readerIsSearchCrawler:D,renderComments:()=>eF,themeVariables:eY,referringUser:W,recentEpisodes:null!=q?q:null,forceFollowPrompt:G,skipFollowPrompt:this.shouldShowWelcomePage()}):(0,l.Y)(I.L4,{ref:this.assignPost,isServingFreePodcastUrl:ew,isShowsEpisodePage:ey,isTheFreePressTheme:eb,postPreview:A,showComments:ef,user:null!=et?et:null,post:ee,pub:h,freeSignup:c,freeSignupEmail:d,reaction_token:m,disableSubscribePrompt:en||(Y||y)&&!g,paywall:!e_,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,freeTrialCoupon:x,showRestackModal:!!L,stripe_publishable_key:j,readerIsSearchCrawler:D,renderComments:()=>eF,themeVariables:eY,referringUser:W,forceFollowPrompt:G,skipFollowPrompt:this.shouldShowWelcomePage()})}):X?(0,l.Y)("p",{className:"main-loader","aria-label":es("Error: Post not found"),children:es("Post not found")}):(0,l.Y)(I.DZ,{pub:h}),b]})}),(0,l.Y)(F.DH,{children:em&&(e_||eb)&&[eb&&(0,l.Y)(eo,{post:ee,user:et,pub:h,freeSignupEmail:d,includeUFI:!!e_&&"video"!==ee.type&&"podcast"!==ee.type}),ef&&!ey&&eF,h.has_posts&&(!ey||eb)&&(0,l.Y)("div",{className:"single-post-section",children:(0,l.FD)("div",{className:s()({container:!(ee.postTheme&&eb)}),children:[(0,l.Y)(eh.A,{onVisible:()=>{this.onVisible("Top Posts Footer")}}),(0,l.Y)(eP.Q,{user:null!=et?et:null,freeSignup:c,freeSignupEmail:d,isShowsEpisodePageForTheFP:ey,pub:h,maxPosts:eC||eu||ev&&!h.plans?10:3,filterPostsPredicate:e=>e.id!==ee.id,sort:eb?"new":f,search:v,stateInUrl:!0,sortTabs:e=>{if(this.context.getConfigFor("related_posts_enabled")){let t=e.findIndex(e=>"related"===e.id);if(-1!==t)return p()([e[t]].concat(e.filter((e,i)=>i!==t)))}let t=e.findIndex(e=>"top"===e.id);return -1!==t?p()([e[t]].concat(e.filter((e,i)=>i!==t))):null},delayFirstLoad:1e3,source:"post",isBelowTheFold:!0,post:ee})]})}),!eC&&[(0,l.Y)(eh.A,{onVisible:()=>this.onVisible("Subscribe Footer")}),(0,l.Y)(U,{publication:h,user:et,freeSignupEmail:d,freeSignup:c})]]}),eS?(0,l.Y)(T.b,{pub:h,pubsToRecommend:N}):null,O?(0,l.Y)(S.Cv,{user:et,pub:h,post:null!=ee?ee:void 0}):null,eI&&(0,l.Y)(ep,{}),(0,l.Y)(C.Ay,{post:ee,mediaUploadId:null!=(n=this.props.clipId)?n:null})]})]})]})}constructor(e,t){super(e,t),(0,n._)(this,"I18N",void 0),(0,n._)(this,"cleanEmbedResizeListener",void 0),(0,n._)(this,"post",void 0),(0,n._)(this,"assignPost",e=>{this.post=e}),(0,n._)(this,"updateSubscribeTakeover",()=>{let e=this.props.publication.id,t=(0,eS.xm)("pub-".concat(e,"-takeover-next-shown-at")),i=!t||Date.now()>=t;(0,eT.Tf)()?this.state.subscribeTakeOverTimer&&(i&&Date.now()-this.state.subscribeTakeOverTimer.getTime()>=12e4&&this.setState({showSubscribeTakeover:!0},()=>{this.loadWelcomePageData()}),this.setState({subscribeTakeOverTimer:null}),this.updateSubscribeTimers()):this.state.subscribeTakeOverTimer||this.setState({subscribeTakeOverTimer:new Date})}),(0,n._)(this,"updateSubscribeTimers",()=>{let e=this.props.publication.id,t="pub-".concat(e,"-subscribe-prompt-next-shown-at"),i="pub-".concat(e,"-takeover-next-shown-at");(0,eS.X3)(t,(0,eO.A)().add(1,"hour").valueOf()),(0,eS.X3)(i,(0,eO.A)().add(1,"hour").valueOf()),this.setState({hideSubscribePrompt:!0})}),(0,n._)(this,"onChangeComment",e=>{this.setState({comments:(0,eA.cx)(this.state.comments,e)})}),(0,n._)(this,"onVisible",e=>{let t="".concat(e," Seen");!this.state.post||this.state[t]||(this.setState({[t]:!0}),(0,ey.u4)(t,{post_id:this.state.post.id,post_audience:this.state.post.audience,post_type:this.state.post.type}))}),(0,n._)(this,"_inlineComments",()=>{let{inlineComments:e,publication:t}=this.props;return!!e||(0,B.shouldUseInlineComments)(t,this.state.post||this.props.post)}),(0,n._)(this,"fillEmbeddedEmailInputs",()=>{var e;let t=document.querySelectorAll('article.post input[type="email"]'),i=(null==(e=this.state.user)?void 0:e.email)||this.props.freeSignupEmail;if(i)for(let e of t)e.value=i;this.setState({embeddedEmailInputsFilled:!0})});let{user:i}=e;this.I18N=I18N.i({pub:e.publication}),e.postPreview&&(i=(0,a._)((0,r._)({},i),{is_draft:!1,is_subscribed:"free"!==e.postPreview,is_founding:"founding"===e.postPreview,is_contributor:!1})),e.post&&[e.post.slug,e.post.uuid].filter(e=>e).includes(e.slug)&&!this.shouldRedirectToComments(e.post)?this.state={post:e.post,comments:e.renderedComments,user:i}:this.state={post:null,comments:null,user:i}}}function e8(e){let{user:t,readerInstalledAt:i,post:n,publication:r,readerIsSearchCrawler:a,publicationSettings:o}=e,s="undefined"!=typeof navigator&&/Twitter for/i.test(navigator.userAgent),c=n&&r&&!a&&!(0,e0.lu)({pub:r})&&!s,d=t&&t.is_contributor&&(null==n?void 0:n.slug)=="coming-soon"&&!(null==o?void 0:o.seen_coming_soon_explainer);return(0,l.FD)(l.FK,{children:[c&&(0,l.Y)(_.oD,{subdomain:r.subdomain,post:n,readerInstalled:!!i,isContributor:!!(null==t?void 0:t.is_contributor)}),d&&(0,l.Y)(w.DZ,{})]})}(0,n._)(e7,"contextType",em.Ke);let e5=e=>{var t,i,n;let{commentsEnabled:o,comments:c,post:d,slug:u,user:p,freeSignup:h,freeSignupEmail:v,publication:y,reaction_token:Y,onVisible:_,onChangeComment:w,inlineComments:C,isShowsEpisodePage:k,selectionFromQuery:S,onChange:I,bannedFromNotes:F,imgSelectionFromQuery:D}=e,{iString:T,iPlural:A}=(0,P.GO)(),[E,N]=(0,b.useState)(!!(0,e4.y)("showRestacks")),[L,U]=(0,b.useState)(!1),j=(0,ef.ur)(),{getSettingFor:z}=(0,eg.Pu)(),W=(0,e0.lu)({pub:y}),V=z("show_restacks_below_posts")&&y.community_enabled&&!W,[K,q]=(0,eq._0)(),[G,J]=(0,b.useState)(!1),$=(0,eD.OU)("/api/v1/note/p-".concat(d.id,"/restacks?filterForPub=true"),{auto:G||E,deps:[d.id]});(0,b.useEffect)(()=>{var e,t;!$.isLoading&&(null==(t=$.data)||null==(e=t.items)?void 0:e.length)&&q({type:"comments_load",payload:{comments:$.data.items.map(e=>{let{comment:t}=e;return t})}})},[q,$.isLoading,$.data]);let Z=(0,eD.OU)("/api/v1/post/".concat(d.id,"/restackers"),{auto:E,deps:[d.id]}),[X,ee]=(0,b.useState)(""),[et,ei]=(0,b.useState)(""),en=(0,b.useRef)(),er=p?void 0:function(){let{redirectOverride:e,overrideTitle:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U(!0),e&&ee(e),t&&ei(t)},el="undefined"!=typeof window&&new URL(window.location.href);el&&(el.searchParams.set("showRestacks",!0),el.hash="discussion");let eo=!!d.videoUpload,es=!!(!eo&&"podcast"===d.type);return(0,l.FD)(l.FK,{children:[(0,l.Y)(eh.A,{onVisible:()=>J(!0)}),(0,l.FD)(Q.I1,{paddingY:32,gap:W?28:16,id:"discussion",children:[(0,l.FD)(Q.I1,{gap:32,className:s()({container:"newsletter"===d.type&&!W,[e6]:W&&!k}),children:[W?(0,l.Y)(H.W,{comments:c,post:d,notAllowedToFetchComments:!(0,B.canSeeComments)(p,d)}):(0,l.Y)(R.EY.H4,{children:V?T("newsletter"===d.type?"Discussion about this post":eo?"Discussion about this video":es?"Discussion about this episode":"Discussion"):d.comment_count?A("1 Comment","%1 Comments",d.comment_count):T("Comments")}),V&&(0,l.Y)(x.az,{alignSelf:"start",children:(0,l.Y)(eV.T,{value:E?"restacks":"comments",onChange:e=>{N("restacks"===e),(0,ey.u4)(ey.qY.POST_DISCUSSION_TOGGLE_CLICKED,{post_id:d.id,tab:e})},tabs:[{value:"comments",label:T("Comments")},{value:"restacks",label:T("Restacks")}],ariaLabel:T("Select discussion type")})})]}),E?(0,l.FD)(Q.I1,{className:"container",paddingTop:16,gap:16,children:[(0,l.Y)(eG.Dx.Provider,{value:{requireLogin:er,onboardingModalRef:en,publicationUsers:[],subscriptions:[]},children:(0,l.Y)(eJ.Ay,{restackUrl:(0,M.wu9)(y,d),placeholder:T((0,e3.Fr)()?"Write a restack...":"Write a restack about this post to your followers..."),surface:"post-page-restacks-list"})}),(0,l.Y)(e$.M9,{isOpen:L,onCancel:()=>{U(!1),ee(""),ei("")},onSuccess:()=>{U(!1),window.history.replaceState(null,"",null==el?void 0:el.toString()),location.reload()},onSignup:()=>{var e;U(!1),null==(e=en.current)||e.open()},redirectOverride:X,overrideTitle:et}),(0,l.Y)(eK.ReaderOnboardingModal,{ref:en,user:j.user,step:e2.d.SIGNUP,redirectAfterProfile:!0,skipCategories:!0,redirect:null==el?void 0:el.toString()}),$.isLoading?(0,l.Y)(eW.y$,{}):(null==(t=$.data)?void 0:t.items.length)?(0,l.FD)(Q.I1,{gap:16,children:[(0,l.Y)(Q.I1,{children:(0,l.Y)(ev.IJ,{surface:"post-page-restacks-list",dispatch:q,state:K,children:null==(i=$.data.items)?void 0:i.slice(0,3).map(e=>{var t,i,n,l,o,s;return(0,a._)((0,r._)({},e),{publication:e.publication?null!=(i=K.publications.get(e.publication.id))?i:e.publication:null,post:e.post?null!=(n=K.posts.get(e.post.id))?n:e.post:null,comment:e.comment?(0,a._)((0,r._)({},null!=(l=K.comments.get(e.comment.id))?l:e.comment),{attachments:(null!=(s=null==(t=null!=(o=K.comments.get(e.comment.id))?o:e.comment)?void 0:t.attachments)?s:[]).filter(e=>{let{type:t,postSelection:i}=e;return"post"!==t||!!i})}):null})}).map(e=>(0,l.Y)(eb.GJ,{className:"feedItem-p_SCsv",item:e},e.entity_key))})}),!m()(d.restacks)&&d.restacks-3>0&&(0,l.FD)(Q.Ye,{gap:8,alignItems:"center",children:[(0,l.Y)(Q.Ye,{as:"a",alignItems:"center",cursor:"pointer",href:(0,ea.so2)(d.id,{urlParams:{utm_source:O.VU.substack,utm_content:O.fL.facepileRestacks}}),children:(0,l.Y)(ez.Z,{users:(null!=(n=Z.data)?n:[]).filter(e=>{var t,i,n;let{id:r}=e;return!(null==(n=$.data)||null==(i=n.items)||null==(t=i.slice(0,3))?void 0:t.some(e=>{let{comment:t}=e;return t.user_id==r}))}).map(e=>(0,a._)((0,r._)({},e),{noLink:!0}))})}),(0,l.FD)(Q.Ye,{as:"a",gap:4,alignItems:"center",cursor:"pointer",href:(0,ea.so2)(d.id,{urlParams:{utm_source:O.VU.substack,utm_content:O.fL.facepileRestacks}}),children:[(0,l.Y)(R.EY.B3,{color:"pub-secondary-text",children:A("See 1 more restack","See %1 more restacks",d.restacks-3)}),(0,l.Y)(g.A,{stroke:"var(--print_secondary_on_web_bg_color, var(--color-fg-secondary))",strokeWidth:1,size:18})]})]})]}):(0,l.Y)(Q.pT,{paddingY:48,justifyContent:"center",alignItems:"center",flex:"grow",children:(0,l.Y)(eH.p,{className:"restackEmpty-joLIAL",icon:(0,l.Y)(f.A,{}),title:T("There are no restacks yet, be the first one to restack the post!")})})]}):(0,l.Y)(e9,{commentsEnabled:o,comments:c,post:d,isShowsEpisodePage:k,slug:u,user:p,freeSignup:h,freeSignupEmail:v,publication:y,reaction_token:Y,onVisible:_,onChangeComment:w,inlineComments:C,selectionFromQuery:S,imgSelectionFromQuery:D,onChange:I,bannedFromNotes:F,userContext:j})]})]})};class e9 extends b.Component{componentDidMount(){document.addEventListener(I.$f,this.handleFocusInput)}componentWillUnmount(){document.removeEventListener(I.$f,this.handleFocusInput)}render(){var e;let{commentsEnabled:t,inlineComments:i,isShowsEpisodePage:n,post:r,user:a,freeSignup:o,freeSignupEmail:s,publication:c,reaction_token:d,onVisible:u,onChangeComment:p,selectionFromQuery:h,slug:m,onChange:g,bannedFromNotes:f,imgSelectionFromQuery:v}=this.props,{comments:b,reactionSigninComment:y}=null!=(e=this.state)?e:{};if(r.is_geoblocked)return null;let Y=(0,e0.lu)({pub:c});if(i)return(0,l.Y)("div",{id:eQ.R4,children:(0,l.Y)(eA.iQ,{slug:m,user:null!=a?a:void 0,freeSignupEmail:s,freeSignup:o,post:r,publication:c,post_reaction_token:d,selectionFromQuery:h,imgSelectionFromQuery:v,initialComments:null!=b?b:[],inline:!0,onChange:g})});let{iPlural:_}=this.I18N,w=async(e,t)=>(0,eA.Jk)({user:null!=a?a:void 0,reactionToken:d,comments:null!=b?b:[],id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>new Promise(t=>this.setState({reactionSigninComment:e.comment},()=>{var e;return null==(e=this.modalRef.current)?void 0:e.open(t)}))}),C=(0,eA.PG)(r,c);return(!(0,e3.Fr)()||(null==a?void 0:a.is_contributor)||(C=(0,M.XV8)(c.subdomain,r.slug,{params:{comments:!0,utm_source:O.VU.post,utm_medium:O.Jn.web}})),Y&&!(0,B.canSeeComments)(a,r))?(0,l.Y)(W.n,{post:r,publication:c,user:null!=a?a:void 0,freeSignupEmail:s,showHeader:!1}):(0,l.Y)("div",{className:"single-post-section comments-section",children:(0,l.FD)("div",{className:Y?n?"":e6:"container",children:[(0,l.Y)(eh.A,{onVisible:()=>u("Post Comments Footer")}),t&&(0,l.Y)(eA.gi,{user:a,freeSignup:o,freeSignupEmail:s,pub:c,post:r,token:d,ref:this.inputRef,bannedFromNotes:f}),b&&b.length>0&&!t&&(0,l.Y)(eA.Nm,{post:r}),b&&b.length>0&&c.community_enabled&&(0,l.Y)(eE.Wh,{className:"post-page-root-comment-list",user:a,freeSignup:o,freeSignupEmail:s,pub:c,post:r,comments:b,reaction_token:d,onChange:p,updateCommentReacted:w,noRestack:!0},"post:".concat(r.id)),r.comment_count>(b||[]).length&&(0,l.Y)("a",{className:"more-comments",href:C,children:_("1 more comment...","%1 more comments...",r.comment_count-(b||[]).length)}),y&&(0,l.Y)(D.LZ,{comment:y,pub:c,user:a,react:()=>w(y.id,!0),modalRef:this.modalRef})]})})}constructor(e,t){super(e,t),(0,n._)(this,"I18N",void 0),(0,n._)(this,"inputRef",void 0),(0,n._)(this,"modalRef",(0,b.createRef)()),(0,n._)(this,"onboardingModalRef",(0,b.createRef)()),(0,n._)(this,"handleFocusInput",void 0),this.I18N=I18N.i({pub:e.publication}),this.inputRef=(0,b.createRef)(),this.handleFocusInput=()=>{var e;null==(e=this.inputRef.current)||e.focus()},this.state={comments:e.comments,reactionSigninComment:null}}}let te=e=>{let{pub:t,post:i}=e;return i?(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:d()((0,eI.II)(t,i),{json:!0,isScriptContext:!0})}}):null},tt=e=>{var t;let{pub:i,post:n,hasPaywall:r}=e;if(!n.videoUpload)return null;let a=(null!=(t=n.videoUpload.preview_duration)?t:0)>0;return(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:d()((0,eI.V)(i,n,n.videoUpload,{usePreview:r&&a}),{json:!0,isScriptContext:!0})}})};function ti(e){let{pub:t,post:i,selection:n,imgSelection:r}=e,a=(0,eJ.NP)();return(0,b.useEffect)(()=>{a.open({restackUrl:(0,M.wu9)(t,i,{urlParams:{selection:n,imgSelection:r}})})},[]),null}},2670:function(e,t,i){i.d(t,{m:()=>a});var n=i(10201),r=i(79909);let a=e=>{let{sitemapHeader:t,sitemapDescription:i,sitemapLinks:a}=e;return(0,n.FD)("div",{className:"container typography sitemap-page",children:[(0,n.Y)(r.Metadata,{title:t,description:i}),(0,n.Y)("h1",{children:t}),(0,n.Y)("div",{children:a.map(e=>(0,n.Y)("p",{children:(0,n.Y)("a",{className:"sitemap-link",href:e.href,native:!0,children:e.text})}))})]})}},41167:function(e,t,i){i.d(t,{A:()=>N,s:()=>T});var n=i(69277),r=i(70408),a=i(79785),l=i(10201),o=i(69843),s=i.n(o),c=i(80697),d=i(17402),u=i(15734),p=i.n(u),h=i(79909),m=i(84605),g=i(86500),f=i(1683),v=i(68349),b=i(35369),y=i(81203),Y=i(39318),_=i(82776),w=i(57324);function C(){let e=(0,a._)(["Substacks recommended by ","",""]);return C=function(){return e},e}function k(){let e=(0,a._)(["Recommended by ",""]);return k=function(){return e},e}function S(){let e=(0,a._)(["By ",""]);return S=function(){return e},e}function I(){let e=(0,a._)(["View all ",""]);return I=function(){return e},e}let F=function(e,t,i,n){let{trackOnly:r=!1,freeSignupEmail:a}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return async()=>{if((0,g.u4)(g.qY.RECOMMENDATION_SUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:e.id,recommending_publication_id:t.id}),!r)try{let r=i&&!i.is_magic&&i.email||a;await p().post("/api/v1/free").send({email:r,source:"recommendations_page",first_url:f.R9,first_referrer:f.b7,first_session_url:f.K0,first_session_referrer:f.OG,current_url:f.AT,current_referrer:f.uC,other_publication_id:e.id,referring_pub_id:t.id}),n(e)}catch(e){alert((0,v.uX)(e)||"Something went wrong")}}},D=function(e,t,i){let{trackOnly:n=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async()=>{if((0,g.u4)(g.qY.RECOMMENDATION_UNSUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:e.id,recommending_publication_id:t.id}),!n)try{await p().delete("/api/v1/free").send({publication_id:e.id,source:"recommendations_page"}),i(e)}catch(e){alert((0,v.uX)(e)||"Something went wrong")}}},T=e=>{let{pub:t,recommendations:i,allSubscribedPubs:n,fullySubscribedPubs:r,user:a,freeSignupEmail:o}=e,{iString:s,iTemplate:u}=(0,m.GO)(),[p,f]=(0,d.useState)(n),I=e=>{f([...p,e])},T=e=>{f(p.filter(t=>{let{id:i}=t;return i!==e.id}))};return(0,l.FD)("div",{className:"container",children:[(0,l.Y)(h.Metadata,{title:u(C(),(0,_.getByLine)(t)||t.name,(0,_.getByLine)(t)?" | ".concat(t.name):"")}),(0,l.FD)("div",{className:"recommendations-page-container",children:[(0,l.Y)("h2",{children:u(k(),(0,_.getByLine)(t)||t.name)}),(0,l.Y)("div",{className:"recommended-publications-container",children:i.map(e=>{let i=e.recommendedPublication;if(!i)return;let n="".concat((0,Y.$_T)(i),"/?utm_source=").concat(w.VU.recommendationsPage,"&utm_campaign=").concat(t.id),d=(0,Y.eV6)(i,{addBase:!0,utm_source:w.VU.recommendationsPage,referring_pub_ids:[t.id],simple:!0}),h=(0,_.getByLine)(i),m=r.map(e=>{let{id:t}=e;return t}).includes(i.id);return(0,l.Y)("div",{className:"recommended-publications-text-container with-blurb",children:(0,l.Y)("div",{className:"recommendation-body",children:(0,l.FD)("div",{className:"publication-content",children:[(0,l.FD)("div",{className:"top-row",children:[(0,l.FD)("a",{className:"left",href:n,onClick:()=>{(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATION_LINK_CLICKED,{source:"recommendations-page",recommended_publication_id:i.id,recommending_publication_id:t.id})},children:[(0,l.Y)(y.Nq,{pub:i,size:48}),(0,l.FD)("div",{className:"pub-meta",children:[(0,l.Y)("div",{className:"publication-title",children:i.name}),!!h&&(0,l.Y)("div",{className:"publication-author",children:u(S(),h)})]})]}),p.map(e=>{let{id:t}=e;return t}).includes(i.id)?(0,l.Y)(b.$n,{priority:"secondary",onClick:D(i,t,T,{trackOnly:m}),href:m?(0,Y.FCy)(i,{addBase:!0}):void 0,className:"unsubscribe",children:s("Subscribed")}):(0,l.Y)(b.$n,{priority:"primary",onClick:a&&!a.is_magic&&a.email||o?F(i,t,a,I,{freeSignupEmail:o}):()=>{(0,g.u4)(g.qY.RECOMMENDATION_SUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:i.id,recommending_publication_id:t.id}),(0,v.V2)(d,{local_navigation:!1})},leading:(0,l.Y)(c.A,{size:20}),children:s("Subscribe")})]}),(0,l.Y)("div",{className:"publication-suggestion-text-area",children:(i.editorial_bio||i.hero_text)&&(0,l.Y)("div",{className:"publication-description",children:i.editorial_bio||i.hero_text})}),e.description&&(0,l.Y)(A,{content:e.description,author:(0,_.getByLine)(t)||t.name})]})})})})})]})]})},A=e=>{let{author:t,content:i}=e;return(0,l.FD)("div",{className:"blurb",children:[(0,l.Y)("p",{className:"blurb-content",children:i}),(0,l.FD)("p",{className:"blurb-author",children:["- ",t]})]})},E=e=>{var t,i,a;let{recommendation:o,pub:s,signedIn:c,render:d}=e,{recommendedPublication:u}=o,p=(0,Y.fOI)(u,{params:{utm_source:w.VU.homepageRecommendations,utm_campaign:s.id},signedIn:c}),h=()=>{(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATION_LINK_CLICKED,{recommending_publication_id:s.id,recommended_publication_id:u.id,source:"homepage-recommendations"})},m={pub:u,openInNewTab:!0,belowTheFold:!0};return d?d({pubAvatarProps:m,pubName:u.name,pubAuthor:null==(i=u.author)?void 0:i.name,url:p,onClick:h}):(0,l.Y)("div",{className:"home-right-col",children:(0,l.Y)("div",{className:"recommendation-row",children:(0,l.FD)("div",{className:"left",children:[(0,l.Y)("a",{onClick:h,children:(0,l.Y)(y.wg,(0,r._)((0,n._)({},m),{size:32}))}),(0,l.FD)("div",{className:"pub-meta",children:[(0,l.Y)("a",{href:p,target:"_blank",onClick:h,children:u.name}),(0,l.Y)("div",{className:"pub-author",children:null!=(a=null==(t=u.author)?void 0:t.name)?a:""})]})]})})})},N=e=>{let{recommendations:t,numRecommendations:i,pub:n,user:r,render:a,renderRecommendation:o}=e,{iString:c,iTemplate:u}=(0,m.GO)(),p=t.map(e=>(0,l.Y)(E,{recommendation:e,pub:n,signedIn:!!r,render:o}));return((0,d.useEffect)(()=>{(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATIONS_SHOWN,{source:"pub-home",recommendations:t.map(e=>{let{recommendedPublication:t}=e;return t.id})})},[t]),a)?a({recommendations:p,canManage:!!(null==r?void 0:r.is_admin),manageUrl:(0,Y.OFB)(n),hasMore:!s()(i)&&i>t.length,hasMoreUrl:(0,Y.nUM)(n),recommendationsCount:i}):(0,l.FD)("div",{className:"home-right-group recommendations",children:[(0,l.FD)("div",{className:"home-right-group-title",children:[(0,l.Y)("a",{href:(0,Y.nUM)(n),children:"Recommendations"}),(null==r?void 0:r.is_admin)?(0,l.Y)("a",{href:(0,Y.OFB)(n),native:!0,children:c("Manage")}):!s()(i)&&i>t.length?(0,l.Y)("a",{href:(0,Y.nUM)(n),native:!0,children:u(I(),i)}):null]}),p]})}},52506:function(e,t,i){i.d(t,{Y:()=>C});var n=i(69277),r=i(10201),a=i(32485),l=i.n(a),o=i(79909),s=i(84605),c=i(51190),d=i(12592),u=i(72216),p=i(63136),h=i(56458),m=i(4016),g=i(46009),f=i(39318),v=i(57324),b=i(22065);let y=e=>{let{}=e,{iString:t}=(0,s.GO)();return(0,r.Y)("div",{className:b.A.noPodcasts,children:t("No podcasts.")})},Y=(e,t,i)=>{let n=e[t.id];return n||(n=(0,f.wpu)(t,{section:null,noSection:!1,addBase:!0,user:null,startAtSubscribeFlow:!i||!i.is_free_subscribed,params:{utm_source:v.VU.allPodcasts}})),n},_=e=>{let{pub:t,user:i,idToMagicLink:n,openInNewTab:a}=e;return"thebulwark"!==t.subdomain?null:(0,r.FD)(p.EY.B3,{translated:!0,paddingTop:16,paddingBottom:16,children:[(0,r.Y)("a",{href:Y(null!=n?n:{},t,i),target:a?"_blank":void 0,rel:"noopener",children:"Click here"})," ","to set up your podcast app for everything in one feed."]})},w=e=>{let{pub:t,user:i,idToMagicLink:n={}}=e,a=[],{iString:l}=(0,s.GO)();(0,h.th)(t)&&(0,h.th)(t).forEach(e=>{var r,o;if(!(0,h.pf)({pub:t,section:e}))return;let s=(0,g.lL)({pub:t,section:e});if(!s.title)return;let c={logoUrl:null!=(r=s.artUrl)?r:void 0,mainClickUrl:(0,f.t6y)({pub:t,section:e,addBase:!0}),buttonClickUrl:n[e.id]||(0,f.wpu)(t,{section:e,noSection:!1,addBase:!0,user:null,startAtSubscribeFlow:!i||!i.is_free_subscribed,params:{utm_source:v.VU.allPodcasts}}),name:s.title,description:null!=(o=s.description)?o:"",buttonText:l("Set up podcast")};a.push(c)}),(0,h.fk)(t)&&a.push((0,u.E)(t,Y(n,t,i)));let o=Object.keys(n).length>0||(null==i?void 0:i.is_free_subscribed)?l("Private podcasts"):l("Podcasts"),c=(0,r.Y)(r.FK,{children:(0,h.Jy)(t)?(0,r.FD)(r.FK,{children:[(0,r.Y)(u.p,{showButton:!0,items:a}),(0,r.Y)(_,{pub:t,user:i,idToMagicLink:n})]}):(0,r.Y)(y,{})});return(0,r.FD)(r.FK,{children:[(0,r.Y)(p.EY.H4,{paddingTop:20,paddingBottom:8,children:o}),c]})},C=e=>{let{pub:t,user:i,idToMagicLink:a,metadata:s}=e;return(0,m.s7)({pub:t,includeTheRampart:!0})?(0,r.FD)("div",{className:l()("page","typography",b.A.container,b.A.containerBulwark),children:[(0,r.Y)(c.X,{idToMagicLink:a,pub:t,user:i}),s&&(0,r.Y)(o.Metadata,(0,n._)({},s))]}):(0,r.FD)("div",{className:l()("page","typography",b.A.container),children:[s&&(0,r.Y)(o.Metadata,(0,n._)({},s)),(0,r.Y)(d.c,{children:(0,r.Y)(w,{idToMagicLink:a,pub:t,user:i})})]})}},99054:function(e,t,i){i.d(t,{$:()=>M});var n=i(69277),r=i(70408),a=i(10201),l=i(3160),o=i(23345),s=i(17402),c=i(79454),d=i(84605),u=i(99145),p=i(12501),h=i(35369),m=i(76977),g=i(16993),f=i(57820),v=i(63136),b=i(39318);function y(e){let{isOpen:t,onClose:i,onSave:l}=e,{iString:o}=(0,d.GO)(),[y,Y]=(0,s.useState)([]),[_,w]=(0,s.useState)({}),[C,k]=(0,s.useState)(!1),[S,I]=(0,s.useState)(!1),{open:F}=(0,u.v9)(),D=()=>{I(!1),i()},{result:T,isLoading:A,refetch:E}=(0,p.st)({pathname:"/api/v1/sponsorship/featured-posts",auto:!1}),{result:N,refetch:P}=(0,p.st)({pathname:"/sponsorship/profile-data",auto:!1});(0,s.useEffect)(()=>{t&&!S?(I(!0),E()):!t&&S&&(Y([]),w({}),I(!1))},[t]),(0,s.useEffect)(()=>{(null==T?void 0:T.post_ids)&&(Y(T.post_ids),P())},[T]),(0,s.useEffect)(()=>{if((null==N?void 0:N.posts)&&(null==T?void 0:T.post_ids)){let e={};N.posts.forEach(t=>{T.post_ids.includes(t.id)&&(e[t.id]=t.title)}),w(t=>(0,n._)({},t,e))}},[N,T]);let x=async()=>{k(!0);try{if(!(await fetch("/api/v1/sponsorship/featured-posts",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_ids:y})})).ok)throw Error("Failed to save featured posts");null==l||l(),D()}catch(e){console.error("Error saving featured posts:",e)}finally{k(!1)}},L=(e,t)=>{let i=[...y],[n]=i.splice(e,1);void 0!==n&&(i.splice(t,0,n),Y(i))};return(0,a.FD)(g.aF,{isOpen:S,onClose:D,width:800,children:[(0,a.Y)(g.rQ,{title:o("Manage Featured Posts"),showClose:!0,onClose:D}),(0,a.Y)(g.cw,{children:(0,a.Y)(m.I1,{gap:24,children:A?(0,a.Y)(m.Ye,{justifyContent:"center",padding:20,children:(0,a.Y)(f.y$,{size:24})}):(0,a.FD)(m.I1,{gap:16,children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.FD)(v.EY.B2,{weight:"semibold",children:[(0,a.Y)(v.EY,{translated:!0,children:"Featured Posts"})," (",y.length,"/10)"]}),(0,a.Y)(h.$n,{size:"sm",priority:"primary",onClick:e=>{e.preventDefault(),console.log("Opening search modal..."),I(!1),F({postsOnly:!0,onSelectResult:async e=>{console.log("onSelectResult callback triggered!",e);let{result:t,onClose:i}=e;if(console.log("result",t),"post"===t.type){let e=(0,b.Gn4)(t.post.url);if(!e){console.log("Could not extract slug from URL:",t.post.url),i(),I(!0);return}console.log("Fetching post by slug:",e);let a=await (0,c.N7)({slug:e});if(!a){console.log("Could not fetch post for slug:",e),i(),I(!0);return}let l=a.id;console.log("Adding post:",l,a.title),!y.includes(l)&&y.length<10&&(Y(e=>[...e,l]),a.title&&w(e=>(0,r._)((0,n._)({},e),{[l]:a.title})))}i(),I(!0)},onClose:()=>{console.log("Search modal closed without selection"),I(!0)}})},disabled:y.length>=10,children:(0,a.Y)(v.EY,{translated:!0,children:"Add Post"})})]}),0===y.length?(0,a.Y)(v.EY.B3,{color:"secondary",children:(0,a.Y)(v.EY,{translated:!0,children:'No posts selected. Click "Add Post" to search and add posts.'})}):(0,a.Y)(m.I1,{gap:8,children:y.map((e,t)=>(0,a.FD)(m.Ye,{gap:12,padding:12,bg:"elevated",radius:"md",justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B3,{weight:"semibold",children:_[e]||"Post ID: ".concat(e)}),(0,a.FD)(m.Ye,{gap:8,children:[t>0&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>L(t,t-1),children:"↑"}),t<y.length-1&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>L(t,t+1),children:"↓"}),(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>{Y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},children:(0,a.Y)(v.EY,{translated:!0,children:"Remove"})})]})]},e))})]})})}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:D,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:x,loading:C,disabled:0===y.length,children:(0,a.Y)(v.EY,{translated:!0,children:"Save Featured Posts"})})})]})}var Y=i(97731);let _=e=>(0,a.Y)(Y.A,(0,r._)((0,n._)({},e),{name:"CommentIcon",svgParams:{height:20,width:14},children:(0,a.Y)("path",{d:"M7.47092 13.7982L7.32727 13.6656H7.13176H2.14118C1.22171 13.6656 0.5 12.944 0.5 12.0679V6.09766C0.5 5.22165 1.22171 4.5 2.14118 4.5H11.8588C12.7783 4.5 13.5 5.22165 13.5 6.09766V12.0679C13.5 12.944 12.7783 13.6656 11.8588 13.6656H10.5412H10.0412V14.1656V16.1657C10.0392 16.1649 10.0339 16.1625 10.0255 16.1565L7.47092 13.7982Z",stroke:"#999999"})}));var w=i(11587);function C(e){let{isOpen:t,onClose:i,onSave:n}=e,{iString:r}=(0,d.GO)(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),{result:Y,isLoading:_,refetch:C}=(0,p.st)({pathname:"/api/v1/sponsorship/stats-config",auto:!1});(0,s.useEffect)(()=>{t?C():(o(""),u(""))},[t]),(0,s.useEffect)(()=>{Y&&(o(JSON.stringify(Y.config,null,2)),u(""))},[Y]);let k=e=>{try{return JSON.parse(e),u(""),!0}catch(e){return u("Invalid JSON: ".concat(e instanceof Error?e.message:String(e))),!1}},S=async()=>{if(k(l)){y(!0);try{let e=JSON.parse(l);if(!(await fetch("/api/v1/sponsorship/stats-config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:e})})).ok)throw Error("Failed to save stats configuration");null==n||n(),i()}catch(t){console.error("Error saving stats config:",t);let e=t instanceof Error?t.message:String(t);e.includes("JSON")?u("Save failed: ".concat(e)):u("Failed to save configuration. Please try again.")}finally{y(!1)}}};return(0,a.FD)(g.aF,{isOpen:t,onClose:i,width:600,children:[(0,a.Y)(g.rQ,{title:r("Edit Sponsorship Stats"),showClose:!0,onClose:i}),(0,a.Y)(g.cw,{children:(0,a.FD)(m.I1,{gap:16,children:[(0,a.Y)(v.EY.B3,{color:"secondary",children:(0,a.Y)(v.EY,{translated:!0,children:"Edit the sponsorship statistics below as JSON. This data will be displayed on the sponsorship profile page."})}),_?(0,a.Y)(m.Ye,{justifyContent:"center",padding:20,children:(0,a.Y)(f.y$,{size:24})}):(0,a.FD)(m.I1,{gap:12,children:[(0,a.Y)(v.EY.B2,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Stats Configuration (JSON)"})}),(0,a.Y)(w.T,{value:l,onChange:e=>{var t;o(t=e.target.value),t.trim()?k(t):u("")},placeholder:r("Enter JSON configuration..."),style:{fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, monospace',fontSize:"14px"}}),c&&(0,a.Y)(v.EY.B4,{color:"error",children:c})]})]})}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:i,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:S,loading:b,disabled:!!c||!l.trim()||_,children:(0,a.Y)(v.EY,{translated:!0,children:"Save Stats"})})})]})}var k=i(46271),S=i(89490),I=i(81203),F=i(94996),D=i(65842),T=i(36372),A=i(32848),E=i(49807);let N="statsContainer-HMgEbx",P=e=>{let{title:t,value:i,listItems:n}=e;return(0,a.FD)(m.I1,{className:"statsBox-esmhyw",gap:16,padding:16,radius:"md",border:"detail-themed",children:[(0,a.Y)(v.EY.Digit,{font:"pub-headings",color:"pub-primary-text",children:t}),n&&(0,a.Y)(S.az,{children:n.map(e=>(0,a.Y)(S.az,{className:"statsItem-zSdbEo",bg:"secondary",paddingX:6,paddingY:2,radius:"sm",children:(0,a.Y)(v.EY.Meta,{color:"pub-primary-text",children:e},e)}))}),i&&(0,a.Y)(v.EY.H4,{font:"pub-headings",color:"pub-primary-text",children:i})]})},x=e=>{let{product:t,onClick:i}=e;return(0,a.FD)(m.Ye,{className:"sponsorshipProductRow-cqWGcn",border:"detail-themed",padding:16,radius:"md",justifyContent:"space-between",alignItems:"start",onClick:i,style:{cursor:"pointer"},children:[(0,a.FD)(m.I1,{gap:4,children:[(0,a.Y)(v.EY.B3,{weight:"semibold",children:t.title}),(0,a.Y)(v.EY.B4,{children:t.description})]}),t.price&&(0,a.Y)(v.EY.B3,{weight:"bold",children:t.price})]})},L=e=>{let{isOpen:t,onClose:i,sponsorshipProducts:l,selectedProduct:o}=e,{iString:c}=(0,d.GO)(),u=(0,T.d)(),[p,b]=(0,s.useState)(!1),[y,Y]=(0,s.useState)({contactName:"",contactEmail:"",sponsorshipType:(null==o?void 0:o.title)||"",brandName:"",campaignDescription:""});(0,s.useEffect)(()=>{(null==o?void 0:o.title)&&Y(e=>(0,r._)((0,n._)({},e),{sponsorshipType:o.title}))},[o]);let _=(e,t)=>{Y(i=>(0,r._)((0,n._)({},i),{[e]:t}))},C=async()=>{if(!y.contactName||!y.contactEmail||!y.sponsorshipType||!y.brandName)return void u.popToast(()=>(0,a.Y)(T.y,{text:c("Please fill in all required fields")}));b(!0);try{if((await fetch("/api/v1/sponsorship/inquiry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,n._)({},y))})).ok)u.popToast(()=>(0,a.Y)(T.y,{text:c("Sponsorship inquiry sent successfully!")})),i(),Y({contactName:"",contactEmail:"",sponsorshipType:(null==o?void 0:o.title)||"",brandName:"",campaignDescription:""});else throw Error("Failed to send inquiry")}catch(e){u.popToast(()=>(0,a.Y)(T.y,{text:c("Failed to send inquiry. Please try again.")}))}finally{b(!1)}};return(0,a.FD)(g.aF,{isOpen:t,onClose:i,children:[(0,a.Y)(g.rQ,{title:c("Sponsorship Inquiry"),onClose:i}),(0,a.FD)(m.I1,{gap:16,padding:24,children:[(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Contact Name"})}),(0,a.Y)(D.ks,{value:y.contactName,onChange:e=>_("contactName",e.target.value),placeholder:c("Enter your name")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Contact Email"})}),(0,a.Y)(D.ks,{type:"email",value:y.contactEmail,onChange:e=>_("contactEmail",e.target.value),placeholder:c("Enter your email")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Sponsorship Type"})}),(0,a.FD)(F.I,{value:y.sponsorshipType,onChange:e=>_("sponsorshipType",e.target.value),children:[(0,a.Y)("option",{value:"",disabled:!0,children:c("Select sponsorship type")}),l.map(e=>(0,a.Y)("option",{value:e.title,children:e.title},e.title))]})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Brand Name"})}),(0,a.Y)(D.ks,{value:y.brandName,onChange:e=>_("brandName",e.target.value),placeholder:c("Enter your brand name")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Description of Campaign"})}),(0,a.Y)(w.T,{value:y.campaignDescription,onChange:e=>_("campaignDescription",e.target.value),placeholder:c("Describe your campaign and goals..."),rows:4})]})]}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:i,disabled:p,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:C,disabled:p,children:p?(0,a.Y)(f.y$,{size:20}):(0,a.Y)(v.EY,{translated:!0,children:"Submit Inquiry"})})})]})},R=e=>{var t;let{post:i,pub:n}=e;return(0,a.FD)(m.I1,{className:"featuredPostContainer-DA7xo_",justifyContent:"space-between",alignItems:"center",as:"a",href:(0,E.wu9)(n,i),target:"_blank",rel:"noopener noreferrer",gap:4,children:[(0,a.FD)(m.I1,{className:"featuredPostPreview-Wv6neL",radius:"md",border:"detail-themed",overflow:"hidden",children:[(0,a.Y)("img",{className:"featuredPostImage-IfvJu6",src:(0,E.dJ9)(null!=(t=i.cover_image)?t:"",900,{crop:"fill",height:470}),alt:i.title}),(0,a.Y)(S.az,{paddingX:12,paddingY:12,children:(0,a.Y)(v.EY.B3,{as:"span",font:"display",weight:"semibold",color:"white",children:i.title})})]}),(0,a.FD)(m.Ye,{gap:16,children:[(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(l.A,{stroke:"#999999",size:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:i.views||0})]}),(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(o.A,{stroke:"#999999",size:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:i.reactions["❤"]||0})]}),(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(_,{width:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:i.comment_count||0})]})]})]})},M=e=>{var t;let{pub:i}=e,{iString:n}=(0,d.GO)(),[r,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[u,g]=(0,s.useState)(!1),[b,Y]=(0,s.useState)(void 0),_=(0,k.Jd)(),{isAuthor:w}=(0,A.NL)(i.id),S=w||(null==_?void 0:_.is_global_admin),{result:F,isLoading:D,error:T,refetch:M}=(0,p.st)({pathname:"/api/v1/sponsorship/profile-data",auto:!0}),B=(null==F?void 0:F.posts)||[],O=null==F?void 0:F.stats;return(0,a.FD)("div",{className:"page typography signup-page",children:[(0,a.Y)("div",{className:"container",children:(0,a.FD)(m.I1,{gap:32,alignItems:"center",children:[(0,a.FD)(m.I1,{alignItems:"center",gap:24,children:[(0,a.Y)(I.Nq,{pub:i,size:64,bg:"transparent"}),(0,a.FD)(m.I1,{alignItems:"center",gap:8,children:[(0,a.Y)(v.EY.H2,{font:"pub-headings",color:"pub-primary-text",align:"center",children:i.name}),(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(null==O?void 0:O.description)||n("Loading description...")})]})]}),(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Publication Stats"})}),S&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>c(!0),children:n("Edit Stats")})]}),(0,a.FD)(m.Ye,{wrap:"wrap",gap:24,children:[!!(null==O?void 0:O.subscribers)&&(0,a.Y)(P,{title:n("Subscribers"),value:O.subscribers.toLocaleString()}),!!(null==O?void 0:O.openRate)&&(0,a.Y)(P,{title:n("Open Rate"),value:"".concat(O.openRate,"%")}),!!(null==O?void 0:O.clickThroughRate)&&(0,a.Y)(P,{title:n("Click Rate"),value:"".concat(O.clickThroughRate,"%")}),!!(null==O?void 0:O.engagementRate)&&(0,a.Y)(P,{title:n("Engagement Rate"),value:"".concat(O.engagementRate,"%")}),!!(null==O?void 0:O.categories)&&O.categories.length>0&&(0,a.Y)(P,{title:n("Categories"),listItems:O.categories}),!!(null==O?void 0:O.topReaderLocations)&&O.topReaderLocations.length>0&&(0,a.Y)(P,{title:n("Top Reader Locations"),listItems:O.topReaderLocations})]})]}),(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Featured Posts"})}),S&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>l(!0),children:n("Manage")})]}),(0,a.Y)(m.Ye,{wrap:"wrap",justifyContent:"space-between",children:D?(0,a.Y)(m.Ye,{justifyContent:"center",padding:32,children:(0,a.Y)(f.y$,{size:24})}):T?(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(0,a.Y)(v.EY,{translated:!0,children:"Unable to load featured posts"})}):B.length>0?B.map(e=>(0,a.Y)(R,{post:e,pub:i},e.id)):(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(0,a.Y)(v.EY,{translated:!0,children:"No featured posts available"})})})]}),(null==F||null==(t=F.stats)?void 0:t.partnerLogos)&&F.stats.partnerLogos.length>0&&(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Selected Brand Partners"})}),(0,a.Y)(m.Ye,{gap:24,wrap:"wrap",children:F.stats.partnerLogos.map(e=>(0,a.Y)("img",{className:"partnerLogo-BH1k1a",src:(0,E.dJ9)(e,300,{})},e))})]}),(null==O?void 0:O.sponsorshipProducts)&&O.sponsorshipProducts.length>0&&(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Available sponsorships"})}),O.sponsorshipProducts.map((e,t)=>(0,a.Y)(x,{product:e,onClick:()=>{Y(e),g(!0)}},t))]})]})}),(0,a.Y)(y,{pub:i,isOpen:r,onClose:()=>l(!1),onSave:()=>{M()}}),(0,a.Y)(C,{pub:i,isOpen:o,onClose:()=>c(!1),onSave:()=>{M()}}),(0,a.Y)(L,{isOpen:u,onClose:()=>{g(!1),Y(void 0)},sponsorshipProducts:(null==O?void 0:O.sponsorshipProducts)||[],selectedProduct:b,pub:i})]})}},19568:function(e,t,i){i.d(t,{S:()=>T});var n=i(69277),r=i(70408),a=i(10201),l=i(32485),o=i.n(l),s=i(17402),c=i(13950),d=i(84605),u=i(86500),p=i(12501),h=i(35369),m=i(60322),g=i(49045),f=i(76977),v=i(95477),b=i(63136),y=i(11587),Y=i(65842),_=i(21398),w=i(39318),C=i(49807),k=i(57324);let S=e=>["checkbox","checkbox_freeform","radio","radio_freeform"].includes(e||""),I=e=>["checkbox_freeform","radio_freeform"].includes(e||""),F=e=>{let{question:t,responseData:i,onChange:l,disabled:o=!1,countries:c}=e,{iString:u}=(0,d.GO)(),p=(0,s.useMemo)(()=>{if("country"===t.type&&i.value&&c){let e=String(i.value).split(",")[0],t=c.find(t=>t.countryShortCode===e);return t?{value:t.countryShortCode,label:t.countryName,regions:t.regions}:null}return null},[i.value]),h=(0,s.useMemo)(()=>{if("country"===t.type&&(null==p?void 0:p.regions)&&c&&i.value){let e=String(i.value).split(",")[1],t=p.regions.find(t=>t.shortCode===e);return t?{value:t.shortCode,label:t.name}:null}return null},[p,i.value]);return(0,a.FD)(f.I1,{gap:16,children:[(0,a.FD)(b.EY.H4,{children:[t.displayLabel,t.is_required&&(0,a.Y)(b.EY.H4,{as:"span",color:"error",children:"*"})]}),"text"===t.type&&(0,a.Y)(y.T,{disabled:o,placeholder:u("Type here"),value:String(i.value||""),onChange:e=>{i.value=e.currentTarget.value,l(i)}}),"number"===t.type&&(0,a.Y)(Y.ks,{disabled:o,placeholder:u("Type number value here"),value:Number.isNaN(Number(i.value))?"":i.value,onChange:e=>{i.value=Number(e.currentTarget.value.replace(/[^\d]/g,""))||0,l(i)}}),"country"===t.type&&(0,a.FD)(f.I1,{gap:24,children:[(0,a.Y)(g.Z,{options:(null==c?void 0:c.map(e=>({label:e.countryName,value:e.countryShortCode})))||[],value:(null==p?void 0:p.value)||null,onChange:e=>{e&&l((0,r._)((0,n._)({},i),{value:e}))},placeholder:u("Select or search for a country...")}),i.value&&(null==p?void 0:p.regions)&&(0,a.Y)(g.Z,{options:p.regions.map(e=>({label:e.name,value:e.shortCode})),value:(null==h?void 0:h.value)||null,onChange:e=>{e&&l((0,r._)((0,n._)({},i),{value:"".concat(String(i.value).split(",")[0],",").concat(e)}))},placeholder:u("Select or search for a state, province, or region...")})]}),S(t.type)&&t.options&&t.options.map(e=>(0,a.FD)(f.Ye,{as:"label",gap:16,children:[("checkbox"===t.type||"checkbox_freeform"===t.type)&&(0,a.Y)(m.S,{disabled:o,name:"".concat(t.id,"check"),checked:i.options.indexOf(String(e.id))>-1,onChange:t=>{let a=i.options.filter(t=>t!==String(e.id));t&&a.push(String(e.id)),l((0,r._)((0,n._)({},i),{options:a}))}}),("radio"===t.type||"radio_freeform"===t.type)&&(0,a.Y)(v.s,{disabled:o,value:String(e.id),name:"".concat(t.id,"check"),checked:i.options.indexOf(String(e.id))>-1,onClick:t=>{let i=[];t.target.checked&&i.push(String(e.id)),l({value:"",options:i})}}),(0,a.Y)(b.EY.B3,{children:e.label})]})),I(t.type)&&(0,a.FD)(f.Ye,{as:"label",gap:16,alignItems:"center",children:[("checkbox"===t.type||"checkbox_freeform"===t.type)&&(0,a.Y)(m.S,{disabled:o,name:"".concat(t.id,"check"),checked:String(i.value).length>0,onChange:e=>{e?l((0,r._)((0,n._)({},i),{value:" "})):l((0,r._)((0,n._)({},i),{value:""}))}}),("radio"===t.type||"radio_freeform"===t.type)&&(0,a.Y)(v.s,{disabled:o,value:"text",name:"".concat(t.id,"check"),checked:String(i.value).length>0,onClick:()=>{l({options:[],value:" "})}}),(0,a.Y)(Y.ks,{disabled:o,placeholder:u("What is your gender?"===t.label?"Prefer to self describe":"Other..."),value:String(i.value||""),onChange:e=>{i.value=e.currentTarget.value,i.value.length>0&&("radio"===t.type||"radio_freeform"===t.type)&&(i.options=[]),l(i)}})]})]})},D=e=>{let{surveyId:t,user:l,pub:u,token:m=""}=e,{iString:g}=(0,d.GO)(),[v,y]=(0,s.useState)({}),{result:Y,isLoading:D,refetch:T}=(0,p.st)({pathname:"/api/v1/survey/".concat(t),auto:!0,query:{token:m||void 0}});(0,s.useEffect)(()=>{if(!D&&Y&&!A){var e;(null==(e=Y.questions)?void 0:e.some(e=>"country"===e.type))&&E()}},[Y,D]);let{result:A,fetch:E}=(0,_.vZ)({module:"country-region-data/data.json",onRequest:()=>i.e("8623").then(i.t.bind(i,53314,19)),fetchImmediately:!1}),N=(0,p.st)({method:"post",pathname:"/api/v1/survey/".concat(t,"/responses"),auto:!1,json:{responses:Object.keys(v).map(e=>({survey_question_id:e,data:v[e]}))},query:{token:m||void 0}}),P=(0,s.useCallback)(async()=>{N.isLoading||(await N.refetch(),await T())},[N]);if(!Y&&!D)return(0,a.Y)(f.I1,{paddingTop:48,gap:48,children:(0,a.Y)(b.EY.H1,{translated:!0,children:"There was an error fetching this survey."})});if(!Y)return(0,a.Y)("div",{});if(Y.hasCurrentUserResponded)return(0,a.FD)(f.I1,{paddingTop:48,gap:24,alignItems:"center",justifyContent:"center",children:[(0,a.Y)(b.EY.H1,{translated:!0,children:"Thank you!"}),(0,a.Y)(b.EY.B3,{translated:!0,children:"Your response has been recorded."})]});let{questions:x=[],title:L}=Y,R=!!l,M=l&&l.is_free_subscribed,B=R&&M,O=B&&x.reduce((e,t)=>{let i=!0;if(t.is_required){let e=v[t.id];if("text"===t.type)i=String((null==e?void 0:e.value)||"").length>0;else if("number"===t.type)i=!Number.isNaN(Number(null==e?void 0:e.value));else if("country"===t.type)i=2===String((null==e?void 0:e.value)||"").split(",").length;else if(S(t.type)){let n=e&&Array.isArray(null==e?void 0:e.options)?e.options:[],r=String((null==e?void 0:e.value)||"");i=I(t.type)?n.length>0||r.length>0:n.length>0}}return e&&i},!0);return(0,a.Y)(c.DH,{children:(0,a.FD)(f.I1,{paddingTop:48,gap:48,children:[(0,a.Y)(b.EY.H1,{color:"pub-primary-text",children:L}),!R&&(0,a.Y)(f.Ye,{alignItems:"center",justifyContent:"center",borderBottom:"detail",paddingBottom:48,children:(0,a.FD)(f.I1,{border:"detail",padding:24,gap:24,sizing:"border-box",radius:"md",children:[(0,a.FD)(b.EY.H4,{translated:!0,children:["Sign in to answer this survey from ",I18N.p(u.name)]}),(0,a.Y)(h.$n,{localNavigation:!1,priority:"primary",href:(0,w.a7q)({for_pub:u.subdomain,redirect:window.location.href}),children:g("Sign in")})]})}),R&&!M&&(0,a.Y)(f.Ye,{alignItems:"center",justifyContent:"center",borderBottom:"detail",paddingBottom:48,children:(0,a.FD)(f.I1,{border:"detail",padding:24,gap:24,sizing:"border-box",radius:"md",children:[(0,a.FD)(b.EY.H4,{translated:!0,children:["Subscribe to ",I18N.p(u.name)," to answer this survey."]}),(0,a.Y)(h.$n,{localNavigation:!1,priority:"primary",href:(0,C.eV6)(u,{params:{next:window.location.href,email:l.email,just_signed_up:!0,autoSubmit:!0,utm_source:k.VU.substack,utm_medium:k.Jn.email,utm_content:k.fL.readerSurveySubscribePrompt}}),children:g("Subscribe")})]})}),(B||!u.invite_only)&&(0,a.FD)(f.I1,{gap:48,className:o()({"questionListDisabled-_qB8wZ":!B}),paddingBottom:48,children:[x.map(e=>{let t=v[e.id]?v[e.id]:{options:[],value:""};return(0,a.Y)(F,{question:e,responseData:t,disabled:!B,countries:null==A?void 0:A.default,onChange:t=>{y((0,r._)((0,n._)({},v),{[e.id]:t}))}},e.id)}),(0,a.Y)(h.$n,{disabled:!O,priority:"primary",onClick:P,children:g("Submit")})]})]})})},T=e=>{let{surveyId:t,user:i,pub:n,token:r=""}=e;return(0,s.useEffect)(()=>{(0,u.u4)(u.qY.READER_SURVEY_SEEN,{surveyId:t,isLoggedIn:!!i,isSubscribed:null==i?void 0:i.is_free_subscribed})},[t]),(0,a.Y)("div",{className:"container",children:(0,a.Y)(D,{surveyId:t,user:i,pub:n,token:r})})}},48825:function(e,t,i){i.d(t,{A:()=>m});var n=i(10201),r=i(13950),a=i(72987),l=i(12501),o=i(16447),s=i(10939),c=i(68410),d=i(93800),u=i(6998),p=i(12592),h=i(4016);function m(e){var t,i,m,g;let{slug:f,pub:v,user:b,tagPagePreloads:y,utm:Y}=e,{isTablet:_}=(0,c.sM)(),w=(0,l.st)({pathname:"/api/v1/publication/post-tag/slug/".concat(f),auto:(null==y?void 0:y.slug)!==f,initialResult:(null==y?void 0:y.slug)===f&&null!=(m=y.postTag)?m:void 0,deps:[y,f]}),C=(0,h.S2)({pub:v});return(0,h.lu)({pub:v})?(0,n.Y)(n.FK,{children:w.isLoading?(0,n.Y)(p.c,{children:(0,n.Y)("p",{className:"main-loader",children:"Loading..."})}):(0,n.Y)(a.N,{isPodcast:!1,isTagPage:!0,newPosts:(null==y?void 0:y.slug)===f?y.posts:void 0,pub:v,section:null,tag:null!=(g=w.result)?g:void 0,user:b,utm:Y})}):(0,n.Y)(p.c,{columns:C?4:2,children:w.isLoading?(0,n.Y)("p",{className:"main-loader"}):(0,n.Y)(n.FK,{children:(0,n.FD)(r.DH,{children:[(0,n.Y)(u.X,{name:(null==(t=w.result)?void 0:t.name)||"Page not found",description:null,logoUrl:null,pub:v}),(0,n.Y)(s.r,{}),(0,n.Y)(o.M,{user:b,pub:v,renderTabs:C?()=>null:void 0,renderLoading:()=>null,sort:"new",postTagId:null==(i=w.result)?void 0:i.id,newPosts:(null==y?void 0:y.slug)===f?y.posts:null,source:"tag-archive",utm:Y,children:e=>{var t;let{posts:i,linkToComments:r,onClickPost:a}=e;return(0,n.Y)(d.m,{hideImages:null==(t=v.theme)?void 0:t.hide_images_from_list,hideHorizontalDividers:C,linkToComments:r,posts:i,variant:C?_?"three-column-grid":"four-column-grid":"two-column-list",onClickPost:a})}})]})})})}},86109:function(e,t,i){i.d(t,{S:()=>eU});var n=i(69277),r=i(10201),a=i(35970),l=i.n(a),o=i(38970),s=i.n(o),c=i(35880),d=i.n(c),u=i(48635),p=i(17402),h=i(79909),m=i(13950),g=i(40075),f=i(12501),v=i(68410),b=i(24782),y=i(28528),Y=i(85965),_=i(12592),w=i(65892),C=i(15734),k=i.n(C),S=i(70408),I=i(15871),F=i(43627),D=i(74979),T=i(83673),A=i.n(T),E=i(33031),N=i.n(E),P=i(48697),x=i(35369),L=i(76977),R=i(25318),M=i(94996),B=i(63136);function O(e){let{pub:t,selected:i,onChangeSelected:n,label:a="Sections and tags"}=e,{result:l,isLoading:o}=(0,f.st)({pathname:"/api/v1/publication/post-tag",auto:!0,deps:[t.id]}),s=(0,I.FR)((0,I.MS)(I.AN,{activationConstraint:{distance:5}})),c=(0,p.useMemo)(()=>l?[...N()(t.sections,e=>e.name.toLowerCase()).map(e=>({value:"section:".concat(e.id),label:e.name})),...N()(l,e=>e.name.toLowerCase()).map(e=>({value:"tag:".concat(e.id),label:e.name}))]:null,[t.sections,l]),d=(0,p.useMemo)(()=>{let e=i.map(e=>{if("section"===e.post_source){let i=t.sections.find(t=>t.id===e.section_id);return i?{value:"section:".concat(i.id),label:i.name}:null}let i=null==l?void 0:l.find(t=>t.id===e.post_tag_id);return i?{value:"tag:".concat(i.id),label:i.name}:null});return A()(e)},[i,t.sections,l]),u=(0,p.useMemo)(()=>{var e;let t=new Set(d.map(e=>e.value));return null!=(e=null==c?void 0:c.filter(e=>!t.has(e.value)))?e:null},[c,d]),h=e=>{let t=d.findIndex(t=>t.value===e);if(-1===t)return;let r=[...i];r.splice(t,1),n(r)};return o?(0,r.Y)("div",{children:(0,r.Y)(B.EY.B4,{color:"secondary",children:"Loading..."})}):(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(R.D,{label:a,children:(0,r.Y)(L.I1,{gap:8,children:d.length?(0,r.Y)(I.Mp,{collisionDetection:I.fp,sensors:s,onDragEnd:e=>{let{active:t,over:r}=e;if(!r||t.id===r.id)return;let a=d.findIndex(e=>e.value===t.id),l=d.findIndex(e=>e.value===r.id);-1===a||-1===l||n((0,F.be)(i,a,l))},children:(0,r.Y)(F.gB,{items:d.map(e=>e.value),strategy:F.kL,children:d.map(e=>(0,r.Y)(U,{id:e.value,children:(0,r.Y)(j,{label:e.label,value:e.value,onRemove:h})},e.value))})}):(0,r.Y)(B.EY.B3,{color:"pub-secondary-text",children:"No sections or tags selected"})})}),(0,r.Y)(R.D,{label:"Add section or tag",children:(0,r.FD)(M.I,{value:"",onChange:e=>{(e=>{if(!e)return;let[t,r]=e.split(":");("section"!==t||r)&&("tag"!==t||r)&&n([...i,"section"===t?{post_source:"section",section_id:parseInt(r),post_tag_id:null}:{post_source:"tag",section_id:null,post_tag_id:r}])})(e.target.value)},children:[(0,r.Y)(M.K,{children:"Select section or tag"}),u&&(0,r.FD)(r.FK,{children:[u.filter(e=>e.value.startsWith("section:")).map(e=>(0,r.Y)("option",{value:e.value,children:e.label})),u.filter(e=>e.value.startsWith("tag:")).map(e=>(0,r.Y)("option",{value:e.value,children:e.label}))]})]})})]})}function U(e){let{id:t,children:i}=e,{attributes:a,isDragging:l,listeners:o,setNodeRef:s,transform:c,transition:d}=(0,F.gl)({id:t}),u={transform:D.Ks.Translate.toString(c),transition:d,zIndex:+!!l,cursor:l?"grabbing":"grab"};return(0,r.Y)("div",(0,S._)((0,n._)({ref:s},a,o),{role:"button",style:u,children:i}))}function j(e){let{value:t,label:i,onRemove:n}=e;return(0,r.FD)(L.Ye,{alignItems:"center",bg:"white",border:"detail-themed",justifyContent:"space-between",paddingLeft:12,paddingRight:8,paddingY:8,radius:"sm",children:[(0,r.Y)(B.EY.B4,{weight:"semibold",children:i}),(0,r.Y)(x.K0,{size:"xs",onClick:()=>n(t),children:(0,r.Y)(P.A,{size:14})})]})}var z=i(16993);let H=e=>{let{pub:t,sources:i,user:n}=e,[a,l]=(0,p.useState)(!1);return n.is_admin?(0,r.FD)(r.FK,{children:[(0,r.Y)(x.K0,{onClick:()=>l(!0),children:(0,r.Y)(w.A,{size:16})}),a&&(0,r.Y)(W,{initialSources:i,isOpen:a,pub:t,onClose:()=>l(!1)})]}):null},W=e=>{let{isOpen:t,pub:i,initialSources:n,onClose:a}=e,[l,o]=(0,p.useState)(n),[s,c]=(0,p.useState)(!1),d=async()=>{c(!0);let e=await k().put("/watch/config").send({value:{sources:l}});200!==e.status?console.error("Failed to save video page options:",e.body):(c(!1),window.location.reload())};return(0,r.FD)(z.aF,{isOpen:t,onClose:a,children:[(0,r.Y)(z.rQ,{showClose:!0,title:"Update Sections/Tags",onClose:a}),(0,r.Y)(z.cw,{children:(0,r.FD)(L.I1,{gap:24,children:[(0,r.Y)(O,{label:"Sections and tags",pub:i,selected:l,onChangeSelected:e=>{o(e)}}),(0,r.Y)(x.$n,{disabled:s,onClick:d,children:"Save"})]})})]})};var V=i(6632),K=i(43241),q=i(23623),G=i(56897),J=i(38305),$=i(27437),Z=i(24078),Q=i(22057),X=i(16291);let ee=e=>{let{post:t,hideAvatars:i}=e;return(0,r.FD)(L.Ye,{alignItems:"center",gap:16,children:[!i&&(0,r.Y)(Q.Z,{max:4,renderAvatar:e=>(0,r.Y)(Z.tp,(0,S._)((0,n._)({},e),{noBase:!1})),size:36,users:t.publishedBylines}),(0,r.FD)(L.Ye,{alignItems:"baseline",gap:2,children:[(0,r.Y)(B.EY.Meta,{color:"primary",nowrap:!0,children:(0,X.A)(t.post_date).locale("en").format("MMM DD")}),(0,r.Y)(B.EY.B3,{color:"primary",children:"∙"}),(0,r.Y)(B.EY.Meta,{color:"primary",children:(0,r.Y)(J.K,{array:t.publishedBylines,formatter:e=>(0,r.Y)($.ProfileHoverCard,{disabled:!1,subject:e,utmSource:"byline",trigger:(0,r.Y)(B.EY,{as:"a",decoration:"hover-underline",children:e.name})}),limit:4})})]})]})};var et=i(17096),ei=i(56878),en=i(93564),er=i(49807),ea=i(82776),el=i(57324);let eo=e=>{let{post:t,pub:i,user:n,post_reaction_token:a}=e,[l,o]=(0,p.useState)(!1);if(!l){var s;return(0,r.FD)(x.$n,{priority:"secondary",onClick:()=>o(!0),children:["Show ",(0,ea.pluralize)(null!=(s=t.comment_count)?s:0,"comment",{zero_fallback:"comments"})]})}return(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(x.$n,{priority:"secondary",onClick:()=>o(!1),children:"Hide comments"}),(0,r.Y)(es,{post:t,post_reaction_token:a,pub:i,user:n})]})},es=e=>{let{post:t,pub:i,user:a,post_reaction_token:l}=e,[o,s]=(0,p.useState)([]),[c,d]=(0,p.useState)(!1),[u,h]=(0,p.useState)(t.default_comment_sort||i.default_comment_sort||"best_first"),m=(0,p.useRef)(!1),g=(0,p.useCallback)(async()=>{if(!m.current){m.current=!0,d(!0);try{let e=await k().get("/api/v1/post/".concat(t.id,"/comments")).query({token:l||"",all_comments:!0,sort:u});e.body.comments&&s(e.body.comments)}catch(e){console.error("Failed to load comments:",e)}finally{d(!1),m.current=!1}}},[t.id,l,u]);(0,p.useEffect)(()=>{g()},[g]);let f=i.community_enabled&&"none"!==t.write_comment_permissions;return f&&!(0,ea.canSeeComments)(a,t)?(0,r.FD)(L.I1,{alignItems:"center",gap:16,paddingTop:16,children:[(0,r.Y)(B.EY.B3,{align:"center",color:"primary",children:"Comments on this video are for paid subscribers only."}),(0,r.Y)(x.vx,{href:(0,er.eV6)(i,{addBase:!0,params:{utm_source:el.VU.videosPage,next:window.location.href}}),priority:"primary-mono",children:(null==a?void 0:a.is_free_subscribed)?"Upgrade now":"Subscribe now"})]}):(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(en.o6,{comments:o,handleSort:e=>{c||(h(e),g())},post:t,publication:i,sort:u}),f&&(0,r.Y)(ei.g,{post:t,pub:i,token:l,user:a,onSuccess:e=>{s([e,...o])}}),c?(0,r.Y)(B.EY.B3,{color:"secondary",children:"Loading comments..."}):o.length>0?(0,r.Y)(et.Wh,{comments:o,depth:0,pageSize:et.yQ,post:t,pub:i,reaction_token:l,retainUserCollapseState:!0,user:a,onChange:e=>{let t=i=>i.map(i=>i.id===e.id?e:i.children?(0,S._)((0,n._)({},i),{children:t(i.children)}):i);s(t(o))}}):(0,r.Y)(B.EY.B3,{color:"primary",children:"No comments yet, be the first to comment."})]})};var ec=i(32485),ed=i.n(ec),eu=i(23345),ep=i(54687),eh=i(15977),em=i(72170),eg=i(41935),ef=i(33460);let ev="container-VAP7_O",eb=e=>{var t;let{post:i,pub:n,user:a,hideComments:l,hideReadMore:o,onToggleComments:s}=e,{modifiedPosts:c,onChangePost:d}=(0,y.np)(),p=null!=(t=c[i.id])?t:i;return(0,r.FD)(L.Ye,{alignItems:"center",gap:8,children:[(0,r.Y)(ey,{post:p,pub:n,user:a,onChange:d}),!l&&(0,r.Y)(eY,{post:p,onClick:s}),(0,r.Y)(e_,{post:p,pub:n,onChange:d}),(0,r.Y)(ew,{post:p,pub:n,user:a}),!o&&(0,r.Y)(x.vx,{href:p.canonical_url,priority:"secondary-outline",rounded:!0,size:"sm",trailing:(0,r.Y)(u.A,{size:16}),children:"Read more"})]})},ey=e=>{var t;let{post:i,pub:n,user:a,onChange:l}=e,o=null!=(t=i.reactions["❤"])?t:0;return(0,r.Y)(eg.Z4,{isStatic:!1,post:i,pub:n,style:"button",user:a,onChange:l,children:e=>{let{isLiked:t,handleLike:i}=e;return(0,r.Y)(x.$n,{className:ed()({"likedButton-wcNuvL":t}),leading:(0,r.Y)(eu.A,{className:ed()({"likedHeart-YgbVH4":t}),size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:i,children:o>0?o:""})}})},eY=e=>{let{post:t,onClick:i}=e;return(0,r.Y)(x.$n,{leading:(0,r.Y)(ep.A,{size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:i,children:t.comment_count>0?t.comment_count:""})},e_=e=>{let{post:t,pub:i,onChange:n}=e;return(0,r.Y)(eg.sk,{isStatic:!1,post:t,pub:i,renderTrigger:e=>{let{isRestacked:t,isDisabled:i,restacks:n,onClick:a}=e;return(0,r.Y)(x.$n,{disabled:i,leading:(0,r.Y)(eh.A,{className:ed()({"hasRestacked-aM4l_G":t}),size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:a,children:n>0?n:""})},style:"button",onChange:n})},ew=e=>{let{post:t,pub:i,user:n}=e;return(0,r.Y)(ef.$8,{post:t,pub:i,trigger:(0,r.Y)(x.$n,{leading:(0,r.Y)(em.A,{size:16}),priority:"secondary-outline",rounded:!0,size:"sm",children:""}),user:n})};var eC=i(74762),ek=i(88553);function eS(e){let{isActive:t,durationSeconds:i,onElapsed:n}=e,[r,a]=(0,p.useState)(i),l=(0,p.useRef)(null),o=(0,p.useRef)(!1),s=(0,p.useCallback)(()=>{o.current||(o.current=!0,null!==l.current&&(window.clearInterval(l.current),l.current=null),n())},[n]);return(0,p.useEffect)(()=>{if(!t){null!==l.current&&(window.clearInterval(l.current),l.current=null),o.current=!1;return}a(i),o.current=!1;let e=window.setInterval(()=>{a(e=>Math.max(0,e-1))},1e3);return l.current=e,()=>{window.clearInterval(e),l.current=null}},[t,i]),(0,p.useEffect)(()=>{r<=0&&s()},[r,s]),{secondsLeft:r,triggerNow:s}}let eI=e=>{let{children:t}=e,[i,n]=(0,p.useState)(!1);return(0,p.useEffect)(()=>{setTimeout(()=>{n(!0)},10)},[]),(0,r.Y)(L.I1,{alignItems:"center",className:ed()("container-Fv_hVp","container--animated-vagNJl",{"container--animated-in-jn7ZQU":i}),inset:0,justifyContent:"center",position:"absolute",children:t})},eF="button-aEg0kT",eD=e=>{let{nextPost:t,onClickPost:i,onClose:n}=e,{secondsLeft:a,triggerNow:l}=eS({isActive:!0,durationSeconds:10,onElapsed:(0,p.useCallback)(()=>{i({post:t})},[i,t])});return(0,r.Y)(eI,{children:(0,r.FD)(L.I1,{gap:12,style:{maxWidth:380},children:[(0,r.FD)(B.EY.Meta,{color:"secondary",children:["Up next in"," ",(0,r.Y)(B.EY.Meta,{as:"span",color:"primary",children:a})]}),(0,r.Y)("div",{onClick:l,children:(0,r.Y)(eC.t,{className:"coverImage-cT2VSY",hideTimestampIcon:!0,imageAspectRatio:ek.fg,imageWidth:380,isBelowTheFold:!0,playButtonSize:40,post:t})}),(0,r.Y)(B.EY.B3,{color:"primary",weight:"semibold",children:t.title}),(0,r.FD)(L.Ye,{gap:8,children:[(0,r.Y)(x.$n,{className:eF,priority:"secondary",onClick:n,children:"Cancel"}),(0,r.Y)(x.$n,{className:eF,priority:"primary-mono",onClick:l,children:"Play now"})]})]})})};var eT=i(67078),eA=i(68349),eE=i(39318);let eN=e=>{let{nextPost:t,post:i,pub:n,user:a,onClickPost:l,onRestart:o}=e,[s,c]=(0,p.useState)(!1),{secondsLeft:d,triggerNow:u}=eS({isActive:!s,durationSeconds:10,onElapsed:(0,p.useCallback)(()=>{t&&l({post:t})},[l,t])}),h=(0,p.useCallback)(()=>{(0,eA.V2)((0,eE.my9)(n,{simple:!0,next:document.location.href,utm_source:el.VU.videosPage,utm_medium:el.Jn.web,utm_content:i.id}),{local_navigation:!1})},[]);return(0,r.FD)(eI,{children:[(0,r.FD)(L.I1,{gap:16,style:{maxWidth:300},children:[(0,r.FD)(L.I1,{gap:4,children:[(0,r.FD)(L.Ye,{alignItems:"center",color:"primary",gap:6,justifyContent:"center",children:[(0,r.Y)(eT.A,{size:16}),(0,r.Y)(B.EY.B2,{color:"primary",textAlign:"center",children:"Paid"})]}),(0,r.Y)(B.EY.B3,{color:"secondary",textAlign:"center",children:"Subscribe to watch the full episode."})]}),(0,r.FD)(L.Ye,{gap:8,children:[o&&(0,r.Y)(x.$n,{flex:"fill",priority:"secondary",onClick:o,children:"Replay"}),(0,r.FD)(x.$n,{flex:"fill",priority:"primary-mono",onClick:h,children:[(null==a?void 0:a.is_free_subscribed)?"Upgrade":"Subscribe"," to watch"]})]})]}),!s&&t&&(0,r.Y)(eP,{nextPost:t,secondsLeft:d,onClickPlayNow:u,onClose:()=>c(!0)})]})},eP=e=>{let{secondsLeft:t,onClickPlayNow:i,nextPost:n,onClose:a}=e;return(0,r.FD)(L.Ye,{alignItems:"center",bg:"elevated-secondary",color:"primary",cursor:"pointer",gap:16,position:"absolute",radius:"xs",style:{bottom:16,right:16},onClick:i,children:[(0,r.Y)(eC.t,{className:"coverImageSmall-hsxEBv",disableVideoHover:!0,hideTimestamp:!0,imageAspectRatio:ek.fg,imageWidth:100,isBelowTheFold:!0,playButtonSize:null,post:n}),(0,r.FD)(L.I1,{children:[(0,r.FD)(B.EY.Meta,{color:"primary",children:["Up next in ",t]}),(0,r.Y)(B.EY.B4,{clamp:1,color:"primary",weight:"semibold",children:n.title})]}),(0,r.Y)(L.I1,{alignSelf:"start",children:(0,r.Y)(x.K0,{priority:"quaternary",size:"sm",onClick:e=>{e.stopPropagation(),a()},children:(0,r.Y)(P.A,{size:16})})})]})};var ex=i(47639),eL=i(56262);let eR=e=>{var t,i;let{autoPlay:n,nextPost:a,post:l,pub:o,user:s,videoPlayerRef:c,onClickPost:d}=e,{isMobile:u}=(0,v.sM)(),[h,m]=(0,p.useState)(!1),g=(null!=(i=null==(t=l.videoUpload)?void 0:t.preview_duration)?i:0)>0,f=(0,eL.isPaidAudience)(l.audience)&&!(null==s?void 0:s.is_subscribed);return l.videoUpload?(0,r.FD)(r.FK,{children:[(0,r.Y)(ex.U,{borderRadius:u?"none":"sm",forceAutoPlay:n,isFreeSubscribed:!!(null==s?void 0:s.is_free_subscribed),isSubscribed:!!(null==s?void 0:s.is_subscribed),mediaUpload:l.videoUpload,post:l,pub:o,renderPaywall:e=>{let{onRestart:t}=e;return(0,r.Y)(eN,{nextPost:a,post:l,pub:o,user:s,onClickPost:d,onRestart:t})},variant:"inbox",videoPlayerRef:c,onFinishVideo:()=>{f&&g||m(!0)}}),a&&h&&(0,r.Y)(eD,{nextPost:a,onClickPost:d,onClose:()=>m(!1)})]}):null},eM=e=>{let{isInitialPost:t,pub:i,user:n,currentPost:a,recentPosts:l,onClickPost:o}=e,{isMobile:s}=(0,v.sM)(),c=(0,p.useRef)(null),[d,u]=(0,p.useState)(!1),h=l.findIndex(e=>e.id===a.id),m=-1===h||h===l.length-1?l[0]:l[h+1];if(!a.videoUpload)return null;let g=l.filter(e=>e.id!==a.id),f=i.sections.find(e=>e.id===a.section_id),b=g.length>5;return s?(0,r.Y)(eB,{currentPost:a,isInitialPost:t,nextPost:null!=m?m:null,pub:i,recentPosts:g,user:n,onClickPost:o}):(0,r.Y)(q.a,{children:(0,r.Y)("div",{className:ev,children:(0,r.Y)(_.c,{columns:4,paddingTop:0,children:(0,r.FD)("div",{className:"playerAndListContainer-hwEtfH",children:[(0,r.FD)(L.I1,{gap:24,children:[(0,r.Y)(L.I1,{position:"relative",children:(0,r.Y)(eR,{autoPlay:!t,nextPost:null!=m?m:null,post:a,pub:i,user:n,videoPlayerRef:c,onClickPost:o})}),(0,r.FD)(L.I1,{gap:12,children:[(0,r.FD)(L.I1,{gap:8,children:[f&&(0,r.Y)(B.EY.Meta,{color:"accent",children:f.name}),(0,r.Y)(B.EY.H3,{color:"primary",weight:"medium",children:a.title})]}),(0,r.FD)(L.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,r.Y)(ee,{post:a}),(0,r.Y)(eb,{hideComments:!0,post:a,pub:i,user:n})]})]}),(0,r.Y)(eo,{post:a,pub:i,user:n})]}),(0,r.FD)(L.I1,{paddingBottom:40*!!d,position:"relative",children:[(0,r.Y)(L.I1,{inset:0,overflowY:d?"auto":"hidden",position:d?"relative":"absolute",children:(0,r.Y)(L.I1,{gap:16,children:g.map(e=>(0,r.Y)(G.z,{post:e,variant:"mini-video",onClick:o}))})}),b&&(0,r.Y)(L.I1,{alignItems:"center",className:"recentPostsBottom-l1j3wA",position:"absolute",children:(0,r.Y)(x.$n,{priority:"secondary",size:"sm",onClick:()=>u(!d),children:d?(0,r.Y)(V.A,{size:16}):(0,r.Y)(K.A,{size:16})})})]})]})})})})},eB=e=>{let{isInitialPost:t,pub:i,user:n,currentPost:a,nextPost:l,recentPosts:o,onClickPost:s}=e,c=(0,p.useRef)(null),[d,u]=(0,p.useState)(!1);if(!a.videoUpload)return null;let h=i.sections.find(e=>e.id===a.section_id);return(0,r.FD)(r.FK,{children:[(0,r.Y)(q.a,{children:(0,r.FD)("div",{className:ev,children:[(0,r.Y)(eR,{autoPlay:!t,nextPost:l,post:a,pub:i,user:n,videoPlayerRef:c,onClickPost:s}),(0,r.FD)(L.I1,{gap:16,paddingX:16,paddingY:12,children:[(0,r.FD)(L.I1,{gap:8,children:[h&&(0,r.Y)(B.EY.Meta,{color:"accent",children:h.name}),(0,r.Y)(B.EY.B3,{color:"primary",weight:"semibold",children:a.title})]}),(0,r.Y)(ee,{post:a}),(0,r.Y)(eb,{hideReadMore:!0,post:a,pub:i,user:n,onToggleComments:()=>{u(!d)}}),d&&(0,r.Y)(es,{post:a,pub:i,user:n}),(0,r.Y)(x.vx,{href:a.canonical_url,priority:"secondary",children:"Read full post"})]})]})}),(0,r.FD)(L.I1,{gap:16,padding:16,children:[(0,r.Y)(B.EY.Meta,{color:"secondary",children:"Next up"}),o.map(e=>(0,r.Y)(G.z,{post:e,variant:"mini-video",onClick:s}))]})]})};var eO=i(16074);let eU=e=>{var t,i,a,o,c;let{activeLiveStream:u,videoPageData:Y,pub:w,user:C,metadata:k}=e,S="undefined"!=typeof window?new URLSearchParams(null==(i=window)||null==(t=i.location)?void 0:t.search):new URLSearchParams,I=S.get("v")?parseInt(null!=(a=S.get("v"))?a:"0"):null,{isMobile:F}=(0,v.sM)(),[D,T]=(0,p.useState)(I),[A,E]=(0,p.useState)(!0),{activeLiveStream:N}=(0,g.Y)({pub:w,user:C,preloadedActiveLiveStream:u}),{result:P}=(0,f.st)({pathname:"/watch/data",auto:!Y,initialResult:Y,deps:[Y]}),x=null!=(c=null!=(o=(0,p.useMemo)(()=>{var e,t,i;let n=[...null!=(e=null==P?void 0:P.recentPosts)?e:[],...null!=(t=l()(d()(null==P?void 0:P.postsBySectionId).map(e=>null!=e?e:[])))?t:[],...null!=(i=l()(d()(null==P?void 0:P.postsByPostTagId).map(e=>null!=e?e:[])))?i:[]];return s()(n,"id")},[null==P?void 0:P.recentPosts,null==P?void 0:P.postsBySectionId,null==P?void 0:P.postsByPostTagId])[null!=D?D:0])?o:null==P?void 0:P.recentPosts[0])?c:null;if(!P||!x||!x.videoUpload)return(0,r.FD)(r.FK,{children:[k&&(0,r.Y)(h.Metadata,(0,n._)({},k)),(0,r.Y)(L.I1,{alignItems:"center",paddingTop:120,children:(0,r.Y)(B.EY.B3,{color:"secondary",children:"No video posts found"})})]});let{sources:R,sectionsById:M,postTagsById:O,postsBySectionId:U,postsByPostTagId:j}=P,z=e=>{let{event:t,post:i}=e;null==t||t.preventDefault(),T(i.id),E(!1),window.history.pushState({},"",(0,eE.oRR)({v:i.id.toString()}))};return(0,r.Y)(y.XL,{disableInteractive:!0,pub:w,user:C,children:(0,r.FD)(m.DH,{children:[k&&(0,r.Y)(h.Metadata,(0,n._)({},k)),(null==N?void 0:N.liveStream.id)&&(0,X.A)(N.liveStream.started_streaming_at).isBefore((0,X.A)().subtract(1,"minute"))&&(0,r.Y)(b.A,{activeLiveStream:N}),(0,r.Y)(eM,{currentPost:x,isInitialPost:A,pub:w,recentPosts:P.recentPosts,user:C,onClickPost:z},x.id),!F&&(0,r.Y)(_.c,{columns:4,children:(0,r.FD)(L.I1,{position:"relative",children:[(null==C?void 0:C.is_admin)&&(0,r.Y)(L.Ye,{position:"absolute",style:{top:0,right:0},children:(0,r.Y)(H,{pub:w,sources:R,user:C})}),(0,r.FD)(L.I1,{children:[R.map((e,t)=>{var i,n,a,l;let{section_id:o,post_tag_id:s}=e,c=null!=(i=M[null!=o?o:0])?i:null,d=null!=(n=O[null!=s?s:""])?n:null,u=o?null!=(a=U[null!=o?o:0])?a:[]:null!=(l=j[null!=s?s:""])?l:[];return 0===u.length?null:(0,r.FD)(r.FK,{children:[0!==t&&(0,r.Y)(eO.c,{paddingBottom:24,paddingTop:16,paddingX:8}),(0,r.Y)(ej,{posts:u,postTag:d,pub:w,section:c,onClickPost:z},null!=o?o:s)]})}),0===R.length&&(0,r.Y)(L.I1,{alignItems:"center",paddingTop:32,children:(0,r.Y)(B.EY.B3,{color:"secondary",children:"No sections found"})})]})]})})]})})},ej=e=>{var t;let{section:i,postTag:n,posts:a,pub:l,onClickPost:o}=e;if(!i&&!n||0===a.length)return null;let s=i?(0,er.Dor)(l,{section:i}):n?(0,er.ii9)(l,n):null;return s?(0,r.FD)(L.I1,{gap:16,children:[(0,r.FD)(L.Ye,{alignItems:"center",justifyContent:"space-between",paddingX:8,children:[(0,r.Y)(B.EY.H3,{color:"pub-primary-text",font:"pub-headings",children:null!=(t=null==i?void 0:i.name)?t:null==n?void 0:n.name}),(0,r.Y)(x.vx,{href:s,priority:"tertiary-accent",size:"sm",trailing:(0,r.Y)(u.A,{size:16}),children:"View all"})]}),(0,r.Y)(Y.C,{hideDescriptions:!0,numColumns:4,posts:a,onClickPost:o})]}):null}},5051:function(e,t,i){i(10201),i(56455),i(15894)},48535:function(e,t,i){i.d(t,{ZZ:()=>f});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(32307),d=i(17402),u=i(84605),p=i(76977),h=i(65842),m=i(67022),g=i(24311);function f(e){var{className:t,min:i,max:o,value:c,onChange:u,disabled:h,readOnly:f,flex:y="auto",error:Y=!1}=e,_=(0,a._)(e,["className","min","max","value","onChange","disabled","readOnly","flex","error"]);let w=(0,d.useRef)(null);return(0,l.FD)(p.pT,{position:"relative",flex:y,minWidth:0,children:[(0,l.Y)("input",(0,r._)((0,n._)({},_),{type:"datetime-local",ref:w,className:s()(t,m.A.datePicker,g.A.input,g.A.inputText,Y&&g.A.error,h&&g.A.disabled,f&&g.A.readOnly),value:b(c),min:b(i),max:b(o),onChange:u,disabled:h})),(0,l.Y)(v,{inputRef:w})]})}let v=e=>{let{inputRef:t}=e,{iString:i}=(0,u.GO)();return(0,l.Y)(h.uk,{position:"trailing",onClick:e=>{let{current:i}=t;if(i){var n;e.preventDefault(),e.stopPropagation(),i.focus(),null==(n=i.showPicker)||n.call(i)}},onMouseDown:e=>{e.preventDefault()},children:(0,l.Y)(c.A,{size:16,"aria-label":i("Calendar icon")})})};function b(e){return e instanceof Date?"".concat(e.getFullYear(),"-").concat(y(e.getMonth()+1),"-").concat(y(e.getDate()),"T").concat(y(e.getHours()),":").concat(y(e.getMinutes())):e}function y(e){let t=String(e);return t.length<2?"0".concat(t):t}},94996:function(e,t,i){i.d(t,{I:()=>m,K:()=>g});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17402),d=i(82519),u=i(76977),p=i(65842),h=i(25879);let m=(0,c.forwardRef)((e,t)=>{var{className:i,error:o=!1,leading:c,trailing:m=(0,l.Y)(d.A,{}),children:g,flex:f="auto"}=e,v=(0,a._)(e,["className","error","leading","trailing","children","flex"]);return(0,l.FD)(u.pT,{position:"relative",flex:f,children:[(0,l.Y)("select",(0,r._)((0,n._)({},v),{className:s()(i,h.A.select,o&&h.A.error,v.disabled&&h.A.disabled,c?h.A.leading:null,m?h.A.trailing:null),ref:t,children:g})),c&&(0,l.Y)(p.uk,{position:"leading",className:s()(o&&h.A.error,v.disabled&&h.A.disabled),children:c}),m&&(0,l.Y)(p.uk,{position:"trailing",className:s()(o&&h.A.error,v.disabled&&h.A.disabled),children:m})]})});m.displayName="SelectNative";let g=e=>{let{children:t}=e;return(0,l.Y)("option",{value:"",disabled:!0,selected:!0,children:t},"placeholder")}},67211:function(e,t,i){i.d(t,{Y:()=>o});var n=i(10201),r=i(60322),a=i(76977),l=i(63136);let o=e=>{let{contentBelow:t,details:i,disabled:o,label:s,name:c,paddingBottom:d,paddingTop:u,testid:p,track:h,value:m,onChange:g,usePublicationTheme:f}=e;return(0,n.FD)(a.Ye,{as:"label",gap:8,cursor:"pointer",paddingBottom:d,paddingTop:u,children:[(0,n.Y)(r.S,{checked:m,name:null!=c?c:p,"data-testid":p,"data-track-input":h,disabled:o,size:"sm",onChange:g}),(0,n.FD)(a.I1,{flex:"grow",children:[(0,n.Y)(l.EY.B4,{as:"span",color:o?f?"pub-secondary-text":"secondary":f?"pub-primary-text":"primary",children:s}),i&&(0,n.Y)(l.EY.B5,{color:f?"pub-secondary-text":"secondary",children:i}),t]})]})}},84270:function(e,t,i){i.d(t,{z:()=>l});var n=i(10201),r=i(25318),a=i(94996);let l=e=>{let{details:t,helpText:i,label:l,name:o,options:s,paddingBottom:c,paddingTop:d,flex:u,value:p,disabled:h,onChange:m}=e;return(0,n.Y)(r.D,{label:l,details:t,helpText:i,paddingTop:d,paddingBottom:c,flex:u,wrapWithLabel:!0,children:(0,n.Y)(a.I,{name:o,value:p,onChange:e=>{let t=e.target;m(t.value,{name:t.name})},disabled:h,children:s.map(e=>(0,n.Y)("option",{value:e.value,children:e.label},e.value))})})}},14085:function(e,t,i){i.d(t,{u:()=>p});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17402),d=i(89490),u=i(78918);let p=(0,c.forwardRef)((e,t)=>{var{children:i,className:o,disable:c,href:p,hoverBackground:h,onClick:m}=e,g=(0,a._)(e,["children","className","disable","href","hoverBackground","onClick"]);let f=c?void 0:m,v="undefined"==typeof window?void 0:p;return(0,l.Y)(d.az,(0,r._)((0,n._)({},g,v?{as:"a",href:v}:{}),{ref:t,className:s()(o,!c&&u.A.container,{[u.A.containerHoverLight]:"light"===h&&!c}),role:f?"button":void 0,onClick:f,children:i}))})},1140:function(e,t,i){i(10201),i(73294),i(35369),i(16074),i(76977);var n=i(75303);i(63136),i(44338),i(11510),i(39318),i(79913),(0,n.I4)({display:"flex",direction:"column",gap:20,paddingLeft:{desktop:20,mobile:12},borderLeft:"detail"})},91916:function(e,t,i){i.d(t,{$E:()=>o,xm:()=>s}),i(10201),i(32485);var n=i(63950),r=i.n(n),a=i(17402);let l=(0,a.createContext)({isPreview:!1,activePreviewBlockId:null,setActivePreviewBlock:r(),isActive:()=>!1,requestBlockInsert:r(),requestBlockPicker:r(),showOverlay:!0,shouldFade:()=>!1,showBodyButton:!0}),o=()=>(0,a.useContext)(l);function s(e){return"content-block"===e.type?"content-block-".concat(e.contentBlockId):e.type}},95187:function(e,t,i){i.d(t,{NZ:()=>b,Z6:()=>g,jA:()=>m,p_:()=>f});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(60250),d=i(87677),u=i(17402),p=i(17028),h=i(64224);let m=function(e){let{inset:t=0,pageSizeAdjust:i=0,initialState:a,scrollFullPage:l=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[o,s]=(0,u.useState)(a||{showLeft:!1,showRight:!1});return(0,u.useEffect)(()=>{let{current:i}=e;if(i){let e=()=>{s(e=>{let a=e;!a.showLeft&&i.scrollLeft>t?a=(0,r._)((0,n._)({},e),{showLeft:!0}):a.showLeft&&i.scrollLeft<=t&&(a=(0,r._)((0,n._)({},e),{showLeft:!1}));let l=i.scrollWidth-i.offsetWidth-4-t;return!a.showRight&&i.scrollLeft<l?a=(0,r._)((0,n._)({},e),{showRight:!0}):a.showRight&&i.scrollLeft>=l&&(a=(0,r._)((0,n._)({},e),{showRight:!1})),a})};return i.addEventListener("scroll",e),setTimeout(()=>{e()},50),()=>{i.removeEventListener("scroll",e)}}},[]),{state:o,handleArrowClick:t=>()=>{let{current:n}=e;n&&n.scrollBy({left:t*(l?n.offsetWidth:n.offsetWidth/2-i),behavior:"smooth"})}}};function g(e){var{className:t,scrollRef:i}=e,o=(0,a._)(e,["className","scrollRef"]);return(0,l.Y)(p.pT,(0,r._)((0,n._)({},o),{className:s()(h.A.scrollBox,t),ref:i,overflowX:"auto",scrollBar:"hidden",minWidth:0,onTouchStart:e=>{let{pageX:t}=e;void 0===t||t>10&&t<window.innerWidth-10||e.preventDefault()}}))}function f(e){let{direction:t,isVisible:i=!0,onClick:n}=e;return(0,l.Y)(p.pT,{alignItems:"center",justifyContent:"center",position:"absolute",className:s()(h.A.arrowButtonContainer,h.A.arrowButtonOffsetContainer,i&&h.A.visible,h.A[t]),children:(0,l.Y)(v,{direction:t,isVisible:i,onClick:n})})}function v(e){let{direction:t,isVisible:i=!0,onClick:n,className:r}=e;return(0,l.Y)(p.K0,{size:"sm",priority:"quaternary",disabled:!i,className:r,onClick:n,"aria-hidden":!i,"aria-label":i?"left"===t?"Previous":"Next":void 0,children:"left"===t?(0,l.Y)(c.A,{}):(0,l.Y)(d.A,{})})}function b(e){let{direction:t,isVisible:i=!0,children:n,bg:r="primary"}=e;return(0,l.FD)(p.pT,{alignItems:"center",className:s()(h.A.arrowButtonContainer,h.A.arrowButtonOverlaidContainer,i&&h.A.visible,h.A[t]),children:[(0,l.Y)("div",{className:s()(h.A.overlay,h.A[r])}),n]})}},28379:function(e,t,i){i.d(t,{t:()=>u});var n=i(99851),r=i(10201),a=i(99862),l=i(17402),o=i(72880),s=i(44333),c=i(76977),d=i(63136);class u extends l.Component{static getDerivedStateFromError(e){return{error:e}}componentDidMount(){Promise.all([i.e("551"),i.e("9565")]).then(i.bind(i,35132)).then(e=>{this.Sentry=e.Sentry})}componentDidCatch(e){console.error(e),this.Sentry&&this.Sentry.captureException(e)}render(){let{error:e}=this.state;return(0,r.Y)(p,{onReset:()=>this.setState({error:null}),error:e,children:e?(0,r.Y)(h,{}):this.props.children})}constructor(e){super(e),(0,n._)(this,"Sentry",null),this.state={error:null}}}function p(e){let{onReset:t,error:i,children:n}=e,o=(0,l.useRef)((0,a.getCurrentUrl)());return(0,s.wN)(e=>{i&&o.current!==e&&t(),o.current=e},[]),i?(0,r.Y)(h,{}):n}function h(){return(0,r.FD)(c.I1,{flex:"grow",justifyContent:"center",alignItems:"center",gap:32,padding:20,children:[(0,r.Y)(o.o,{src:"/img/reader/toad.png",maxWidth:200}),(0,r.FD)(c.I1,{gap:8,children:[(0,r.Y)(d.EY.H3,{weight:"semibold",align:"center",children:"Oh no—this page croaked."}),(0,r.Y)(d.EY.B3,{color:"secondary",align:"center",children:"Try again, or hop to another page."})]})]})}},60281:function(e,t,i){i.d(t,{Ft:()=>L,Mr:()=>j,SE:()=>U,Wc:()=>O,h8:()=>z,pS:()=>H,pp:()=>R});var n=i(10201),r=i(32485),a=i.n(r),l=i(48697),o=i(17402),s=i(78649),c=i(38305),d=i(27437),u=i(84777),p=i(68924),h=i(9292),m=i(58050),g=i(84605),f=i(46271),v=i(25859),b=i(86500),y=i(58418),Y=i(82772),_=i(68349),w=i(24078),C=i(15040),k=i(35369),S=i(76977),I=i(22602),F=i(63136),D=i(504),T=i(80303),A=i(49095),E=i(83660),N=i(39318),P=i(49807),x=i(12896);let L="inviteFriendsNuxDismissed";function R(e){let{feedUserSuggestion:t,surface:i}=e,r=(0,o.useRef)(null),c=(0,m.cC)(t.user,i),d=c.isFollowing?"Following":t.isFollowing?"Follow Back":"Follow",u=c.isFollowing?"secondary":"primary",p=(0,E.A)(t),[h,g]=(0,o.useState)(!1),f="feed"===i?"pymk_notes_feed_item":"suggestions"===i?"pymk_notes_suggestions_page":"pymk_notes_sidebar";(0,Y.S8)(r,()=>{(0,D.Si)(t,i,{extraEventProps:{has_social_context:!!t.mutualsContext}})});let[b,y]=(0,o.useState)(!1),C=e=>{b||(y(!0),(0,D.aK)(t,i,e))},I=e=>{C("user-suggestion"),e.defaultPrevented||(0,_.V2)((0,P.gYq)(t.user,{utm_source:f}),{event:e})},T=e=>{e.preventDefault(),C("user-suggestion-cta"),c.isFollowing?c.toggle():(c.toggle(),g(!0))},N=async e=>{e.preventDefault(),C("user-suggestion-dismiss"),g(!0),await fetch("/api/v1/reader/feed/user-suggestions/".concat(t.user.id,"/dismiss"),{method:"POST"})};if(h)return null;let L=t.user.status;return"feed"===i?(0,n.Y)(s.Q,{children:(0,n.FD)(S.I1,{ref:r,className:a()(x.A.personYouMayKnow,x.A.personYouMayKnowFeed,x.A.withSocialContext),alignItems:"center",bg:"primary",border:"detail",padding:12,gap:12,radius:"lg",shadow:"md",onClick:I,justifyContent:"space-between",children:[(0,n.Y)(k.K0,{size:"sm",priority:"tertiary",className:x.A.close,onClick:N,children:(0,n.Y)(l.A,{size:16})}),(0,n.Y)(w.eu,{user:t.user,size:100}),(0,n.FD)(S.I1,{minWidth:0,flex:"grow",justifyContent:"start",alignSelf:"stretch",gap:4,children:[(0,n.FD)(S.Ye,{gap:4,alignItems:"center",justifyContent:"center",children:[(0,n.Y)(F.EY.B4,{decoration:"hover-underline",weight:"semibold",textAlign:"center",ellipsis:!0,children:(0,n.Y)(v.yp,{user:t.user,ellipsis:!0,children:t.user.name})}),(null==L?void 0:L.badge)&&(0,n.Y)(A.UserBadge,{size:"xs",userBadge:L.badge})]}),(null==L?void 0:L.subscriber)?(0,n.Y)(A.RelationshipTag,{children:L.subscriber.label}):t.mutualsContext?(0,n.Y)(M,{mutualsContext:t.mutualsContext}):(0,n.Y)(B,{children:p})]}),(0,n.Y)(k.$n,{size:"sm",priority:u,onClick:T,alignSelf:"stretch",justifyContent:"center",children:d})]})}):(0,n.Y)(O,{user:t.user,source:f,publication:t.publication,label:p,onClick:I,cta:(0,n.FD)(S.Ye,{alignItems:"center",gap:8,children:[(0,n.Y)(k.$n,{size:"sm",priority:u,onClick:T,children:d}),(0,n.Y)(k.K0,{rounded:!0,size:"sm",priority:"tertiary",onClick:N,children:(0,n.Y)(l.A,{size:20})})]}),boxRef:r})}function M(e){let{mutualsContext:t}=e,{iString:i}=(0,g.GO)(),r=t.users.sort(e=>e.photo_url?1:-1);return 0===r.length?null:(0,n.Y)(S.fI,{alignItems:"center",justifyContent:"center",gap:6,className:x.A.personYouMayKnowMutuals,children:(0,n.FD)(B,{children:[i("Followed by "),(0,n.Y)(c.K,{array:r,limit:3,formatter:e=>(0,n.Y)(v.Yq,{href:(0,P.gYq)(e),children:e.name})})]})})}function B(e){let{children:t}=e;return(0,n.Y)(F.EY.B5,{color:"secondary",clamp:2,style:{lineHeight:"13px"},textAlign:"center",children:t})}function O(e){var t;let{user:i,publication:r,label:a,onClick:l,cta:o,source:s,boxRef:c}=e,p=(0,f.Jd)(),h=i&&i.id===(null==p?void 0:p.id);return(0,n.FD)(S.pT,{ref:c,className:x.A.personYouMayKnow,alignItems:"center",justifyContent:"space-between",padding:8,gap:12,onClick:l,radius:"md",flex:"grow",children:[(0,n.FD)(S.pT,{gap:12,minWidth:0,children:[(0,n.Y)(C.Ff,{pub:r||void 0,children:(0,n.Y)(w.tp,{user:i,size:40})}),(0,n.FD)(S.I1,{minWidth:0,justifyContent:"center",children:[(0,n.FD)(S.pT,{alignItems:"center",gap:4,children:[(0,n.Y)(d.ProfileHoverCard,{subject:i,utmSource:s,trigger:(0,n.Y)(v.Yq,{href:(0,P.gYq)(i),showBack:!0,ellipsis:!0,children:(0,n.Y)(F.EY.B3,{as:"span",decoration:"hover-underline",weight:"semibold",clamp:1,children:i.name})})}),(0,n.Y)(A.UserStatusSymbols,{size:"xs",status:i.status})]}),(0,n.Y)(u.m,{pubId:null!=(t=null==r?void 0:r.id)?t:0,disabled:!r,trigger:(0,n.Y)(F.EY.B4,{color:"secondary",ellipsis:!0,as:r?"a":void 0,decoration:r?"hover-underline":void 0,target:"_blank",rel:"noopener","data-native":!0,onClick:e=>{e.stopPropagation()},href:r?(0,N.fOI)(r):void 0,children:a})})]})]}),!h&&o]})}function U(){return(0,n.FD)(S.pT,{className:x.A.personYouMayKnow,alignItems:"center",padding:8,gap:12,children:[(0,n.Y)(I.O,{radius:"full",width:40,height:40,flex:"auto"}),(0,n.FD)(S.I1,{style:{width:"100%"},gap:8,children:[(0,n.Y)(I.O,{width:"80%",height:16}),(0,n.Y)(I.O,{width:"40%",height:16})]})]})}function j(){let[e,t]=(0,y.A)("facebookPymkNuxDismissed",604800);return e?null:(0,n.Y)(s.Q,{children:(0,n.FD)(S.I1,{className:a()(x.A.personYouMayKnow,x.A.personYouMayKnowFeed),border:"detail",alignItems:"center",bg:"primary",padding:12,gap:12,style:{position:"relative"},radius:"md",children:[(0,n.Y)(k.K0,{className:x.A.close,onClick:t,rounded:!0,children:(0,n.Y)(l.A,{size:20})}),(0,n.Y)(p.A,{fill:"var(--color-accent-fg-blue)",stroke:"none",height:64,width:64}),(0,n.FD)(S.I1,{alignItems:"center",minWidth:0,flex:"grow",children:[(0,n.Y)(F.EY.B4,{align:"center",weight:"bold",ellipsis:!0,children:"Connect Facebook"}),(0,n.Y)(F.EY.B4,{align:"center",color:"secondary",ellipsis:!0,children:"Find your friends"})]}),(0,n.Y)(k.$n,{size:"sm",priority:"primary",href:(0,P.wVQ)({type:"reader2",redirect:(0,N.oT5)()}),style:{backgroundColor:"var(--color-accent-fg-blue)"},localNavigation:!1,onClick:()=>(0,b.u4)(b.qY.CONNECT_FACEBOOK_SCREEN_VIEWED,{source:"suggestions"}),children:"Connect"})]})})}function z(){let[,e]=(0,y.A)("sidebarFacebookNuxDismissed");return(0,n.FD)(S.I1,{position:"relative",alignItems:"center",gap:12,paddingX:32,paddingY:8,children:[(0,n.Y)(k.K0,{className:x.A.close,onClick:()=>{e()},rounded:!0,children:(0,n.Y)(l.A,{size:20})}),(0,n.Y)(p.A,{width:40,height:40}),(0,n.FD)(S.I1,{alignItems:"center",gap:6,children:[(0,n.Y)(F.EY.H4,{children:"Find your friends"}),(0,n.Y)(F.EY.B4,{align:"center",color:"secondary",children:"Connect Facebook to see what your friends are reading."})]}),(0,n.Y)(k.$n,{priority:"primary",href:(0,P.wVQ)({type:"reader2",redirect:(0,N.oT5)()}),localNavigation:!1,style:{backgroundColor:"var(--color-accent-fg-blue)"},rounded:!0,onClick:()=>(0,b.u4)(b.qY.CONNECT_FACEBOOK_SCREEN_VIEWED,{source:"sidebar"}),children:"Connect Facebook"})]})}function H(e){let{utmSource:t}=e,[i,r]=(0,o.useState)(!1),[a,s]=(0,o.useState)(!1),{user:c,changeSetting:d}=(0,f.ur)(),[,u]=(0,y.A)(L),[,p]=(0,y.A)("sidebarInviteFriendsNuxDismissed");if(!c)return null;let m=()=>{d("invite_friends_nux_dismissed_at",new Date().toISOString()),u()};return(0,n.FD)(n.FK,{children:[(0,n.Y)(S.I1,{children:(0,n.FD)(S.I1,{alignItems:"center",gap:12,padding:32,className:x.A.shareProfile,children:[(0,n.Y)(k.K0,{className:x.A.close,onClick:()=>{m(),p()},rounded:!0,children:(0,n.Y)(l.A,{size:20})}),(0,n.FD)(S.I1,{className:x.A.avatarContainer,children:[(0,n.Y)(w.eu,{user:c,size:48}),(0,n.Y)(S.pT,{className:x.A.badge,padding:4,children:(0,n.Y)(h.Sb,{className:x.A.badgeIcon})})]}),(0,n.FD)(S.I1,{alignItems:"center",gap:6,children:[(0,n.Y)(F.EY.H4,{children:"Invite your friends"}),(0,n.Y)(F.EY.B4,{align:"center",color:"secondary",children:"Share your profile to help your friends find you on Substack."})]}),(0,n.Y)(k.$n,{priority:"primary",onClick:()=>{r(!0),(0,b.u4)(b.qY.INVITE_FRIENDS_MODAL_SHOWN,{source:t})},rounded:!0,children:"Invite friends"})]})}),(0,n.Y)(T.z,{isOpen:i,utmSource:t,onClose:()=>{r(!1),a&&m()},setShared:()=>s(!0)})]})}},2481:function(e,t,i){i.d(t,{Ay:()=>A,L6:()=>M,NP:()=>R,um:()=>E,wG:()=>L});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17402),d=i(78649),u=i(52820),p=i(84605),h=i(46271),m=i(86998),g=i(98920),f=i(24078),v=i(35369),b=i(76977),y=i(16993),Y=i(63136),_=i(2824),w=(i(81870),i(5180)),C=i(21398),k=i(46453),S=i(11510),I=i(16884),F=i(70515),D=i(79804);function T(e){var{isOpen:t}=e,o=(0,a._)(e,["isOpen"]);let{iString:s}=(0,p.GO)();return(0,l.FD)(y.aF,{className:D.A.composerModal,isOpen:t,onClose:o.onClose,fullscreenMobile:!0,width:600,children:[(0,l.Y)(y.lR,{title:s("New note")}),(0,l.Y)(C.Ic,(0,r._)((0,n._)({},o),{module:"../feed/NoteComposer",resolve:e=>e.NoteComposer,onRequest:()=>Promise.all([i.e("1777"),i.e("8810"),i.e("4581"),i.e("550"),i.e("5256"),i.e("2060")]).then(i.bind(i,86708)),whileLoading:(0,l.Y)("div",{style:{height:336}})}))]})}function A(e){let{disabled:t,parentPubId:i,parentPostId:a,parentCommentId:o,restackUrl:c,placeholder:g,tabId:y,surface:_,initialText:w,className:C,textClassName:S,parentMediaClipId:I}=e,{iString:F}=(0,p.GO)(),T=R(),A=(0,h.Jd)(),{requireLogin:E,onboardingModalRef:N}=(0,k.eE)(),{getExperimentVariant:P}=(0,u.Wk)(),x=(0,m.zj)({onAddFiles:e=>{T.open((0,n._)({parentPubId:i,parentPostId:a,parentCommentId:o,restackUrl:c,initialFiles:e,tabId:y,surface:_,initialText:w},I&&{parentMediaClipId:I}))},acceptFile:m.um});return(0,l.Y)(b.I1,(0,r._)((0,n._)({},x.props),{position:"relative",children:(0,l.Y)(v.Nm,{onClick:()=>{if(!t)if(A)T.open((0,n._)({parentPubId:i,parentPostId:a,parentCommentId:o,restackUrl:c,tabId:y,surface:_,initialText:w},I&&{parentMediaClipId:I}));else if("control"===(P("homepage_welcome_card_2")||"control"))null==E||E();else{var e;null==(e=N.current)||e.open()}},disabled:t,radius:"md",resetCss:!0,showFocus:!0,animate:!0,"aria-label":F("New post"),children:(0,l.Y)(d.Q,{children:(0,l.FD)(b.Ye,{padding:16,gap:12,radius:"md",alignItems:"center",bg:"primary",border:"detail",shadow:"xs",cursor:"pointer",userSelect:"none",className:s()(D.A.inlineComposer,x.isDragging&&D.A.isDragging,C),animate:!0,children:[A?(0,l.Y)(f.eu,{size:36,user:A,"aria-hidden":!0}):(0,l.Y)(b.pT,{flex:"auto",children:(0,l.Y)(f.eu,{size:36,"aria-hidden":!0})}),(0,l.Y)(Y.EY.B2,{align:"left",color:"secondary",flex:"grow",ellipsis:!0,className:S,children:g||"What's on your mind?"})]})})})}))}function E(e){let{disabled:t,parentPubId:i,parentPostId:a,parentCommentId:o,placeholder:c,tabId:d,surface:u,parentMediaClipId:p}=e,g=R(),y=(0,h.Jd)(),_=(0,S.Iu)(),{requireLogin:w}=(0,k.eE)(),C=(0,m.zj)({onAddFiles:e=>{g.open((0,n._)({parentPubId:i,parentPostId:a,parentCommentId:o,initialFiles:e,tabId:d,surface:u},p&&{parentMediaClipId:p}))},acceptFile:m.um});return(0,l.Y)(b.I1,(0,r._)((0,n._)({},C.props),{children:(0,l.Y)(v.Nm,{onClick:()=>{t||(y?g.open((0,n._)({parentPubId:i,parentPostId:a,parentCommentId:o,tabId:d,surface:u},p&&{parentMediaClipId:p})):null==w||w())},disabled:t,resetCss:!0,children:(0,l.FD)(b.Ye,{padding:16,gap:12,alignItems:"center",bg:"primary",cursor:"pointer",className:s()(D.A.mobileInlineComposer,{[D.A.isDropping]:C.isDragging}),children:[y?(0,l.Y)(f.eu,{size:36,user:y}):(0,l.Y)(b.pT,{flex:"auto",children:(0,l.Y)(f.eu,{size:36})}),(0,l.Y)(Y.EY.B3,{align:"left",color:"secondary",flex:"grow",children:c||"What's on your mind?"}),!_&&(0,l.Y)(N,{})]})})}))}function N(){return(0,l.Y)(b.pT,{fontSize:14,fontWeight:"semibold",font:"text",style:{backgroundColor:"var(--color-button-primary-bg)",opacity:.5},alignItems:"center",justifyContent:"center",height:40,paddingX:12,radius:"sm",color:"white",children:"Post"})}let P={isOpen:!1,firstComment:void 0},x=(0,c.createContext)({state:P,open:async()=>{throw Error("Not implemented")}});function L(e){var t,a,o;let{children:s}=e,d=(0,h.Jd)(),u=!(null==d?void 0:d.name),p=(0,w.wA)(),[m,f]=(0,c.useState)(P),[v,b]=(0,c.useState)(!1),Y=(0,c.useRef)(),{feedItem:k}=m,S=M(k),I=(null==k?void 0:k.type)==="comment"?null!=(a=null==(t=k.parentComments)?void 0:t[0])?a:k.comment:null;(0,c.useEffect)(()=>{d&&Promise.all([i.e("1777"),i.e("8810"),i.e("4581"),i.e("550"),i.e("5256"),i.e("2060")]).then(i.bind(i,86708))},[d]),(0,c.useEffect)(()=>{m.isOpen&&i.e("2679").then(i.bind(i,15722))},[m.isOpen]),(0,c.useEffect)(()=>{m.isOpen&&u&&b(!0)},[Y,u,m.isOpen]);let F=(0,c.useMemo)(()=>({state:m,open:e=>new Promise((t,i)=>{f((0,r._)((0,n._)({},P,e),{isOpen:!0,resolve:t,reject:i}))})}),[m]),D=function(){var e,t,i;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null==(t=document.activeElement)||null==(e=t.blur)||e.call(t),null==(i=m.onDismiss)||i.call(m),f((0,n._)((0,r._)((0,n._)({},m),{isOpen:!1}),a))};return(0,l.FD)(x.Provider,{value:F,children:[s,u?(0,l.Y)(g.Z,{displaySignInModal:v,onCloseSignInModal:()=>{b(!1),f((0,r._)((0,n._)({},m),{isOpen:!1}))},isStatic:!1,entry:"composer-new-post"}):S?(0,l.Y)(_.a,{isOpen:m.isOpen,onClose:()=>D(),requirement:S,writerId:null!=(o=null==I?void 0:I.user_id)?o:0}):(0,l.Y)(T,(0,r._)((0,n._)({},m),{isOpen:m.isOpen,onClose:()=>D(),onSuccess:e=>{var t,i;e.isFirstFeedCommentByUser?f((0,r._)((0,n._)({},m),{firstComment:e})):D(),p({type:m.editComment?"edit_comment":"new_comment",payload:{comment:e}}),null==(t=m.onCompose)||t.call(m,e),null==(i=m.resolve)||i.call(m,e)},onError:m.reject})),(0,l.Y)(y.aF,{isOpen:m.isOpen&&!!m.firstComment,children:m.firstComment&&(0,l.Y)(C.Ic,{module:"@/frontend/feed/NuxModal",resolve:e=>e.FeedNuxShareFirstNote,onRequest:()=>i.e("2679").then(i.bind(i,15722)),onClose:()=>D(),comment:m.firstComment})})]})}function R(){return(0,c.useContext)(x)}function M(e){var t,i;let n=(0,h.Jd)(),r=null==e?void 0:e.post,a=(null==e?void 0:e.type)=="comment"?null!=(i=null==(t=e.parentComments)?void 0:t[0])?i:e.comment:null,{user_id:l}=null!=a?a:{},{reply_minimum_role:o}=null!=a?a:{},s=(0,I.GQ)(null!=l?l:0);if(null==o&&(null==r?void 0:r.write_comment_permissions)==="only_paid"&&(o="paid_subscriber"),!l||!o||(null==e?void 0:e.canReply)||a&&n&&(0,F.fP)(a,n.id))return null;if(o){if("free_subscriber"===o&&(!s||!["free_subscription","subscribed"].includes(s)))return"free_subscriber";if("paid_subscriber"===o&&"subscribed"!==s)return"paid_subscriber"}return null}},2548:function(e,t,i){i.d(t,{I1:()=>u.I1,IE:()=>A,Qe:()=>Y,YW:()=>C,Ye:()=>u.Ye,bi:()=>D,cJ:()=>S,fz:()=>_,h1:()=>y,ix:()=>I,jA:()=>p.jA,jC:()=>F,p2:()=>T,tP:()=>b.t});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17402);i(17988);var d=i(56804);i(68349);var u=i(76977);i(63136);var p=i(95187),h=i(24216),m=i(28379);i(11510);var g=i(49807),f=i(57324),v=i(50321),b=i(17059);let y=(0,c.forwardRef)((e,t)=>{var{isPadded:i=!0,className:o,linkClassName:c}=e,d=(0,a._)(e,["isPadded","className","linkClassName"]);return(0,l.Y)("div",{ref:t,className:s()(v.A.linkRow,i&&v.A.isPadded,o),children:(0,l.Y)(Y,(0,r._)((0,n._)({},d),{className:c}))})});function Y(e){var{children:t,className:i,href:o,newTab:c,onClick:p,noAnchor:h,native:m,utmCampaign:b,utmSource:y,isSelected:Y}=e,_=(0,a._)(e,["children","className","href","newTab","onClick","noAnchor","native","utmCampaign","utmSource","isSelected"]);let w="undefined"!=typeof location?location.pathname:"",C=h||null==o?"div":"a",k=o&&(0,g.yRP)(o,{utm_source:y||w,utm_medium:f.Jn.reader2,utm_campaign:b});return(0,l.Y)(u.pT,(0,r._)((0,n._)({as:C,className:s()(v.A.linkRowA,i,(k||p)&&null==Y&&v.A.isClickable,Y&&v.A.isSelected,null!=Y&&v.A.isSelectable),"data-selected":Y,href:k,target:c?"_blank":void 0,onClick:e=>{p&&p(e),!e.defaultPrevented&&h&&k&&(0,d.o)(e,k,{native:m,newTab:c})},showFocus:!0,animate:!0},_),{children:t}))}function _(e){var{className:t,variant:i,size:r,serif:o,isConstrained:c,maxLines:d=3}=e,u=(0,a._)(e,["className","variant","size","serif","isConstrained","maxLines"]);return(0,l.Y)("div",(0,n._)({className:s()("reader2-paragraph",i&&"reader2-".concat(i),r&&"reader2-font-".concat(r),o&&"reader2-font-serif",c&&"reader2-clamp-lines reader2-".concat(d,"-lines"),t)},u))}function w(e){let{className:t,children:i}=e;return(0,l.Y)("div",{className:s()("reader-nav-center",t),children:(0,l.Y)("div",{className:"reader2-page reader2-font-base",children:i})})}function C(e){let{className:t,scrollRef:i,children:n}=e;return(0,l.Y)(k,{ref:i,children:(0,l.Y)(w,{className:t,children:n})})}let k=(0,c.forwardRef)((e,t)=>(0,l.Y)(m.t,{children:(0,l.Y)("div",(0,n._)({id:"reader-nav-page-scroll",className:s()("reader-nav-page-scroll",e.className),ref:t},e))}));function S(e){var{gap:t=16}=e,i=(0,a._)(e,["gap"]);return(0,l.Y)(u.I1,(0,r._)((0,n._)({},i),{className:s()(v.A.pageStack,v.A["gap_".concat(t)])}))}(0,h.a)("reader2-page-top"),(0,h.a)(v.A.pageTopFixed),(0,h.a)("reader2-page-body");let I=(0,h.a)(v.A.pageStack),F=(0,h.a)("reader2-page-center");(0,h.a)("reader2-modal-title-text"),(0,h.a)("reader2-column"),(0,h.a)("reader2-text-h3 reader2-section-title"),(0,h.a)("reader2-text-h4"),(0,h.a)("reader2-item-title");let D=(0,h.a)("reader2-item-meta");(0,h.a)("reader2-form-error"),(0,h.a)("reader2-subtitle"),(0,h.a)("reader2-separator","hr"),(0,h.a)("reader2-page-section withTitle"),(0,h.a)("reader2-row reader2-split-row");let T=(0,h.a)(s()(v.A.hoverLink,"pencraft"),"a");function A(e){return(0,l.Y)(T,(0,n._)({target:"_blank"},e))}},5180:function(e,t,i){i.d(t,{B9:()=>k,Ro:()=>w,To:()=>y,_0:()=>_,bL:()=>N,et:()=>v,l$:()=>C,tO:()=>Y,wA:()=>b});var n=i(69277),r=i(70408),a=i(83673),l=i.n(a),o=i(2404),s=i.n(o),c=i(17402),d=i(96467),u=i(12501),p=i(68349),h=i(504),m=i(16291),g=i(70189),f=i(49807);let v=(0,c.createContext)({dispatch:()=>Promise.resolve()});function b(){return(0,c.useContext)(v).dispatch}let y={isSigningIn:!1,signInNoExit:!1,pages:[],readingQueue:[],posts:new Map,mediaClipsAsPosts:new Map,publications:new Map,referringPubByPostId:{},comments:new Map,inboxItems:new Map,hiddenItems:[],publicationSettings:new Map,publicationRecommendations:new Map,feedItemStats:new Map,activeLiveStreams:[],mutedFeedItems:new Set},Y=(0,c.createContext)(y);function _(){let{initialData:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.K)(k,e,e=>{let{feedItem:t,readingQueue:i,initialPost:n}=e,r=y;return t&&(r=F(r,t)),i&&(r=A(r,i)),n&&(r=T(r,{posts:[n.post],publications:l()([n.publication,n.referringPub]),publicationSettings:new Map([[n.publication.id,n.publicationSettings]]),recommendationsByPubId:n.referringRecommendation?new Map([[n.referringRecommendation.recommended_publication_id,n.referringRecommendation]]):void 0})),r})}function w(){return(0,c.useContext)(Y)}function C(e){let t=w();return!!e&&"entity_key"in e&&t.hiddenItems.includes(e.entity_key)}function k(e,t){var i,a,l,o,c,d,v,b,Y,_,w;switch(t.type){case"sign_in":return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,isSigningIn:t.payload.isSigningIn,signInNoExit:null!=(i=t.payload.signInNoExit)&&i});case"page_load":{let{result:i}=t.payload;return(0,r._)((0,n._)({},I(e,i.items)),{lastDispatchType:t.type,pages:(0,u.VL)(e.pages,t)})}case"post_load":{let{post:i,publication:n}=t.payload;return T(e,{posts:[i],publications:[n]})}case"post_like":{let{postId:i,mediaClipId:n,isLiked:r}=t.payload,a=n?e.mediaClipsAsPosts.get(n):e.posts.get(i);return D(e,t.type,i,(v=a,{reaction:null!=(b=r)?b:!v.reaction,reactions:{"❤":((null==(Y=v.reactions)?void 0:Y["❤"])||0)+(b?1:-1)}}),n)}case"post_restack":{let{postId:i,mediaClipId:n,isRestacked:r}=t.payload,a=n?e.mediaClipsAsPosts.get(n):e.posts.get(i);return a?D(e,t.type,i,(_=a,{restacked:w=r,restacks:(_.restacks||0)+(w?1:-1)}),n):e}case"post_delete":{let{publication:i,post:a}=t.payload,l=new Map(e.posts),o=new Map(e.mediaClipsAsPosts);a.media_clip_id&&o.delete(a.media_clip_id),l.delete(a.id);let s=new Map([...e.comments].filter(e=>{let[t,i]=e;return i.post_id!==a.id}));return[(0,f.kGL)(a.id,{noBase:!0}),(0,f.q$n)(i,a,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,n._)({},e),{lastDispatchType:t.type,posts:l,mediaClipsAsPosts:o,comments:s,pages:e.pages.map(e=>(0,r._)((0,n._)({},e),{result:e.result?(0,r._)((0,n._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null==(t=e.post)?void 0:t.id)!==a.id})}):e.result}))})}case"post_save":{let{postId:i,isSaved:n}=t.payload,r=e.posts.get(i),a=null==n?!(null==r?void 0:r.is_saved):n;return r?D(e,t.type,i,{is_saved:a}):e}case"comment_like":{let{commentId:i,isLiked:l}=t.payload,o=e.comments.get(i);if(!o)return e;return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,comments:E(e.comments,i,(0,r._)((0,n._)({},o),{reaction:l?"❤":void 0,reactions:(0,r._)((0,n._)({},o.reactions),{"❤":((null==(a=o.reactions)?void 0:a["❤"])||0)+(l?1:-1)}),reaction_count:(o.reaction_count||0)+(l?1:-1)}))})}case"comment_restack":{let{commentId:i,isRestacked:a}=t.payload,l=e.comments.get(i);return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,comments:l?E(e.comments,i,(0,r._)((0,n._)({},l),{restacked:a,restacks:(l.restacks||0)+(a?1:-1)})):e.comments})}case"comment_delete":{let{comment:i}=t.payload,a=new Map(e.posts),l=new Map(e.mediaClipsAsPosts),o=new Map([...e.comments].filter(e=>{let[t,n]=e;return n.id!==i.id&&!new RegExp("(^|.)".concat(i.id,"(.|$)")).test(n.ancestor_path)})),s=a.get(i.post_id),c=i.media_clip_id?l.get(i.media_clip_id):null,d=i.ancestor_path&&o.get(Number(i.ancestor_path.split(".").pop()));return d?o.set(d.id,(0,r._)((0,n._)({},d),{children_count:(d.children_count||1)-1,children:(d.children||[]).filter(e=>e.id!==i.id)})):(s||c)&&(s&&a.set(s.id,(0,r._)((0,n._)({},s),{child_comment_count:(s.child_comment_count||1)-1})),c&&l.set(i.media_clip_id,(0,r._)((0,n._)({},c),{child_comment_count:(c.child_comment_count||1)-1}))),[(0,f.Zgx)(i,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,n._)({},e),{lastDispatchType:t.type,posts:a,mediaClipsAsPosts:l,comments:o,pages:e.pages.map(e=>(0,r._)((0,n._)({},e),{result:e.result?(0,r._)((0,n._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null==(t=e.comment)?void 0:t.id)!==i.id&&!(e.parentComments||[]).filter(Boolean).map(e=>e.id).includes(i.id)})}):e.result}))})}case"clip_delete":{let{mediaClip:i,author:a}=t.payload;return[(0,g.w1)(i,a,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,n._)({},e),{lastDispatchType:t.type,pages:e.pages.map(e=>(0,r._)((0,n._)({},e),{result:e.result?(0,r._)((0,n._)({},e.result),{items:e.result.items.filter(e=>{var t;return"post"!==e.type||(null==(t=e.mediaClip)?void 0:t.id)!==i.id})}):e.result}))})}case"new_post":return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,publications:new Map([...e.publications].concat([[t.payload.publication.id,t.payload.publication]])),posts:new Map([...e.posts].concat([[t.payload.post.id,t.payload.post]])),pages:[{error:null,isLoading:!1,result:{items:[{type:"post",entity_key:(0,g.pi)(t.payload.post.id),publication:t.payload.publication,post:t.payload.post,context:t.payload.context||{}}]}},...e.pages]});case"new_comment":{let{comment:i}=t.payload,a=new Map(e.posts),s=new Map(e.mediaClipsAsPosts),c=a.get(i.post_id),d=i.media_clip_id?s.get(i.media_clip_id):null;c&&a.set(c.id,(0,r._)((0,n._)({},c),{child_comment_count:(c.child_comment_count||0)+1})),d&&s.set(i.media_clip_id,(0,r._)((0,n._)({},d),{child_comment_count:(d.child_comment_count||0)+1}));let u=new Map(e.comments);u.set(i.id,i);let p=((null==(l=i.ancestor_path)?void 0:l.split("."))||[]).map(Number).filter(Boolean).map(e=>u.get(e)||null),m=null!=(o=p[p.length-1])?o:null;m&&u.set(m.id,(0,r._)((0,n._)({},m),{children_count:(m.children_count||0)+1,children:[i].concat(m.children||[])}));let f=[{error:null,isLoading:!1,result:{items:[(0,h.n5)({type:"comment",entity_key:(0,g.a5)(i.id),comment:i,parentComments:p,publication:null,post:null,canReply:!0,context:{type:"comment",timestamp:new Date().toISOString(),users:[],fallbackReason:"",fallbackUrl:null}})]}},...e.pages];return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,posts:a,mediaClipsAsPosts:s,comments:u,pages:f})}case"edit_comment":{let{comment:i}=t.payload,a=new Map(e.comments);return a.set(i.id,i),(0,r._)((0,n._)({},e),{lastDispatchType:t.type,comments:a})}case"comments_load":{let{comments:i}=t.payload,a=[],l=i.slice();for(;l.length>0;){let e=l.pop();a.push(e),l.push(...e.children||[])}return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,comments:new Map([...e.comments].concat(a.map(e=>[e.id,e])))})}case"item_load":{let{item:i}=t.payload;return(0,r._)((0,n._)({},F(e,i)),{lastDispatchType:t.type})}case"items_load":{let{items:i}=t.payload;return(0,r._)((0,n._)({},I(e,i)),{lastDispatchType:t.type})}case"new_feed_items":{let i=[...e.pages];if(t.payload.insertLocation){let e={error:null,isLoading:!1,result:{items:t.payload.feedItems}};"prepend"===t.payload.insertLocation?i.unshift(e):"append"===t.payload.insertLocation&&i.push(e)}return(0,r._)((0,n._)({},I(S(e,10),t.payload.feedItems)),{lastDispatchType:t.type,pages:i})}case"items_cull":{let t=null==(d=e.pages.find(e=>{var t;return null==(t=e.result)?void 0:t.originalCursorTimestamp}))||null==(c=d.result)?void 0:c.originalCursorTimestamp;if(t&&(0,m.A)(t).isBefore((0,m.A)().subtract(10,"minutes")))return y;return S(e,10)}case"inbox_load":return A(e,t.payload);case"active_live_streams_load":if(s()(e.activeLiveStreams,t.payload))return e;return(0,r._)((0,n._)({},e),{activeLiveStreams:t.payload.filter(e=>(0,m.A)(e.liveStream.started_streaming_at).isBefore((0,m.A)().subtract(1,"minute")))});case"inbox_item_archive":{let{contentKey:i,isArchived:a}=t.payload,l=e.inboxItems.get(i);return(0,r._)((0,n._)({},e),{inboxItems:E(e.inboxItems,i,(0,r._)((0,n._)({},l),{archived_at:a?new Date().toISOString():null}))})}case"item_hide":{let{entityKey:i}=t.payload;return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,hiddenItems:[...e.hiddenItems,i]})}case"item_unhide":{let{entityKey:i}=t.payload;return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,hiddenItems:e.hiddenItems.filter(e=>e!==i)})}case"item_dismiss":{let{entityKey:i}=t.payload;return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,pages:e.pages.map(e=>(0,r._)((0,n._)({},e),{result:e.result?(0,r._)((0,n._)({},e.result),{items:e.result.items.filter(e=>"entity_key"in e&&e.entity_key!==i)}):e.result}))})}case"update_paused_notifications":{let i=new Set([...e.mutedFeedItems,...t.payload.map(e=>e.entity_key)]);return(0,r._)((0,n._)({},e),{mutedFeedItems:i})}case"item_pause_notifications":{let{entityKey:i}=t.payload,a=new Set(e.mutedFeedItems);return a.add(i),(0,r._)((0,n._)({},e),{mutedFeedItems:a})}case"item_unpause_notifications":{let{entityKey:i}=t.payload,a=new Set(e.mutedFeedItems);return a.delete(i),(0,r._)((0,n._)({},e),{mutedFeedItems:a})}}return(0,r._)((0,n._)({},e),{lastDispatchType:t.type,pages:(0,u.VL)(e.pages,t)})}function S(e,t){let i,a=0,l=[];for(let n of e.pages){var o;let e=null==(o=n.result)?void 0:o.items;if(!e||n.error||n.isLoading)break;for(let t of(i=n,e))l.push(t),a++;if(a>t)break}if(!(null==i?void 0:i.result))return e;let s=(0,r._)((0,n._)({},i),{result:(0,r._)((0,n._)({},i.result),{items:l})});return(0,r._)((0,n._)({},e),{pages:[s]})}function I(e,t){let i=new Map(e.publications),a=new Map(e.posts),l=new Map(e.mediaClipsAsPosts),o=new Map(e.comments),s=new Set(e.mutedFeedItems);for(let e of t){if("publication"in e&&e.publication&&i.set(e.publication.id,e.publication),"post"in e){let{post:t,mediaClip:i}=e;i?l.set(i.id,t):t&&a.set(t.id,t),e.isMuted&&s.add(e.entity_key)}if("comment"in e){let{comment:t}=e;if(t&&(o.set(t.id,t),t.attachments)){for(let e of t.attachments)if("post"===e.type){var c;(null==(c=e.mediaClip)?void 0:c.id)?l.set(e.mediaClip.id,e.post):a.set(e.post.id,e.post),i.set(e.publication.id,e.publication)}}e.isMuted&&s.add(e.entity_key)}if("parentComments"in e)for(let t of e.parentComments)t&&o.set(t.id,t)}return(0,r._)((0,n._)({},e),{publications:i,posts:a,mediaClipsAsPosts:l,comments:o,mutedFeedItems:s})}function F(e,t){var i;return(0,r._)((0,n._)({},e),{posts:t.post&&!t.mediaClip?E(e.posts,t.post.id,t.post):e.posts,mediaClipsAsPosts:t.post&&t.mediaClip?E(e.mediaClipsAsPosts,t.mediaClip.id,t.post):e.mediaClipsAsPosts,publications:t.publication?E(e.publications,t.publication.id,t.publication):e.publications,comments:new Map([...e.comments].concat([t.comment,...null!=(i=t.parentComments)?i:[]].filter(Boolean).map(e=>[e.id,e]))),feedItemStats:t.feedItemStats&&t.feedItemStats.entity_key?E(e.feedItemStats,t.feedItemStats.entity_key,t.feedItemStats):e.feedItemStats,mutedFeedItems:new Set(t.entity_key&&t.isMuted?[t.entity_key]:void 0)})}function D(e,t,i,a,l){let o=new Map(e.posts),s=new Map(e.mediaClipsAsPosts),c=l?s.get(l):o.get(i);return c&&(l?s.set(l,(0,n._)({},c,a)):o.set(c.id,(0,n._)({},c,a))),(0,r._)((0,n._)({},e),{lastDispatchType:t,posts:o,mediaClipsAsPosts:s})}function T(e,t){let{posts:i,publications:a,publicationSettings:l,recommendationsByPubId:o}=t,s=new Map(e.posts);for(let e of i)s.set(e.id,(0,n._)({},s.get(e.id),e));let c=new Map(e.publications);for(let e of a)c.set(e.id,(0,n._)({},c.get(e.id),e));let d=new Map([...e.publicationSettings.entries(),...l?l.entries():[]]),u=new Map([...e.publicationRecommendations.entries(),...o?o.entries():[]]);return(0,r._)((0,n._)({},e),{posts:s,publications:c,publicationSettings:d,publicationRecommendations:u})}function A(e,t){return(0,r._)((0,n._)({},T(e,t)),{readingQueue:t.inboxItems.map(e=>e.content_key),inboxItems:new Map([...e.inboxItems].concat(t.inboxItems.map(e=>[e.content_key,e]))),referringPubByPostId:(0,n._)({},e.referringPubByPostId,t.referringPubByPostId)})}function E(e,t,i){let n=new Map(e);return n.set(t,i),n}function N(e,t){var i;return(i=e,[t].map(e=>{var t,r,a,l;let o=(0,n._)({},e);return"publication"in o&&o.publication&&(o.publication=null!=(t=i.publications.get(o.publication.id))?t:o.publication),"post"in o&&o.post&&(o.post=null!=(r="mediaClip"in o&&o.mediaClip&&i.mediaClipsAsPosts.get(o.mediaClip.id)||i.posts.get(o.post.id))?r:o.post),"mediaClip"in o&&o.mediaClip&&(o.mediaClip=null!=(a=i.mediaClipsAsPosts.get(o.mediaClip.id))?a:o.mediaClip),"comment"in o&&o.comment&&(o.comment=null!=(l=i.comments.get(o.comment.id))?l:o.comment),"parentComments"in o&&o.parentComments&&(o.parentComments=o.parentComments.map(e=>e&&i.comments.get(e.id)||null)),o}))[0]}},83804:function(e,t,i){i.d(t,{Kd:()=>S,lC:()=>C,zK:()=>w});var n=i(10201),r=i(32485),a=i.n(r),l=i(49921),o=i(5061),s=i(17402),c=i(17988),d=i(78649),u=i(82519),p=i(84605),h=i(85478),m=i(17028),g=i(69553),f=i(46376),v=i(70577),b=i(32848),y=i(43296),Y=i(55714),_=i(93375);let w=e=>{let{liveStream:t,handle:i,subscriptions:r,setSubscriptions:a,className:o,isHostView:s,isOpen:d=!0,onClose:u=()=>void 0,showClose:h=!1}=e,{iString:f}=(0,p.GO)(),v=(0,c.useMediaQuery)({maxWidth:800});return(0,n.FD)(m.VP,{display:!d||(null==i?void 0:i.active)||v?"none":"flex",width:400,alignSelf:"stretch",sizing:"border-box",borderLeft:"detail",className:o,children:[(0,n.FD)(m.pT,{padding:16,borderBottom:"detail",alignItems:"center",justifyContent:"space-between",children:[(0,n.Y)(m.EY.H4,{userSelect:"none",children:f("Live chat")}),h&&(0,n.Y)(m.K0,{onClick:u,children:(0,n.Y)(l.A,{size:20})})]}),(0,n.Y)(C,{liveStream:t,isHostView:s}),(0,n.Y)(g.T,{liveStream:t,subscriptions:r,setSubscriptions:a,showShareButton:!s})]})},C=e=>{var t,i;let{liveStream:r,isHostView:a}=e,[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),p=(0,s.useRef)(null),{getConfigFor:g}=(0,h.mJ)(),_=g("thefp_enable_web_livestream_kicking"),w=(0,y.XW)(),C=(0,b.n7)(),F=e=>{c(t=>t.find(t=>t.id===e.id)?t:[...t,e].slice(-1e3))};if((0,s.useEffect)(()=>null==w?void 0:w.listen({[(0,Y.sl)({streamId:r.liveStream.id})]:e=>{var t,i;let{data:n}=e;(null==n||null==(t=n.message)?void 0:t.type)==="live-stream:message-sent"&&F(n.message.message),(null==n||null==(i=n.message)?void 0:i.type)==="live-stream:viewer-count-updated"&&n.message.num_viewers_joined>0&&F(n.message),d&&setTimeout(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},0)}}),[w,r.liveStream.id,d]),(0,s.useEffect)(()=>{p.current&&!r.liveStreamInformation.desktopPlaybackUrl&&(p.current.scrollTop=p.current.scrollHeight)},[r.liveStreamInformation.desktopPlaybackUrl]),!a&&!r.liveStreamInformation.desktopPlaybackUrl)return(0,n.Y)(v.S,{});if(a&&0===l.length)return(0,n.Y)(m.VP,{flex:"grow",position:"relative",justifyContent:"center",children:(0,n.Y)(m.pT,{justifyContent:"center",children:(0,n.FD)(m.VP,{alignItems:"center",gap:16,children:[(0,n.Y)(o.A,{size:24}),(0,n.Y)(m.EY.B4,{translated:!0,weight:"semibold",children:"Live chat will appear here"})]})})});let D=null==(t=C.result)?void 0:t.publicationUserMap.get(null!=(i=r.liveStream.publication_id)?i:-1),T=(null==D?void 0:D.role)==="admin";return(0,n.FD)(m.VP,{flex:"grow",position:"relative",children:[(0,n.Y)(k,{ref:p,onScroll:()=>{p.current&&u(32>=Math.abs(p.current.scrollTop))},children:(0,n.Y)(S,{children:l.map(e=>"user"in e?(0,n.Y)(f.K,{message:e,showBlockButton:!!T&&!!_,liveStream:r.liveStream,disableUserLinks:a},e.id):e.num_viewers_joined>0?(0,n.Y)(f.t,{message:e,disableUserLinks:a},e.id):null)})}),(0,n.Y)(I,{scrollRef:p,hidden:d})]})},k=(0,m.I4)({display:"flex",direction:"column-reverse",flex:"grow",scrollBar:"hidden",overflow:"auto",position:"relative"}),S=(0,m.I4)({display:"flex",direction:"column",padding:16,gap:16}),I=e=>{let{scrollRef:t,hidden:i}=e;return(0,n.Y)(d.Q,{children:(0,n.Y)(m.pT,{bg:"primary",radius:"full",className:a()(_.A.jumpButton,i&&_.A.hidden),children:(0,n.Y)(m.K0,{priority:"secondary-outline",rounded:!0,onClick:()=>{setTimeout(()=>{var e;null==(e=t.current)||e.scrollTo({top:t.current.scrollHeight,behavior:"smooth"})},0)},children:(0,n.Y)(u.A,{})})})})}},55700:function(e,t,i){function n(e){return e?t=>{t.preventDefault(),e()}:null}i.d(t,{M:()=>n}),i(10201),i(32485),i(6498),i(33031),i(17402),i(37343),i(28308),i(46275),i(46271),i(44333),i(68349),i(76977),i(63136),i(44502),i(67551),i(70362),i(98643),i(887),i(45133),i(28649),i(46453),i(57322),i(47408),i(2481),i(68683),i(62088),i(11510),i(32848),i(59167),i(39318),i(70189),i(49807),i(82776),i(44567)},6074:function(e,t,i){i.d(t,{u:()=>r});var n=i(69277);function r(e,t){return(0,n._)({},e,Object.fromEntries(Object.entries(null!=t?t:{}).filter(e=>{let[t,i]=e;return null!=i})))}},63840:function(e,t,i){i.d(t,{a:()=>A});var n=i(79785),r=i(10201),a=i(36049),l=i.n(a),o=i(45773),s=i(1839),c=i(40972),d=i(17402),u=i(84605),p=i(55561),h=i(86500),m=i(94729),g=i(35369),f=i(76977),v=i(16993),b=i(63136),y=i(65842),Y=i(36372),_=i(17059),w=i(49807),C=i(57324),k=i(96583);function S(){let e=(0,n._)([""," added"]);return S=function(){return e},e}function I(){let e=(0,n._)([""," removed"]);return I=function(){return e},e}function F(){let e=(0,n._)([""," updated"]);return F=function(){return e},e}function D(){let e=(0,n._)([""," created"]);return D=function(){return e},e}function T(){let e=(0,n._)(["Manage Substacks (",")"]);return T=function(){return e},e}let A=e=>{let{reads:t,open:i,close:n}=e;return(0,r.Y)(E,{reads:t,open:i,close:n})},E=e=>{var t,i,n;let{list:a,reads:l,open:c,close:p}=e,{popToast:_}=(0,Y.d)(),{iTemplate:w,iString:C}=(0,u.GO)(),[T,A]=(0,d.useState)(null!=(t=null==a?void 0:a.name)?t:"My list"),[E]=(0,d.useState)(null!=(i=null==a?void 0:a.slug)?i:""),[P,L]=(0,d.useState)(null!=(n=null==a?void 0:a.publications)?n:[]),[R,M]=(0,d.useState)(!1),B=P?null==l?void 0:l.filter(e=>!(null==P?void 0:P.map(e=>e.id).includes(e.id))):l;(0,d.useEffect)(()=>{(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_SEEN,{editing:!!a})},[]);let O=()=>{var e,t;A(null!=(e=null==a?void 0:a.name)?e:"My list"),L(null!=(t=null==a?void 0:a.publications)?t:[]),M(!1)},U=e=>{L(null==P?void 0:P.filter(t=>t.id!==e.id)),M(!0),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_REMOVED,{pub_id:e.id}),_(()=>(0,r.Y)(Y.y,{Icon:s.A,text:w(I(),e.name)}))},j=async()=>{let e,t,i={name:T,slug:E.length>0?E:void 0,publications:null==P?void 0:P.map(e=>e.id)};try{var n;a?(e=w(F(),T),t=await (0,m.x6)("/api/v1/list/".concat(a.id),{method:"PUT",json:i})):(e=w(D(),T),t=await (0,m.x6)("/api/v1/list",{method:"POST",json:i})),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_SUBMITTED,{data:i,editing:!!a}),_(()=>(0,r.Y)(Y.y,{Icon:o.A,text:e})),O(),p(null!=(n=null==t?void 0:t.list)?n:{})}catch(e){_(()=>(0,r.Y)(Y.y,{text:C("Something went wrong. Please try again")}))}},z=()=>{(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_CLOSED,{editing:!!a}),O(),p()};return(0,r.FD)(v.aF,{isOpen:c,onClose:z,className:k.A.modalContainer,children:[(0,r.Y)(v.rQ,{onClose:z,showClose:!0,title:a?C("Edit list"):C("Create new list")}),(0,r.Y)(v.cw,{children:(0,r.FD)(f.I1,{gap:48,alignItems:"stretch",justifyContent:"start",children:[(0,r.FD)(f.I1,{flex:"grow",gap:8,children:[(0,r.Y)(b.EY.B3,{translated:!0,weight:"semibold",children:"List Name"}),(0,r.Y)(y.ks,{placeholder:C("My List"),value:T,onChange:e=>{A(e.currentTarget.value),R||M(!0)}})]}),(0,r.Y)(N,{currentPublicationIds:null==P?void 0:P.map(e=>e.id),existingSubscriptions:null==l?void 0:l.map(e=>e.id),possibleSuggestions:B,onAdd:e=>{L([...P,e]),M(!0),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_ADDED,{pub_id:e.id}),_(()=>(0,r.Y)(Y.y,{Icon:o.A,text:w(S(),e.name)}))},onRemove:U}),P.length>0&&(0,r.Y)(x,{pubs:P,removePub:U})]})}),(0,r.Y)(v.jl,{primaryButton:(0,r.Y)(g.$n,{priority:"primary",disabled:!(R&&T&&P.length>=1),onClick:j,children:(0,r.Y)(b.EY.B3,{color:"primary",children:a?C("Update"):C("Create")})}),secondaryButton:(0,r.Y)(g.$n,{priority:"secondary",onClick:z,children:(0,r.Y)(b.EY.B3,{translated:!0,children:"Cancel"})}),showDivider:!0})]})},N=e=>{let t,{currentPublicationIds:i,existingSubscriptions:n,possibleSuggestions:a,onAdd:o,onRemove:s}=e,{iString:m}=(0,u.GO)(),[g,v]=(0,d.useState)(""),[Y,_]=(0,d.useState)(),{language:w}=(0,u.GO)(),{allResults:C,onSearch:S,isLoading:I}=(0,p.z)({defaultQuery:g,language:w}),F=new Set(n);(0,d.useEffect)(()=>{g&&(S(g),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_SEARCHED,{query:g}))},[g]),(0,d.useEffect)(()=>{a&&_(l()(a).slice(0,3))},[i,a]);let D=C.results;return t=""===g?[]:D.sort((e,t)=>!F.has(e.id)-!F.has(t.id)||D.indexOf(e)-D.indexOf(t)),(0,r.FD)(f.I1,{justifyContent:"start",gap:20,flex:"grow",children:[(0,r.Y)(b.EY.B3,{translated:!0,align:"left",className:k.A.fullWidth,weight:"semibold",children:"Add Substacks"}),(0,r.FD)(f.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,r.Y)(y.ks,{placeholder:"Search for Substacks",value:g,onChange:e=>v(e.currentTarget.value)}),!!t.length&&(0,r.Y)("div",{onClick:()=>v(""),children:(0,r.Y)(c.A,{width:30,style:{cursor:"pointer"}})})]}),(0,r.Y)(r.FK,{children:t.length?(0,r.Y)(f.I1,{flex:"grow",gap:20,justifyContent:"start",paddingTop:4,children:t.map(e=>{let t=null==i?void 0:i.includes(e.id);return(0,r.Y)(L,{pub:e,buttonText:t?m("Remove"):m("Add"),onClick:t?()=>s(e):()=>o(e)},e.id)})}):g&&I?(0,r.Y)(b.EY.Meta,{translated:!0,children:"Searching..."}):g&&0===t.length?(0,r.Y)(b.EY.Meta,{translated:!0,children:"No publications found"}):(0,r.Y)(P,{pubs:Y,onAdd:o,onRemove:s})})]})},P=e=>{let{pubs:t,currentPubs:i,onAdd:n,onRemove:a}=e,{iString:l}=(0,u.GO)();return(null==t?void 0:t.length)?(0,r.FD)(f.I1,{justifyContent:"start",gap:12,children:[(0,r.Y)(b.EY.Meta,{translated:!0,children:"Suggestions"}),t.map(e=>{let t=null==i?void 0:i.includes(e.id);return(0,r.Y)(L,{pub:e,buttonText:t?l("Remove"):l("Add"),onClick:()=>{t?a(e):((0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_SUGGESTION_ADDED,{pub_id:e.id}),n(e))}},e.id)})]}):(0,r.Y)(b.EY.Meta,{translated:!0,children:"Search publications to get started"})},x=e=>{let{pubs:t,removePub:i}=e,{iTemplate:n}=(0,u.GO)();return(0,r.FD)(f.I1,{justifyContent:"start",gap:20,flex:"grow",children:[(0,r.Y)(b.EY.B3,{align:"left",weight:"semibold",children:n(T(),t.length)}),(0,r.Y)(f.I1,{justifyContent:"start",gap:16,flex:"grow",children:t.map(e=>(0,r.Y)(L,{pub:e,buttonText:"Remove",onClick:()=>i(e)},e.id))})]})},L=e=>{var t;let{pub:i,buttonText:n,onClick:a,disable:l}=e;return(0,r.Y)("a",{href:(0,w.yRP)((0,w.$_T)(i),{utm_source:C.VU.listManagementModal}),target:"_blank",rel:"noopener",children:(0,r.FD)(f.Ye,{alignItems:"center",justifyContent:"space-between",gap:12,flex:"grow",children:[(0,r.Y)(_.t,{src:null!=(t=i.logo_url)?t:"",width:40,height:40,className:k.A.previewImage}),(0,r.FD)(f.I1,{minWidth:0,flex:"grow",children:[(0,r.Y)(b.EY.B4,{weight:"semibold",ellipsis:!0,children:i.name}),(0,r.Y)(b.EY.B4,{color:"secondary",ellipsis:!0,children:i.author_name})]}),(0,r.Y)(g.$n,{onClick:e=>{e.preventDefault(),a()},priority:"secondary",disabled:l,children:n})]})})}},16884:function(e,t,i){i.d(t,{GQ:()=>f,Zm:()=>g,yc:()=>b});var n=i(69277),r=i(10201),a=i(17402),l=i(58050),o=i(46271),s=i(94729),c=i(1683),d=i(36372),u=i(32848),p=i(40659),h=i(96301),m=i(49807);function g(e){var t,i,n;let{publicationId:s,publication:c,publicationName:p,user:h,allowSecondaryPublications:m=!0,subscriptionSource:g,sourceNoteId:f}=e;s=null!=(n=null!=(i=null==c?void 0:c.id)?i:s)?n:null==h||null==(t=h.primary_publication)?void 0:t.id;let Y=(0,o.Jd)(),_=(0,d.d)(),w=(0,l.uy)(),C=(0,u.n7)(),[k,S]=(0,a.useState)(!1),I=!!s&&function(e,t,i){if(!e||!t||!i.hasLoadedOnce||!i.result)return!1;let n=i.result.subscriptionMap.get(t);if(n&&"unsubscribed"!==n.membership_state)return!0;let r=i.result.publicationUserMap.get(t);return!!(r&&["admin","editor","contributor"].includes(r.role))}(Y,s,C)||function(e,t,i){let{allowSecondaryPublications:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e||!t||!i.hasLoadedOnce||!i.result)return!1;let{subscriptions:r,publicationUsers:a}=i.result;if(n){for(let e of r)if("unsubscribed"!==e.membership_state&&v(t.id,e.publication_id,i))return!0;for(let e of a)if(["admin","editor","contributor"].includes(e.role)&&v(t.id,e.publication_id,i))return!0}return!1}(Y,h,C,{allowSecondaryPublications:m}),[F,D]=(0,a.useState)(null),T=C.isLoading||!!F,A=async e=>{var t;if(e&&(e.preventDefault(),e.stopPropagation()),T||I)return;D("subscribing");let i=await b(s,g,{publication:c,user:Y,sourceNoteId:f}),n="Subscribed to ".concat(s?null!=(t=null!=p?p:null==c?void 0:c.name)?t:"publication":h?h.name:"profile");if(i.didAction){if(S(!0),_.popToast(()=>(0,r.Y)(d.y,{text:n})),Y&&s)try{await C.refetchPublication(s)}catch(e){console.error("Failed to reload subscriptions:",e)}h&&w(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.includes(h.id)?e:[h.id,...e]},{revalidate:!1})}else i.errorMessage&&_.popToast(()=>{var e;return(0,r.Y)(d.y,{text:null!=(e=i.errorMessage)?e:""})});D(null)},E=async e=>{var t;if(e&&(e.preventDefault(),e.stopPropagation()),T||!I)return;D("unsubscribing");let i=await y(s,g),n="Unsubscribed from ".concat(s?null!=(t=null!=p?p:null==c?void 0:c.name)?t:"publication":h?h.name:"profile");if(i.didAction){if(S(!1),_.popToast(()=>(0,r.Y)(d.y,{text:n})),Y&&s)try{await C.refetchPublication(s)}catch(e){console.error("Failed to reload subscriptions:",e)}else if(Y)try{await C.refetch()}catch(e){console.error("Failed to reload subscriptions:",e)}}else i.errorMessage&&_.popToast(()=>{var e;return(0,r.Y)(d.y,{text:null!=(e=i.errorMessage)?e:""})});D(null)},N=I&&!F||"subscribing"===F;return{showCta:!!s&&(!Y||C.hasLoadedOnce)&&!(Y&&Y.id===(null==h?void 0:h.id))&&(!I||k||"unsubscribing"===F),isSubscribed:N,hasPublication:!!s,subscribe:A,unsubscribe:E,toggle:N?E:A}}function f(e){let t=(0,u.n7)(),i=(0,o.Jd)();if((null==i?void 0:i.id)===e)return"subscribed";let{result:n}=t;if(!n)return null;let{subscriptions:r,publicationUsers:a}=n;for(let i of a)if(["admin","editor","contributor"].includes(i.role)&&v(e,i.publication_id,t))return"subscribed";let l=null;for(let i of r)if(v(e,i.publication_id,t)){var s;l=null!=(s=(0,h.cE)(i.membership_state,l)?i.membership_state:l)?s:null}return l}function v(e,t,i){if(i.isLoading||!i.result)return!1;let n=i.result.publicationMap.get(t);if(n){if(n.author_id===e)return!0;for(let t of n.contributors)if(t.user_id===e)return!0}return!1}async function b(e,t){let i,{publication:r,user:a,sourceNoteId:l,openPubInNewTabAfterSubscription:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=(0,p.cf)(),u=!1;if(a)try{(await (0,s.x6)("/api/v1/reader/signup/pub",{method:"POST",json:(0,n._)({publication_id:e,email:a.email,source:t,noWelcomeEmail:!0,sourceNoteId:l,first_url:c.R9,first_referrer:c.b7,first_session_url:c.K0,first_session_referrer:c.OG,current_url:c.AT,current_referrer:c.uC},d)})).requires_confirmation?i="Check your email to confirm subscription":u=!0}catch(e){console.error(e),i="Failed to subscribe"}else if(!a){if(!r)try{r=await (0,s.x6)("/api/v1/reader/publication/".concat(e))}catch(e){console.error(e)}if(r&&o){let e=(0,m.eV6)(r,{addBase:!0,user:null!=a?a:void 0});window.open(e,"_blank")}}return{didAction:u,errorMessage:i}}async function y(e,t){let i,n=!1;try{await (0,s.x6)("/api/v1/subscription/email",{method:"POST",json:{publication_id:e,email_disabled:!0,disable_all:!0,receive_podcast_emails:!1,source:t}}),n=!0}catch(e){console.error(e),i="Failed to unsubscribe"}return{didAction:n,errorMessage:i}}},27747:function(e,t,i){i.d(t,{KQ:()=>F,Uz:()=>D});var n=i(69277),r=i(10201),a=i(45994),l=i(32485),o=i.n(l),s=i(99070),c=i(23623),d=i(84605),u=i(68410),p=i(89490),h=i(76977),m=i(28734),g=i(56371),f=i(13348),v=i(69825),b=i(31790),y=i(8734),Y=i(60649),_=i(7755),w=i(56458),C=i(4016),k=i(56262),S=i(92967),I=i(91867);let F=e=>{let{isFreeSubscribed:t,isSubscribed:i,isTesting:n,post:l,pub:o,section:s,variant:c,reaction_token:d,trackingProps:u}=e,[p,h]=(0,a.J0)(!1),m=(0,a.li)(null),g=!i&&(0,k.isPaidAudience)(l.audience);if(!l.podcastUpload)return null;let f=(0,C.zM)({post:l}),v=l.podcastUpload.is_free_preview,y=!f&&g&&(p||!v&&"notes-embed"!==c)&&!(0,w.Ed)({post:l});return(0,r.FD)(r.FK,{children:[(0,r.Y)(A,{audioFileUrl:l.podcast_url,audioPlayerRef:m,metricsPost:l,hidePreviewUI:f,paywallComponent:y?(0,r.Y)(b.v,{inlineIcon:"notes-embed"===c,isFreeSubscribed:t,post:l,pub:o,medium:"audio",variant:"overlay",onRestart:v?()=>{var e;(null==(e=m.current)?void 0:e.player)&&(h(!1),m.current.player.currentTime=0,m.current.player.play())}:void 0,magicToken:d}):void 0,podcastDuration:l.podcast_duration,podcastUpload:l.podcastUpload,post:l,postId:l.id,postTitle:l.title,pub:o,section:s,showPaidLabel:g&&!v,user:null,variant:c,onFinishAudio:()=>{h(!0)},useBlur:!0,trackingProps:u}),n&&(0,r.Y)("button",{onClick:()=>{h(!0)},children:"finish audio"})]})},D=e=>{var t;let{audioPlayerRef:i,explicitHeight:n,explicitPodcastUrl:l,feedUrl:o,hasPaywall:s,isPrivateFeed:c,isServingFreePodcastUrl:d,post:u,pub:p,radius:h,section:m,ufiComponent:g,user:f,freeSignup:v,reaction_token:y}=e,[Y,_]=(0,a.J0)(!1),w=(0,C.zM)({post:u}),k=null==(t=u.podcastUpload)?void 0:t.is_free_preview,S=!w&&s&&(!k||Y)&&!d;return(0,r.Y)(A,{audioFileUrl:u.podcast_url,audioPlayerRef:i,feedUrl:o,explicitHeight:n,explicitPodcastUrl:l,hidePreviewUI:w,isPrivateFeed:c,isServingFreePodcastUrl:d,metricsPost:u,paywallComponent:S?(0,r.Y)(b.v,{isFreeSubscribed:!!(null==f?void 0:f.is_free_subscribed)||!!v,post:u,pub:p,medium:"audio",variant:"overlay",onRestart:k?()=>{var e;(null==(e=i.current)?void 0:e.player)&&(_(!1),i.current.player.currentTime=0,i.current.player.play())}:void 0,magicToken:y}):void 0,podcastDuration:u.podcast_duration,podcastUpload:u.podcastUpload,post:u,postId:u.id,postTitle:u.title,pub:p,radius:h,section:m,ufiComponent:g,user:f,variant:"episode-page",onFinishAudio:()=>{_(!0)}})},T={"episode-page":400,editor:320,"notes-embed":128,"notes-full":250},A=e=>{var t,i,a;let{audioFileUrl:l,audioPlayerRef:b,explicitHeight:w,explicitPodcastUrl:C,feedUrl:k,hasFreePodcastUrlSet:F,hidePreviewUI:D,hideUfi:A,isPrivateFeed:E,isServingFreePodcastUrl:N,metricsPost:P,postId:x,postTitle:L,podcastDuration:R,pub:M,podcastUpload:B,radius:O,section:U,showPaidLabel:j,podcastPreviewUpload:z,post:H,ufiComponent:W,editComponent:V,paywallComponent:K,variant:q,user:G,onFinishAudio:J,useBlur:$,trackingProps:Z}=e,{isMobile:Q}=(0,u.sM)(),{iString:X}=(0,d.GO)(),ee=U?null!=(t=U.podcastPalette)?t:null:null!=(i=M.podcastPalette)?i:null,{title:et,backgroundUrl:ei,artUrl:en}=(0,_.ed)({pub:M,podcastUpload:B,section:U,thumbnailInfo:(null==B?void 0:B.full_podcast_info)&&x?{post_id:x,media_upload_id:B.full_podcast_info.media_upload_id,thumbnail_id:B.full_podcast_info.thumbnail_id}:null}),er=null!=w?w:T[q],ea="notes-embed"===q,el=Q||ea,eo=!!K,es=$||en===ei,ec=!!V,ed=(null==B?void 0:B.is_free_preview)||z;return(0,r.Y)(s.A,{ref:b,duration:R,metricsPost:P,preventSnappingToCurrentTime:!0,pub:M,skipPreloading:N,src:l,updateOnEveryFrame:R<300,onFinishAudio:J,mediaUpload:null!=B?B:void 0,trackingProps:(0,n._)({contentType:"post",entityType:"post",entityKey:null!=(a=null==H?void 0:H.id)?a:"unknown",surface:"editor"===q?"editor":"post"},Z),render:e=>{var t;let{currentTime:i,dragTime:n,isPlaying:a,playbackRate:s,progress:d,progressBarRef:u,progressBarOnMouseDown:b,remainingTime:_,setPlaybackRate:w,skipBack:T,skipForward:P,togglePlayback:x}=e;return(0,r.Y)(c.a,{children:(0,r.FD)(p.az,{position:"relative",style:{minHeight:Q?Math.min(200,er):er},children:[(0,r.Y)(m._,{backgroundUrl:ea?null:ei,blurAmount:ea?40:120,isBlurred:es,palette:ee,radius:O}),(0,r.FD)(h.I1,{position:"absolute",inset:0,justifyContent:el?"space-between":void 0,children:[(0,r.FD)(h.Ye,{alignItems:"stretch",flex:el?void 0:"grow",justifyContent:"space-between",children:[(!el||!eo)&&(0,r.Y)(p.az,{padding:el||"notes-full"===q?16:24,paddingBottom:"notes-embed"===q?0:void 0,overflow:"hidden",flex:"grow",children:(0,r.Y)(g.P,{isDisabled:eo,explicitPodcastUrl:C,pub:M,post:H,postTitle:L,section:U,showUpgradeButton:N,showTitle:et,variant:"notes-embed"===q?"notes-embed":Q||"notes-full"===q?"mini":"regular"})}),!el&&!eo&&!A&&W&&(0,r.Y)(h.Ye,{alignItems:"center",paddingX:24,children:W}),null!=V?V:null]}),!eo&&"notes-embed"!==q&&(0,r.Y)(h.I1,{paddingX:16,position:el?void 0:"absolute",className:o()({[I.A.controlsCentered]:!el}),children:(0,r.Y)(v.w,{audioFileUrl:l,feedUrl:k,isPlaying:null!=a&&a,isPrivateFeed:!!E,playbackRate:s,sectionId:U?U.id:null,user:G,onChangePlaybackRate:w,onSkipBack:T,onSkipForward:P,onTogglePlayback:x})}),(!el||!eo)&&(0,r.FD)(h.Ye,{className:o()(I.A.track),alignItems:"center",gap:16,opacity:eo?20:void 0,padding:el||"notes-full"===q?16:24,paddingTop:"notes-embed"===q?8:void 0,pointerEvents:eo?"none":void 0,onClick:e=>{j||(e.stopPropagation(),e.preventDefault())},children:[ed&&ec&&z&&(0,r.Y)(y.d,{children:(0,S.kq)(null!=(t=z.duration)?t:0)}),ed&&!D&&!ec&&(0,r.Y)(y.d,{children:X("Preview")}),j&&(0,r.Y)(y.d,{children:X("Paid")}),F&&(0,r.Y)(y.d,{children:X("Free url set")}),(0,r.Y)(Y.v,{containerRef:u,currentTime:i,dragTime:n,hideStartingTimestamp:Q,progress:d,remainingTime:_,onMouseDown:b}),"notes-embed"===q&&(0,r.Y)(f.gD,{isPlaying:null!=a&&a,size:40,onTogglePlayback:x})]})]}),K]})})}})}},13348:function(e,t,i){i.d(t,{gD:()=>m,ro:()=>g,tl:()=>f});var n=i(10201),r=i(64955),a=i(59307),l=i(51782),o=i(84605),s=i(35369),c=i(76977),d=i(57820),u=i(63136),p=i(76247);let h={32:10,40:14,56:16,72:20},m=e=>{let{bg:t="glass-thick",isPlaying:i,isStatic:r,size:l,onTogglePlayback:s}=e,d=h[l],{iString:u}=(0,o.GO)();return(0,n.Y)(c.pT,{bg:t,className:p.A.playButton,alignItems:"center",justifyContent:"center",onClick:s,style:{width:l,height:l},role:"button","aria-label":u(i?"Pause":"Play"),"aria-pressed":i,children:i?(0,n.FD)("div",{className:p.A.pauseIcon,style:{width:d,height:d},children:[(0,n.Y)("div",{className:p.A.pauseIconBar}),(0,n.Y)("div",{className:p.A.pauseIconBar})]}):(0,n.Y)(a.A,{className:p.A.playButtonIcon,height:d,isStatic:r,fill:r?"#000":void 0,stroke:"none"})})},g=e=>{let{isPlaying:t,size:i,onTogglePlayback:l,href:c,loading:u}=e,{iString:m}=(0,o.GO)(),g=h[i];return(0,n.Y)(s.mZ,{priority:"primary",onClick:l,rounded:!0,style:{width:i,height:i},href:c,children:u?(0,n.Y)(d.y$,{theme:"media"}):t?(0,n.Y)(r.A,{className:p.A.videoIcon,height:g,style:{stroke:"none"},"aria-label":m("Pause")}):(0,n.Y)(a.A,{className:p.A.videoIcon,height:g,style:{stroke:"none"},"aria-label":m("Play")})})};function f(){let{iString:e}=(0,o.GO)();return(0,n.FD)(c.VP,{gap:12,alignItems:"center",children:[(0,n.FD)(s.mZ,{priority:"primary",rounded:!0,style:{width:72,height:72,position:"relative",overflow:"hidden"},"aria-label":e("Unmute"),children:[(0,n.Y)("div",{className:p.A.audioWaveform}),(0,n.Y)(l.A,{fill:"var(--color-utility-white)",size:24})]}),(0,n.Y)(u.EY.B3,{weight:"semibold",color:"white",children:e("Click to listen")})]})}},59294:function(e,t,i){i.d(t,{AC:()=>y,Fy:()=>Y,Hc:()=>b,MB:()=>_,TR:()=>f,Zq:()=>g,_N:()=>v});var n=i(69277),r=i(70408),a=i(45994),l=i(83673),o=i.n(l),s=i(11741),c=i.n(s),d=i(63375),u=i.n(d),p=i(15734),h=i.n(p),m=i(39318);let g=e=>{let{pub:t,magicToken:i,section:l,user:o}=e,[s,c]=(0,a.J0)((0,m.mWT)({pub:(0,r._)((0,n._)({},t),{section:l}),token:i})),[d,u]=(0,a.J0)(!1),p=!o||!o.is_subscribed&&!o.is_free_subscribed,[g,f]=(0,a.J0)(p);return(0,a.vJ)(()=>{p||(async()=>{try{var e;let t=await h().get("/api/v1/subscription/podcast_rss_url").query({token:i,section_id:null!=(e=null==l?void 0:l.id)?e:null});t.body.podcast_rss_url&&(c(t.body.podcast_rss_url),u(!0)),f(!0)}catch(e){f(!0)}})()},[i,l,p]),{feedUrl:s,isPrivateFeed:d,isLoaded:g}},f=e=>{let[t,i]=(0,a.J0)(!1),n=()=>{i(!0)},r=()=>{i(!1)};return(0,a.vJ)(()=>{let t=e.current;if(t)return t.addEventListener("mouseenter",n),t.addEventListener("mouseleave",r),()=>{t.removeEventListener("mouseenter",n),t.removeEventListener("mouseleave",r)}},[e]),[t]},v=(e,t,i)=>{(0,a.vJ)(()=>{let n=e.toLocaleLowerCase(),r=e=>{if(!i)return;e.preventDefault();let r=e.key.toLocaleLowerCase();if(r===n||e.ctrlKey&&"ctrl+shift+".concat(r)===n||e.ctrlKey&&"ctrl+".concat(r)===n||e.shiftKey&&"shift+".concat(r)===n)return void t()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[e,t,i])},b=e=>{let[t,i]=(0,a.J0)(null);return(0,a.vJ)(()=>{let t=async e=>{let{body:{src:t}}=await h().get("/api/v1/video/upload/".concat(e,"/storyboard"));i((await h().get(t)).body)};(null==e?void 0:e.id)&&t(e.id)},[e]),t},y=e=>{let[t,i]=(0,a.J0)(!1),n=e=>{i(e)},r=t=>{e.current&&e.current.contains(t.target)?n(!0):n(!1)};return(0,a.vJ)(()=>(document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}),[]),t},Y=e=>{let{transcription:t,processAlignedRows:i}=e,[n,r]=(0,a.J0)(!1),[l,s]=(0,a.J0)([]),[c,d]=(0,a.J0)([]),[p,m]=(0,a.J0)({});return(0,a.vJ)(()=>{(async()=>{if(!t.cdn_url)return;r(!0);let e=await h().get(t.cdn_url);if(!e.text)return r(!1);let n=JSON.parse(e.text);i?s(i({rows:n})):s(n);let a=o()(u()(n.map(e=>{var t;return null!=(t=e.speaker)?t:""}))).sort();a.length&&d(a),t.speaker_map&&Object.values(t.speaker_map).length&&m(t.speaker_map)})()},[t.cdn_url,t.cdn_unaligned_url,t.speaker_map,i]),{loading:n,rows:l,speakers:c,speakerMap:p}},_=e=>{let{containerRef:t,playerRef:i,disable:n}=e,r=(0,a.li)(null),l=(0,a.li)(null),[o,s]=(0,a.J0)();return(0,a.vJ)(()=>{let e=()=>{n||setTimeout(()=>{var e,t,i;let n=window.getSelection();if(!n||0===n.rangeCount||n.isCollapsed||!l.current){s(void 0),l.current=null,r.current=null;return}let a=n.focusNode,o=parseInt(null==a||null==(t=a.parentNode)||null==(e=t.dataset)?void 0:e.chunkIndex),d=n.focusOffset;c()(o)||(r.current={rowIndex:o,offset:d,text:null!=(i=null==a?void 0:a.textContent)?i:""}),s(n)},0)},i=null,a=0,o=e=>{var t,i,n,r;let a=e.srcElement,o=parseInt(null!=(r=null==(t=a.dataset)?void 0:t.chunkIndex)?r:null==(n=a.parentNode)||null==(i=n.dataset)?void 0:i.chunkIndex);setTimeout(()=>{let e=window.getSelection(),t=null==e?void 0:e.anchorOffset;"number"!=typeof t||c()(o)||(l.current={rowIndex:o,offset:t,text:a.textContent})},0)},d=()=>{a>5||((i=t.current)?(i.addEventListener("mouseup",e),i.addEventListener("selectstart",o)):(a+=1,setTimeout(()=>{d()},50)))};return d(),()=>{null==i||i.removeEventListener("mouseup",e),null==i||i.removeEventListener("selectstart",o)}},[t,n,i]),{clearSelection:(0,a.hb)(()=>{o&&(o.removeAllRanges?o.removeAllRanges():o.empty&&o.empty()),s(void 0),l.current=null,r.current=null},[o]),selection:o,selectStartRef:l,selectEndRef:r}}},7755:function(e,t,i){i.d(t,{Ei:()=>A,Em:()=>I,Hx:()=>S,Pi:()=>D,R4:()=>T,RM:()=>C,dV:()=>w,ed:()=>y,fU:()=>E});var n=i(69277),r=i(70408),a=i(79785),l=i(83673),o=i.n(l),s=i(38970),c=i.n(s),d=i(36233),u=i(86500),p=i(68349),h=i(56458),m=i(46009),g=i(56262),f=i(39318),v=i(49807);function b(){let e=(0,a._)(['Invalid URL. URL should start with "','"']);return b=function(){return e},e}let y=e=>{let{pub:t,podcastUpload:i,section:a,thumbnailInfo:l,useSection:o}=e;if(o){let e=a?(0,v.Dor)(t,{section:a}):(0,v.$_T)(t);return a?{artUrl:a.logo_url,backgroundUrl:a.cover_photo_url,description:a.description,paidArtUrl:null,title:a.name,url:e}:{artUrl:t.logo_url,backgroundUrl:t.cover_photo_url,description:null,paidArtUrl:null,title:t.name,url:e}}let{title:s,description:c,artUrl:d,paidEpisodeArtUrl:u}=a&&!o?(0,m.lL)({pub:t,section:a}):(0,m.j_)({pub:t}),p=a?(0,v.Dor)(t,{section:a}):(0,v.$_T)(t),h=d;if(i&&l&&l.thumbnail_id>1){let e=(0,f.Pzx)((0,r._)((0,n._)({},i),{id:l.media_upload_id,post_id:l.post_id,thumbnail_id:l.thumbnail_id}));e&&(h=e)}else if(i&&i.thumbnail_id>1){let e=(0,f.Pzx)(i);e&&(h=e)}return{artUrl:d,backgroundUrl:h,description:c,paidArtUrl:null!=u?u:null,title:s,url:p}},Y=[{key:"apple_podcasts",label:"Apple Podcasts",fieldName:"apple_podcasts_url"},{key:"spotify",label:"Spotify",fieldName:"spotify_url"},{key:"spotify_for_paid_users",label:"Spotify",fieldName:"spotify_for_paid_users_url"},{key:"youtube_music",label:"YouTube Music",fieldName:"youtube_music_url"},{key:"youtube",label:"YouTube",fieldName:"youtube_url"},{key:"overcast",label:"Overcast",fieldName:"overcast_url"},{key:"pocket_casts",label:"Pocket Casts",fieldName:"pocket_casts_url"}],_=e=>{let{platform:t,feedUrl:i,isApple:n,isMobile:r}=e;return i?"apple_podcasts"===t&&n?"podcast://".concat((0,f.L56)(i)):"overcast"===t&&r?"overcast://x-callback-url/add?url=".concat(encodeURIComponent(i)):"pocket_casts"===t&&r?"pktc://subscribe/".concat((0,f.L56)(i)):null:null},w=e=>{let{feedUrl:t,isApple:i,isMobile:n,showLinks:r,userIsSubscribed:a}=e,l=[],o=c()(Y,"key"),s=!1;for(let e of Y){let c;if(["spotify","spotify_for_paid_users","spotify_open_access"].includes(e.key)){if(s)continue;let e=function(e){let{showLinks:t,userIsSubscribed:i}=e;return i&&t.spotify_for_paid_users_url?{label:"Spotify",platform:"spotify_for_paid_users",url:t.spotify_for_paid_users_url}:!i&&t.spotify_url?{label:"Spotify",platform:"spotify",url:t.spotify_url}:t.spotify_open_access_url?{label:"Spotify",platform:"spotify",url:t.spotify_open_access_url}:null}({showLinks:r,userIsSubscribed:a});if(e){l.push(e),s=!0;continue}}if(a&&"youtube"!==e.key)c=_({platform:e.key,feedUrl:t,isApple:i,isMobile:n});else{var d;c=null!=(d=r[e.fieldName])?d:_({platform:e.key,feedUrl:t,isApple:i,isMobile:n})}c&&l.push({label:o[e.key].label,platform:e.key,url:c}),"spotify"===e.key&&r.spotify_open_access_url&&l.push({label:"Spotify",platform:"spotify_open_access",url:r.spotify_open_access_url})}return l},C=e=>{let{feedUrl:t,isApple:i,isMobile:n,render:r,showLinks:a,user:l,analyticsSource:s="shows_episode_page"}=e,h=c()(Y,"key");return o()([...w({feedUrl:t,isApple:i,isMobile:n,showLinks:a,userIsSubscribed:!!(null==l?void 0:l.is_subscribed)}).map(e=>{let i="spotify_open_access"===e.platform?"Spotify":h[e.platform].label;return r({key:e.platform,label:i,url:e.url,onClick:()=>{(0,u.u4)(u.qY.PODCAST_APP_LINK_CLICK,{appName:i,feedUrl:t,url:e.url,source:s}),n||window.open(e.url,"_blank")}})}),t&&r({key:"rss",label:"RSS Feed",url:t,onClick:()=>{(0,u.u4)(u.qY.PODCAST_FEED_URL_COPIED,{feedUrl:t,source:s}),(0,d.Ay)("RSS feed URL copied"),(0,p.lW)(t)}})])},k={apple_podcasts:["https://podcasts.apple.com/","https://itunes.apple.com/"],overcast:["https://overcast.fm/"],pocket_casts:["https://pca.st/"],spotify:["https://open.spotify.com/"],spotify_for_paid_users:["https://open.spotify.com/"],youtube:["https://youtube.com/","https://www.youtube.com/"],youtube_music:["https://music.youtube.com/"]},S=e=>{let{platform:t,url:i,language:n}=e,{iString:r,iTemplate:a}=I18N.i(n),l=k[t];if(l.every(e=>!i.startsWith(e))){var o;return{isValid:!1,message:a(b(),null!=(o=l[0])?o:"undefined")}}return i.length>255?{isValid:!1,message:r("URL can't be longer than 255 characters")}:{isValid:!0,message:null}},I=e=>{let{pub:t,section:i,spotifySettings:n}=e;return F({showLinks:i?i.showLinks:t.show_links,spotifySettings:n})},F=e=>{let{showLinks:t,spotifySettings:i}=e,n={apple_podcasts_url:null,overcast_url:null,pocket_casts_url:null,spotify_url:null,spotify_for_paid_users_url:null,youtube_url:null,youtube_music_url:null,spotify_open_access_url:null};if(i&&(n.spotify_open_access_url=i.spotify_show_url),!t)return n;for(let e of t)n["".concat(e.platform,"_url")]=e.url;return n},D="https://support.substack.com/hc/en-us/articles/4519588148244-How-do-I-listen-to-episodes-on-my-podcast-app-",T="comments-for-scroll",A=e=>{var t,i,n,r;let{post:a,pub:l,user:o}=e,s=a.section_id&&null!=(i=l.sections.find(e=>e.id===a.section_id))?i:null;if((0,h.rI)({post:a,section:s,pub:l}))return null;if((null==(t=a.podcastFields)?void 0:t.free_podcast_url)&&!(null==o?void 0:o.is_subscribed))return{url:a.podcastFields.free_podcast_url,type:"free_podcast_url"};if(a.podcastUpload&&a.podcast_url){let e=!!a.podcastUpload.src_media_upload_id||!(0,g.isPaidAudience)(a.audience)||(null==o?void 0:o.is_subscribed)||null!=(r=null==(n=a.videoUpload)?void 0:n.preview_duration)&&r,t=(0,g.isPaidAudience)(a.audience)&&!(null==o?void 0:o.is_subscribed);return{url:a.podcast_url,type:t?e?"alternate_audio_preview":"extra_audio_preview":"alternate_full_audio"}}return null},E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=(null==t?void 0:t.decimals)===1,n=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60),l=n?"".concat(n,":").concat(r<10?"0":"").concat(r,":").concat(a<10?"0":"").concat(a):"".concat(r,":").concat(a<10?"0":"").concat(a);if(i){let t=Math.round(e%1*10);return"".concat(l,".").concat(t)}return l}},68723:function(e,t,i){i.d(t,{W2:()=>J,B2:()=>G,Lt:()=>$});var n=i(69277),r=i(70408),a=i(32641),l=i(10201),o=i(32485),s=i.n(o),c=i(17402),d=i(18993),u=i(26683),p=i(79785),h=i(17159),m=i.n(h),g=i(87583),f=i(79909),v=i(84605),b=i(86500),y=i(92476),Y=i(24078),_=i(16074),w=i(76977),C=i(63136),k=i(39318),S=i(49807),I=i(98949),F=i(82776),D=i(57324);let T="threadsLinkFallback-sQtc8r",A="appBadge-jMueor";function E(){let e=(0,p._)([""," started a thread"]);return E=function(){return e},e}function N(){let e=(0,p._)(["Join "," subscriber chat "]);return N=function(){return e},e}function P(e){let{pub:t,utm_campaign:i}=e;return(0,l.FD)(w.I1,{alignItems:"center",justifyContent:"center",gap:12,children:[(0,l.Y)(U,{utm_campaign:i}),(0,l.FD)(C.EY.B4,{translated:!0,size:12,color:"secondary",className:T,children:["Already have the app? ",(0,l.Y)("a",{href:(0,k.Q1d)(t),children:"Open now"})]})]})}function x(e){let{pub:t,utm_campaign:i}=e;return(0,l.FD)(w.I1,{alignItems:"center",justifyContent:"center",gap:12,children:[(0,l.Y)(j,{utm_campaign:i}),(0,l.FD)(C.EY.B4,{translated:!0,size:12,color:"secondary",className:T,children:["Already have the app? ",(0,l.Y)("a",{href:(0,k.Q1d)(t),children:"Open now"})]})]})}function L(e){var t,i,n,r;let{pub:a,communityAction:o}=e,{iString:s,iTemplate:c}=(0,v.GO)(),d=o?c(E(),(null==(t=o.author)?void 0:t.name)||s("Someone")):c(N(),(0,F.possessive)(a.author_name)),u=(null==o?void 0:o.communityPost)?null==(i=o.communityPost.body)?void 0:i.slice(0,128):"Subscribe to ".concat(a.name," and join the conversation."),p=(null!=(r=null==o?void 0:o.communityPost.media_assets)?r:[])[0],h=(null==o||null==(n=o.communityPost)?void 0:n.type)==="media"&&!!p,g=h?p.url:a.logo_url,b=(0,S.xWO)({pubKey:a.subdomain});return(0,l.FD)(l.FK,{children:[(0,l.Y)(f.Metadata,{title:d,socialTitle:d,description:u,image:g,isLargeImage:h}),(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:m()((0,y.AF)(a,{name:d,url:b,description:u,potentialAction:null}),{json:!0,isScriptContext:!0})}})]})}function R(e){let{publication:t,communityAction:i,publicationAuthor:n,utm_campaign:r}=e,a=(0,I.Fr)(),o=(0,I.m0)();return(0,l.FD)(w.I1,{gap:a?20:24,justifyContent:"center",alignItems:"center",children:[(0,l.Y)(Y.eu,{user:n,size:88}),(0,l.Y)(w.I1,{gap:8,children:(0,l.FD)(C.EY.H2,{translated:!0,size:24,align:"center",weight:"bold",color:"pub-primary-text",children:["Join ",I18N.p(n.name||"Substack user"),"'s subscriber chat"]})}),!a&&(0,l.Y)("div",{className:"threadsLinkContainer-JACRi5",children:(0,l.Y)(B,{utm_campaign:r,subdomain:t.subdomain})}),a&&(o?(0,l.Y)(x,{pub:t,utm_campaign:r}):(0,l.Y)(P,{pub:t,utm_campaign:r})),(0,l.Y)(M,{publication:t,source:"pub-nav-bar"}),(0,l.Y)(L,{pub:t,communityAction:i})]})}function M(e){let{publication:t,source:i,postId:n,commentId:r,targetReplyId:a,showTarget:o,text:s}=e,{iString:c}=(0,v.GO)();return s||(s=c("Or open on web")),(0,l.Y)("a",{href:(0,S.e$6)({pubId:t.id,postId:n,commentId:r,params:{utm_source:i,targetReplyId:a,showTarget:o}}),className:"webChatLink-DvDRdZ",children:(0,l.Y)(C.EY.B3,{weight:"semibold",align:"center",as:"p",color:"pub-secondary-text",children:s})})}function B(e){let{utm_campaign:t,postId:i,subdomain:n,commentId:r,targetReplyId:a}=e;return(0,l.FD)(w.I1,{gap:24,children:[(0,l.Y)(w.pT,{justifyContent:"center",children:(0,l.Y)(C.EY.B4,{translated:!0,as:"span",weight:"bold",children:"Scan the QR code below"})}),(0,l.Y)(w.pT,{flex:"auto",justifyContent:"center",alignSelf:"center",border:"detail",radius:"sm",className:"qrCode-JMB0bK",children:(0,l.Y)(O,{utm_campaign:t,postId:i,subdomain:n,commentId:r,targetReplyId:a})}),(0,l.Y)(_.v,{}),(0,l.FD)(w.pT,{gap:16,justifyContent:"center",children:[(0,l.Y)(U,{utm_campaign:t}),(0,l.Y)(j,{utm_campaign:t})]})]})}function O(e){let{utm_campaign:t,postId:i,subdomain:n,commentId:r,targetReplyId:a}=e,o=(0,c.useRef)(),s=r?(0,S.j5y)({commentId:r,targetReplyId:a,utm_campaign:t}):i?(0,S.sWz)({postId:i,utm_campaign:t}):(0,S.xWO)({pubKey:n,redirect:"app-store",utm_campaign:t});return(0,c.useEffect)(()=>{let{current:e}=o;e&&g.toCanvas(e,s,{width:180,margin:2})},[]),(0,l.Y)("canvas",{ref:o})}function U(e){let{utm_campaign:t}=e;return(0,l.Y)("a",{className:A,href:(0,k.cxW)({utm_campaign:t,utm_source:D.VU.substack}),onClick:()=>{(0,b.u4)(b.qY.APP_STORE_LINK_CLICKED,{app_store:"ios"})},children:(0,l.Y)("img",{src:(0,k.dJ9)("/img/app_page/app-store.png",400),height:40})})}function j(e){let{utm_campaign:t}=e;return(0,l.Y)("a",{className:A,href:(0,k.zw3)({utm_campaign:t,utm_source:D.VU.substack}),onClick:()=>{(0,b.u4)(b.qY.APP_STORE_LINK_CLICKED,{app_store:"android"})},children:(0,l.Y)("img",{src:(0,k.dJ9)("/img/app_page/google-play.png",400),height:40})})}var z=i(20504),H=i(36520),W=i(35369),V=i(16993),K=i(11510);function q(e){let{children:t,pub:i,user:n,showHeader:r,layoutTop:a}=e;return(0,l.FD)("div",{className:s()("pageContainer-QRoB4X",a?"layoutTop-HNorD1":"layoutCentered-puapcv"),children:[(0,l.Y)("div",{className:"header-LFnrx6",children:r&&i&&n&&(0,l.Y)(z.W1,{pub:i,user:n,hideNavBar:!0,hideTitle:!0,selectedSectionId:null})}),t]})}function G(e){let{publication:t,communityAction:i,user:n,showHeader:r,activeChatInfo:a}=e;return(0,I.Fr)()?(0,l.Y)(w.I1,{alignItems:"center",justifyContent:"center",paddingX:16,paddingTop:56,children:(0,l.Y)(H.o,{pub:t,chatInformation:a,canSkip:!1,onNext:()=>{},hasAppInstalled:!!(null==n?void 0:n.reader_installed_at),redirectToChat:!0,upsellGroup:"publication-chat-page"})}):(0,l.Y)(q,{pub:t,user:n,showHeader:r,children:(0,l.Y)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:56,children:(0,l.Y)(R,{publication:t,communityAction:i,publicationAuthor:t.author||{id:t.author_id||0,name:t.author_name||"",photo_url:t.author_photo_url},utm_campaign:D._9.threadsPage})})})})}function J(e){let{publication:t,communityAction:i,user:n,layoutTop:r,appModalOpenByDefault:a}=e,o=(0,K.Iu)(),[s,p]=(0,c.useState)(!o&&a),h=D._9.threadPage,{iString:m}=(0,v.GO)(),g=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(W.$n,{href:(0,S.sWz)({postId:i.communityPost.id,utm_source:D.VU.chatPostLanding,redirect:"app-store",utm_campaign:h}),onClick:o?null:e=>{e.preventDefault(),p(!0)},children:m("Open in app")}),(0,l.Y)(M,{publication:t,postId:i.communityPost.id,text:m("Or join the conversation on web"),source:"post-permalink"})]});return(0,l.Y)(q,{pub:t,user:n,layoutTop:r,children:(0,l.FD)(u.Sd,{children:[(0,l.FD)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:[(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:16,children:(0,l.Y)(w.I1,{style:{maxWidth:580},flex:"grow",justifyContent:"center",children:"open"===i.status?(0,l.Y)(d.lS,{communityPost:i.communityPost,author:i.author,withAttribution:!0,extras:o?null:g,flex:"auto",isReadOnly:!0}):(0,l.Y)(w.I1,{children:(0,l.Y)(d.I8,{author:i.author,extras:o?null:g,commenters:i.communityPost.recent_commenters,count:i.communityPost.comment_count,audience:i.communityPost.audience})})})}),o&&(0,l.Y)(w.I1,{sizing:"border-box",borderTop:"detail-themed",paddingY:16,alignSelf:"stretch",children:g}),(0,l.Y)(L,{pub:t,communityAction:i})]}),(0,l.Y)(Z,{utm_campaign:h,isOpen:s,postId:i.communityPost.id,onClose:()=>p(!1),subdomain:t.subdomain})]})})}function $(e){var t;let{publication:i,communityAction:n,user:r,layoutTop:a,appModalOpenByDefault:o}=e,{iString:s}=(0,v.GO)(),u=(0,K.Iu)(),[p,h]=(0,c.useState)(!u&&o),m=D._9.commentPage,g=null!=(t=n.communityComment.parent_id)?t:n.communityComment.id,f=n.communityComment.parent_id?n.communityComment.id:void 0,b=n.communityComment.post_id,y=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(W.$n,{href:(0,S.j5y)({commentId:g,targetReplyId:f,utm_source:D.VU.chatPostLanding,redirect:"app-store",utm_campaign:m}),onClick:u?null:e=>{e.preventDefault(),h(!0)},children:s("Open in app")}),(0,l.Y)(M,{publication:i,postId:b,commentId:g,targetReplyId:f,showTarget:!!f||void 0,text:s("Or join the conversation on web"),source:"post-permalink"})]});return(0,l.FD)(q,{pub:i,user:r,layoutTop:a,children:[(0,l.FD)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:[(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:16,children:(0,l.Y)(w.I1,{style:{maxWidth:580},flex:"grow",justifyContent:"center",children:"VISIBLE"!==n.status&&n.status?"PAID_SUBSCRIPTION_REQUIRED"===n.status||"FOUNDING_SUBSCRIPTION_REQUIRED"===n.status?(0,l.Y)(w.I1,{children:(0,l.Y)(d.I8,{author:n.author,extras:u?null:y,commenters:n.communityComment.recent_commenters,count:n.communityComment.reply_count,audience:"FOUNDING_SUBSCRIPTION_REQUIRED"===n.status?"only_founding":"only_paid"})}):(0,l.Y)(w.I1,{children:(0,l.Y)(d.dw,{author:n.author,extras:u?null:y,commenters:n.communityComment.recent_commenters,count:n.communityComment.reply_count})}):(0,l.Y)(d.eT,{chatPublicationId:i.id,communityComment:n.communityComment,author:n.author,extras:u?null:y,isReadOnly:!0,isBanned:!1,quoteReply:n.quote,chatAuthorNameAttribution:i.author_name,flex:"auto"})})}),u&&(0,l.Y)(w.I1,{sizing:"border-box",borderTop:"detail-themed",paddingY:16,alignSelf:"stretch",children:y})]}),(0,l.Y)(Z,{utm_campaign:m,isOpen:p,postId:b,commentId:g,targetReplyId:f,onClose:()=>h(!1),subdomain:i.subdomain})]})}function Z(e){var{postId:t,utm_campaign:i,subdomain:o,commentId:s,targetReplyId:c}=e,d=(0,a._)(e,["postId","utm_campaign","subdomain","commentId","targetReplyId"]);let{iString:u}=(0,v.GO)();return(0,l.FD)(V.aF,(0,r._)((0,n._)({},d),{children:[(0,l.Y)(V.rQ,{title:u("Open in the Substack app"),showClose:!0,onClose:d.onClose,showDivider:!0}),(0,l.Y)(w.I1,{paddingY:32,paddingX:40,children:(0,l.Y)(B,{utm_campaign:i,postId:t,subdomain:o,commentId:s,targetReplyId:c})})]}))}},14984:function(e,t,i){i.d(t,{Ty:()=>u,fk:()=>h,tB:()=>m});var n=i(10201),r=i(50014),a=i.n(r),l=i(17402);i(46271);var o=i(17186),s=i(49807),c=i(84985);let d={surfaces:[],addSurface:()=>void 0},u=e=>{let{pub:t}=e,i=(0,l.useRef)(null),[r,a]=(0,l.useState)(!1);(0,l.useEffect)(()=>(window.addEventListener("message",o),()=>window.removeEventListener("message",o))),(0,l.useEffect)(()=>{var e;if(r&&(null==(e=i.current)?void 0:e.contentWindow)&&t){let e=i.current.contentWindow;null==e||e.postMessage({pub:t},"".concat((0,s.Ewe)()))}},[t,r]);let o=e=>{var t;(null==(t=e.data)?void 0:t.surfaceReady)===!0&&a(!0)};return"undefined"==typeof window?null:(0,n.Y)("iframe",{className:c.A.visitedSurfacesIFrame,ref:i,src:"".concat((0,s.Ewe)(),"/visited-surface-frame"),width:"0",height:"0"})},p=(0,l.createContext)(d);function h(){return(0,l.useContext)(p)}function m(e){let{user:t,children:i}=e,{surfaces:r,addSurface:s}=(e=>{let[t,i]=(0,l.useState)([]),n=(0,l.useMemo)(()=>e?"".concat("user-recent-surfaces","-").concat(e.id):"",[e]);(0,l.useEffect)(()=>{if(!e)return;let t=(0,o.xm)(n);i(null!=t?t:[])},[e,n]);let r=(0,l.useCallback)(e=>{var t;let r=null!=(t=(0,o.xm)(n))?t:[],l="visited-publication"===e.type?{type:e.type,publication:{id:e.publication.id,name:e.publication.name,base_url:e.publication.base_url,logo_url:e.publication.logo_url,custom_domain:e.publication.custom_domain,custom_domain_optional:e.publication.custom_domain_optional,subdomain:e.publication.subdomain,theme:e.publication.theme,theme_var_background_pop:e.publication.theme_var_background_pop,author_photo_url:e.publication.author_photo_url,author:e.publication.author,cover_photo_url:e.publication.cover_photo_url}}:{type:e.type,profile:{name:e.profile.name,id:e.profile.id,photo_url:e.profile.photo_url}},s=a()([l,...r],e=>"visited-publication"===e.type?"pub-".concat(e.publication.id):"profile-".concat(e.profile.id)).slice(0,10);i(s);try{(0,o.X3)(n,s)}catch(e){console.error("Failed to update local recent surfaces:",e)}},[n]);return e?{surfaces:t,addSurface:r}:d})(t);return(0,n.Y)(p.Provider,{value:{surfaces:r,addSurface:s},children:i})}},72550:function(e,t,i){i.d(t,{hX:()=>o,zC:()=>p});var n=i(69277),r=i(70408);i(50014);var a=i(82776),l=i(58643);let o=3;l.A.colors.primitive.gray["700"].toRgb();let s=l.A.colors.primitive.white,c=l.A.colors.primitive.black;(0,r._)((0,n._)({},s.toRgb()),{a:0});let d=l.A.colors.light,u=l.A.colors.dark;d.semantic.substack.bg.primary.toRgb(),d.semantic.substack.bg["primary-hover"].toRgb(),d.semantic.substack.bg["primary-hover"].toRgb(),(0,r._)((0,n._)({},d.semantic.substack.bg.primary.toRgb()),{a:.2}),s.toRgb(),(0,r._)((0,n._)({},d.semantic.substack.bg.primary.toRgb()),{a:.2}),(0,r._)((0,n._)({},d.semantic.substack.bg.primary.toRgb()),{a:.3}),u.semantic.substack.bg.primary.toRgb(),u.semantic.substack.bg["primary-hover"].toRgb(),u.semantic.substack.bg["primary-hover"].toRgb(),(0,r._)((0,n._)({},u.semantic.substack.bg.primary.toRgb()),{a:.2}),s.toRgb(),(0,r._)((0,n._)({},u.semantic.substack.bg.primary.toRgb()),{a:.2}),(0,r._)((0,n._)({},u.semantic.substack.bg.primary.toRgb()),{a:.3}),(0,r._)((0,n._)({},c.toRgb()),{a:.8}),(0,r._)((0,n._)({},c.toRgb()),{a:.5}),(0,r._)((0,n._)({},c.toRgb()),{a:.3}),d.semantic.substack.fg.primary.toRgb(),(0,r._)((0,n._)({},s.toRgb()),{a:.9}),(0,r._)((0,n._)({},s.toRgb()),{a:.5}),(0,r._)((0,n._)({},s.toRgb()),{a:.3}),u.semantic.substack.fg.primary.toRgb(),s.toRgb(),s.toRgb(),d.bg["primary-hover"].toRgb(),d.bg.primary.toRgb(),d.bg.secondary.toRgb(),d.bg.tertiary.toRgb(),d.bg.tertiary.toRgb(),d.bg.quaternary.toRgb(),u.bg.primary.toRgb(),u.bg["primary-hover"].toRgb(),u.bg["primary-hover"].toRgb(),u.bg.secondary.toRgb(),u.bg.tertiary.toRgb(),u.bg.tertiary.toRgb(),u.bg.quaternary.toRgb();let p=e=>{var t,i,n,r,l,o,s,c,d,u,p,h,m,g,f,v,b,y,Y,_,w,C,k,S,I,F,D,T,A,E,N,P,x,L,R,M,B;return e&&e.colors?{"--color-app-light-accent":(0,a.rgbaToString)(null==e||null==(t=e.colors)?void 0:t.accent.primary),"--color-app-light-accent-hover":(0,a.rgbaToString)(null==e||null==(i=e.colors)?void 0:i.accent.primary_hover),"--color-app-light-accent-inverse":(0,a.rgbaToString)(null==e||null==(n=e.colors)?void 0:n.accent.contrast),"--color-app-light-accent-text":(0,a.rgbaToString)(null==e||null==(r=e.colors)?void 0:r.fg.accent),"--color-app-dark-accent":(0,a.rgbaToString)(null==e||null==(l=e.colors)?void 0:l.accent.dark.primary),"--color-app-dark-accent-hover":(0,a.rgbaToString)(null==e||null==(o=e.colors)?void 0:o.accent.dark.primary_hover),"--color-app-dark-accent-inverse":(0,a.rgbaToString)(null==e||null==(s=e.colors)?void 0:s.accent.dark.contrast),"--color-app-dark-accent-text":(0,a.rgbaToString)(null==e||null==(d=e.colors)||null==(c=d.fg.dark)?void 0:c.accent),"--color-app-light-bg-accent":(0,a.rgbaToString)(null==e||null==(u=e.colors)?void 0:u.accent.bg),"--color-app-light-bg-accent-hover":(0,a.rgbaToString)(null==e||null==(p=e.colors)?void 0:p.accent.bg_hover),"--color-app-dark-bg-accent":(0,a.rgbaToString)(null==e||null==(h=e.colors)?void 0:h.accent.dark.bg),"--color-app-dark-bg-accent-hover":(0,a.rgbaToString)(null==e||null==(m=e.colors)?void 0:m.accent.dark.bg_hover),"--color-app-light-fg-primary":(0,a.rgbaToString)(null==e||null==(g=e.colors)?void 0:g.fg.primary),"--color-app-light-fg-secondary":(0,a.rgbaToString)(null==e||null==(f=e.colors)?void 0:f.fg.secondary),"--color-app-light-fg-tertiary":(0,a.rgbaToString)(null==e||null==(v=e.colors)?void 0:v.fg.tertiary),"--color-app-dark-fg-primary":(0,a.rgbaToString)(null==e||null==(y=e.colors)||null==(b=y.fg.dark)?void 0:b.primary),"--color-app-dark-fg-secondary":(0,a.rgbaToString)(null==e||null==(_=e.colors)||null==(Y=_.fg.dark)?void 0:Y.secondary),"--color-app-dark-fg-tertiary":(0,a.rgbaToString)(null==e||null==(C=e.colors)||null==(w=C.fg.dark)?void 0:w.tertiary),"--color-app-light-bg-primary":(0,a.rgbaToString)(null==e||null==(k=e.colors)?void 0:k.bg.primary),"--color-app-light-bg-primary-hover":(0,a.rgbaToString)(null==e||null==(S=e.colors)?void 0:S.bg.primary_hover),"--color-app-light-bg-secondary":(0,a.rgbaToString)(null==e||null==(I=e.colors)?void 0:I.bg.secondary),"--color-app-light-bg-tertiary":(0,a.rgbaToString)(null==e||null==(F=e.colors)?void 0:F.bg.tertiary),"--color-app-light-bg-quaternary":(0,a.rgbaToString)(null==e||null==(D=e.colors)?void 0:D.bg.quaternary),"--color-app-dark-bg-primary":(0,a.rgbaToString)(null==e||null==(A=e.colors)||null==(T=A.bg.dark)?void 0:T.primary),"--color-app-dark-bg-primary-hover":(0,a.rgbaToString)(null==e||null==(N=e.colors)||null==(E=N.bg.dark)?void 0:E.primary_hover),"--color-app-dark-bg-secondary":(0,a.rgbaToString)(null==e||null==(x=e.colors)||null==(P=x.bg.dark)?void 0:P.secondary),"--color-app-dark-bg-tertiary":(0,a.rgbaToString)(null==e||null==(R=e.colors)||null==(L=R.bg.dark)?void 0:L.tertiary),"--color-app-dark-bg-quaternary":(0,a.rgbaToString)(null==e||null==(B=e.colors)||null==(M=B.bg.dark)?void 0:M.quaternary)}:null}},38123:function(e,t,i){function n(e,t){for(let[i,n]of Object.entries(t))null!=n&&(e[i]=n);return e}function r(e,t){return Object.entries(e).every(e=>{let[i,n]=e;return n===t[i]})}i.d(t,{bN:()=>r,qy:()=>n})},86898:function(e,t,i){i.d(t,{AD:()=>r,O:()=>n,VK:()=>a,cD:()=>l,wJ:()=>o});let n={newspaper:{id:"newspaper",legacyEquivalent:"newspaper",postCount:{desktop:1,tablet:1,mobile:1}},magaziney:{id:"magaziney",legacyEquivalent:"magaziney",postCount:{desktop:3,tablet:3,mobile:3}},"magazine-5":{id:"magazine-5",legacyEquivalent:"magaziney",postCount:{desktop:5,tablet:3,mobile:5}},"feature-media":{id:"feature-media",legacyEquivalent:"newspaper",postCount:{desktop:1,tablet:1,mobile:1}},feature:{id:"feature",legacyEquivalent:"magaziney",postCount:{desktop:5,tablet:5,mobile:5}},podcast:{id:"podcast",legacyEquivalent:"newspaper",postCount:{desktop:0,tablet:0,mobile:0}}},r={posts:{min:3,default:6,max:7},rows:{min:1,default:2,max:4}},a=e=>{let{contentBlock:t,breakpoint:i="desktop",isTheFP:n}=e;if("list"===t.block_type)return t.num_posts||r.posts.default;if("grid"===t.block_type){let e=t.num_rows||r.rows.default;if("desktop"===i||"mobile"===i){let i=4;return t.primary_sidebar_modules.length>0&&(i-=1),t.secondary_sidebar_modules.length>0&&(i-=1),i*e}if("tablet"===i){let i=3;return(t.primary_sidebar_modules.length>0||t.secondary_sidebar_modules.length>0)&&(i-=1),i*e}}if("feature"===t.block_type){if(n){var a;return t.attrs.feature&&(null==(a=t.attrs.feature)?void 0:a.variant)!=="special-feature"?5:8}return 5}return"podcast_plus_three"===t.block_type?4:"single_post"===t.block_type?1:"half_feature"===t.block_type?"tablet"===i?3:4:0},l=e=>{let{contentBlocks:t,breakpoint:i,isTheFP:n,recentPosts:r,postsBySectionId:l,postsByTagId:s,postsForContentBlockPins:c}=e,d={},u=0;for(let e of t){var p,h,m;let t=[];if("latest"===e.post_source){let l=a({contentBlock:e,breakpoint:i,isTheFP:n});t=r.slice(u,u+l),u+=l}else"section"===e.post_source&&e.section_id?t=null!=(p=l[e.section_id])?p:[]:"tag"===e.post_source&&e.post_tag_id&&(t=null!=(h=s[e.post_tag_id])?h:[]);let{posts:g,numPostsDisplaced:f}=o({posts:t,contentBlockPins:null!=(m=e.contentBlockPins)?m:[],pinnedPosts:c});u-=f,d[e.id]={posts:g,postsWithoutPins:t}}return d},o=e=>{let{posts:t,contentBlockPins:i,pinnedPosts:n}=e,r=[...t],a=0;if(!i||0===i.length)return{posts:r,numPostsDisplaced:a};for(let e of i.sort((e,t)=>e.position-t.position)){let i=n[e.post_id];if(!i)continue;let l=r.findIndex(e=>e.id===i.id);-1===l?(r.splice(e.position,0,i),r=r.slice(0,t.length),a+=1):(r.splice(l,1),r.splice(e.position,0,i))}return{posts:r,numPostsDisplaced:a}}},85520:function(e,t,i){i.d(t,{B9:()=>n});let n="choose_handle"},70515:function(e,t,i){i.d(t,{$h:()=>l,Pp:()=>c,Qz:()=>o,WD:()=>function e(t,i){if(Symbol.iterator in Object(t)){for(let n of t)if(!1===i(n)||!1===e(n.children||[],i))return!1}},fP:()=>d,rX:()=>s});var n=i(9740),r=i(50129),a=i(75237);let l=9999,o=function(){let{likesEnabled:e=!0,language:t="en"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{iString:i}=I18N.i(t),n=[];return e&&n.push({key:"best_first",text:i("Top first"),description:i("Top comments first")}),n.push({key:"most_recent_first",text:i("Newest first"),description:i("Newest comments first")}),n.push({key:"oldest_first",text:i("Oldest first"),description:i("Oldest comments first")}),n},s=(e,t)=>{var i;return null==(i=o({language:t}).find(t=>t.key===e))?void 0:i.text},c=e=>!e.deleted&&!!e.status&&r.Qg.has(e.status);function d(e,t){let{attachments:i}=e;if(i&&i.length>0){for(let e of i)if("post"===e.type){for(let i of e.post.publishedBylines)if(i.id===t)return!0;if((0,n.Ie)(e.publication,t))return!0}else if("comment"===e.type){if(e.comment.user_id===t)return!0}else if("publication"===e.type&&(0,n.Ie)(e.publication,t))return!0}return(function(e){let t=[];if(e.body_json)for(let l of(0,a.A)(e.body_json)){var i,n,r;"substack_mention"!==l.type||(null==(i=l.attrs)?void 0:i.mentionType)!=="user"&&(null==(n=l.attrs)?void 0:n.mentionType)||t.push(null==(r=l.attrs)?void 0:r.id)}return new Set(t)})(e).has(t)}}}]);