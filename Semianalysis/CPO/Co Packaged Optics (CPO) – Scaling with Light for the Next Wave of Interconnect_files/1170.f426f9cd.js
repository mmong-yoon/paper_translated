"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["1170"],{42383:function(e,t,i){i.d(t,{A:()=>n});let n={customThemeHeader:"customThemeHeader-hnC_lZ",headerImageContainer:"headerImageContainer-RUy6uK",portraitImage:"portraitImage-IxD7Ka",fullWidthImageHeader:"fullWidthImageHeader-t5EqiB",fullWidthHeaderContent:"fullWidthHeaderContent-HjaASe",fullWidthHeaderSubtitle:"fullWidthHeaderSubtitle-VOunOK",titleAndImageContainer:"titleAndImageContainer-Eb9L9t",titleAndImageHeader:"titleAndImageHeader-IHm_Y5",noImage:"noImage-uj9DyC",image:"image-_uMo6d",thickRule:"thickRule-aN1kyk","portrait-image-container":"portrait-image-container-zwwsEI",portraitImageContainer:"portrait-image-container-zwwsEI","landscape-image-container":"landscape-image-container-QgDAqQ",landscapeImageContainer:"landscape-image-container-QgDAqQ",bylineWrapper:"bylineWrapper-AHoCt5",bylineContainer:"bylineContainer-TXwfpr",copy:"copy-WXqCFN",eagleStampContainer:"eagleStampContainer-UIFpMk",eagleStampImage:"eagleStampImage-EG5gS3",america250Logo:"america250Logo-Mg4J2n"}},44567:function(e,t,i){i.d(t,{A:()=>n});let n=/^(1889|6578)$/.test(i.j)?{hasModal:"hasModal-bDnxNx",modalViewer:"modalViewer-xO_gxg",active:"active-uB0ZZs",logo:"logo-DQBU5j",back:"back-nF7MN5"}:null},37343:function(e,t,i){i.d(t,{HY:()=>_,oD:()=>b});var n=i(10201),o=i(17402);if(/^(1889|6578)$/.test(i.j))var r=i(85902);var a=i(73164),s=i(84605),l=i(86500);i(58418);var c=i(68349);i(24078),i(35369),i(76977),i(63136);var d=i(24216),u=i(39318);if(/^(1889|6578)$/.test(i.j))var p=i(41086);if(i(49807),/^(1889|6578)$/.test(i.j))var h=i(98949);if(/^(1889|6578)$/.test(i.j))var m=i(57324);let f=/^(1889|6578)$/.test(i.j)?(0,o.createContext)({hidden:!1}):null;function _(e){let{children:t}=e,[i,r]=(0,o.useState)(!1);return(0,n.Y)(f.Provider,{value:{hidden:i,setHidden:r},children:t})}function b(e){let{post:t,subdomain:i,readerInstalled:a,isContributor:d}=e,_=(0,h.aR)()?"ios":(0,h.m0)()?"android":null,{iString:b}=(0,s.GO)(),{hidden:Y}=(0,o.useContext)(f),S=Y||!_;if((0,o.useEffect)(()=>{S||!a||d||t.is_draft||(0,p.y)("triedRedirect")||(0,c.ar)()||(0,c.V2)((0,u.XV8)(i,t.slug,{params:{utm_medium:m.Jn.web,utm_campaign:m._9.postsOpenInApp,utm_source:m.VU.postBanner}}))},[]),S)return null;let C=b("Read in the Substack app");"podcast"==t.type?C=b("Listen in the Substack app"):"video"==t.type&&(C=b("Watch in the Substack app"));let A=(0,u.XV8)(i,t.slug,{redirect:"app-store",source:m.VU.postBanner});return(0,h.ux)()?(0,n.FD)(n.FK,{children:[(0,n.Y)(r.mg,{children:(0,n.Y)("meta",{name:"apple-itunes-app",content:"app-id=1581650857, app-argument=".concat(A)})}),(0,n.Y)(g,{surface:"post",bannerType:"safari-native-app-banner"})]}):(0,n.FD)(v,{className:"app-banner-post",children:[(0,n.Y)(g,{surface:"post"}),(0,n.Y)(w,{}),(0,n.Y)(y,{children:(0,n.Y)("div",{children:C})}),(0,n.Y)("a",{className:"app-banner-cta",href:A,onClick:()=>{(0,l.u4)(l.qY.APP_BANNER_TAPPED,{surface:"post",type:"header"})},children:b("Open app")})]})}function g(e){let{surface:t,bannerType:i}=e;return(0,o.useEffect)(()=>{(0,l.u4)(l.qY.APP_BANNER_VIEWED,{surface:t,bannerType:i})},[]),null}let v=(0,d.a)("app-banner"),y=(0,d.a)("app-banner-text");function w(){return(0,n.Y)("div",{className:"app-banner-icon",children:(0,n.Y)(a.A,{height:16})})}},20674:function(e,t,i){i.d(t,{D:()=>C});var n=i(69277),o=i(70408),r=i(10201),a=i(32485),s=i.n(a),l=i(17402),c=i(34615),d=i(38305),u=i(27437),p=i(84605),h=i(85478),m=i(24078),f=i(22057),_=i(76977),b=i(63136),g=i(16291),v=i(56262),y=i(39318),w=i(49807),Y=i(82776),S=i(96063);function C(e){let{variant:t,post:i,pub:a,relativeLinks:C=!1,hideMeta:A=!1,hideFaces:I=!1,showAudience:k=!1,renderBylines:P,className:D,avatarSize:N=36}=e,{getConfigFor:x}=(0,h.mJ)(),E=!!x("enable_author_pages"),{publishedBylines:T=[]}=i,R=T.map(e=>{if(!E)return e;let t=a.contributors.find(t=>t.user_id===e.id);return t?(0,o._)((0,n._)({},e),{name:t.name||e.name,bio:t.bio||e.bio,photo_url:t.photo_url||e.photo_url}):e}),F=a.bylines_enabled&&(0,Y.getPrintedByline)(a,i),[O,U]=(0,l.useState)(!1),L=!I&&F&&a.byline_images_enabled&&R.some(e=>{let{photo_url:t}=e;return!!t});k||(k="page"!==i.type);let{iContext:M,language:B,iString:V}=(0,p.GO)(),j=e=>{let t=E?(0,y.cxh)({userId:e.id,pub:a}):null;return E&&!t?{href:void 0}:t?{href:t}:{href:(0,w.gYq)(e)}};return(0,r.FD)(_.pT,{className:s()("byline-wrapper",{[S.A["byline-wrapper--swap-on-mobile"]]:"shows"===t},D),gap:12,alignItems:"center",children:[L&&(0,r.Y)(_.pT,{className:s()({[S.A["byline-faces--swap-on-mobile"]]:"shows"===t}),children:(0,r.Y)(f.Z,{users:R,max:4,size:N,renderAvatar:e=>(0,r.Y)(m.tp,(0,o._)((0,n._)({},e),{noBase:C}))})}),(0,r.FD)(_.I1,{children:[F&&(P?P({publishedBylines:R,getLinkProps:j}):(0,r.FD)(b.EY.Meta,{color:"pub-primary-text",children:[(0,r.Y)(d.K,{array:R,limit:4,formatter:e=>(0,r.Y)(u.ProfileHoverCard,{disabled:E,subject:e,utmSource:"byline",trigger:(0,r.Y)(b.EY,(0,o._)((0,n._)({as:"a"},j(e)),{decoration:"hover-underline",children:e.name}))}),othersFormatter:e=>(0,r.Y)("span",{style:{cursor:"pointer"},onClick:()=>U(!0),children:e})}),(0,r.Y)(c.K,{isOpen:O,modalLabel:V("Authors"),faces:R,totalCount:R.length,onClose:()=>U(!1),utmSource:"post-bylines-modal"})]})),!A&&(0,r.FD)(_.pT,{gap:4,children:[(0,r.Y)(b.EY.Meta,{color:"pub-secondary-text",children:(0,g.A)(i.post_date).locale(B).format("MMM DD, YYYY")}),k&&(0,v.isPaidAudience)(i.audience)&&(0,r.FD)(b.EY.Meta,{color:"pub-secondary-text",children:["∙ ",M("postAudience","Paid")]})]})]})]})}},52077:function(e,t,i){i.d(t,{Ay:()=>V,Ui:()=>q,vo:()=>z});var n=i(69277),o=i(70408),r=i(10201),a=i(32485),s=i.n(a),l=i(78659),c=i.n(l),d=i(90128),u=i.n(d),p=i(63375),h=i.n(p),m=i(16858),f=i(31050),_=i(56808),b=i(750),g=i(17402),v=i(15734),y=i.n(v),w=i(69715),Y=i(23623),S=i(58925),C=i(54014),A=i(84605),I=i(95064),k=i(39598),P=i(26289),D=i(86500),N=i(90250),x=i(89490),E=i(76977),T=i(22602),R=i(63136),F=i(59294),O=i(50874),U=i(82776),L=i(92967),M=i(7642),B=i(91086);function V(e){var t,i;let{disableSelection:a,player:s,postId:l,renderTranscriptionChunk:d,transcription:u,onUpdateActiveRowIndex:p}=e,{iString:m}=(0,A.GO)(),{onStartClipping:f}=(0,w.MC)(),_=(0,g.useRef)(null),{selection:b,clearSelection:v,selectEndRef:Y,selectStartRef:S}=(0,F.MB)({containerRef:_,disable:null!=a&&a,playerRef:s}),[x,T]=(0,g.useState)(!0),[U,L]=(0,g.useState)(),[M,V]=(0,g.useState)(["nick","mills"]),[q,z]=(0,g.useState)({}),[H,K]=(0,g.useState)(!1),[G,J]=(0,g.useState)(!1),[Q,X]=(0,g.useState)(),{currentTime:Z,isPlaying:ee}=(0,P.yr)(s),et=q?Object.values(q).filter(e=>e):[],ei=!!((null==M?void 0:M.length)&&et.length),{setItems:en}=(0,I.IS)(),eo=null==U?void 0:U.findIndex(e=>e.start<=Z&&e.end>Z);if((0,g.useEffect)(()=>{p&&void 0!==eo&&-1!==eo&&p(eo)},[eo,p]),(0,g.useEffect)(()=>{T(!0),u.cdn_url&&y().get(u.cdn_url).then(e=>{if(!e.text)return;let t=JSON.parse(e.text),i=(0,O.qD)({rows:t});L(i),en(i);let n=h()(i.map(e=>{var t;return null!=(t=e.speaker)?t:""})).filter(e=>e).sort();n.length&&V(n)}).finally(()=>{T(!1)}),u.speaker_map&&Object.values(u.speaker_map).length&&z(u.speaker_map)},[null==U?void 0:U.length,en,u.cdn_url,u.cdn_unaligned_url,u.speaker_map]),x)return(0,r.Y)(W,{});if(!(null==U?void 0:U.length))return(0,r.Y)("div",{className:B.A.transcriptionStatus,children:(0,r.Y)(R.EY.Meta,{children:m((null==u?void 0:u.status)==="in_progress"?"Transcription in progress...":"No transcript...")})});let er=(null==s||null==(i=s.current)||null==(t=i.player)?void 0:t.tagName)==="VIDEO",ea=er?"videogram":"audiogram";return(0,r.FD)(E.I1,{ref:_,children:[b&&(0,r.Y)(j,{isVideo:er,selection:b,onSelect:er?()=>{if(!b||!U||!S.current||!Y.current)return;let e=S.current,t=Y.current;(e.rowIndex>t.rowIndex||e.rowIndex===t.rowIndex&&e.offset>t.offset)&&([e,t]=[t,e]);let i=(0,N.At)({startRow:U[e.rowIndex],endRow:U[t.rowIndex],startOffset:e.offset,endOffset:t.offset,startNodeText:e.text,endNodeText:t.text});v(),f((0,o._)((0,n._)({},i),{source:"transcription",title:null}))}:function(){if(b&&Y.current&&S.current&&U){let e=(0,n._)({},S.current),t=(0,n._)({},Y.current),[i,o]=(0,N.fE)({selectStart:e,selectEnd:t,alignedRows:U});i>o&&([i,o]=[o,i]),K(!0),y().post("/api/v1/audiogram").send({post_id:l,start_idx:i,end_idx:o,use_draft:!1}).then(e=>{var t,i;(null==(t=e.body)?void 0:t.data)&&(X(e.body.data),v(),(null==s||null==(i=s.current)?void 0:i.player)&&s.current.player.pause())}).finally(()=>K(!1))}}}),d&&U.map((e,t)=>{var i;return d({isPlaying:ee,row:e,rowIndex:t,words:e.words,showSpeaker:(0===t||null==(i=U[t-1])?void 0:i.speaker)!==e.speaker,speakerName:ei&&e.speaker?q[e.speaker]:void 0,onPause:()=>{var e;(null==s||null==(e=s.current)?void 0:e.player)&&s.current.player.pause()},onPlay:()=>{var t;(null==s||null==(t=s.current)?void 0:t.player)&&(s.current.player.currentTime=e.start+1e-4,s.current.player.play())}})}),!d&&U.map((e,t)=>(0,r.Y)($,{idx:t,row:e,rows:U,speakerName:ei&&e.speaker?q[e.speaker]:void 0,onReassign:()=>J(!0),currentTime:Z,isPlaying:ee,isSelected:!!(b&&Y.current&&S.current&&t===c()(t,Math.min(S.current.rowIndex,Y.current.rowIndex),Math.max(S.current.rowIndex,Y.current.rowIndex))),onClick:()=>{v()},onPause:()=>{var e;(null==s||null==(e=s.current)?void 0:e.player)&&s.current.player.pause()},onPlay:()=>{var t;(null==s||null==(t=s.current)?void 0:t.player)&&(s.current.player.currentTime=e.start+1e-4,s.current.player.play())}},t)),(0,r.Y)(k.B,{isOpen:!!(H||Q),onClose:()=>X(void 0),isGenerating:H,finishedGram:Q,noun:ea,postId:l,onDownload:function(e){return(0,D.u4)(D.qY.AUDIOGRAM_DOWNLOAD_CLICKED,{post_id:l,audiogram_id:null==Q?void 0:Q.id,media_upload_id:u.media_upload_id}),fetch(e,{method:"GET"}).then(e=>e.blob()).then(e=>{var t;let i=null==Q||null==(t=Q.video_url)?void 0:t.split("/").pop(),n=null==i?void 0:i.match(/^([^-]+-[^_]+)_/),o=(null==n?void 0:n[1])||"",r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download="substack-".concat(ea,"-").concat(l,"-").concat(o,".mp4"),document.body.appendChild(a),a.click(),URL.revokeObjectURL(r),a.remove()})}}),(0,r.Y)(C.j,{isOpen:M&&!!M.length&&!!G,onClose:()=>J(!1),speakers:M,speakerMap:q,onChangeSpeakerMap:z,postId:l})]})}function j(e){var t,i;let{isVideo:n,selection:o,onSelect:a}=e,{iString:l}=(0,A.GO)(),c=null==(i=o.anchorNode)||null==(t=i.parentElement)?void 0:t.getBoundingClientRect();return c?(0,r.Y)(Y.a,{children:(0,r.Y)(E.I1,{style:{top:(0,U.isTouchDevice)()?Math.max(c.y,0)+c.height+12:Math.max(c.bottom,0)+12,left:c.x+c.width/2,transform:"translateX(-50%)",pointerEvents:"auto",maxWidth:240},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:s()(M.A.popover,M.A.mounted),padding:4,gap:4,children:n?(0,r.FD)(S.ut,{onClick:a,children:[(0,r.Y)(m.A,{stroke:"var(--color-utility-white)",size:20}),(0,r.Y)(R.EY.B4,{color:"white",weight:"medium",children:l("Create clip")})]}):(0,r.FD)(S.ut,{onClick:a,children:[(0,r.Y)(f.A,{stroke:"var(--color-utility-white)",size:20}),(0,r.Y)(R.EY.B4,{color:"white",weight:"medium",children:l("Make audiogram")})]})})}):null}function W(){return(0,r.FD)(E.VP,{gap:12,children:[(0,r.Y)(T.O,{width:"80%",height:24}),(0,r.Y)(T.O,{width:"34%",height:24}),(0,r.Y)(T.O,{width:"75%",height:24}),(0,r.Y)(T.O,{width:"100%",height:24}),(0,r.Y)(T.O,{width:"68%",height:24})]})}function q(e){if(!e)return"Unknown Speaker";let t=e.split("_"),i=parseInt(t[1]);return"".concat(u()(t[0])," ").concat(i+1)}function $(e){let{row:t,currentTime:i,onPlay:a,isPlaying:l,onPause:c,isSelected:d,onClick:u,idx:p,rows:h,onReassign:m,speakerName:f}=e,[v,y]=(0,g.useState)(!1),w=(0,g.useRef)(null),Y=t.start<=i&&t.end>=i,S=t.words.map(e=>e.start<=i&&e.end>=i?(0,r.FD)(r.FK,{children:[(0,r.Y)("span",{className:B.A.activeWord,children:e.word})," "]}):"".concat(e.word," "));S.length||(S=t.text.split(" ").map(e=>(0,r.FD)("span",{children:[e," "]})));let C=null;if(t.speaker&&f){var A;let e=0===p||null==(A=h[p-1])?void 0:A.speaker;t.speaker!==e&&(C=(0,r.Y)("div",{className:B.A.speakerText,onClick:m,children:f}))}return(0,r.FD)("div",{ref:w,onClick:u,onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),style:{display:"flex",width:"100%",alignItems:"center"},children:[l&&(!v||Y)?(0,r.Y)(b.A,{onClick:c,size:24,className:B.A.playCircle,style:(0,o._)((0,n._)({},v&&{color:"var(--color-accent-themed)"}),{visibility:Y||v?"visible":"hidden"})}):(0,r.Y)(_.A,{onClick:a,size:24,className:B.A.playCircle,style:(0,o._)((0,n._)({},v&&{color:"var(--color-accent-themed)"}),{visibility:Y||v?"visible":"hidden"})}),(0,r.FD)("div",{className:s()(B.A.transcriptionChunk,{[B.A.activeRow]:Y||d,[B.A.hoverChunk]:v}),"data-chunk-index":p,children:[(0,r.Y)("div",{className:s()(B.A.rowIndicator,{[B.A.hoverRow]:v})}),(0,r.FD)("div",{style:{display:"flex",flexDirection:"column",flex:1,padding:"5px 0"},children:[C,(0,r.Y)("div",{className:B.A.rowText,"data-chunk-index":p,children:S})]})]})]})}let z=e=>{let{isActiveRow:t,isPlaying:i,row:n,rowIndex:o,onPause:a,onPlay:l,postId:c,children:d,className:u,activeClassName:p,editable:h}=e,m=t&&i;return(0,r.Y)(x.az,{id:"transcription-".concat(o),paddingRight:16,className:s()(u,{[null!=p?p:""]:m}),onClick:()=>{var e;null!=(e=window.getSelection())&&e.toString()||h||((0,D.u4)(D.qY.TRANSCRIPTION_TIMESTAMP_CLICKED,{post_id:c,timestamp:(0,L.kq)(n.start)}),m?a():l())},children:d})}},6212:function(e,t,i){i.d(t,{$f:()=>eK,$y:()=>e7,DZ:()=>e1,HA:()=>eG,I0:()=>e2,L4:()=>eX,Mq:()=>e3,RR:()=>e0,dm:()=>e5,sT:()=>eJ});var n=i(99851),o=i(69277),r=i(70408),a=i(79785),s=i(10201),l=i(32485),c=i.n(l),d=i(84934),u=i(17402),p=i(15734),h=i.n(p),m=i(43262),f=i(3526),_=i(70997),b=i(76609),g=i(76219),v=i(95337),y=i(71328),w=i(52117),Y=i(70345),S=i(27437),C=i(34746),A=i(13918),I=i(65754),k=i(90177),P=i(41935),D=i(20674),N=i(47789),x=i(75890),E=i(3338),T=i(15113),R=i(76185),F=i(58398),O=i(81209),U=i(65207),L=i(64591),M=i(69656),B=i(77921),V=i(1842),j=i(90847),W=i(49984),q=i(81668),$=i(56778),z=i(52820),H=i(84565),K=i(84605),G=i(13505),J=i(53989),Q=i(86500),X=i(53928),Z=i(66565),ee=i(94729),et=i(64595),ei=i(13022),en=i(1459),eo=i(68349),er=i(43998),ea=i(24078),es=i(89490),el=i(35369),ec=i(16074),ed=i(76977),eu=i(20500),ep=i(63136),eh=i(36372),em=i(56007),ef=i(36375),e_=i(61554),eb=i(49095),eg=i(73030),ev=i(98111),ey=i(56458),ew=i(4016),eY=i(96301),eS=i(83873),eC=i(39318),eA=i(41086),eI=i(49807),ek=i(98949),eP=i(82776),eD=i(57324),eN=i(96063);function ex(){let e=(0,a._)(["The full video is for subscribers in the "," plan"]);return ex=function(){return e},e}function eE(){let e=(0,a._)(["The full video is for subscribers in the Founding Member plan"]);return eE=function(){return e},e}function eT(){let e=(0,a._)(["The full video is for paid subscribers"]);return eT=function(){return e},e}function eR(){let e=(0,a._)(["This email is for subscribers in the "," plan"]);return eR=function(){return e},e}function eF(){let e=(0,a._)(["This email is for subscribers in the Founding Member plan"]);return eF=function(){return e},e}function eO(){let e=(0,a._)(["This email is for paid subscribers"]);return eO=function(){return e},e}function eU(){let e=(0,a._)(["Continue reading this post for free, courtesy of ","."]);return eU=function(){return e},e}function eL(){let e=(0,a._)(["This post is for subscribers in the "," plan"]);return eL=function(){return e},e}function eM(){let e=(0,a._)(["This post is for subscribers in the Founding Member plan"]);return eM=function(){return e},e}function eB(){let e=(0,a._)(["This post is for paid subscribers"]);return eB=function(){return e},e}function eV(){let e=(0,a._)(["Subscribe to "," to continue reading"]);return eV=function(){return e},e}function ej(){let e=(0,a._)(["Visit the author’s Substack to subscribe and read more."]);return ej=function(){return e},e}function eW(){let e=(0,a._)(["Visit ",""]);return eW=function(){return e},e}function eq(){let e=(0,a._)(["Support ",""]);return eq=function(){return e},e}function e$(){let e=(0,a._)(["Subscribe to ",""]);return e$=function(){return e},e}function ez(){let e=(0,a._)(["By ",""]);return ez=function(){return e},e}function eH(){let e=(0,a._)(["Subscribe to ",""]);return eH=function(){return e},e}let eK="focus-comment-input",eG=(e,t)=>!!e&&!e.invite_only&&!!t&&t.has_publication&&!t.is_admin&&!t.is_contributor&&!t.is_public_admin&&(0,en.e)(t,e),eJ=(e,t,i,n)=>"enabled"===e.payments_state?!(null==t?void 0:t.is_subscribed):(null==t?void 0:t.is_free_subscribed)&&"disabled"===e.payments_state&&!e.invite_only?!n&&i&&!(null==t?void 0:t.is_pledged):!(null==t?void 0:t.is_free_subscribed);class eQ extends u.Component{async loadReactors(){let e=await h().get("/api/v1/post/".concat(this.props.post.id,"/facepile"));this.setState({reactors:e.body.reactors,restackers:e.body.restackers})}async componentDidMount(){var e,t,i;if(this.props.paywall&&!this.props.postPreview&&((0,Q.u4)(Q.qY.POST_PAYWALL_SHOWN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type,user:this.props.user,paywall_variant:this.getPaywallConfiguration(this.state.bypassPostUnlockSubscriptionCheck).variant}),(0,X.jN)(X.ti.TRACK_PAYWALL_SHOWN),this.state.exposeLoggedOutPostUnlockExperiment&&this.context.exposeExperiment("unsubscribed_post_unlock_logged_out"),(0,ew.lu)({pub:this.props.pub}))){let e=null==(i=window)||null==(t=i._analyticsConfig)?void 0:t.anonymousId;(0,Z.BU)("paywall_shown",(0,o._)({post_id:this.props.post.id},this.props.user?{user_id:this.props.user.id,user_email:this.props.user.email,membership_type:this.props.user.is_subscribed?"paid":this.props.user.is_free_subscribed?"free":"none"}:e?{anonymousId:e}:{}))}this._triggerShare=()=>this.triggerShare(),null==(e=this.containerRef.current)||e.addEventListener("share-post",this._triggerShare),this.props.post&&this.loadReactors(),.001>Math.random()&&(0,Q.kE)({post:this.props.post});let n=(0,eA.y)("subscribe_prompt");n&&("paid"===n?this.props.popToast(()=>(0,s.Y)(eh.y,{text:"Subscription purchased for ".concat(this.props.pub.name)})):this.props.popToast(()=>(0,s.Y)(eh.y,{text:"Subscribed to ".concat(this.props.pub.name)})));let r=null;0x9f7afc3===this.props.post.id&&alert("userAgent: ".concat(navigator.userAgent)),(0,ek.Fr)({checkFirst4:!0})&&(/Instagram/i.test(navigator.userAgent)?r="instagram":/(Messenger|FBAN|FBAV|FB_IAB)/i.test(navigator.userAgent)?r="facebook":/LinkedIn/i.test(navigator.userAgent)&&(r="linkedin")),r?this.setWebviewModalState(r):this.setPostPromptState()}componentWillUnmount(){if(this._triggerShare){var e;null==(e=this.containerRef.current)||e.removeEventListener("share-post",this._triggerShare)}this.props.stopInterval&&this.props.stopInterval()}getPaywallConfiguration(e){let{freeSignup:t,freeTrialCoupon:i,getSettingFor:n,post:o,pub:r,user:a}=this.props,s=!0===this.props.paywall&&r.paywall_free_trial_enabled&&i,l=!!(n("paywall_unlock_tokens")&&"only_paid"===o.audience&&o.teaser_post_eligible&&!(null==a?void 0:a.is_subscribed)&&((null==a?void 0:a.is_free_subscribed)||t||e)&&!(null==a?void 0:a.has_redeemed_post_unlock_token)&&!this.state.hasPostUnlockFailed);return{variant:s?"free_trial":l?"post_unlock":"regular",showPostUnlockPrompt:l}}async setWebviewModalState(e){this.setState({showWebViewModal:{action:"facebook"===e?"read":"follow",platform:e}})}async setPostPromptState(){let{post:e,disableSubscribePrompt:t,readerIsSearchCrawler:i,pub:n,user:o,referringUser:r,forceFollowPrompt:a}=this.props,s="newsletter"===e.type&&!0===this.props.getSettingFor("enable_post_page_conversion")&&!t&&!(0,eo.ar)()&&!i,l=this.props.skipFollowPrompt,c=!1;if(a)c=!0;else if(!eP.PUB_IDS_TO_NOT_SHOW_FOLLOW_PROMPT_ON.includes(n.id)&&!l&&s&&r&&r.name&&r.id!==(null==o?void 0:o.id)&&n.author_id!==r.id&&n.contributors.every(e=>e.user_id!==r.id)){let e=[];if(o)try{e=await (0,ee.x6)("/api/v1/feed/following")}catch(e){console.warn("Failed to fetch following state",e)}c=!e.includes(r.id)}let d=s&&!c&&!this.props.paywall&&!this.props.freeSignup&&!o;this.setState({shouldShowFollowPrompt:c,shouldShowSubscribePrompt:d})}triggerShare(){let{fromEmail:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({shareModalOpen:!0,shareModalMedium:e?"email":"web"})}onBottomReached(e){this.state.bottomReached||this.props.postPreview||(this.setState({bottomReached:!0}),(0,Q.sM)({post:this.props.post,hasPaywall:e,surface:"publication",trackerUuid:this.props.getCurrentUuid()}))}shouldShowUFI(){let{fromPostPage:e,user:t,pub:i,getSettingFor:n}=this.props,{canShowSubscribeFooterAfterPost:o}=this.state;return!!e&&!!o&&eJ(i,t,!!n("payment_pledges_enabled"),this.shouldShowRecommendCta)}shouldTrackPaywallPostSeen(){if("undefined"==typeof window)return!1;let e=document.createElement("div");e.innerHTML=this.props.post.body_html;let t=this.props.pub.post_preview_limit||eP.DEFAULT_PREVIEW_LIMIT,i="",n=!1;for(let o=e.childNodes.length-1;o>=0;o--){let r=e.childNodes[o];if(r&&(i+=r.textContent).length>t){n=!0;break}}return n}render(){var e,t,i,n,r,a,l,u,p;let{user:h,pub:_,post:v,freeSignup:S,freeSignupEmail:k,isServingFreePodcastUrl:D,isShowsPost:x,isTheFreePressTheme:O,reaction_token:W,invisible:z,paywall:H,onChange:K,hideTitle:G,noTitleLink:J,showComments:X,fromPostPage:Z,freeTrialCoupon:ee,showRestackModal:en,stripe_publishable_key:eo,crossPostInfo:er,iString:ea,iTemplate:es,themeVariables:ec,referringUser:eu,renderComments:ep,renderContent:em,startInterval:e_,forceFollowPrompt:eb}=this.props,{showTranscription:eg,truncated:ev,autoPlayVoiceOver:eY,reactors:eA,restackers:eP,shouldShowFollowPrompt:eD,shouldShowSubscribePrompt:eV,showWebViewModal:ej,bypassPostUnlockSubscriptionCheck:eW}=null!=(n=this.state)?n:{};if(v.is_geoblocked)return(0,s.Y)(e9,{});let eq=(0,ew.lu)({pub:_}),e$=!!this.context.getConfigFor("like_posts_enabled"),ez=(0,w.Rv)(null!=(r=ev||v.body_html)?r:"",eq?"h1, h2, h3":"h1, h2, h3, h4"),eH=!H||H&&this.shouldTrackPaywallPostSeen();e_&&eH&&e_({postId:this.props.post.id,containerElementRef:this.containerRef,elementIsStatic:!0});let eK="video"===v.type&&!H&&(null==(e=v.videoUpload)?void 0:e.transcription),eG=this.shouldShowUFI()&&!(0,ew.lu)({pub:_}),eJ=e3(v),eQ=!!eA&&eA.length>0,{showPostUnlockPrompt:eX}=this.getPaywallConfiguration(eW),e1=(0,ek.Fr)({checkFirst4:!0}),e8="";e8="video"===v.type?"founding"===v.audience&&(0,ey.m4)(_)?es(ex(),null!=(a=(0,ey.m4)(_))?a:""):es("founding"===v.audience?eE():eT()):"adhoc_email"===v.type?"founding"===v.audience&&(0,ey.m4)(_)?es(eR(),null!=(l=(0,ey.m4)(_))?l:""):es("founding"===v.audience?eF():eO()):eX?e1?ea("Continue reading this post for free in the Substack app"):es(eU(),_.author_name||_.name):"founding"===v.audience&&(0,ey.m4)(_)?es(eL(),null!=(u=(0,ey.m4)(_))?u:""):es("founding"===v.audience?eM():eB());let e7=(0,s.FD)(j.Z,{disabled:!O,post:v,isShowsPost:x,children:[(0,s.Y)(N.I,{post:v,user:h,onChange:K,reaction_token:W,children:e=>(0,s.FD)(s.FK,{children:[(0,s.Y)("div",{className:"available-content",children:eg?(0,s.Y)("div",{className:"container",children:(0,s.Y)(ef.A,{post:v,pub:_,user:h,playerRef:this.videoPlayer})}):(0,s.Y)(T.A,{html:ev||v.body_html||null,pub:_,trackSelection:!0,post:v,themeVariables:ec,user:h,freeSignup:S,freeSignupEmail:k,paywall:H,showing_behind_paywall:!!v.post_paywall_content_for_google,onLike:e})}),v.post_paywall_content_for_google&&(0,s.Y)("div",{className:"paywall-content",children:(0,s.Y)(T.A,{html:v.post_paywall_content_for_google,pub:_,trackSelection:!1,post:v,user:h,freeSignup:S,freeSignupEmail:k,paywall:H,onLike:e})})]})}),!z&&eH&&(0,s.Y)($.A,{onVisible:()=>this.onBottomReached(!!H)})]}),e5=(0,ew.S2)({pub:_}),te=(0,et.h8)({post:v,pub:_}),tt=this.context.getConfigFor("thefp_show_fixed_footer_paywall"),ti=eq?(0,s.Y)(B.n,{post:v,user:h,pub:_,freeSignupEmail:k}):(0,s.Y)(C.pU,(0,o._)({user:h,freeSignupEmail:k,freeSignup:S,publication:_,post:v,coupon:!0===this.props.paywall&&this.props.pub.paywall_free_trial_enabled?ee:null,showPostUnlockPrompt:eX,magicToken:W,isUnsubscribedPostUnlockUpsell:eW,onOpenPostUnlockModal:eW?()=>this.setState({showPostUnlockModal:!0}):void 0,hasCompletedUnsubscribedUnlock:!!this.state.hasCompletedUnsubscribedUnlock,onPostUnlockError:()=>this.props.popToast(()=>(0,s.Y)(eh.y,{text:ea("Teaser posts are not currently available for this content")}))},Object.assign({title:e8,reauthenticationTitle:ea("To read this, please re-authenticate.")},H)));return(0,s.FD)("article",{className:c()("typography ".concat(v.type,"-post post"),{"shows-post":x,"full-width-image-header":(null==(t=v.postTheme)?void 0:t.header_variant)==="full-width-image",[null!=(p=eN.A.bottomWithTos)?p:"undefined"]:_.has_custom_tos}),ref:this.containerRef,children:[(null==h?void 0:h.is_contributor)&&(null==v?void 0:v.id)&&(null==v?void 0:v.type)==="page"&&(0,s.Y)(el.$n,{priority:"secondary",href:(0,eI.I_S)(_,v.id,{params:{back:document.location.href}}),localNavigation:!1,leading:(0,s.Y)(d.A,{size:20}),children:ea("Edit")}),(0,s.Y)(e6,{post:v,user:h,onChange:K}),(0,s.Y)(F.Z,{isOpen:!!this.state.shareModalOpen,onClose:()=>this.setState({shareModalOpen:!1,shareModalMedium:void 0}),user:h,pub:_,post:v,reaction_token:W,medium:this.state.shareModalMedium||"web"}),this.state.showPostUnlockModal&&(0,s.Y)(E.V,{post:v,pub:_,user:h,freeSignupEmail:k,magicToken:W,onClose:()=>this.setState({showPostUnlockModal:!1}),onSubscriptionComplete:()=>{if(this.setState({hasCompletedUnsubscribedUnlock:!0}),"undefined"!=typeof window&&window.history.replaceState){let e=(0,eC.oRR)({has_completed_unsubscribed_unlock:"true"});window.history.replaceState({},document.title,e)}},onUnlockFailed:()=>{this.setState({hasPostUnlockFailed:!0})},hasCompletedUnlock:!!this.state.hasCompletedUnsubscribedUnlock}),eD&&(0,s.Y)(Y.y$,{pub:_,post:v,referringUser:eu,freeSignupEmail:k,forceFollowPrompt:eb,surface:"post-follow-referrer-prompt"}),eV&&(0,s.Y)(U.F,{pub:_,post:v,stripe_publishable_key:eo,sharer:eu}),ej&&(0,s.Y)(f.D,{pub:_,slug:v.slug,action:ej.action,platform:ej.platform}),em?(0,s.FD)(s.FK,{children:[!z&&(0,s.Y)($.A,{onVisible:()=>{this.onTopReached(!!H)}}),em({comments:ep?ep():null,crossPostInfo:er,postContent:(0,s.FD)(s.FK,{children:[e7,!!(H&&!v.post_paywall_content_for_google&&!D)&&ti]})})]}):(0,s.FD)(s.FK,{children:[(0,s.Y)(e2,{user:null!=h?h:null,pub:_,post:v,isOnPostPage:!0,reaction_token:W,allowEdit:!0,showShare:!0,showSubtitle:!0,showPhoto:!0,showCommentRestack:!_.hide_post_restacks,hideTitle:!!G,noTitleLink:!!J,onChange:K,hideDate:"page"===v.type,hideAudience:"page"===v.type,showReactions:e$,showComments:!!X,showLabel:!0,fromPostPage:!!Z,onClickCommentButton:this.onCommentButtonClicked,reactors:eA,showRestackModal:!!en,showTranscriptionButton:!!eK,onTranscriptionClick:this.onTranscriptionClick,autoPlayVoiceOver:eY}),v.age_verification&&v.age_verification.status!==eS.Y.CompletedAdult&&(0,s.Y)(m.J,{content:v,description:v.subtitle,source:"post"}),!z&&eH&&(0,s.Y)($.A,{onVisible:()=>this.onTopReached(!!H)}),(v.has_voiceover||!!v.voiceoverUpload)&&!O&&(0,s.Y)(b.g,{pub:_,post:v,mediaUploadId:v.voiceover_upload_id,duration:null==(i=v.voiceoverUpload)?void 0:i.duration,autoPlay:eY,href:v.canonical_url,isPaywalled:!v.voiceover_upload_id}),!v.voiceoverUpload&&eY&&eJ&&(0,s.Y)(q.w,{postId:v.id,onClose:()=>{(0,Q.u4)(Q.qY.LISTEN_TO_THIS_POST_MODAL_DISMISSED,{post_id:v.id}),this.setState({autoPlayVoiceOver:!1})}}),er?(0,s.Y)(y.k,{postType:v.type,crossPostInfo:er}):null,(0,s.FD)("div",{children:[ez&&eq&&(0,s.Y)(V._,{postId:null==v?void 0:v.id,toc:ez,leftMargin:24,title:v.title,commentCount:v.comment_count,showComments:!0,wordCount:v.wordcount}),ez&&!eq&&(0,s.Y)(L.M,{toc:ez,position:"fixed"}),e7,te&&(0,s.Y)(g.u,{doiUrl:te.doiUrl,pdfUrl:te.pdfUrl}),H&&!v.post_paywall_content_for_google?(0,s.FD)(s.FK,{children:[ti,(0,s.Y)(I.e,{post:v})]}):ev?(0,s.Y)("p",{children:(0,s.FD)(el.$n,{className:"expander",onClick:()=>this.setState({truncated:null}),children:["+ ",ea("show full post")]})}):!["page"].includes(null==v?void 0:v.type)&&(0,s.FD)(s.FK,{children:[eG&&(0,s.Y)(e0,{pub:_,post:v,user:h,freeSignup:!!S,freeSignupEmail:k}),!eG&&this.shouldShowRecommendCta&&(0,s.Y)(R.R,{pub:_}),er&&("only_paid"===v.audience||"founding"===v.audience)&&(0,s.Y)(eZ,{pub:_}),(0,ei.Ay)("like_posts_enabled")&&_.community_enabled&&eQ&&!O&&(0,s.Y)(ed.fI,{borderTop:"detail-themed",paddingY:16,children:(0,s.Y)(A.d2,{post:v,pub:_,user:h,reactors:eA,secondaryFaces:eP})}),!O&&(0,s.Y)(s.FK,{children:(0,s.Y)("div",{className:"post-footer",children:(0,s.Y)(P.bW,{post:v,pub:_,user:h,onChange:K,postReactionToken:W,position:"post-footer"})})}),(0,s.Y)(I.e,{post:v})]}),v.show_guest_bios&&"podcast"!==v.type&&!eq&&!e5&&(0,s.Y)(e4,{user:h,post:v})]})]}),eq&&H&&!(null==h?void 0:h.is_subscribed)&&tt&&"everyone"!==v.audience&&(0,s.Y)(M.Q,{pub:_})]})}constructor(e,t){var i,o,r,a,s,l,c,d,p,h;super(e,t),(0,n._)(this,"containerRef",void 0),(0,n._)(this,"podcastCommentInput",void 0),(0,n._)(this,"podcastPlayer",void 0),(0,n._)(this,"videoPlayer",void 0),(0,n._)(this,"shouldShowRecommendCta",void 0),(0,n._)(this,"_triggerShare",void 0),(0,n._)(this,"onTopReached",e=>{this.state.topReached||this.props.postPreview||(this.setState({topReached:!0}),(0,Q.Jw)({post:this.props.post,hasPaywall:e,surface:"publication",markRead:!!this.props.user&&!this.props.noPageView,user:this.props.user,trackerUuid:this.props.getCurrentUuid()}))}),(0,n._)(this,"onTranscriptionClick",()=>{this.setState(e=>({showTranscription:!e.showTranscription}))}),(0,n._)(this,"onCommentButtonClicked",e=>{this.props.showComments&&!this.props.post.comment_count&&(e.stopPropagation(),e.preventDefault(),document.dispatchEvent(new CustomEvent(eK)))});const m="true"===(0,eA.y)("has_completed_unsubscribed_unlock")&&(null==(i=this.props.user)?void 0:i.is_free_subscribed);(0,ew.lu)({pub:this.props.pub})&&["cbs_news","paramount"].includes((0,eA.y)("utm_source")||"")&&(null==(p=sessionStorage)||p.setItem("is_from_cbs_news","true"));const f=this.props.user&&!(null==(o=this.props.user)?void 0:o.is_subscribed)&&!(null==(r=this.props.user)?void 0:r.is_free_subscribed)&&!(null==(a=this.props.user)?void 0:a.reader_installed_at)&&!(null==(s=this.props.user)?void 0:s.has_redeemed_post_unlock_token),_=!this.props.user&&!0===this.props.paywall&&"only_paid"===this.props.post.audience&&this.props.post.teaser_post_eligible,b=_?this.context.getExperimentVariant("unsubscribed_post_unlock_logged_out"):null,g={bypassPostUnlockSubscriptionCheck:!!(this.props.user&&!(null==(l=this.props.user)?void 0:l.reader_installed_at)&&!(null==(c=this.props.user)?void 0:c.is_subscribed)&&("true"===(0,eA.y)("bypass_subscription_check")||f||m)||"treatment"===b),showTranscription:!1,autoPlay:!1,autoPlayVoiceOver:!1,commentSort:null!=(h=e.post.default_comment_sort)?h:"best_first",loadedWithHeaderLink:"undefined"!=typeof window&&(null==(d=window.location.hash)?void 0:d.startsWith("#".concat(encodeURIComponent("\xa7")))),reactors:null,feedUrl:null,shouldShowSubscribePrompt:!1,shouldShowFollowPrompt:!1,exposeLoggedOutPostUnlockExperiment:!!_,hasCompletedUnsubscribedUnlock:m};e.paywall||e.post.hidden||!e.post.body_html||(g.canShowSubscribeFooterAfterPost=e7(e.post.body_html),g.truncated=e.truncateAt?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if("undefined"==typeof window)return null;let n=document.createElement("div");if(n.innerHTML=e,null===n.textContent||n.textContent.length<t||n.childNodes.length<=1)return null;do n.removeChild(n.lastChild);while(n.childNodes.length>1&&n.textContent.length>i);return n.innerHTML}(e.post.body_html,e.truncateAt,e.truncateTo):null),"undefined"!=typeof window&&window.history.replaceState&&("true"===(0,eA.y)("autoPlay")&&(window.history.replaceState({},document.title,(0,eC.oRR)({autoPlay:null})),g.autoPlay=!0),"true"===(0,eA.y)("play_audio")&&(window.history.replaceState({},document.title,(0,eC.oRR)({play_audio:null})),g.autoPlayVoiceOver=!0)),this.state=g,this.containerRef=(0,u.createRef)(),this.podcastCommentInput=(0,u.createRef)(),this.podcastPlayer=(0,u.createRef)(),this.videoPlayer=(0,u.createRef)(),this.shouldShowRecommendCta=eG(e.pub,e.user)}}(0,n._)(eQ,"contextType",H.Ke),(0,n._)(eQ,"displayName","Post");let eX=(0,em.Ho)((0,z.WR)((0,J.S0)((0,K.wr)((0,G.BF)(eQ))))),eZ=e=>{let{pub:t}=e,{iTemplate:i}=(0,K.GO)();return(0,s.FD)(s.FK,{children:[(0,s.Y)(ec.c,{paddingTop:16}),(0,s.FD)(ed.VP,{gap:16,paddingY:32,alignItems:"center",children:[(0,s.FD)(ed.VP,{gap:8,paddingBottom:8,children:[(0,s.Y)(ep.EY.H4,{flex:"grow",align:"center",children:i(eV(),t.name)}),(0,s.Y)(ep.EY.B3,{flex:"grow",align:"center",color:"secondary",children:i(ej())})]}),(0,s.Y)(el.$n,{priority:"primary",onClick:()=>{(0,Q.u4)(Q.qY.POST_END_CTA_CLICKED,{type:"cross-post"}),(0,eo.V2)((0,eI.eV6)(t,{params:{utm_source:eD.VU.postEndCta,addBase:!0}}),{local_navigation:!1})},children:i(eW(),t.name)})]})]})},e0=e=>{let{pub:t,post:i,user:n,freeSignup:o,freeSignupEmail:r,overridePledgesEnabled:a}=e,{iString:l,iTemplate:c}=(0,K.GO)(),{getSettingFor:d}=(0,J.Pu)(),[p,h]=(0,u.useState)(null),m=(0,eA.y)("just_subscribed"),f="disabled"===t.payments_state&&!t.invite_only&&(d("payment_pledges_enabled")||a),_="enabled"===t.payments_state&&(null==n?void 0:n.is_free_subscribed)&&!(null==n?void 0:n.is_subscribed)?"paid_upsell":f&&(null==n?void 0:n.is_free_subscribed)&&!(null==n?void 0:n.is_pledged)?"pledge_upsell":"free_upsell",b=f&&(null==n?void 0:n.is_free_subscribed)&&!(null==n?void 0:n.is_pledged);(0,u.useEffect)(()=>{(0,Q.u4)(Q.qY.POST_END_CTA_RENDERED,{pub_id:t.id,post_id:i.id,type:_})},[t.id,i.id,_,b,null==n?void 0:n.is_free_subscribed]);let g=(0,eP.getByLine)(t);return(0,s.FD)(s.FK,{children:[(0,s.Y)(ec.c,{paddingTop:16}),(0,s.Y)($.A,{onVisible:()=>{(0,Q.u4)(Q.qY.POST_END_CTA_SEEN,{pub_id:t.id,post_id:i.id,type:_})}}),(0,s.FD)(ed.VP,{gap:16,paddingY:32,children:[(0,s.FD)(ed.VP,{gap:8,paddingBottom:8,children:[(0,s.Y)(ep.EY.H4,{flex:"grow",align:"center",children:f&&(null==n?void 0:n.is_free_subscribed)?c(eq(),t.name):c(e$(),t.name)}),(0,s.FD)(ep.EY.B3,{flex:"grow",align:"center",color:"secondary",children:[g?c(ez(),g):null,g&&t.rankingDetail?" \xb7 ":null,t.rankingDetail]}),t.hero_text&&(0,s.Y)(ep.EY.B3,{color:"primary",flex:"grow",align:"center",children:t.hero_text})]}),(0,s.Y)(ed.VP,{alignItems:"center",gap:16,children:b?(0,s.Y)(el.$n,{priority:"primary",onClick:()=>{(0,Q.u4)(Q.qY.POST_END_CTA_CLICKED,{type:"pledge"}),(0,eo.V2)((0,eI.eV6)(t,{params:{utm_source:eD.VU.postEndCta}}),{local_navigation:!1})},children:l("Pledge your support")}):(0,s.FD)(s.FK,{children:[(0,s.Y)(O.A,{pub:t,post:i,user:n,freeSignup:o,freeSignupEmail:r,isStatic:!1,onPrepareData:()=>{h(null)},source:"post-end-cta",className:eN.A.subscribeWidget}),p&&(0,s.Y)(eu.yn,{align:"center",children:p}),!(null==n?void 0:n.is_free_subscribed)&&!m&&(0,s.Y)(ed.VP,{maxWidth:400,children:(0,s.Y)(e_.U,{includeCheckbox:!1,addSubscribePreamble:!0,color:"secondary",textAlign:"center"})})]})})]})]})},e1=e=>{let{pub:t}=e;return(0,s.FD)("div",{className:"post-silhouette",children:[(0,s.Y)("div",{className:"post-silhouette-title"}),(0,s.Y)("div",{className:"post-silhouette-meta ".concat(t&&t.bylines_enabled&&t.byline_images_enabled?"with-byline-image":"")}),(0,s.Y)("div",{className:"post-silhouette-body"})]})},e2=e=>{var t,i,n,o;let r,{allowEdit:a,allowSendEmail:l,allowTruncate:d,base_url:u,children:p,className:h,hideAudience:m,hideDate:f,hideTitle:b,hidePinning:g,noTitleLink:y,isStatic:w,isFreePreview:Y,is_draft:S,onChange:C,post:I,pub:N,reaction_token:E,showComments:T,showDatetime:R,showEmailSent:F,showReactions:O,showShare:U,showAppUpsell:L,showSubtitle:M,showPhoto:B,showLabel:V,showRestack:j,showCommentRestack:q,hideAuthor:$,user:H,utm_source:G,fromPostPage:J,onClickCommentButton:Q,reactors:X,inThreadHead:Z,publishedPost:ee,compEndsSoon:et,compEndedRecently:ei,siteConfigValues:en={},eligibleForTTS:eo,showRestackModal:er,showIcon:ea,isOnPostPage:es,showTranscriptionButton:el,onTranscriptionClick:ec,isAppMode:eu=!1,republishingPost:eh,autoPlayVoiceOver:em=!1,readInAppText:ef}=e,{iString:e_}=(0,K.GO)(),{getExperimentVariant:eb,exposeExperiment:eg}=(0,z.Wk)(),ey=(0,ek.Fr)({checkFirst4:!0}),eS=eh||I,eC="number"==typeof d?d:45,eA=I.title&&I.title.length>eC,ex=S?I.draft_title:I.title,eE=[(ea||"thread"===I.type)&&(0,s.Y)(x.C,{postType:I.type,isStatic:w,height:15,className:I.type}),eA&&d?(0,eP.truncateWords)(ex,eC):ex],eT=S?I.draft_subtitle:I.subtitle;I.section_id&&N.sections&&N.sections.length&&(I.section=N.sections.find(e=>e.id===I.section_id));let eR=(0,eY.ZA)({pub:N,subscriptionType:null==H?void 0:H.subscription_type}),eF=!["page"].includes(null==I?void 0:I.type),eO=eF&&w&&et&&!eR&&(null==en?void 0:en.continue_support_cta_in_newsletter_emails),eU=e3(I)||eo||I.voiceoverUpload,eL=(null==I?void 0:I.type)==="adhoc_email",eM=eF&&w&&!eL&&!eu,eB=(0,ew.lu)({pub:N})&&(!!I.postTheme||["video","podcast"].includes(I.type)&&Z);r=I.post_url_override?I.post_url_override:w&&eu?ev.T.POST_TITLE_APP_MODE_URL:w?ev.T.POST_TITLE_URL:"".concat((0,eI.wu9)(N,I)).concat(G?"?utm_source=".concat(G):"");let eV="".concat(N.base_url+(eS.section?(0,eI.Dor)(N,{section:eS.section}):""),"/?utm_source=").concat(eD.VU.substack,"&utm_medium=").concat(eD.Jn.menu),ej=!!N.leaderboard_ranking&&(0,ek.Fr)(),eW=!1;return ej&&(eW="treatment"===eb("post_page_leaderboards_cta"),eg("post_page_leaderboards_cta")),eB?(0,s.Y)(W.Xl,{post:I,postTheme:I.postTheme,title:ex,subtitle:eT,pub:N,inThreadHead:!!Z,autoPlayVoiceOver:em}):(0,s.FD)("div",{className:c()("post-header",h),role:"region","aria-label":e_("Post header"),children:[(0,ew.S2)({pub:N})&&(null!=(o=null==(t=I.postTags)?void 0:t.length)?o:0)>0&&(0,s.Y)(ed.fI,{alignItems:"center",gap:4,paddingBottom:8,children:null==(i=I.postTags)?void 0:i.map((e,t)=>(0,s.FD)(s.FK,{children:[0!==t&&(0,s.Y)(ep.EY.Meta,{children:"—"}),(0,s.Y)(ep.EY.Meta,{as:"a",size:14,href:(0,eI.ii9)(N,e),children:e.name})]}))}),V&&I.section&&(0,s.Y)(ed.fI,{className:"post-label",children:(0,s.Y)(ep.EY.Meta,{as:"a",size:14,href:eV,children:null==(n=eS.section)?void 0:n.name})}),eO&&(0,s.Y)(v.K,{post:I,compAlreadyExpired:ei}),eW&&(0,s.Y)(e8,{pub:N,post:I}),!b&&(0,s.Y)("h1",{className:c()("post-title",I.is_published?"published":"restack"!==I.type||eh?"adhoc_email"===I.type?"adhoc":"unpublished":"email-only-cross-post",{"post-title--the-pillar":(0,ew.S2)({pub:N})},eN.A.title),dir:"auto",children:y?eE:(0,s.Y)("a",{href:r,children:eE})}),M&&eT&&(0,s.Y)("h3",{className:c()("subtitle",{"subtitle--the-pillar":(0,ew.S2)({pub:N})},eN.A.subtitle),dir:"auto",children:eT}),"page"===I.type?(0,s.Y)("div",{style:{height:32}}):es&&!w?(0,s.FD)(ed.VP,{paddingBottom:16,"aria-label":e_("Post UFI"),role:"region",children:[(0,s.Y)(ed.VP,{paddingY:16,children:(0,s.Y)(D.D,{post:I,pub:N})}),(0,s.Y)(_.p,{user:H,isMobile:ey,post:I}),ey?J&&(0,s.Y)(P.I2,{post:I,pub:N,user:H,isStatic:!!w,postReactionToken:E,onChange:C,allowEdit:a,hidePinning:g,showEmailSent:F,allowSendEmail:l,hideComments:!T,onCommentsClick:Q,showRestackModal:er}):(0,s.Y)(P.bW,{post:I,pub:N,user:H,onChange:C,showRestackModal:er,showTranscriptionButton:el,onTranscriptionClick:ec,showClipping:"video"===I.type,postReactionToken:E,position:"post-header"})]}):(0,s.FD)(s.FK,{children:[!eF||w||ee||Z?eF&&!w&&ee?(0,s.Y)(P.xx,{post:I,pub:N,user:H,style:"compressed",labelStyle:"counts-or-none",postReactionToken:E,showEmailSent:F,hideShare:!U||"restack"===I.type,hideComments:"restack"===I.type,hideSavePost:"restack"===I.type,hideReactions:"restack"===I.type,showPreamble:!0,onChange:void 0,allowEdit:a,allowSendEmail:l,editButtonIsLast:!0,preambleConfig:{showAudience:!m,showDate:!f,showDatetime:R,showAuthor:!$},isStatic:w,position:"publisher-post-list"}):Z&&!w?(0,s.Y)(P.xx,{post:I,pub:N,user:H,style:"compressed",labelStyle:"counts-or-none",postReactionToken:E,hideSavePost:!0,showPreamble:!0,allowEdit:a,allowSendEmail:l,editButtonIsLast:!0,onChange:C,preambleConfig:{showAudience:!m,showDate:!f,showDatetime:R,showAuthor:!$},hideShare:!U,position:"publisher-post-list",isStatic:w}):eF?(0,s.Y)(A.u3,{user:H,pub:N,post:I,showDate:!f,showDatetime:R,showEmailSent:F,showAudience:!m,showReactions:!eM&&O,showComments:!eM&&T,showShare:!eM&&U,showRestack:!eM&&j,reaction_token:E,onChange:C,isStatic:w,isFreePreview:Y,sharedShareDialog:!0,base_url:u,allowSendEmail:l,allowEdit:a,showAuthor:!$,showPhoto:B,hidePinning:g,inThreadHead:Z,fromPostPage:J,onClickCommentButton:Q,reactors:X,isAppMode:eu}):(0,s.Y)("div",{className:"spacer",style:{height:24}}):(0,s.Y)(k.s,{className:"meta-subheader",pub:N,post:I,user:H,showDate:!f,showDatetime:!!R,isStatic:!!w,postReactionToken:E,onChange:C,allowEdit:a,hidePinning:g,showEmailSent:F,allowSendEmail:l,allowMobileFooter:J,onCommentsClick:Q,showRestackModal:er}),eF&&eM&&(0,s.Y)(P.fz,{readInAppText:ef,customization:{showShare:U,showComments:T,showReactions:O,showListen:!j&&!Y&&!!eU,showSave:!j,showRestack:j,showCommentRestack:q,showAppUpsell:L}}),eL&&(0,s.Y)("div",{className:"email-ufi-2-empty"})]}),p]})},e8=e=>{let{pub:t,post:i}=e;return t.leaderboard_ranking?(0,s.FD)(ed.Ye,{gap:8,alignItems:"center",paddingBottom:8,children:[(0,s.Y)(ep.EY.Meta,{children:t.name}),(0,s.Y)(es.az,{bg:"secondary",padding:4,radius:"sm",children:(0,s.Y)(ep.EY.B5,{children:(0,s.Y)("a",{href:(0,eI.Jvx)({tabId:t.leaderboard_ranking.category_id.toString(),userId:t.author_id}),style:{textDecoration:"none"},target:"_blank",rel:"noopener noreferrer",onClick:()=>{(0,Q.u4)(Q.qY.POST_PAGE_LEADERBOARD_CTA_CLICKED,{post_id:i.id})},children:(0,eg.kN)(t.leaderboard_ranking)})})})]}):null},e4=e=>{let{user:t,post:i}=e,{iString:n,iTemplate:o}=(0,K.GO)(),r=(0,eP.getBylineUsers)(i).filter(e=>e.is_guest);return 0===r.length?null:(0,s.FD)("div",{className:"post-contributor-footer",children:[(0,s.Y)("div",{className:"container-border"}),r.map(e=>{let i=(0,eP.guessFirstName)(e.name),r=e.primaryPublicationSubscribeUrl;r&&(null==t?void 0:t.email)&&(r=(0,eC.oRR)(r,{email:t.email,autoSubmit:!0,utm_source:eD.VU.substack,utm_campaign:eD._9.guestPostBio,utm_medium:eD.Jn.web}));let a=(0,eC.oRR)((0,eI.gYq)(e),{utm_campaign:eD._9.guestPostBio,utm_medium:eD.Jn.web}),l=!!e.photo_url;return(0,s.Y)("div",{className:c()("post-contributor-bio",{"post-contributor-bio-no-text":!e.bio}),"data-user-id":e.id,children:(0,s.Y)("table",{cellpadding:"0",cellspacing:"0",className:"post-contributor-bio-table",children:(0,s.FD)("tr",{className:"post-contributor-bio-table-row",children:[l&&(0,s.Y)("td",{className:"post-contributor-bio-userhead-cell post-contributor-bio-userhead-cell-web",children:(0,s.Y)(ea.tp,{size:52,user:e,utmSource:"byline"})}),(0,s.Y)("td",{className:"post-contributor-bio-body-cell post-contributor-bio-body-cell-web",children:(0,s.FD)("div",{className:"post-contributor-bio-body",children:[e.bio&&(0,s.Y)("div",{className:"post-contributor-bio-preamble",children:n("A guest post by")}),(0,s.Y)("table",{cellpadding:"0",cellspacing:"0",className:"post-contributor-bio-body-table",children:(0,s.FD)("tr",{className:"post-contributor-bio-body-table-row",children:[(0,s.FD)("td",{className:"post-contributor-bio-copy-cell",children:[!e.bio&&(0,s.Y)("div",{className:"post-contributor-bio-preamble",children:n("A guest post by")}),(0,s.FD)(ed.fI,{gap:4,alignItems:"center",paddingBottom:4,children:[(0,s.Y)(S.ProfileHoverCard,{subject:e,utmSource:"byline",trigger:(0,s.Y)("a",{className:"post-contributor-bio-title no-margin",href:a,native:!0,children:e.name})}),(0,s.Y)(eb.UserStatusSymbols,{size:"sm",tier:e.bestseller_tier,userId:e.id})]}),e.bio&&(0,s.Y)("div",{className:"post-contributor-bio-text",children:e.bio})]}),(0,s.Y)("td",{className:"post-contributor-bio-controls-cell post-contributor-bio-controls-cell-web",children:(0,s.Y)("div",{className:"post-contributor-bio-controls",children:r&&(0,s.Y)("a",{className:"post-contributor-bio-subscribe-button button primary",href:r,native:!0,children:(0,s.Y)("span",{className:"post-contributor-bio-subscribe-button-label",children:o(eH(),i)})})})})]})})]})})]})})})})]})};function e7(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if("undefined"==typeof window)return!1;let i=document.createElement("div");i.innerHTML=e;let n="",o=!1;for(let e=i.childNodes.length-1;e>=0;e--){let r=i.childNodes[e];if(r){if((0,eo.nB)(r,"button-wrapper")||(0,eo.nB)(r,"subscription-widget-wrap")||(0,eo.nB)(r,"subscribe-widget")){o=!0;break}if((n+=r.textContent).length>t)break}}return!o}function e6(e){let{post:t,user:i,onChange:n}=e,[a,l]=(0,u.useState)(!1),{getExperimentVariant:c}=(0,z.Wk)(),d="treatment"===c("video_email_watch_later_experiment"),{onSave:p}=(0,P.Jj)({post:t,isSaved:!1});return((0,u.useEffect)(()=>{if("save"===new URL(location).searchParams.get("action")&&(history.replaceState({},"",(0,eC.oRR)({action:null})),i)){let e=p();n({post:(0,r._)((0,o._)({},t),{is_saved:e})}),e&&d&&l(!0)}},[]),a)?(0,s.Y)(er.l,{onClose:()=>l(!1)}):null}function e3(e){var t;return!!(null==(t=e.audio_items)?void 0:t.some(e=>"tts"===e.type))}function e5(e){var t;return!!(null==(t=e.audio_items)?void 0:t.some(e=>"tts"===e.type&&"paywalled"===e.status))}let e9=()=>(0,s.Y)("article",{className:c()("typography post",{"shows-post":!1}),children:(0,s.Y)(es.az,{className:"container",padding:12,children:(0,s.Y)("p",{align:"center",children:(0,s.Y)(ep.EY,{translated:!0,as:"span",children:"This content has been withheld in your country in response to a legal requirement."})})})})},66665:function(e,t,i){i.d(t,{A:()=>Y});var n=i(69277),o=i(70408),r=i(10201),a=i(75107),s=i(49436),l=i(17402),c=i(31793),d=i(63446),u=i(15894),p=i(32600),h=i(25006),m=i(46271),f=i(17306),_=i(12501),b=i(76977),g=i(39318),v=i(57324);let y="description-RcyL9U",w="isCollapsed-VgTQX_",Y=e=>{var t,i;let{post:Y}=e,S=Y.publishedBylines,{sectionId:C}=(0,p.C)(null!=(i=null==(t=S[0])?void 0:t.id)?i:-1),A=(0,h.df)(),I=(0,m.Jd)(),{newsletters:k}=(0,c.E)(),P=k.topic.newsletters.map(e=>e.sectionId).includes(Y.section_id),[D,N]=(0,l.useState)(!1),x=C||(P?Y.section_id:null),[E,T]=(0,l.useState)(null),[R,F]=(0,l.useState)(null),{markdownProps:O}=(0,f.$)(E),{result:U,refetch:L}=(0,_.st)({pathname:"/api/v1/subscription",auto:!1}),{refetch:M}=(0,_.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH"}),B=async(e,t)=>{await M({json:{[e]:{setting:t?"individual":"disabled"}}})};if((0,l.useEffect)(()=>{if(x&&A){let e=A.sections.find(e=>e.id===x);T((null==e?void 0:e.description)||null),F((null==e?void 0:e.name)||null)}},[x,A]),(0,l.useEffect)(()=>{L()},[]),!x)return null;let V=!!C,j=(null==U?void 0:U.email_settings[x])==="individual",W=!!(null==I?void 0:I.subscription_id)||!!(null==I?void 0:I.is_free_subscribed),q=async()=>{if(x){if(!W&&A){var e;let t=null==(e=A.sections.find(e=>e.id===x))?void 0:e.slug;if(!t)return;let i=(0,g.eV6)(A,{addBase:!0,sectionSlug:t,next:(0,g.yRP)(window.location.href,{follow:!0}),utm_source:v.VU.followAuthorCta,utm_medium:v.Jn.web});window.location.href=i;return}await B(x,!j)}};return(0,r.FD)("div",{className:"container-Z8NWXZ",children:[(0,r.FD)(b.Ye,{alignItems:"start",className:"header-ih4JRy",justifyContent:"space-between",children:[V?(0,r.Y)(u.T,(0,o._)((0,n._)({},O),{className:"".concat(y," ").concat(D?"":w),preset:"d4-serif"})):(0,r.Y)(u.T,{className:"topicTitle-qCRICs",preset:"d4-serif-bold",children:R||"No description available."}),(0,r.Y)(d.v,{style:{padding:"0 4px"},variant:"tertiary",onClick:()=>N(!D),children:(0,r.Y)(a.A,{className:"chevron-EHp9xB",stroke:"red",style:{transform:D?"rotate(180deg)":"rotate(0deg)"}})})]}),!V&&(0,r.Y)(u.T,(0,o._)((0,n._)({},O),{className:"".concat(y," ").concat(D?"":w),preset:"d4-serif"})),(0,r.Y)(d.v,{size:"sm",variant:"tertiary",onClick:async()=>{await q(),await L()},children:(0,r.FD)(b.Ye,{alignItems:"center",gap:8,children:[j?"FOLLOWED":"FOLLOW ".concat(V?"COLUMN":"TOPIC")," ",(0,r.Y)(s.A,{className:"bellIcon-Q6Vwqc"})]})})]})}},46360:function(e,t,i){i.d(t,{L:()=>h});var n=i(10201),o=i(32485),r=i.n(o),a=i(99927),s=i(61755),l=i(18835),c=i(85478),d=i(76977),u=i(82776),p=i(74213);let h=e=>{var t;let{post:i,pub:o,user:h,autoPlayVoiceOver:m,variant:f}=e,{getConfigFor:_}=(0,c.mJ)(),b=i.has_voiceover||!!i.voiceoverUpload,g="newsletter-post"===f&&(0,u.showCommentsOnPost)({publication:o,post:i}),v="newsletter-post"===f&&o.community_enabled,y="newsletter-post"===f,w=!!(null==h?void 0:h.is_contributor),Y="newsletter-post"===f&&!!_("show_open_post_as_pdf_button");return g||v||y||w?(0,n.FD)(d.pT,{className:r()(p.A.postUFI,{[p.A.hasVoiceover||""]:b}),gap:24,justifyContent:"end",children:[b&&(0,n.Y)(l.A,{autoPlay:m,duration:null==(t=i.voiceoverUpload)?void 0:t.duration,href:i.canonical_url,isPaywalled:!(null==h?void 0:h.is_subscribed),mediaUploadId:i.voiceover_upload_id,post:i,pub:o,user:h}),(0,n.FD)(d.Ye,{alignItems:"center",gap:16,children:[g&&(0,n.Y)(s.qS,{post:i,pub:o,size:"large"}),v&&(0,n.Y)(s.ct,{post:i,pub:o,size:"large",user:h}),y&&(0,n.Y)(s.wu,{post:i,pub:o,user:h}),Y&&(0,n.Y)(a.V,{post:i,pub:o,user:h}),w&&(0,n.Y)(s.xn,{className:p.A.editButtonContainer,context:"post-page",post:i,pub:o,user:h})]})]}):null}},32600:function(e,t,i){i.d(t,{C:()=>c});var n=i(17402),o=i(25006),r=i(46271),a=i(12501),s=i(39318),l=i(57324);let c=e=>{var t;let[i,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!0),[m,f]=(0,n.useState)(!1),_=(0,o.df)(),b=(0,r.Jd)(),g=null!=(t=null==_?void 0:_.authorPagesInfo)?t:[],v=null==g?void 0:g.find(t=>t.user_id===e),y=(null==v?void 0:v.primary_section_id)===0||null==v?void 0:v.primary_section_id,w=!!(null==b?void 0:b.subscription_id)||!!(null==b?void 0:b.is_free_subscribed),{result:Y,refetch:S}=(0,a.st)({pathname:"/api/v1/subscription",auto:!1}),{refetch:C}=(0,a.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH",cacheTtl:6e4});(0,n.useEffect)(()=>{(async()=>{h(!0);try{f(!!y);let t=await S(),i=new URLSearchParams(window.location.search),n="true"===i.get("follow");if(i.has("follow")){i.delete("follow");let e=i.toString()?"".concat(window.location.pathname,"?").concat(i.toString()):window.location.pathname;window.history.replaceState({},"",e)}if(n&&y&&w&&!(t instanceof Error)){var e;(null==t||null==(e=t.email_settings)?void 0:e[y])!=="individual"&&(await C({json:{[y]:{setting:"individual"}}}),c(!0))}}finally{h(!1)}})()},[e,_]),(0,n.useEffect)(()=>{u(w)},[w]),(0,n.useEffect)(()=>{(null==Y?void 0:Y.email_settings)&&y&&(c("individual"===Y.email_settings[y]),u(w))},[Y,y,w]);let A=async()=>{if(!y)return;if(!w&&_){var e;let t=null==(e=_.sections.find(e=>e.id===y))?void 0:e.slug,i=(0,s.eV6)(_,{addBase:!0,sectionSlug:t,next:(0,s.yRP)(window.location.href,{follow:!0}),utm_source:l.VU.followAuthorCta,utm_medium:l.Jn.web});window.location.href=i;return}let t=!i;await C({json:{[y]:{setting:t?"individual":"disabled"}}}),c(t)};return{isSubscribedToAuthor:i,isSubscribedToPub:d,isLoading:p,hasSection:m,toggleSubscription:A,sectionId:y,currentUserSubscriptions:Y}}},53293:function(e,t,i){i.d(t,{T:()=>s,l:()=>l});var n=i(10201),o=i(17402),r=i(4016);let a=(0,o.createContext)({theme:null,setTheme:()=>void 0}),s=()=>(0,o.useContext)(a),l=e=>{var t;let{pub:i,post:s,children:l}=e,[c,d]=(0,o.useState)(null!=(t=null==s?void 0:s.postTheme)?t:null);return(0,r.lu)({pub:i})?(0,n.Y)(a.Provider,{value:{theme:c,setTheme:d},children:l}):(0,n.Y)(n.FK,{children:l})}},39598:function(e,t,i){i.d(t,{B:()=>h});var n=i(79785),o=i(10201),r=i(48309),a=i(84605),s=i(86500),l=i(35369),c=i(16993),d=i(57820);function u(){let e=(0,n._)(["Generating ","..."]);return u=function(){return e},e}function p(){let e=(0,n._)(["Shareable ",""]);return p=function(){return e},e}function h(e){let{isOpen:t,onClose:i,isGenerating:n,finishedGram:h,noun:m,postId:f,onDownload:_}=e,{iString:b,iTemplate:g}=(0,a.GO)();return(0,o.FD)(c.aF,{isOpen:t,onClose:i,children:[(0,o.Y)(c.rQ,{title:g(n?u():p(),m),showClose:!0,showDivider:!0,onClose:i}),(0,o.Y)(c.cw,{children:h?(0,o.Y)("video",{src:h.cdn_url,style:{borderRadius:12},controls:!0,download:!0,width:400}):(0,o.Y)(d.y$,{alignItems:"center",justifyContent:"center",minHeight:220})}),h&&(0,o.Y)(c.jl,{direction:"column",primaryButton:(0,o.Y)(l.$n,{priority:"primary",leading:(0,o.Y)(r.A,{size:20}),onClick:()=>{(0,s.u4)(s.qY.AUDIOGRAM_DOWNLOAD_CLICKED,{post_id:f,audiogram_id:null==h?void 0:h.id,media_upload_id:null==h?void 0:h.media_upload_id}),_(h.cdn_url)},children:b("Download")})})]})}},17306:function(e,t,i){i.d(t,{$:()=>o});var n=i(17402);let o=e=>{let[t,o]=(0,n.useState)();return(0,n.useEffect)(()=>{"string"==typeof e&&i.e("8868").then(i.bind(i,36815)).then(t=>{let{micromark:i}=t;o(i(e))})},[e]),{markdownProps:"string"==typeof e?{dangerouslySetInnerHTML:{__html:null!=t?t:e.replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1")},style:{opacity:+!!t}}:{children:e}}}},57568:function(e,t,i){i.d(t,{f:()=>o});var n=i(17988);let o=()=>({isPrint:(0,n.useMediaQuery)({query:"print"})})},44502:function(e,t,i){i.r(t),i.d(t,{ReaderOnboardingModal:()=>k,ReaderOnboardingModalWithUserContext:()=>P});var n=i(99851),o=i(69277),r=i(70408),a=i(32641),s=i(10201),l=i(17402),c=i(86271),d=i(52820),u=i(46271),p=i(86500),h=i(20360),m=i(7717),f=i(14868),_=i(95573),b=i(51651),g=i(21980),v=i(30950),y=i(55087),w=i(10023),Y=i(71419),S=i(52023),C=i(78979),A=i(39318),I=i(49807);class k extends c.w{componentDidMount(){super.componentDidMount()}componentWillReceiveProps(e){this.setState({skipRedirectOnExit:e.skipRedirectOnExit,zIndex:e.zIndex,entry:e.entry,onBeforeClose:e.onBeforeClose})}getDefaultStep(){return C.d.CATEGORIES}openForPub(e,t){this.setState({pub:e,profile:t,step:t?this.props.user?C.d.CATEGORIES:C.d.PUB_SIGNUP:C.d.PUB_LANDING}),this.open()}openToPubSignup(e){this.setState({pub:e,step:C.d.PUB_SIGNUP,profile:null}),this.open()}setStep(e){if((0,p.u4)(p.qY.READER_ONBOARDING_STEP_CHANGED,{from_step:this.state.step,to_step:e,modal:!0}),e===C.d.EXIT)if(this.state.skipRedirectOnExit)this.close();else{var t;let e=null!=(t=this.redirect)?t:this.state.pub&&"reader2"===this.state.entry?(0,A.$_T)(this.state.pub):(0,I.oT5)();document.location.href=e}else setTimeout(()=>this.setState({step:e}),0)}setPreviousStepData(e,t){this.setState({previousStepData:(0,r._)((0,o._)({},this.state.previousStepData),{[e]:t})})}getClassName(){return"reader-onboarding-modal wide"}onClose(){(0,p.u4)(p.qY.READER_ONBOARDING_MODAL_CLOSED,{entry:this.props.entry,step:this.state.step}),this.setStep(this.getDefaultStep()),document.location.reload()}onOpen(){var e;(0,p.u4)(p.qY.READER_ONBOARDING_MODAL_OPENED,{entry:this.props.entry,step:this.state.step,for_pub_id:null==(e=this.state.pub)?void 0:e.id})}handleError(e){let{ignore:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{step:i}=this.state;console.error("Error in reader onboarding ".concat(i," step: ").concat(e)),(0,p.u4)(p.qY.READER_ONBOARDING_ERROR,{step:i,entry:this.props.entry,ignore:t}),t||this.setStep(C.d.ERROR)}renderStep(){let e=this.props,{ref:t}=e,i=(0,a._)(e,["ref"]),{step:n,open:l,pub:c,profile:d,previousStepData:u}=this.state,p={setStep:this.setStep,handleError:this.handleError,close:this.close,setPreviousStepData:this.setPreviousStepData},A=()=>{this.setPreviousStepData(C.d.APP_UPSELL,!0),this.setStep(C.d.WELCOME)};if(!l)return null;switch(n){case C.d.SIGNUP:return(0,s.Y)(w.A,(0,r._)((0,o._)({},i,p),{previousStepData:u}));case C.d.PUB_LANDING:return(0,s.Y)(v.A,(0,r._)((0,o._)({},i,p),{pub:c}));case C.d.PUB_SIGNUP:return(0,s.Y)(y.A,(0,r._)((0,o._)({},i,p),{pub:c,profile:null!=d?d:null}));case C.d.CATEGORIES:return(0,s.Y)(b.I,(0,r._)((0,o._)({},i,p),{pub:c}));case C.d.PROFILE:return(0,s.Y)(g.A,(0,o._)({},i,p));case C.d.START_WRITING:return(0,s.Y)(Y.A,(0,o._)({},i,p));case C.d.CREATE_PUBLICATION:return(0,s.Y)(m.A,(0,o._)({},i,p));case C.d.CREATE_PUBLICATION_SUCCESS:return(0,s.Y)(f.A,(0,r._)((0,o._)({},i,p),{previousStepData:u}));case C.d.ERROR:return(0,s.Y)(_.A,(0,o._)({},i,p));case C.d.APP_UPSELL:return(0,s.Y)(h.A,{onComplete:A});case C.d.WELCOME:default:return(0,s.Y)(S.A,(0,r._)((0,o._)({},i,p),{pub:c,profile:null!=d?d:null}))}}renderChildren(){return(0,s.Y)("div",{className:"reader-onboarding-modal-container",children:this.renderStep()})}constructor(e,t){var i;super(e,t),(0,n._)(this,"redirect",void 0),this.setStep=this.setStep.bind(this),this.state.pub=e.pub||null,this.handleError=this.handleError.bind(this),this.state.previousStepData={},this.setPreviousStepData=this.setPreviousStepData.bind(this),this.state.skipRedirectOnExit=null!=(i=e.skipRedirectOnExit)&&i,this.redirect=e.redirect&&"/"!==e.redirect?e.redirect:null,this.state.step=e.step||this.getDefaultStep()}}(0,n._)(k,"contextType",d.qL);let P=(0,l.forwardRef)((e,t)=>{let i=(0,u.ur)(),n=e.onBeforeClose,a=n?()=>n(i.user):void 0,l=(0,r._)((0,o._)({},e),{onBeforeClose:a,user:i.user});return(0,s.Y)(k,(0,r._)((0,o._)({},l),{ref:t}))})},67551:function(e,t,i){i(10201),i(32485),i(17402),i(84605),i(15975),i(44333),i(17028),i(414),i(63136),i(15454),i(95034),i(11710),i(91324),i(83357),i(39318)},98643:function(e,t,i){i(10201),i(47963),i(84605),i(86500),i(35369),i(76977)},22830:function(e,t,i){i(10201),i(32485),i(44383),i(17402),i(69324),i(44333),i(17028),i(11510),i(39318)},45795:function(e,t,i){if(i.d(t,{CF:()=>q,i3:()=>el}),/^(1889|6578)$/.test(i.j))var n=i(69277);if(/^(1889|6578)$/.test(i.j))var o=i(70408);if(/^(1889|6578)$/.test(i.j))var r=i(32641);var a=i(10201),s=i(32485),l=i.n(s);if(/^(1889|6578)$/.test(i.j))var c=i(23345);if(/^(1889|6578)$/.test(i.j))var d=i(57157);if(/^(1889|6578)$/.test(i.j))var u=i(3831);if(/^(1889|6578)$/.test(i.j))var p=i(38637);if(/^(1889|6578)$/.test(i.j))var h=i(82853);var m=i(17402),f=i(38305),_=i(84777),b=i(898),g=i(90226),v=i(10256),y=i(91513);i(72035);var w=i(41935),Y=i(46271),S=i(60346),C=i(86500),A=i(72569),I=i(82772),k=i(68349),P=i(93946),D=i(35369),N=i(76977),x=i(22602),E=i(81203),T=i(63136),R=i(2548),F=i(90389),O=i(93427),U=i(11510),L=i(32848),M=i(49095);if(/^(1889|6578)$/.test(i.j))var B=i(65942);var V=i(39318),j=i(82776),W=i(8636);function q(e){var t,{post:i,pub:s,openInPostViewer:l,canonicalUrl:c}=e,d=(0,r._)(e,["post","pub","openInPostViewer","canonicalUrl"]);let u=!!(0,Y.Jd)(),{subscription:p}=(0,L.K5)(s.id);return(0,a.Y)($,(0,o._)((0,n._)({},d),{post:i,postId:i.id,title:i.title,description:(0,B.A)(i.description),bylines:i.publishedBylines,consumptionTime:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"md",{minutes:i,action:n}=function(e){let t,{comment_count:i,podcast_duration:n,wordcount:o,videoUpload:r}=e,a=null,s=(0,P.Zq)(e);if(r&&r.duration&&r.duration>0)t=r.duration/60,a="watch";else if("podcast"===s)t=n/60,a="listen";else{if("thread"===s)return{minutes:0,action:i>0?"".concat(i.toLocaleString()," replies"):"Thread"};if(null==o||!(o>0))return{minutes:0,action:null};t=o/j.READ_WORDS_PER_MINUTE,a="read"}return{minutes:Math.max(Math.round(t),1),action:a}}(e);if(null===n)return"";let o=function(e,t){if(0===e||!e)return"";let i=Math.floor(e/60),n=e%60;switch(t){case"lg":return i>0?"".concat(i.toLocaleString()," hours ").concat(n>0?"".concat(n.toLocaleString()," minutes"):""):"".concat(n.toLocaleString()," minutes");case"sm":return i>0?"".concat(i.toLocaleString(),"h ").concat(n>0?"".concat(n.toLocaleString(),"m"):""):"".concat(n.toLocaleString(),"m");default:return i>0?"".concat(i.toLocaleString()," hr ").concat(n>0?"".concat(n.toLocaleString()," min"):""):"".concat(n.toLocaleString()," min")}}(i,t);return"".concat(o," ").concat(n)}(i),coverImage:i.cover_image,type:(0,P.Zq)(i),Icon:"podcast"===(t=(0,P.Zq)(i))?g.O:"video"===t?y.n:"thread"===t?v.y:null,canonicalUrl:null!=c?c:(0,V.wu9)(s,i,{signedIn:u}),noNewTab:l,timestamp:i.post_date,pub:s,audienceBadge:["only_paid","founding"].includes(i.audience)?(null==p?void 0:p.membership_state)==="free_signup"&&i.should_send_free_preview?"preview":"founding"===i.audience?"founding":"paid":void 0}))}function $(e){var{post:t,bylines:i,consumptionTime:s,Icon:l,audienceBadge:c,showBestsellerBadge:d,highlights:u,excerpt:p,noNewTab:h,showLoginPrompt:m}=e,f=(0,r._)(e,["post","bylines","consumptionTime","Icon","audienceBadge","showBestsellerBadge","highlights","excerpt","noNewTab","showLoginPrompt"]);return(0,a.FD)(z,(0,o._)((0,n._)({},f),{highlights:u,noNewTab:h,children:[m&&(0,a.Y)(S.H,{version:"login"}),(0,a.Y)(X,{post:t,bylines:i,consumptionTime:s,Icon:l,audienceBadge:c,showBestsellerBadge:d,highlights:u,excerpt:p})]}))}function z(e){let{children:t,pub:i,publisherName:n,logoUrl:o,timestamp:r,isViewed:s,isArchived:c,isSelected:d,isLiked:u,isSaved:p,onLike:h,onClick:f,canonicalUrl:_,postId:b,defaultSaved:g,onSave:v,onArchive:y,onMouseEnter:w,onVisible:S,utmSource:C,highlights:A,noNewTab:P}=e,D=(0,Y.Jd)(),[x,E]=(0,O.kw)(!s),T=(0,k.rr)(),R=(0,m.useRef)();return(0,I.S8)(R,()=>S&&S(),{threshold:.2}),(0,a.FD)(K,{ref:R,href:_,onClick:e=>{E(),f&&f(e)},className:"reader2-post-container",utmSource:C,isSelected:d,onMouseMove:()=>{null==w||w(b)},noNewTab:P,children:[(0,a.Y)(G,{pub:i,publisherName:n,logoUrl:o,highlights:A,children:(0,a.FD)(N.fI,{gap:12,alignItems:"center",className:l()("reader2-post-info",D&&"hasUser"),children:[(0,a.Y)(J,{className:"inbox-item-timestamp",value:r}),(0,a.Y)(H,{isMobile:T,postId:b,defaultSaved:g,isSaved:p,isArchived:c,onSave:v,user:D,onArchive:y,isLiked:u,onLike:h,canonicalUrl:_,communityEnabled:null==i?void 0:i.community_enabled}),x]})}),t]})}function H(e){let{isMobile:t,postId:i,defaultSaved:n,isLiked:o,onLike:r,isSaved:s,onSave:c,user:d,isArchived:u,onArchive:p,canonicalUrl:h,communityEnabled:m}=e,{isSaved:f,onSave:_}=(0,w.ln)({postId:i,defaultSaved:n}),b=()=>{null==p||p()},g=(0,A.c)();return t?null:(0,a.FD)(N.pT,{padding:4,gap:4,position:"absolute",className:l()("inbox-item-actions-menu",W.A.actionMenu),onClick:e=>{e.stopPropagation(),e.preventDefault()},radius:"md",border:"detail",bg:"primary",children:[r&&m&&(0,a.Y)(D.$n,{size:"sm",priority:"tertiary",onClick:()=>r(i),children:(0,a.Y)(en,{isActive:o})}),(0,a.Y)(D.$n,{size:"sm",priority:"tertiary",onClick:()=>g(h),children:(0,a.Y)(es,{})}),d&&(0,a.Y)(D.$n,{size:"sm",priority:"tertiary",onClick:()=>{c?c(i,!f):_()},children:(0,a.Y)(eo,{isActive:null!=s?s:f})}),p&&(u?(0,a.Y)(D.$n,{size:"sm",priority:"tertiary",onClick:b,children:(0,a.Y)(ea,{})}):(0,a.Y)(D.$n,{size:"sm",priority:"tertiary",onClick:b,children:(0,a.Y)(er,{})}))]})}let K=/^(1889|6578)$/.test(i.j)?(0,m.forwardRef)((e,t)=>{var{noNewTab:i}=e,o=(0,r._)(e,["noNewTab"]);return(0,a.Y)(R.h1,(0,n._)({ref:t,linkClassName:l()("reader2-inbox-post",null==o.isSelected&&"hover-action-menu",W.A.inboxItem),native:!0,isPadded:!1,newTab:!i},o))}):null;function G(e){let{pub:t,logoUrl:i,publisherName:n,children:o,highlights:r={}}=e;return(0,a.FD)("div",{className:"reader2-post-head reader2-text-meta",children:[(t||i)&&(0,a.Y)(E.Nq,{pub:t,logoUrl:i,publicationName:n,size:20,radius:"xs"}),(0,a.Y)("div",{className:"pub-name",children:n||t&&(0,a.Y)(_.m,{pubId:t.id,trigger:(0,a.Y)(R.IE,{href:t.base_url,onClick:e=>e.stopPropagation(),children:(0,F.S)(t.name,r["publication.name"])})})}),o]})}function J(e){let{value:t,className:i}=e;return(0,a.Y)(T.EY.Meta,{className:i,nowrap:!0,children:(0,k.Wy)(t)})}function Q(e){let{post:t,image:i,metaText:n,highlights:o={},excerpt:r}=e;return(0,a.FD)("div",{className:"reader2-post-body",onClick:()=>{var e;let i=(null==(e=window)?void 0:e.location)&&new URL(window.location.href);i&&(0,C.u4)(C.qY.POST_SEARCH_RESULT_CLICKED,{post_id:t.id,query:decodeURIComponent(i.pathname.replace(/\/search\//g,""))})},children:[(0,a.FD)(R.I1,{minWidth:0,gap:8,children:[(0,a.Y)("div",{className:"reader2-post-title reader2-clamp-lines",children:(0,F.S)(t.title,o.title||o["posts.title"],"heavy")}),t.description&&(0,a.Y)(R.fz,{variant:"secondary",isConstrained:!r,children:r?(0,a.FD)(T.EY,{as:"span",fontStyle:"italic",children:["“...",(0,F.S)(r,o.body_text,"heavy"),"”"]}):(0,F.S)((0,B.A)(t.description),o.subtitle||o["posts.subtitle"],"heavy")}),n]}),i]})}function X(e){let{bylines:t,consumptionTime:i,Icon:n,audienceBadge:o,showBestsellerBadge:r,post:s,highlights:l,excerpt:c}=e;return(0,a.Y)(Q,{post:s,metaText:(0,a.Y)(Z,{bylines:t,consumptionTime:i,Icon:n,audienceBadge:o,showBestsellerBadge:r,highlights:l}),image:s.cover_image&&(0,a.Y)(ei,{post:s}),highlights:l,excerpt:c})}function Z(e){let{bylines:t,consumptionTime:i,Icon:n,audienceBadge:o,showBestsellerBadge:r,highlights:s={}}=e;return(0,a.FD)(R.bi,{children:[o&&(0,a.FD)(a.FK,{children:[(0,a.Y)("span",{className:"meta-audience-badge",children:o}),(0,a.Y)(et,{})]}),t.length>0?(0,a.FD)(a.FK,{children:[(0,a.Y)(f.K,{array:t,limit:3,formatter:e=>r?(0,a.Y)(ee,{name:e.name||"",tier:e.bestseller_tier,userId:e.id}):(0,F.S)(e.name||"",s["publication.author_name"])}),i&&(0,a.Y)(et,{})]}):null,n&&(0,a.FD)(a.FK,{children:[(0,a.Y)(n,{className:"meta-icon"})," "]}),i]})}let ee=e=>{let{name:t,tier:i,userId:n}=e;return i?(0,a.FD)(R.Ye,{inline:!0,gap:4,alignItems:"center",children:[t," ",(0,a.Y)(M.UserStatusSymbols,{userId:n,tier:i,size:"sm"})]}):(0,a.Y)(a.FK,{children:t})},et=()=>(0,a.Y)("span",{className:"meta-bullet",children:"∙"});function ei(e){let{post:t,size:i=132,square:n,className:o}=e,r=t.cover_image,s=(0,P.Zq)(t),c="podcast"===s||n?i:200,[d,u]=(0,m.useState)(null);return d?null:(0,a.FD)("div",{className:l()("reader2-post-picture-container",o),children:[(0,a.Y)(R.tP,{className:l()("reader2-post-picture",s),src:r,width:c,height:i,loading:"lazy",noStyle:!n,onError:e=>u(e)}),("podcast"===s||"video"===s)&&(0,a.Y)("div",{className:"reader2-picture-overlay",children:(0,a.Y)(b.o,{className:"picture-play"})})]})}function en(e){let{isActive:t}=e;return(0,a.Y)(c.A,{className:t?W.A.activeLike:"",size:20})}function eo(e){let{isActive:t}=e;return(0,a.Y)(d.A,{className:t?W.A.activeSave:"",size:20})}function er(){return(0,a.Y)(u.A,{size:20})}function ea(){return(0,a.Y)(p.A,{size:20})}function es(){return(0,a.Y)(h.A,{size:20})}function el(){return(0,a.Y)(a.FK,{children:Array(6).fill(0).map((e,t)=>(0,a.Y)(ec,{},t))})}function ec(){let e=(0,U.Iu)();return(0,a.Y)(R.h1,{isPadded:!1,children:(0,a.FD)(R.I1,{flex:"grow",gap:12,padding:e?8:12,children:[(0,a.FD)(N.fI,{gap:12,justifyContent:"space-between",alignItems:"center",children:[(0,a.FD)(N.fI,{gap:12,alignItems:"center",flex:"grow",children:[(0,a.Y)(x.O,{width:24,height:24,radius:"sm"}),(0,a.Y)(x.O,{maxWidth:120,flex:"grow"})]}),(0,a.Y)(x.O,{maxWidth:80,flex:"grow"})]}),(0,a.FD)("div",{className:"reader2-post-body",children:[(0,a.FD)(R.I1,{minWidth:0,gap:4,children:[(0,a.Y)(x.O,{width:"70%"}),(0,a.Y)(x.O,{width:"80%"}),(0,a.Y)(x.O,{width:"50%"})]}),(0,a.Y)(x.O,{width:e?64:160,height:e?64:120})]})]})})}},14315:function(e,t,i){i(10201),i(32485),i(17402),i(97731),i(59307),i(6212),i(41935),i(33460),i(94090),i(15667),i(72880),i(9979),i(84605),i(46271),i(77405),i(67024),i(94328),i(86500),i(94729),i(72569),i(37552),i(76528),i(82772),i(68349),i(91694);var n=i(89490);i(35369),i(76977),i(44552),i(88774),i(22602),i(57820),i(81203),i(75303),i(63136),i(36372),i(95187),i(5180),i(2548),i(76531),i(45795),i(51735),i(11510),i(16291),i(37764),i(39318),i(18947),i(49807);var o=i(91093);(0,n.I4)({display:"flex",direction:"column",gap:8,justifyContent:"center",alignItems:"center",className:o.A.cardTop}),(0,n.I4)({display:"flex",direction:"column",padding:12,paddingTop:20,gap:20,flex:"grow",className:o.A.cardBottom}),(0,n.I4)({display:"flex",direction:"column",gap:2,flex:"grow"}),(0,n.I4)({display:"flex",alignItems:"center",gap:8}),(0,n.I4)({display:"flex",gap:4,minWidth:0,flex:"grow",alignItems:"center"})},59396:function(e,t,i){i(10201),i(17402),i(12501)},70362:function(e,t,i){i(10201),i(83673),i(17402),i(47963),i(70357),i(46271),i(53906),i(27332),i(86500),i(24078),i(35369),i(74715),i(16074),i(76977),i(81203),i(63136),i(84605);var n=i(89490);(0,n.I4)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:8}),(0,n.I4)({display:"flex",direction:"column",gap:8}),i(32485),i(8853),i(84777),i(41935),i(85478),i(25859),i(82772),i(67250),i(22602),i(67024),i(94328),i(95187),i(14315),i(49807),(0,n.I4)({display:"flex",justifyContent:"space-between",alignItems:"start",gap:12}),i(39318),(0,n.I4)({display:"flex",justifyContent:"space-between",alignItems:"start",gap:12}),i(17849),i(21398),i(46453),i(2548),i(59396),i(11510),i(49095),i(37764)},17849:function(e,t,i){i(10201),i(78649),i(76977),i(68940),i(22830)},887:function(e,t,i){i(10201);var n=i(75303);i(34387),i(69198);var o=i(70828);(0,n.I4)({display:"flex",flex:"auto",className:o.A.container}),(0,n.I4)({display:"flex",className:o.A.nav,zIndex:1,gap:20,paddingX:20,sizing:"border-box",alignItems:"center",flex:"grow",justifyContent:"end",borderBottom:"detail"})},45133:function(e,t,i){i(10201),i(69324),i(97640),i(95899),i(46271);var n=i(89490);i(35369),i(76977),i(28649),i(34387),i(89273),i(69198),i(63136),i(45197);var o=i(70828);(0,n.I4)({display:"flex",alignItems:"center",justifyContent:"start",gap:20,flex:"grow"}),(0,n.I4)({display:"flex",alignItems:"center",justifyContent:"end",gap:12,flex:"grow"}),(0,n.I4)({display:"flex",flex:"auto",className:o.A.container}),(0,n.I4)({display:"flex",className:o.A.nav,zIndex:1,gap:20,paddingX:20,sizing:"border-box",alignItems:"center",flex:"grow",justifyContent:"space-between"})},28649:function(e,t,i){i(10201),i(44333),i(35369),i(11510),i(70189)},34387:function(e,t,i){i(10201),i(84605),i(35369),i(49807)},89273:function(e,t,i){i.d(t,{l:()=>l});var n=i(10201),o=i(70357),r=i(35369),a=i(17028),s=i(70189);function l(){return(0,n.Y)(r.Nm,{href:s.TJ,"aria-label":"Home",resetCss:!0,display:"flex",direction:"column",radius:"md",bg:"primary",showFocus:!0,animate:!0,hover:!0,children:(0,n.Y)(a.ov,{width:48,height:48,position:"relative",children:(0,n.Y)(o.A,{fill:"var(--color-nav-logo)",size:28})})})}},57322:function(e,t,i){i.d(t,{W:()=>j});var n=i(10201);if(/^(1889|6578)$/.test(i.j))var o=i(24472);var r=i(17402),a=i(95387),s=i(2929),l=i(31052),c=i(68058),d=i(56796),u=i(63626),p=i(22005),h=i(92707),m=i(11004),f=i(92170),_=i(97250),b=i(44512),g=i(69324),v=i(84605),y=i(46275),w=i(97640),Y=i(95899),S=i(46271),C=i(86500),A=i(44333),I=i(68349),k=i(17028),P=i(62956),D=i(96871),N=i(38303),x=i(46453),E=i(89273),T=i(61539),R=i(55287),F=i(2481),O=i(16291),U=i(39318),L=i(70189),M=i(49807);if(/^(1889|6578)$/.test(i.j))var B=i(57324);var V=i(64339);function j(e){var t,i;let{requireLogin:V,setDrawer:j,drawer:z,native:H}=e,K=(0,S.Jd)(),{iString:G}=(0,v.GO)(),{viewerProfile:J}=(0,Y.xc)(),{isExpanded:Q}=(0,x.eE)(),[X]=(0,A.rd)(),{activityUnreadCount:Z}=(0,w.Vd)(),ee=(0,y.BR)().isOnDestination,[et,ei]=(0,r.useState)(null),en={urlParams:{utm_content:B.fL.islandDesktopNavSidebar}},eo=ee?L.TJ:(0,M.yRP)((0,M.$_T)(),{utm_content:B.fL.islandDesktopNavSidebar}),er=ee?null:(0,M.jQM)(en),ea=ee?M.AAD:(0,M.yRP)((0,M.$_T)()+M.AAD,{utm_content:B.fL.islandDesktopNavSidebar}),es=(null==K?void 0:K.profile_set_up_at)?(0,M.gYq)(K,{noBase:ee,utm_source:B.VU.menu,utm_content:ee?void 0:B.fL.islandDesktopNavSidebar}):K?(0,M.W$o)({utm_source:B.VU.menu,utm_content:ee?void 0:B.fL.islandDesktopNavSidebar}):void 0;(0,r.useEffect)(()=>{if("undefined"!=typeof window){let e=window.localStorage.getItem("chatLastClicked");e&&ei((0,O.A)(e))}},[]);let el=(null==J||null==(t=J.publicationUsers)?void 0:t.find(e=>"admin"===e.role||"contributor"===e.role))||{publication:null==K||null==(i=K.dashboard_pubs)?void 0:i[0]},ec=(0,F.NP)(),{isOpen:ed}=(0,g.Ku)(),{chatUnreadCount:eu,useChatBadge:ep}=(0,P.J)({chatLastClicked:et}),eh=!!z,em=eh||ed,ef=X.path.includes(M.pU7),e_=X.path.startsWith(M.v6Q),eb=X.path.startsWith(M.Q6R),eg=X.path.startsWith(M.AAD),ev=z||e_||!ee;return(0,n.Y)(k.VP,{position:"relative",children:(0,n.FD)(W,{border:ev?"detail":void 0,position:"fixed",children:[(0,n.Y)(q,{alignItems:Q?"start":"center",children:(0,n.Y)(E.l,{})}),(0,n.FD)($,{children:[(0,n.Y)(R.d,{href:eo,icon:(0,n.Y)(h.A,{}),activeIcon:(0,n.Y)(p.A,{}),text:G("Home"),native:!!H,isActive:!em&&void 0}),(0,n.Y)(R.d,{href:ee?M.tvl:(0,M.ahR)(en),icon:(0,n.Y)(f.A,{}),activeIcon:(0,n.Y)(m.A,{}),requireLogin:V,text:G("Subscriptions"),native:!!H,isActive:!em&&void 0}),(0,n.Y)(R.d,{href:ee?M.v6Q:(0,M.ehp)(en),icon:(0,n.Y)(c.A,{}),activeIcon:(0,n.Y)(l.A,{}),requireLogin:V,badge:eu,dot:!!ep,native:!!H,text:G("Chat"),onClick:K?()=>{j&&j(null),ei((0,O.A)()),window.localStorage.setItem("chatLastClicked",(0,O.A)().toISOString())}:void 0,isActive:!em&&void 0}),(0,n.Y)(R.d,{onClick:K?()=>{j?j("activity"===z?null:"activity"):er&&(0,I.V2)(er)}:void 0,isActive:eh||eb,icon:(0,n.Y)(s.A,{}),activeIcon:(0,n.Y)(a.A,{}),requireLogin:V,badge:Z,text:G("Activity")}),(0,n.Y)(R.d,{href:ea,icon:(0,n.Y)(b.A,{}),activeIcon:(0,n.Y)(_.A,{}),text:G("Explore"),isActive:eg||ef,native:!!H}),!!(null==K?void 0:K.subdomain)&&(0,n.Y)(R.d,{icon:(0,n.Y)(u.A,{}),activeIcon:(0,n.Y)(d.A,{}),text:G("Dashboard"),onClick:()=>{let e=K?(0,U.yRA)(K,{params:{utm_source:B.VU.menu}}):void 0;e&&((0,C.u4)(C.qY.HOMEPAGE_DASHBOARD_LINK_CLICKED),(0,I.V2)(e,{local_navigation:!1,newTab:!0}))}}),(0,n.Y)(R.d,{href:es||void 0,icon:K?(0,n.Y)(D.v,{user:K}):(0,n.Y)(o.A,{}),activeIcon:K?(0,n.Y)(D.v,{user:K,isActive:!0}):(0,n.Y)(o.A,{}),requireLogin:V,text:G("Profile"),native:!!H||!(null==K?void 0:K.profile_set_up_at),isActive:!em&&void 0}),(0,n.Y)(N.X,{onNoteClick:()=>{j&&j(null),ec.open({onCompose:()=>{(0,L.Oh)(X.path)?((0,I.V2)("/inbox",{replace:!0}),setTimeout(()=>{(0,I.V2)(L.TJ,{replace:!0})},0)):(0,I.V2)(eo)}})},profile:J,publicationUser:el,requireLogin:V})]}),K&&(0,n.Y)(q,{children:(0,n.Y)(T.Q,{})})]})})}function W(e){let{children:t,border:i,position:o}=e;return(0,n.Y)(k.VP,{position:o,padding:8,borderRight:i,sizing:"border-box",role:"navigation","aria-label":"Main navigation","aria-orientation":"vertical",className:V.A.sidebar,children:t})}function q(e){let{alignItems:t,children:i}=e;return(0,n.Y)(k.VP,{padding:8,height:64,flex:"auto",sizing:"border-box",alignItems:t,children:i})}function $(e){let{children:t}=e;return(0,n.Y)(k.VP,{padding:8,gap:8,flex:"grow",justifyContent:"start",children:t})}},69198:function(e,t,i){i(10201),i(84605),i(35369),i(11510)},47408:function(e,t,i){i.d(t,{w:()=>Y});var n=i(10201),o=i(32485),r=i.n(o);if(/^(1889|6578)$/.test(i.j))var a=i(49802);var s=i(31052),l=i(68058),c=i(22005),d=i(92707),u=i(11004),p=i(92170),h=i(46275),m=i(13022),f=i(76977),_=i(62956),b=i(21713),g=i(70189),v=i(49807);if(/^(1889|6578)$/.test(i.j))var y=i(57324);var w=i(5059);function Y(e){let{requireLogin:t}=e,i=(0,h.BR)().isOnDestination,{chatUnreadCount:o}=(0,_.J)({}),Y={noBase:!1,urlParams:{utm_content:y.fL.islandDesktopNavSidebar}},S=i?g.TJ:(0,v.yRP)((0,v.$_T)(),{utm_content:y.fL.islandDesktopNavSidebar});return(0,n.Y)(f.pT,{className:r()(w.A.container,!i&&w.A.publicationNav),children:(0,n.FD)(f.pT,{className:w.A.tabs,flex:"grow",alignItems:"center",justifyContent:"space-between",borderTop:"detail",paddingX:64,children:[(0,n.Y)(b.D,{href:S,icon:(0,n.Y)(d.A,{}),activeIcon:(0,n.Y)(c.A,{}),requireLogin:t,native:!i}),(0,n.Y)(b.D,{href:i?v.tvl:(0,v.ahR)(Y),icon:(0,n.Y)(p.A,{}),activeIcon:(0,n.Y)(u.A,{}),requireLogin:t,native:!i}),(0,n.Y)(m.XA,{configKey:"web_reader_podcasts_tab",children:(0,n.Y)(b.D,{href:"/podcasts-player",icon:(0,n.Y)(a.A,{}),activeIcon:(0,n.Y)(a.A,{}),requireLogin:t})}),(0,n.Y)(b.D,{href:i?(0,v.ehp)():(0,v.ehp)(Y),icon:(0,n.Y)(l.A,{}),activeIcon:(0,n.Y)(s.A,{}),requireLogin:t,badge:o,native:!i})]})})}},77148:function(e,t,i){i(10201);var n=i(7350),o=i.n(n);i(17402),o()(e=>{let{allProgress:t,user:i}=e,n=(e=>{let{user:t}=e;return"podcasts:listening_progress:".concat(t.id)})({user:i});localStorage.setItem(n,JSON.stringify(t))},1e3)},68683:function(e,t,i){i(10201),i(32485),i(17402),i(99070),i(6212),i(76977),i(46453),i(69843),i(63558),i(43510),i(72880),i(84605),i(56804);var n=i(89490);i(35369),i(88774),i(81203),i(75303),i(63136),i(83629),i(39318),i(49807),i(82776),(0,n.I4)({display:"flex",direction:"row",flex:"grow",alignItems:"center",justifyContent:"space-between",paddingX:8,gap:16}),i(76531)},76531:function(e,t,i){i.d(t,{p:()=>r}),i(10201),i(36944);var n=i(17402);i(77148);let o=/^(1889|6578)$/.test(i.j)?(0,n.createContext)({activePodcast:null,activePost:null,activePublication:null,lastActivePost:null,lastActivePodcast:null,lastActivePublication:null,audioPlayerRef:{current:null},currentTime:0,duration:null,isPlaying:!1,listeningProgress:{},onClear:()=>void 0,onPlay:()=>void 0,onToggle:()=>void 0}):null,r=()=>(0,n.useContext)(o)},51735:function(e,t,i){i.d(t,{_:()=>l});var n=i(10201);if(/^(1889|6578)$/.test(i.j))var o=i(44471);var r=i(84605),a=i(94729),s=i(36372);function l(e){let{publication:t,postId:i,onSuccess:l}=e,c=(0,s.d)(),{iString:d}=(0,r.GO)();return async e=>{let{reportCategory:r,details:u}=e;(null==t?void 0:t.id)&&i&&(await (0,a.x6)("/api/v1/publications/".concat(t.id,"/posts/").concat(i,"/report"),{method:"POST",json:{details:u,reportCategory:r}}),null==l||l(),c.popToast(()=>(0,n.Y)(s.y,{text:d("We received your report"),Icon:o.A})))}}}}]);