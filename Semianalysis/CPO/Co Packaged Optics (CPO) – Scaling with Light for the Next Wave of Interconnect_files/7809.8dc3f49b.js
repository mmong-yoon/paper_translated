"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7809"],{84985:function(t,n,e){e.d(n,{A:()=>o});let o={visitedSurfacesIFrame:"visitedSurfacesIFrame-yy8AJL"}},96917:function(t,n,e){e.d(n,{A:()=>v});var o=e(99851),i=e(69277),a=e(70408),r=e(10201),u=e(17402),l=e(85478),c=e(86500),d=e(17186),s=e(68349),m=e(49807);let h="".concat(m.Pmx,"/fedcm/config.json");var p=e(39318),f=e(41086);let g="domain-redirect-time";class v extends u.Component{componentDidMount(){let t=this.loadedWithLikelyLoggedInParam()?"param":null;t&&!this.shouldBlockLoginRedirect()?this.attemptLoginRedirect({source:t}):this.useFedCm()?this.initiateFedCmFlow():this.useIframe()&&window.addEventListener("message",t=>this.handleFrameMessage(t)),(0,s.qm)("triedSigningIn")}useFedCm(){var t;return(null==(t=this.state.pub)?void 0:t.custom_domain)&&!this.state.user&&this.context.getConfigFor("enable_fedcm")&&"undefined"!=typeof window&&"IdentityCredential"in window}async initiateFedCmFlow(){let t=await navigator.credentials.get({identity:{providers:[{configURL:h,clientId:"substack_custom_domain"}]}});(null==t?void 0:t.token)==="redirect-to-login"&&this.attemptLoginRedirect({source:"fedcm"})}shouldBlockLoginRedirect(){var t;let n=parseInt((0,d.xm)(g,0));return this.state.block_auto_login||!(null==(t=this.state.pub)?void 0:t.custom_domain)||this.state.user||"undefined"==typeof window||Date.now()-n<=864e5||this.state.triedSigningIn}handleFrameMessage(t){var n,e,o;if((null==(n=t.data)?void 0:n.type)!=="frame-state")return;let i=!this.shouldBlockLoginRedirect()&&(null==(e=t.data)?void 0:e.loggedInAtSubstack);(0,c.u4)(c.qY.FRAME_MESSAGE_HANDLED,{loggedInAtSubstack:null==(o=t.data)?void 0:o.loggedInAtSubstack,loggedInAtCustomDomain:!!this.state.user,attemptRedirect:i}),i&&this.attemptLoginRedirect({source:"cookie"})}attemptLoginRedirect(){var t;let{source:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,c.u4)(c.qY.CUSTOM_DOMAIN_LOGIN_REDIRECT_ATTEMPTED,{fromParam:"param"===n,source:n}),(0,d.X3)(g,"".concat(Date.now()));let e=(0,p.RY1)({useOriginalUrl:!0});this.props.initialData.hide_intro_popup&&(e=(0,p.oRR)(e,{hide_intro_popup:!0})),location.href=(0,p.a7q)({for_pub:null==(t=this.state.pub)?void 0:t.subdomain,justTrying:!0,redirect:e})}loadedWithLikelyLoggedInParam(){return"undefined"!=typeof window&&window._preloads.original_url&&!!(0,f.y)(window._preloads.original_url,"lli")}useIframe(){var t,n,e;return!("undefined"==typeof window||this.loadedWithLikelyLoggedInParam()||!(null==(t=this.state.pub)?void 0:t.custom_domain)||(0,p.P1Q)(null==(e=window)||null==(n=e.location)?void 0:n.href))}render(){return this.useIframe()?(0,r.Y)("iframe",{src:"".concat((0,p.Ewe)(),"/channel-frame"),className:"channel-frame",width:"0",height:"0"}):null}constructor(t,n){var e;super(t,n),this.state=(0,a._)((0,i._)({},t.initialData),{triedSigningIn:null!=(e=(0,f.y)("triedSigningIn"))?e:void 0})}}(0,o._)(v,"contextType",l.W8)},82203:function(t,n,e){e.d(n,{K:()=>d});var o=e(10201),i=e(32485),a=e.n(i),r=e(95977),u=e(41232),l=e(39891),c=e(87300);function d(t){let{src:n,size:e,framed:i}=t;return(0,o.Y)(r.A,{className:a()(u.A.avatar,c.A.avatar,i&&c.A.framed),src:(0,l.dJ)(n),style:{width:e,height:e,minWidth:e,minHeight:e,objectFit:"cover",margin:0,display:"inline"},width:e,height:e})}},76528:function(t,n,e){e.d(n,{AA:()=>l,OU:()=>u});var o=e(69277),i=e(32641),a=e(25250),r=e(94729);function u(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;var{deps:u,auto:l=!0,massage:c=async t=>t,shouldRevalidate:d=!0}=n,s=(0,i._)(n,["deps","auto","massage","shouldRevalidate"]);return(0,a.Ay)(l?u?[...u,t]:t:null,()=>(0,r.x6)(t,s).then(c),(0,o._)({},d?null:{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1},e))}function l(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var{deps:e}=n,o=(0,i._)(n,["deps"]);(0,a.uv)(e?[...e,t]:t,()=>(0,r.x6)(t,o))}},67734:function(t,n,e){e.d(n,{id:()=>o,oW:()=>i}),e(90128),e(16291),e(82776);let o=(t,n)=>{let e;if(n&&n!==t.currency){var o,i,a;if(!(null==(o=t.currency_options)?void 0:o[n]))return;e=null!=(a=null==(i=t.currency_options[n])?void 0:i.unit_amount)?a:null}else e="object"in t&&"price"===t.object?t.unit_amount:t.amount;return null!=e?e:0},i=(t,n)=>{var e;return n&&n!==t.currency?null==(e=t.metadata.minimum_local)?void 0:e[n]:t.metadata.minimum}},47851:function(t,n,e){e.d(n,{mn:()=>o});let o={comp_one_month:"1 month comp",comp_three_months:"3 month comp",comp_six_months:"6 month comp",comp_nine_months:"9 month comp",comp_twelve_months:"12 month comp",custom:"Custom"}},92636:function(t,n,e){e.d(n,{$_:()=>d,Bp:()=>l,Ew:()=>s,PH:()=>f,Pm:()=>r,Sg:()=>p,c$:()=>h,d5:()=>a,qd:()=>m,sX:()=>u,w4:()=>i,xJ:()=>o,yR:()=>c});let o="substack.com",i="https://substackcdn.com";function a(t){return"https://"+t}i.replace(/https?:\/\//,"").replace(/\/$/,"");let r=a(o),u=new URL(r);function l(t){return Object.keys(t).filter(n=>void 0!==t[n]&&null!==t[n]).map(n=>"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t[n]))).join("&")}function c(t,n){if(!t)return"";if(!n)return t;let e=l(n),o=e?-1===t.indexOf("?")?"?":"&":"";return"".concat(t).concat(o).concat(e)}function d(t){let{forceSubdomain:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&"object"==typeof t&&"base_url"in t&&t.base_url&&!n?t.base_url:a(function(t){let{forceSubdomain:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&"object"==typeof t&&"custom_domain"in t&&t.custom_domain&&!t.custom_domain_optional&&!n)return t.custom_domain;let e=o;return t&&"www"!==t.subdomain&&(e="".concat(t.subdomain,".").concat(e)),e}(t,{forceSubdomain:n}))}function s(){return d()}function m(){return a("open.".concat(o))}function h(t){let{noBase:n,urlParams:e,pub:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n?"":d(o);return c("".concat(i).concat(t),e)}function p(){var t;if("undefined"==typeof document||!(null==(t=document.location)?void 0:t.hostname))return!0;let n=document.location.hostname;return n.startsWith(o)||n.startsWith("substack.info")}function f(){var t;if("undefined"==typeof document||!(null==(t=document.location)?void 0:t.hostname))return!0;let n=document.location.hostname;return!(n.startsWith(o)||n.startsWith("substack.info"))&&document.location.pathname.startsWith("/publish/")}},46058:function(t,n,e){e.d(n,{D0:()=>c,Ji:()=>u,VL:()=>l,cp:()=>d,pI:()=>a,w3:()=>r});var o=e(92636),i=e(49807);function a(t,n){let e=r(t,n);return e||((null==n?void 0:n.darkMode)?d:c)}function r(t){let{preferAuthorPhoto:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n&&(null==t?void 0:t.author_photo_url)&&(0,i.dJ9)(t.author_photo_url)?(0,i.dJ9)(t.author_photo_url):(null==t?void 0:t.photo_url)&&(0,i.dJ9)(t.photo_url)?(0,i.dJ9)(t.photo_url):(null==t?void 0:t.id)!=null?u(t.id):null}function u(t){return"".concat((0,o.Ew)(),"/img/avatars/").concat(["purple","yellow","orange","green","black"][t%5],".png")}function l(t){return t.startsWith("".concat((0,o.Ew)(),"/img/avatars/"))}let c="".concat((0,o.Ew)(),"/img/avatars/default-light.png"),d="".concat((0,o.Ew)(),"/img/avatars/default-dark.png")}}]);